{"version":3,"sources":["../src/core/config.ts","../src/core/physics.ts","../src/animation/loop.ts","../src/utils/math.ts","../src/utils/warnings.ts","../src/core/spring.ts","../src/core/spring-value.ts","../src/core/spring-group.ts","../src/animation/sequence.ts","../src/animation/trail.ts","../src/animation/decay.ts","../src/animation/keyframes.ts","../src/interpolation/interpolate.ts","../src/interpolation/color.ts","../src/gesture/drag.ts","../src/gesture/scroll.ts","../src/gesture/advanced.ts","../src/utils/color.ts","../src/scroll/scroll-linked.ts","../src/animation/timeline.ts","../src/svg/morph.ts","../src/layout/shared.ts","../src/animation/stagger-patterns.ts","../src/core/MotionValue.ts","../src/svg/path.ts","../src/layout/flip.ts"],"names":["defaultConfig","springPresets","configFromDuration","ms","configFromBounce","bounce","simulateSpring","position","velocity","target","config","stiffness","damping","mass","restSpeed","restDelta","displacement","absDisplacement","absVelocity","dt","springForce","dampingForce","acceleration","newVelocity","newPosition","isRest","calculatePeriod","calculateDampingRatio","isUnderdamped","isCriticallyDamped","ratio","isOverdamped","AnimationState","AnimationLoop","id","cb","now","rawDelta","clampedDelta","listener","toRemove","ref","animation","i","existingId","callback","count","delta","globalLoop","clamp","value","min","max","actualMin","actualMax","lerp","a","b","t","mapRange","inMin","inMax","outMin","outMax","degToRad","degrees","radToDeg","radians","isDev","warnedMessages","warnOnce","message","validateSpringConfig","validateDragConfig","rubberBandFactor","bounds","validateDecayConfig","deceleration","clearWarnings","SpringAnimationImpl","from","to","resolve","temp","_now","result","spring","SpringValueImpl","initial","mergedConfig","originalOnUpdate","originalOnComplete","subscriber","createSpringValue","SpringGroupImpl","initialValues","key","springValue","values","promises","createSpringGroup","sequence","animations","createAnimation","parallel","stagger","items","animate","options","delay","startIndex","indices","used","offset","left","right","getDelay","_i","index","anim","delayMs","TrailImpl","followDelay","springConfig","targetValue","delayFrames","targetFrame","startFrame","framesToWait","s","unsubscribers","unsubscribe","createTrail","DecayAnimationImpl","decay","keyframes","times","onKeyframe","onComplete","onUpdate","normalizedKeyframes","v","keyframeCount","kf","currentIndex","isPlaying","isPaused","currentValue","destroyed","createSpring","animateToNext","targetKf","checkComplete","parseKeyframeArray","isKeyframeArray","defaultInterpolateOptions","InterpolationImpl","source","input","output","extrapolate","extrapolateLeft","extrapolateRight","mode","specificMode","fallbackMode","interpolate","ColorInterpolationImpl","colorStrings","c","r","g","color","hexMatch","hex","rgbMatch","rgbaMatch","hslMatch","h","l","gray","hue2rgb","p","q","interpolateColor","colors","defaultDragConfig","DragSpringImpl","element","newX","newY","factor","x","y","velocityX","velocityY","top","bottom","targetX","targetY","createDragSpring","defaultScrollConfig","ScrollSpringImpl","container","deltaX","deltaY","maxScrollX","maxScrollY","checkEnd","containerRect","elementRect","createScrollSpring","getDistance","p1","p2","dx","dy","getAngle","getCenter","rubberBand","createPinchGesture","minScale","maxScale","enableRubberBand","onPinch","onPinchStart","onPinchEnd","enabled","active","initialDistance","initialScale","currentScale","lastScale","startTime","lastTime","touches","scaleSpring","createState","event","first","last","touchArray","origin","handleTouchStart","e","touch","handleTouchMove","currentDistance","newScale","handleTouchEnd","targetScale","createRotateGesture","initialEnabled","threshold","onRotate","onRotateStart","onRotateEnd","initialAngle","currentAngle","lastAngle","angleOffset","newAngle","angleDelta","createSwipeGesture","velocityThreshold","distanceThreshold","maxDuration","axis","onSwipe","onSwipeStart","onSwipeEnd","startPoint","lastPoint","pointerId","direction","duration","movement","detectDirection","absX","absY","velX","velY","meetsDistanceX","meetsDistanceY","meetsVelocityX","meetsVelocityY","handlePointerDown","handlePointerMove","handlePointerUp","state","createLongPressGesture","movementTolerance","onLongPress","onPressStart","onPressEnd","triggered","timerId","createGestures","controllers","parseColor","hexToRgb","hslToRgb","rgbToHex","toHex","n","cleanHex","rgbToHsl","lerpColor","colorA","colorB","createScrollProgress","smooth","progress","smoothedProgress","lastScrollY","rafId","subscribers","calculateProgress","scrollY","windowHeight","newProgress","isInView","visibleRatio","rect","elementTop","elementHeight","endPoint","scrollStart","scrollEnd","documentHeight","notify","info","onScroll","initialInfo","createParallax","speed","easing","rootMargin","observer","update","elementCenter","viewportCenter","normalizedDistance","entries","entry","createScrollTrigger","start","end","startOffset","endOffset","onEnter","onLeave","onProgress","once","scrub","isActive","hasEntered","getPosition","pos","startPos","endPos","triggerStart","triggerEnd","startProgress","endProgress","rawProgress","wasActive","createScrollLinkedValue","scrollProgress","inputRange","outputRange","shouldClamp","firstOutput","isColorOutput","firstInput","lastInput","segmentIndex","curr","next","segmentStart","segmentEnd","segmentProgress","startValue","endValue","scrollEasings","timelineIdCounter","createTimeline","defaults","autoplay","repeat","yoyo","repeatDelay","onStart","onRepeat","segments","labels","callbacks","pauses","currentTime","totalDuration","isReversed","repeatCount","lastFrameTime","hasStarted","insertTime","parsePosition","lastSegment","labelMatch","labelName","labelTime","offsetValue","resolveTarget","extractNumericProps","props","applyPropsToElement","transforms","cssProps","prop","val","getCurrentElementValues","current","computed","tick","timestamp","deltaTime","callbacksAtTime","pauseCallback","segment","shouldBeActive","timeline","endTime","numericProps","currentValues","originalOnStart","targetValues","fromProps","toProps","fromNumeric","toNumeric","label","time","tween","allTo","targets","tl","parsePath","d","commands","regex","matches","matchItem","typeChar","valuesStr","type","toAbsolute","cmd","absValues","currentY","samplePath","samples","points","svgNS","svg","path","step","point","interpolatePoint","pointsToPath","firstPoint","createMorph","initialPath","currentPath","fromPoints","toPoints","currentPoints","initialCommands","progressSpring","targetCommands","targetPoints","createMorphSequence","paths","firstPath","morph","targetIndex","targetPath","shapes","cx","cy","width","height","rx","sides","angle","outerR","innerR","size","hw","hh","measureElement","styles","applyTransform","scaleX","scaleY","compensatedRadius","resetTransform","createLayoutGroup","defaultSpring","onAnimationStart","onAnimationComplete","crossfade","transition","elements","previousMeasurements","register","existing","measurement","unregister","group","animateElement","previousMeasurement","currentMeasurement","groupIdCounter","createSharedLayoutContext","groups","groupId","createAutoLayout","root","attribute","debounceTime","layoutConfig","resizeObserver","debounceTimer","scanAndRegister","el","debouncedUpdate","mutations","shouldUpdate","mutation","node","seededRandom","seed","gridDistance","columns","rows","col","row","originCol","originRow","linearStagger","delays","reverseStagger","centerStagger","center","distanceFromCenter","maxDistance","edgeStagger","maxDelay","gridStagger","distance","waveStagger","frequency","amplitude","waveOffset","spiralStagger","startFrom","spiral","visited","idx","originalIndex","spiralPosition","randomStagger","minMultiplier","maxMultiplier","random","multiplier","customStagger","fn","applyStagger","opt","staggerPresets","MotionValue","initialValue","newValue","createMotionValue","transformValue","transform","derived","normalized","createPathAnimation","autoPlay","totalLength","waitForRest","check","getPathLength","preparePathForAnimation","initialProgress","length","getPointAtProgress","createFlip","deltaWidth","deltaHeight","cancelled","originalTransform","originalTransformOrigin","invertedT","cleanup","flip","mutate","flipBatch","firstStates"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * Spring configuration interface\n */\nexport interface SpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Initial velocity */\n  velocity?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Callback called on each update */\n  onUpdate?: (value: number) => void\n  /** Callback called when animation starts */\n  onStart?: () => void\n  /** Callback called when animation reaches target */\n  onComplete?: () => void\n  /** Callback called when spring is at rest */\n  onRest?: () => void\n}\n\n/**\n * Default spring configuration\n */\nexport const defaultConfig: SpringConfig = {\n  stiffness: 100,\n  damping: 10,\n  mass: 1,\n  velocity: 0,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Spring presets interface\n */\nexport interface SpringPresets {\n  /** Default spring: { stiffness: 100, damping: 10 } */\n  default: SpringConfig\n  /** Gentle spring: { stiffness: 120, damping: 14 } */\n  gentle: SpringConfig\n  /** Wobbly spring: { stiffness: 180, damping: 12 } */\n  wobbly: SpringConfig\n  /** Stiff spring: { stiffness: 210, damping: 20 } */\n  stiff: SpringConfig\n  /** Slow spring: { stiffness: 280, damping: 60 } */\n  slow: SpringConfig\n  /** Molasses spring: { stiffness: 280, damping: 120 } */\n  molasses: SpringConfig\n  /** Bouncy spring: { stiffness: 200, damping: 8 } */\n  bounce: SpringConfig\n  /** No wobble spring: { stiffness: 170, damping: 26 } */\n  noWobble: SpringConfig\n}\n\n/**\n * Built-in spring presets\n */\nexport const springPresets: SpringPresets = {\n  default: { stiffness: 100, damping: 10 },\n  gentle: { stiffness: 120, damping: 14 },\n  wobbly: { stiffness: 180, damping: 12 },\n  stiff: { stiffness: 210, damping: 20 },\n  slow: { stiffness: 280, damping: 60 },\n  molasses: { stiffness: 280, damping: 120 },\n  bounce: { stiffness: 200, damping: 8 },\n  noWobble: { stiffness: 170, damping: 26 },\n}\n\n/**\n * Create a spring config that settles in approximately the given duration\n * @param ms - Approximate settling time in milliseconds\n * @returns Spring config\n */\nexport function configFromDuration(ms: number): SpringConfig {\n  if (ms < 300) {\n    return { stiffness: 170, damping: 26 }\n  }\n  if (ms < 500) {\n    return { stiffness: 100, damping: 20 }\n  }\n  return { stiffness: 80, damping: 15 }\n}\n\n/**\n * Create a spring config with specific bounce amount\n * @param bounce - Bounce factor (0 = no bounce, 0.5 = 50% overshoot)\n * @returns Spring config\n */\nexport function configFromBounce(bounce: number): SpringConfig {\n  if (bounce <= 0) {\n    return { stiffness: 170, damping: 26 }\n  }\n  if (bounce <= 0.25) {\n    return { stiffness: 200, damping: 12 }\n  }\n  return { stiffness: 200, damping: 8 }\n}\n","import type { SpringConfig } from './config.js'\n\n/**\n * Result of a spring physics simulation step\n */\nexport interface SimulationResult {\n  /** New position */\n  position: number\n  /** New velocity */\n  velocity: number\n  /** Whether the spring is at rest */\n  isRest: boolean\n}\n\n/**\n * Simulate one step of spring physics using semi-implicit Euler integration\n *\n * The spring follows the damped harmonic oscillator equation:\n * F = -k * x - c * v\n * a = F / m\n *\n * Where:\n * - k = stiffness (spring constant)\n * - c = damping coefficient\n * - m = mass\n * - x = displacement from rest (target - position)\n * - v = velocity\n * - a = acceleration\n * - dt = time step (1/60 for 60fps animation)\n *\n * @param position - Current position\n * @param velocity - Current velocity\n * @param target - Target position (rest position)\n * @param config - Spring configuration\n * @returns Simulation result with new position, velocity, and rest state\n */\nexport function simulateSpring(\n  position: number,\n  velocity: number,\n  target: number,\n  config: SpringConfig\n): SimulationResult {\n  const {\n    stiffness = 100,\n    damping = 10,\n    mass = 1,\n    restSpeed = 0.01,\n    restDelta = 0.01,\n  } = config\n\n  // Calculate displacement from target (cached for reuse)\n  const displacement = target - position\n  const absDisplacement = Math.abs(displacement)\n  const absVelocity = Math.abs(velocity)\n\n  // Early exit optimization: if already at rest, skip expensive calculations\n  // This significantly improves performance for springs that have settled\n  if (absDisplacement <= restDelta && absVelocity <= restSpeed) {\n    return {\n      position: target, // Snap to exact target\n      velocity: 0,\n      isRest: true,\n    }\n  }\n\n  // Time step for 60fps animation\n  // This ensures the spring simulation is stable with typical stiffness values\n  const dt = 1 / 60\n\n  // Calculate spring force (Hooke's law: F = -k * x)\n  const springForce = stiffness * displacement\n\n  // Calculate damping force (opposes velocity: F = -c * v)\n  // Optimization: skip multiplication if velocity is negligible\n  const dampingForce = absVelocity > 0.0001 ? damping * velocity : 0\n\n  // Calculate total force and acceleration (Newton's second law: a = F/m)\n  const acceleration = (springForce - dampingForce) / mass\n\n  // Semi-implicit Euler integration\n  // Update velocity first, then use new velocity to update position\n  // This provides better energy conservation than standard Euler\n  const newVelocity = velocity + acceleration * dt\n  const newPosition = position + newVelocity * dt\n\n  // Check if spring is at rest\n  // Spring is at rest when:\n  // 1. Close to target position (displacement < restDelta)\n  // 2. Moving slowly (velocity < restSpeed)\n  const isRest =\n    absDisplacement <= restDelta &&\n    Math.abs(newVelocity) <= restSpeed\n\n  return {\n    position: newPosition,\n    velocity: newVelocity,\n    isRest,\n  }\n}\n\n/**\n * Calculate the period of oscillation for a spring\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Period in seconds\n */\nexport function calculatePeriod(stiffness: number, mass: number): number {\n  return 2 * Math.PI * Math.sqrt(mass / stiffness)\n}\n\n/**\n * Calculate the damping ratio for a spring\n * @param damping - Damping coefficient\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Damping ratio\n */\nexport function calculateDampingRatio(\n  damping: number,\n  stiffness: number,\n  mass: number\n): number {\n  return damping / (2 * Math.sqrt(stiffness * mass))\n}\n\n/**\n * Check if a spring is underdamped (will oscillate)\n * @param config - Spring configuration\n * @returns True if underdamped\n */\nexport function isUnderdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio < 1\n}\n\n/**\n * Check if a spring is critically damped (fastest return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if critically damped\n */\nexport function isCriticallyDamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return Math.abs(ratio - 1) < 0.001\n}\n\n/**\n * Check if a spring is overdamped (slow return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if overdamped\n */\nexport function isOverdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio > 1\n}\n","/**\n * Animation state enum\n */\nexport enum AnimationState {\n  Idle = 'idle',\n  Running = 'running',\n  Paused = 'paused',\n  Complete = 'complete',\n}\n\n/**\n * Interface for objects that can be animated\n */\nexport interface Animatable {\n  /**\n   * Update the animation\n   * @param now - Current timestamp from performance.now()\n   */\n  update(now: number): void\n\n  /**\n   * Check if the animation is complete\n   */\n  isComplete(): boolean\n}\n\n/**\n * Callback type for cleanup notifications\n */\nexport type CleanupCallback = (id: number) => void\n\n/**\n * Maximum allowed delta time (ms) to prevent physics explosions after tab suspension\n * If more time has passed, we clamp to this value for stable simulation\n */\nconst MAX_DELTA_TIME = 64 // ~15fps minimum, prevents huge jumps\n\n/**\n * Global animation loop manager\n * Uses requestAnimationFrame to drive all animations\n * Features:\n * - WeakRef-based animation tracking for memory safety\n * - FinalizationRegistry for cleanup callbacks\n * - Frame-drop resilience with delta time clamping\n * - Single-pass update + cleanup for O(n) performance\n * - Frame event listeners for external monitoring\n */\nclass AnimationLoop {\n  private animations = new Set<WeakRef<Animatable>>()\n  private animationMap = new WeakMap<Animatable, WeakRef<Animatable>>()\n  private rafId: number | null = null\n  private isRunning = false\n  private lastTime: number = 0\n  private nextId = 1\n  private idMap = new WeakMap<Animatable, number>()\n  private frameListeners = new Set<(deltaTime: number) => void>()\n\n  // FinalizationRegistry for automatic cleanup notifications\n  private registry = new FinalizationRegistry<number>((id) => {\n    this.cleanupCallbacks.forEach((cb) => cb(id))\n  })\n  private cleanupCallbacks = new Set<CleanupCallback>()\n\n  /**\n   * Add an animation to the loop\n   * Uses WeakRef to prevent memory leaks if animation is garbage collected\n   * @returns Unique ID for this animation\n   */\n  add(animation: Animatable): number {\n    // Check if already added\n    const existingId = this.idMap.get(animation)\n    if (existingId !== undefined) return existingId\n\n    const id = this.nextId++\n    const ref = new WeakRef(animation)\n    this.animations.add(ref)\n    this.animationMap.set(animation, ref)\n    this.idMap.set(animation, id)\n\n    // Register for finalization callback\n    this.registry.register(animation, id)\n\n    this.start()\n    return id\n  }\n\n  /**\n   * Remove an animation from the loop\n   */\n  remove(animation: Animatable): void {\n    const ref = this.animationMap.get(animation)\n    if (ref) {\n      this.animations.delete(ref)\n      this.animationMap.delete(animation)\n      this.idMap.delete(animation)\n      // Note: unregister not strictly needed as registry uses weak refs\n    }\n    if (this.animations.size === 0) {\n      this.stop()\n    }\n  }\n\n  /**\n   * Register a callback for when animations are garbage collected\n   * Useful for debugging memory leaks\n   */\n  onCleanup(callback: CleanupCallback): () => void {\n    this.cleanupCallbacks.add(callback)\n    return () => this.cleanupCallbacks.delete(callback)\n  }\n\n  /**\n   * Register a callback for each frame\n   * Receives delta time in milliseconds\n   */\n  onFrame(callback: (deltaTime: number) => void): () => void {\n    this.frameListeners.add(callback)\n    return () => this.frameListeners.delete(callback)\n  }\n\n  /**\n   * Start the animation loop\n   */\n  private start(): void {\n    if (this.isRunning) return\n    this.isRunning = true\n    this.lastTime = performance.now()\n    this.tick()\n  }\n\n  /**\n   * Stop the animation loop\n   */\n  private stop(): void {\n    this.isRunning = false\n    if (this.rafId !== null) {\n      cancelAnimationFrame(this.rafId)\n      this.rafId = null\n    }\n  }\n\n  /**\n   * Single animation frame - optimized single-pass update + cleanup\n   * Features:\n   * - WeakRef dereferencing with automatic cleanup of dead refs\n   * - Delta time clamping for frame-drop resilience\n   * - O(n) single-pass performance\n   * - Frame listener notifications\n   */\n  private tick = (): void => {\n    const now = performance.now()\n\n    // Calculate and clamp delta time to prevent physics explosions\n    // This handles tab suspension, debugger pauses, etc.\n    const rawDelta = now - this.lastTime\n    const clampedDelta = Math.min(rawDelta, MAX_DELTA_TIME)\n    this.lastTime = now\n\n    // Notify frame listeners\n    for (const listener of this.frameListeners) {\n      listener(clampedDelta)\n    }\n\n    // Single pass: update all animations and collect refs to remove\n    const toRemove: WeakRef<Animatable>[] = []\n\n    for (const ref of this.animations) {\n      const animation = ref.deref()\n\n      // If WeakRef is dead (animation was garbage collected), mark for removal\n      if (!animation) {\n        toRemove.push(ref)\n        continue\n      }\n\n      animation.update(now)\n\n      if (animation.isComplete()) {\n        toRemove.push(ref)\n        this.animationMap.delete(animation)\n        this.idMap.delete(animation)\n      }\n    }\n\n    // Remove dead/completed refs\n    for (let i = 0; i < toRemove.length; i++) {\n      this.animations.delete(toRemove[i]!)\n    }\n\n    // Continue or stop loop\n    if (this.animations.size > 0) {\n      this.rafId = requestAnimationFrame(this.tick)\n    } else {\n      this.stop()\n    }\n  }\n\n  /**\n   * Get the number of active animations (including potentially dead refs)\n   */\n  get size(): number {\n    return this.animations.size\n  }\n\n  /**\n   * Get count of actually alive animations (for debugging/testing)\n   */\n  getAliveCount(): number {\n    let count = 0\n    for (const ref of this.animations) {\n      if (ref.deref()) count++\n    }\n    return count\n  }\n\n  /**\n   * Get current frame rate (based on last delta)\n   */\n  getFPS(): number {\n    const delta = performance.now() - this.lastTime\n    return delta > 0 ? Math.round(1000 / delta) : 60\n  }\n}\n\n/**\n * Global animation loop instance\n */\nexport const globalLoop = new AnimationLoop()\n","/**\n * Clamp a value between a minimum and maximum\n * @param value - The value to clamp\n * @param min - The minimum allowed value\n * @param max - The maximum allowed value\n * @returns The clamped value\n */\nexport function clamp(value: number, min: number, max: number): number {\n  // Handle inverted min/max (swap them)\n  const actualMin = Math.min(min, max)\n  const actualMax = Math.max(min, max)\n  return Math.max(actualMin, Math.min(actualMax, value))\n}\n\n/**\n * Linear interpolation between two values\n * @param a - The start value\n * @param b - The end value\n * @param t - The interpolation factor (0-1)\n * @returns The interpolated value\n */\nexport function lerp(a: number, b: number, t: number): number {\n  return a + (b - a) * t\n}\n\n/**\n * Map a value from one range to another\n * @param value - The value to map\n * @param inMin - The minimum of the input range\n * @param inMax - The maximum of the input range\n * @param outMin - The minimum of the output range\n * @param outMax - The maximum of the output range\n * @returns The mapped value\n */\nexport function mapRange(\n  value: number,\n  inMin: number,\n  inMax: number,\n  outMin: number,\n  outMax: number\n): number {\n  return ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin\n}\n\n/**\n * Convert degrees to radians\n * @param degrees - The angle in degrees\n * @returns The angle in radians\n */\nexport function degToRad(degrees: number): number {\n  return (degrees * Math.PI) / 180\n}\n\n/**\n * Convert radians to degrees\n * @param radians - The angle in radians\n * @returns The angle in degrees\n */\nexport function radToDeg(radians: number): number {\n  return (radians * 180) / Math.PI\n}\n","/**\n * Development mode warnings for SpringKit\n * These warnings help developers avoid common configuration mistakes\n */\n\nconst isDev = typeof process !== 'undefined' && process.env?.NODE_ENV !== 'production'\nconst warnedMessages = new Set<string>()\n\n/**\n * Log a warning message once (won't repeat the same message)\n */\nfunction warnOnce(message: string): void {\n  if (!isDev || warnedMessages.has(message)) return\n  warnedMessages.add(message)\n  console.warn(`[SpringKit] ${message}`)\n}\n\n/**\n * Validate spring configuration and warn about potential issues\n */\nexport function validateSpringConfig(config: {\n  stiffness?: number\n  damping?: number\n  mass?: number\n}): void {\n  if (!isDev) return\n\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n\n  // Check for extreme stiffness with low damping (unstable oscillation)\n  if (stiffness > 400 && damping < 10) {\n    warnOnce(\n      `High stiffness (${stiffness}) with low damping (${damping}) may cause excessive oscillation. ` +\n      `Consider increasing damping to at least ${Math.round(stiffness / 20)} for smoother animation.`\n    )\n  }\n\n  // Check for very low stiffness (sluggish animation)\n  if (stiffness < 20) {\n    warnOnce(\n      `Very low stiffness (${stiffness}) will result in sluggish animation. ` +\n      `Consider using stiffness >= 50 for more responsive feel.`\n    )\n  }\n\n  // Check for very high damping (overdamped, no spring feel)\n  if (damping > stiffness) {\n    warnOnce(\n      `Damping (${damping}) is higher than stiffness (${stiffness}), ` +\n      `which removes the \"springy\" feel. Consider reducing damping for bouncier animation.`\n    )\n  }\n\n  // Check for zero or negative mass\n  if (mass <= 0) {\n    warnOnce(\n      `Mass must be positive. Got ${mass}. Using default mass of 1.`\n    )\n  }\n\n  // Check for very high mass (slow animation)\n  if (mass > 10) {\n    warnOnce(\n      `High mass (${mass}) will make the animation very slow. ` +\n      `Consider mass between 0.5 and 5 for typical use cases.`\n    )\n  }\n}\n\n/**\n * Validate drag configuration\n */\nexport function validateDragConfig(config: {\n  rubberBandFactor?: number\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n}): void {\n  if (!isDev) return\n\n  const { rubberBandFactor, bounds } = config\n\n  // Check rubber band factor range\n  if (rubberBandFactor !== undefined && (rubberBandFactor < 0 || rubberBandFactor > 1)) {\n    warnOnce(\n      `rubberBandFactor should be between 0 and 1. Got ${rubberBandFactor}. ` +\n      `Values outside this range may cause unexpected behavior.`\n    )\n  }\n\n  // Check for inverted bounds\n  if (bounds) {\n    if (bounds.left !== undefined && bounds.right !== undefined && bounds.left > bounds.right) {\n      warnOnce(\n        `Drag bounds are inverted: left (${bounds.left}) > right (${bounds.right}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n    if (bounds.top !== undefined && bounds.bottom !== undefined && bounds.top > bounds.bottom) {\n      warnOnce(\n        `Drag bounds are inverted: top (${bounds.top}) > bottom (${bounds.bottom}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n  }\n}\n\n/**\n * Validate decay configuration\n */\nexport function validateDecayConfig(config: {\n  velocity: number\n  deceleration?: number\n}): void {\n  if (!isDev) return\n\n  const { velocity, deceleration = 0.998 } = config\n\n  // Check for zero velocity\n  if (velocity === 0) {\n    warnOnce(\n      `Decay animation started with zero velocity. ` +\n      `The animation will complete immediately.`\n    )\n  }\n\n  // Check deceleration range\n  if (deceleration <= 0 || deceleration >= 1) {\n    warnOnce(\n      `Deceleration should be between 0 and 1 (exclusive). Got ${deceleration}. ` +\n      `Typical values are 0.99-0.999.`\n    )\n  }\n}\n\n/**\n * Clear warned messages (useful for testing)\n */\nexport function clearWarnings(): void {\n  warnedMessages.clear()\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { simulateSpring } from './physics.js'\nimport { globalLoop, type Animatable, AnimationState } from '../animation/loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateSpringConfig } from '../utils/warnings.js'\n\n/**\n * Spring animation control interface\n */\nexport interface SpringAnimation {\n  /** Start the animation */\n  start(): SpringAnimation\n  /** Stop the animation immediately */\n  stop(): void\n  /** Pause the animation */\n  pause(): void\n  /** Resume the animation */\n  resume(): void\n  /** Reverse the animation direction */\n  reverse(): void\n  /** Update the target value */\n  set(to: number): void\n  /** Update target while preserving current velocity (for smooth interruptions) */\n  setWithVelocity(to: number, velocity?: number): void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Check if paused */\n  isPaused(): boolean\n  /** Check if complete */\n  isComplete(): boolean\n  /** Get current value */\n  getValue(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring animation implementation\n */\nclass SpringAnimationImpl implements SpringAnimation, Animatable {\n  private position: number\n  private velocity: number\n  private target: number\n  private config: SpringConfig & Required<Pick<SpringConfig, 'stiffness' | 'damping' | 'mass' | 'restSpeed' | 'restDelta'>>\n  private state: AnimationState = AnimationState.Idle\n  private resolveComplete: (() => void) | null = null\n  private from: number\n  private to: number\n  private clampedFrom: number\n  private clampedTo: number\n\n  finished: Promise<void>\n\n  constructor(\n    from: number,\n    to: number,\n    config: SpringConfig = {}\n  ) {\n    // Validate config in development mode\n    validateSpringConfig(config)\n\n    this.from = from\n    this.to = to\n    this.clampedFrom = from\n    this.clampedTo = to\n    this.position = from\n    this.velocity = config.velocity ?? 0\n    this.target = to\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      stiffness: config.stiffness ?? defaultConfig.stiffness!,\n      damping: config.damping ?? defaultConfig.damping!,\n      mass: config.mass ?? defaultConfig.mass!,\n      restSpeed: config.restSpeed ?? defaultConfig.restSpeed!,\n      restDelta: config.restDelta ?? defaultConfig.restDelta!,\n    }\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): SpringAnimation {\n    if (this.state === AnimationState.Running) return this\n\n    this.state = AnimationState.Running\n    this.config.onStart?.()\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  pause(): void {\n    if (this.state === AnimationState.Running) {\n      this.state = AnimationState.Paused\n      globalLoop.remove(this)\n    }\n  }\n\n  resume(): void {\n    if (this.state === AnimationState.Paused) {\n      this.state = AnimationState.Running\n      globalLoop.add(this)\n    }\n  }\n\n  reverse(): void {\n    const temp = this.from\n    this.from = this.to\n    this.to = temp\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.target = this.to\n  }\n\n  set(to: number): void {\n    this.to = to\n    this.clampedTo = to\n    this.target = to\n  }\n\n  setWithVelocity(to: number, velocity?: number): void {\n    // Update from to current position for smooth continuation\n    this.from = this.position\n    this.clampedFrom = this.position\n    this.to = to\n    this.clampedTo = to\n    this.target = to\n\n    // Use provided velocity or preserve current velocity\n    if (velocity !== undefined) {\n      this.velocity = velocity\n    }\n    // If not running, start the animation\n    if (this.state !== AnimationState.Running) {\n      this.start()\n    }\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    const result = simulateSpring(\n      this.position,\n      this.velocity,\n      this.target,\n      this.config\n    )\n\n    this.position = result.position\n    this.velocity = result.velocity\n\n    // Handle clamping\n    if (this.config.clamp) {\n      const min = Math.min(this.clampedFrom, this.clampedTo)\n      const max = Math.max(this.clampedFrom, this.clampedTo)\n      this.position = clamp(this.position, min, max)\n    }\n\n    // Emit update\n    this.config.onUpdate?.(this.position)\n\n    // Check rest state\n    if (result.isRest) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.position = this.target // Ensure we end exactly at target\n      this.config.onUpdate?.(this.position)\n      this.config.onComplete?.()\n      this.config.onRest?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.state === AnimationState.Running\n  }\n\n  isPaused(): boolean {\n    return this.state === AnimationState.Paused\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  getValue(): number {\n    return this.position\n  }\n\n  getVelocity(): number {\n    return this.velocity\n  }\n\n  destroy(): void {\n    this.stop()\n    this.config.onUpdate = undefined\n    this.config.onStart = undefined\n    this.config.onComplete = undefined\n    this.config.onRest = undefined\n  }\n}\n\n/**\n * Create a spring animation\n *\n * @param from - Starting value\n * @param to - Target value\n * @param config - Spring configuration\n * @returns Spring animation controller\n *\n * @example\n * ```ts\n * const anim = spring(0, 100, {\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function spring(\n  from: number,\n  to: number,\n  config?: SpringConfig\n): SpringAnimation {\n  return new SpringAnimationImpl(from, to, config)\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { spring, type SpringAnimation } from './spring.js'\n\n/**\n * Spring value interface\n */\nexport interface SpringValue {\n  /** Get current value */\n  get(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Animate to a new value */\n  set(to: number, config?: Partial<SpringConfig>): void\n  /** Set value immediately without animation */\n  jump(to: number): void\n  /** Stop current animation at current position */\n  stop(): void\n  /** Update spring configuration */\n  setConfig(config: Partial<SpringConfig>): void\n  /** Subscribe to value changes */\n  subscribe(callback: (value: number) => void): () => void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Promise that resolves when current animation completes */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring value implementation\n */\nclass SpringValueImpl implements SpringValue {\n  private value: number\n  private config: SpringConfig\n  private currentAnimation: SpringAnimation | null = null\n  private subscribers = new Set<(value: number) => void>()\n  private resolveComplete: (() => void) | null = null\n  private finishedPromise: Promise<void>\n\n  constructor(initial: number, config: SpringConfig = {}) {\n    this.value = initial\n    this.config = { ...defaultConfig, ...config }\n\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  get(): number {\n    return this.value\n  }\n\n  getVelocity(): number {\n    return this.currentAnimation?.getVelocity() ?? 0\n  }\n\n  set(to: number, config: Partial<SpringConfig> = {}): void {\n    // Cancel existing animation\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n\n    // Create new promise for this animation\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n\n    // Create new animation\n    const mergedConfig = { ...this.config, ...config }\n    const originalOnUpdate = mergedConfig.onUpdate\n    const originalOnComplete = mergedConfig.onComplete\n\n    this.currentAnimation = spring(this.value, to, {\n      ...mergedConfig,\n      onUpdate: (value) => {\n        this.value = value\n        this.notify()\n        // Also call original onUpdate if provided\n        originalOnUpdate?.(value)\n      },\n      onComplete: () => {\n        originalOnComplete?.()\n        if (this.resolveComplete) {\n          this.resolveComplete()\n        }\n      },\n    })\n\n    this.currentAnimation.start()\n  }\n\n  jump(to: number): void {\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n    this.value = to\n    this.notify()\n  }\n\n  stop(): void {\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n    if (this.resolveComplete) {\n      this.resolveComplete()\n    }\n  }\n\n  setConfig(config: Partial<SpringConfig>): void {\n    this.config = { ...this.config, ...config }\n  }\n\n  subscribe(callback: (value: number) => void): () => void {\n    this.subscribers.add(callback)\n\n    // Immediately call with current value\n    callback(this.value)\n\n    return () => {\n      this.subscribers.delete(callback)\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.currentAnimation?.isAnimating() ?? false\n  }\n\n  get finished(): Promise<void> {\n    return this.finishedPromise\n  }\n\n  private notify(): void {\n    for (const subscriber of this.subscribers) {\n      subscriber(this.value)\n    }\n  }\n\n  destroy(): void {\n    this.currentAnimation?.destroy()\n    this.currentAnimation = null\n    this.subscribers.clear()\n  }\n}\n\n/**\n * Create a spring value\n *\n * @param initial - Initial value\n * @param config - Spring configuration\n * @returns Spring value controller\n *\n * @example\n * ```ts\n * const x = createSpringValue(0, { stiffness: 100, damping: 10 })\n *\n * x.subscribe((value) => {\n *   element.style.transform = `translateX(${value}px)`\n * })\n *\n * x.set(100) // Animates to 100\n * x.jump(0)  // Jumps to 0 immediately\n * ```\n */\nexport function createSpringValue(\n  initial: number,\n  config?: SpringConfig\n): SpringValue {\n  return new SpringValueImpl(initial, config)\n}\n\n// Re-export for type usage\nexport { SpringValueImpl as SpringValueClass }\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { createSpringValue, type SpringValue } from './spring-value.js'\n\n/**\n * Spring group interface\n */\nexport interface SpringGroup<T extends Record<string, number>> {\n  /** Get all current values */\n  get(): T\n  /** Get a single value by key */\n  getValue(key: keyof T): number\n  /** Animate to new values (partial update) */\n  set(values: Partial<T>, config?: Partial<SpringConfig>): void\n  /** Set values immediately without animation */\n  jump(values: Partial<T>): void\n  /** Subscribe to value changes */\n  subscribe(callback: (values: T) => void): () => void\n  /** Check if any spring is animating */\n  isAnimating(): boolean\n  /** Promise that resolves when all animations complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring group implementation\n */\nclass SpringGroupImpl<T extends Record<string, number>> implements SpringGroup<T> {\n  private values: Map<keyof T, SpringValue>\n  private config: SpringConfig\n  private subscribers = new Set<(values: T) => void>()\n  private resolveComplete: (() => void) | null = null\n  private finishedPromise: Promise<void>\n\n  constructor(initialValues: T, config: SpringConfig = {}) {\n    this.config = { ...defaultConfig, ...config }\n\n    // Create SpringValue for each key\n    this.values = new Map()\n    for (const [key, value] of Object.entries(initialValues)) {\n      const springValue = createSpringValue(value, this.config)\n      springValue.subscribe(() => this.notify())\n      this.values.set(key as keyof T, springValue)\n    }\n\n    this.finishedPromise = Promise.resolve()\n\n    // Initialize promise handler\n    this.resetPromise()\n  }\n\n  private resetPromise(): void {\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  get(): T {\n    const result = {} as T\n    for (const [key, springValue] of this.values) {\n      (result as Record<string, number>)[key as string] = springValue.get()\n    }\n    return result\n  }\n\n  getValue(key: keyof T): number {\n    return this.values.get(key)?.get() ?? 0\n  }\n\n  set(values: Partial<T>, config: Partial<SpringConfig> = {}): void {\n    // Reset promise for new batch of animations\n    this.resetPromise()\n\n    const promises: Promise<void>[] = []\n\n    for (const [key, value] of Object.entries(values)) {\n      const springValue = this.values.get(key as keyof T)\n      if (springValue) {\n        springValue.set(value, config)\n        promises.push(springValue.finished)\n      }\n    }\n\n    // Resolve when all animations complete\n    Promise.all(promises).then(() => {\n      if (this.resolveComplete) {\n        this.resolveComplete()\n      }\n    })\n  }\n\n  jump(values: Partial<T>): void {\n    for (const [key, value] of Object.entries(values)) {\n      const springValue = this.values.get(key as keyof T)\n      if (springValue) {\n        springValue.jump(value)\n      }\n    }\n    // Note: notify() is already called by the spring subscriptions, so we don't call it again\n  }\n\n  subscribe(callback: (values: T) => void): () => void {\n    this.subscribers.add(callback)\n    callback(this.get())\n    return () => this.subscribers.delete(callback)\n  }\n\n  isAnimating(): boolean {\n    for (const springValue of this.values.values()) {\n      if (springValue.isAnimating()) return true\n    }\n    return false\n  }\n\n  get finished(): Promise<void> {\n    return this.finishedPromise\n  }\n\n  private notify(): void {\n    const values = this.get()\n    for (const subscriber of this.subscribers) {\n      subscriber(values)\n    }\n  }\n\n  destroy(): void {\n    for (const springValue of this.values.values()) {\n      springValue.destroy()\n    }\n    this.subscribers.clear()\n  }\n}\n\n/**\n * Create a spring group for animating multiple values together\n *\n * @param initialValues - Initial values object\n * @param config - Spring configuration\n * @returns Spring group controller\n *\n * @example\n * ```ts\n * const group = createSpringGroup(\n *   { x: 0, y: 0, scale: 1 },\n *   { stiffness: 100, damping: 10 }\n * )\n *\n * group.subscribe((values) => {\n *   element.style.transform = `\n *     translate(${values.x}px, ${values.y}px)\n *     scale(${values.scale})\n *   `\n * })\n *\n * group.set({ x: 100, scale: 1.5 })\n * ```\n */\nexport function createSpringGroup<T extends Record<string, number>>(\n  initialValues: T,\n  config?: SpringConfig\n): SpringGroup<T> {\n  return new SpringGroupImpl(initialValues, config)\n}\n\n// Re-export for type usage\nexport { SpringGroupImpl as SpringGroupClass }\n","import type { SpringAnimation } from '../core/spring.js'\n\n/**\n * Stagger options interface\n */\nexport interface StaggerOptions {\n  /** Delay between animations (ms) or function returning delay */\n  delay?: number | ((index: number) => number)\n  /** Where to start staggering from */\n  from?: 'first' | 'last' | 'center' | number\n}\n\n/**\n * Run animations one after another (sequentially)\n *\n * @param animations - Array of functions that create animations\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * await sequence([\n *   () => spring(0, 100, { onUpdate: updateOpacity }).start(),\n *   () => spring(0, 200, { onUpdate: updateX }).start(),\n *   () => spring(0, 50, { onUpdate: updateY }).start(),\n * ])\n *\n * console.log('All animations complete!')\n * ```\n */\nexport async function sequence(\n  animations: Array<() => SpringAnimation>\n): Promise<void> {\n  for (const createAnimation of animations) {\n    const anim = createAnimation()\n    await anim.finished\n  }\n}\n\n/**\n * Run animations simultaneously (in parallel)\n *\n * @param animations - Array of functions that create animations\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * await parallel([\n *   () => spring(0, 100, { onUpdate: updateOpacity }).start(),\n *   () => spring(0, 200, { onUpdate: updateX }).start(),\n *   () => spring(1, 2, { onUpdate: updateScale }).start(),\n * ])\n *\n * console.log('All animations complete!')\n * ```\n */\nexport async function parallel(\n  animations: Array<() => SpringAnimation>\n): Promise<void> {\n  const promises = animations.map((createAnimation) => {\n    const anim = createAnimation()\n    return anim.finished\n  })\n  await Promise.all(promises)\n}\n\n/**\n * Run animations with staggered delays\n *\n * @param items - Array of items to animate\n * @param animate - Function that creates an animation for each item\n * @param options - Stagger options\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * const elements = document.querySelectorAll('.item')\n *\n * await stagger(\n *   elements,\n *   (element, index) => {\n *     return spring(0, 1, {\n *       onUpdate: (value) => {\n *         element.style.opacity = String(value)\n *       },\n *     }).start()\n *   },\n *   { delay: 50 }\n * )\n * ```\n */\nexport async function stagger<T>(\n  items: T[],\n  animate: (item: T, index: number) => SpringAnimation,\n  options: StaggerOptions = {}\n): Promise<void> {\n  const { delay = 0, from = 'first' } = options\n\n  // Calculate start index based on 'from' option\n  let startIndex = 0\n  if (from === 'last') startIndex = items.length - 1\n  else if (from === 'center') startIndex = Math.floor(items.length / 2)\n  else if (typeof from === 'number') startIndex = from\n\n  // Build index order from start point outward\n  const indices: number[] = []\n  const used = new Set<number>()\n\n  indices.push(startIndex)\n  used.add(startIndex)\n\n  for (let offset = 1; offset < items.length; offset++) {\n    const left = startIndex - offset\n    const right = startIndex + offset\n\n    // Add right first if it exists\n    if (right < items.length && !used.has(right)) {\n      indices.push(right)\n      used.add(right)\n    }\n\n    // Then add left if it exists\n    if (left >= 0 && !used.has(left)) {\n      indices.push(left)\n      used.add(left)\n    }\n  }\n\n  // All indices are already added by the main loop above\n  // No need for defensive fallback as the logic is complete\n\n  // Start animations with delay\n  const getDelay = typeof delay === 'function' ? delay : (_i: number) => delay\n  const animations: SpringAnimation[] = []\n\n  for (let i = 0; i < indices.length; i++) {\n    const index = indices[i]!\n    const anim = animate(items[index]!, index)\n    animations.push(anim)\n\n    const delayMs = getDelay(i)\n\n    if (delayMs > 0) {\n      setTimeout(() => {\n        anim.start()\n      }, delayMs)\n    } else {\n      anim.start()\n    }\n  }\n\n  await Promise.all(animations.map((a) => a.finished))\n}\n","import type { SpringConfig } from '../core/config.js'\nimport { defaultConfig } from '../core/config.js'\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\n/**\n * Trail configuration interface\n */\nexport interface TrailConfig extends SpringConfig {\n  /** Frames delay between items following each other */\n  followDelay?: number\n}\n\n/**\n * Trail interface\n */\nexport interface Trail {\n  /** Set the leader value (followers will follow with delay) */\n  set(value: number): void\n  /** Set all values immediately without animation */\n  jump(value: number): void\n  /** Get all current values */\n  getValues(): number[]\n  /** Subscribe to value changes */\n  subscribe(callback: (values: number[]) => void): () => void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Trail implementation\n * Creates a chain of springs where each spring follows the previous one\n */\nclass TrailImpl implements Trail {\n  private springs: SpringValue[]\n  private leader: SpringValue\n  private followDelay: number\n  private subscribers = new Set<(values: number[]) => void>()\n  private frameCount: number = 0\n  private pendingUpdates: Map<number, number> = new Map()\n\n  constructor(count: number, config: TrailConfig = {}) {\n    const { followDelay = 2, ...springConfig } = config\n\n    this.followDelay = followDelay\n\n    // Create leader spring\n    this.leader = createSpringValue(0, springConfig)\n\n    // Create follower springs\n    this.springs = []\n    for (let i = 0; i < count; i++) {\n      const spring = createSpringValue(0, springConfig)\n      this.springs.push(spring)\n    }\n\n    // Connect leader to followers with delay\n    this.leader.subscribe(() => {\n      this.frameCount++\n      this.scheduleFollowerUpdates()\n    })\n  }\n\n  private scheduleFollowerUpdates(): void {\n    const targetValue = this.leader.get()\n\n    for (let i = 0; i < this.springs.length; i++) {\n      const delayFrames = (i + 1) * this.followDelay\n      const targetFrame = this.frameCount + delayFrames\n\n      // Store the pending update\n      this.pendingUpdates.set(i, targetFrame)\n\n      // Schedule the update\n      this.scheduleFollowerUpdate(i, targetValue, targetFrame, delayFrames)\n    }\n  }\n\n  private scheduleFollowerUpdate(\n    index: number,\n    targetValue: number,\n    targetFrame: number,\n    delayFrames: number\n  ): void {\n    const startFrame = this.frameCount\n    const framesToWait = targetFrame - startFrame\n\n    if (framesToWait <= 0) {\n      // Update immediately if delay has passed\n      this.springs[index]!.set(targetValue)\n    } else {\n      // Use setTimeout for delay (approximately 16ms per frame at 60fps)\n      const delayMs = Math.max(framesToWait * 16, 0)\n\n      setTimeout(() => {\n        // Only update if this is still the current pending update\n        const currentTarget = this.pendingUpdates.get(index)\n        if (currentTarget === targetFrame) {\n          this.springs[index]!.set(targetValue)\n        }\n      }, delayMs)\n    }\n  }\n\n  set(value: number): void {\n    this.leader.set(value)\n  }\n\n  jump(value: number): void {\n    this.leader.jump(value)\n    for (const spring of this.springs) {\n      spring.jump(value)\n    }\n  }\n\n  getValues(): number[] {\n    return this.springs.map((s) => s.get())\n  }\n\n  subscribe(callback: (values: number[]) => void): () => void {\n    this.subscribers.add(callback)\n\n    // Subscribe to each follower spring\n    const unsubscribers: (() => void)[] = []\n    for (const spring of this.springs) {\n      unsubscribers.push(\n        spring.subscribe(() => {\n          this.notify()\n        })\n      )\n    }\n\n    // Immediately call with current values\n    callback(this.getValues())\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback)\n      for (const unsubscribe of unsubscribers) {\n        unsubscribe()\n      }\n    }\n  }\n\n  private notify(): void {\n    const values = this.getValues()\n    for (const subscriber of this.subscribers) {\n      subscriber(values)\n    }\n  }\n\n  destroy(): void {\n    this.leader.destroy()\n    for (const spring of this.springs) {\n      spring.destroy()\n    }\n    this.subscribers.clear()\n    this.pendingUpdates.clear()\n  }\n}\n\n/**\n * Create a trail animation\n *\n * @param count - Number of items in the trail\n * @param config - Trail configuration\n * @returns Trail controller\n *\n * @example\n * ```ts\n * const trail = createTrail(5, {\n *   stiffness: 200,\n *   damping: 25,\n *   followDelay: 3,\n * })\n *\n * trail.subscribe((values) => {\n *   elements.forEach((el, i) => {\n *     el.style.transform = `translateX(${values[i]}px)`\n *   })\n * })\n *\n * trail.set(100) // First item moves immediately, others follow\n * ```\n */\nexport function createTrail(count: number, config?: TrailConfig): Trail {\n  return new TrailImpl(count, config)\n}\n","import { globalLoop, type Animatable, AnimationState } from './loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateDecayConfig } from '../utils/warnings.js'\n\n/**\n * Decay animation configuration interface\n */\nexport interface DecayConfig {\n  /** Initial velocity */\n  velocity: number\n  /** Deceleration factor (0-1, higher = slower decay) */\n  deceleration?: number\n  /** Optional clamp range [min, max] */\n  clamp?: [number, number]\n  /** Callback called on each update */\n  onUpdate?: (value: number) => void\n  /** Callback called when complete */\n  onComplete?: () => void\n}\n\n/**\n * Decay animation interface\n */\nexport interface DecayAnimation {\n  /** Start the decay animation */\n  start(): DecayAnimation\n  /** Stop the decay animation */\n  stop(): void\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n}\n\n/**\n * Decay animation implementation\n * Simulates natural momentum/deceleration\n */\nclass DecayAnimationImpl implements DecayAnimation, Animatable {\n  private value: number\n  private velocity: number\n  private deceleration: number\n  private clampRange: [number, number] | undefined\n  private state: AnimationState = AnimationState.Idle\n  private rafId: number | null = null\n  private resolveComplete: (() => void) | null = null\n  private config: DecayConfig\n\n  finished: Promise<void>\n\n  constructor(config: DecayConfig) {\n    // Validate config in development mode\n    validateDecayConfig(config)\n\n    this.value = 0\n    this.velocity = config.velocity\n    this.deceleration = config.deceleration ?? 0.998\n    this.clampRange = config.clamp\n    this.state = AnimationState.Idle\n    this.config = config\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): DecayAnimation {\n    if (this.state === AnimationState.Running) return this\n    this.state = AnimationState.Running\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    // Apply deceleration\n    this.velocity *= this.deceleration\n    this.value += this.velocity\n\n    // Apply clamp\n    if (this.clampRange) {\n      const [min, max] = this.clampRange\n      this.value = clamp(this.value, min, max)\n\n      // Stop if we hit a boundary with velocity in that direction\n      if ((this.value <= min && this.velocity < 0) || (this.value >= max && this.velocity > 0)) {\n        this.velocity = 0\n      }\n    }\n\n    this.config.onUpdate?.(this.value)\n\n    // Check if stopped\n    if (Math.abs(this.velocity) < 0.01) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.config.onComplete?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  destroy(): void {\n    this.stop()\n    this.config.onUpdate = undefined\n    this.config.onComplete = undefined\n  }\n}\n\n/**\n * Create a decay animation\n *\n * @param config - Decay configuration\n * @returns Decay animation controller\n *\n * @example\n * ```ts\n * const anim = decay({\n *   velocity: 1000,\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function decay(config: DecayConfig): DecayAnimation {\n  return new DecayAnimationImpl(config)\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Keyframe definition with optional per-keyframe config\n */\nexport interface Keyframe<T = number> {\n  /** Target value at this keyframe */\n  value: T\n  /** Time position (0-1) for this keyframe. If not provided, evenly distributed */\n  at?: number\n  /** Spring config override for transition TO this keyframe */\n  config?: SpringConfig\n}\n\n/**\n * Options for keyframe animation\n */\nexport interface KeyframesOptions {\n  /** Default spring configuration */\n  config?: SpringConfig\n  /** Time positions for keyframes (0-1). Length must match values array */\n  times?: number[]\n  /** Callback for each keyframe transition start */\n  onKeyframe?: (index: number) => void\n  /** Callback when all keyframes complete */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (value: number) => void\n}\n\n/**\n * Keyframes animation controller\n */\nexport interface KeyframesAnimation {\n  /** Start the animation */\n  play: () => Promise<void>\n  /** Pause the animation */\n  pause: () => void\n  /** Resume a paused animation */\n  resume: () => void\n  /** Stop and reset to initial value */\n  stop: () => void\n  /** Get current value */\n  get: () => number\n  /** Get current keyframe index */\n  getCurrentKeyframe: () => number\n  /** Check if animation is playing */\n  isPlaying: () => boolean\n  /** Jump to specific keyframe */\n  jumpTo: (index: number) => void\n  /** Destroy and cleanup */\n  destroy: () => void\n}\n\n/**\n * Create a keyframe-based spring animation.\n * Animates through a sequence of values using spring physics.\n *\n * @example Basic keyframes\n * ```ts\n * const anim = keyframes([0, 100, 50, 100], {\n *   config: { stiffness: 200, damping: 20 },\n *   onUpdate: (value) => element.style.opacity = value / 100,\n * })\n * await anim.play()\n * ```\n *\n * @example With time positions\n * ```ts\n * const anim = keyframes([0, 100, 0], {\n *   times: [0, 0.3, 1], // 100 at 30%, back to 0 at 100%\n *   onUpdate: (value) => console.log(value),\n * })\n * ```\n *\n * @example With per-keyframe configs\n * ```ts\n * const anim = keyframes([\n *   { value: 0 },\n *   { value: 100, config: { stiffness: 500 } }, // Quick to 100\n *   { value: 50, config: { stiffness: 100 } },  // Slow to 50\n * ])\n * ```\n */\nexport function keyframes(\n  values: (number | Keyframe<number>)[],\n  options: KeyframesOptions = {}\n): KeyframesAnimation {\n  const {\n    config = {},\n    times,\n    onKeyframe,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Normalize keyframes\n  const normalizedKeyframes = values.map((v, i): Keyframe<number> => {\n    if (typeof v === 'number') {\n      return {\n        value: v,\n        at: times?.[i],\n      }\n    }\n    return { ...v, at: v.at ?? times?.[i] }\n  })\n\n  // Fill in missing time positions (evenly distributed)\n  const keyframeCount = normalizedKeyframes.length\n  normalizedKeyframes.forEach((kf, i) => {\n    if (kf.at === undefined) {\n      kf.at = keyframeCount > 1 ? i / (keyframeCount - 1) : 0\n    }\n  })\n\n  // Sort by time position\n  normalizedKeyframes.sort((a, b) => (a.at ?? 0) - (b.at ?? 0))\n\n  // State\n  let currentIndex = 0\n  let isPlaying = false\n  let isPaused = false\n  let spring: ReturnType<typeof createSpringValue> | null = null\n  let currentValue = normalizedKeyframes[0]?.value ?? 0\n  let destroyed = false\n\n  const createSpring = () => {\n    if (spring) {\n      spring.destroy()\n    }\n\n    const currentKf = normalizedKeyframes[currentIndex]\n    const springConfig = currentKf?.config ?? config\n\n    spring = createSpringValue(currentValue, springConfig)\n    spring.subscribe((value) => {\n      currentValue = value\n      onUpdate?.(value)\n    })\n  }\n\n  const animateToNext = async (): Promise<boolean> => {\n    if (destroyed || isPaused) return false\n    if (currentIndex >= normalizedKeyframes.length - 1) return false\n\n    currentIndex++\n    const targetKf = normalizedKeyframes[currentIndex]\n    if (!targetKf) return false\n\n    // Create new spring with keyframe-specific config if needed\n    if (targetKf.config) {\n      createSpring()\n    }\n\n    onKeyframe?.(currentIndex)\n\n    if (spring) {\n      spring.set(targetKf.value)\n\n      // Wait for spring to settle\n      await new Promise<void>((resolve) => {\n        const checkComplete = () => {\n          if (destroyed || isPaused) {\n            resolve()\n            return\n          }\n\n          if (spring && !spring.isAnimating()) {\n            resolve()\n          } else {\n            requestAnimationFrame(checkComplete)\n          }\n        }\n        // Give spring time to start\n        setTimeout(checkComplete, 16)\n      })\n    }\n\n    return true\n  }\n\n  const animation: KeyframesAnimation = {\n    play: async () => {\n      if (destroyed) return\n      if (isPlaying) return\n\n      isPlaying = true\n      isPaused = false\n\n      // Reset if at end\n      if (currentIndex >= normalizedKeyframes.length - 1) {\n        currentIndex = 0\n        currentValue = normalizedKeyframes[0]?.value ?? 0\n      }\n\n      createSpring()\n      onKeyframe?.(0)\n\n      // Animate through all keyframes\n      while (await animateToNext()) {\n        // Continue to next keyframe\n      }\n\n      if (!isPaused && !destroyed) {\n        isPlaying = false\n        onComplete?.()\n      }\n    },\n\n    pause: () => {\n      isPaused = true\n      isPlaying = false\n      if (spring) {\n        spring.stop()\n      }\n    },\n\n    resume: () => {\n      if (!isPaused || destroyed) return\n      isPaused = false\n      isPlaying = true\n\n      // Continue from current position\n      const continueAnimation = async () => {\n        while (await animateToNext()) {\n          // Continue to next keyframe\n        }\n\n        if (!isPaused && !destroyed) {\n          isPlaying = false\n          onComplete?.()\n        }\n      }\n\n      continueAnimation()\n    },\n\n    stop: () => {\n      isPaused = false\n      isPlaying = false\n      currentIndex = 0\n      currentValue = normalizedKeyframes[0]?.value ?? 0\n\n      if (spring) {\n        spring.jump(currentValue)\n      }\n    },\n\n    get: () => currentValue,\n\n    getCurrentKeyframe: () => currentIndex,\n\n    isPlaying: () => isPlaying,\n\n    jumpTo: (index: number) => {\n      if (index < 0 || index >= normalizedKeyframes.length) return\n\n      currentIndex = index\n      const targetValue = normalizedKeyframes[index]?.value ?? 0\n      currentValue = targetValue\n\n      if (spring) {\n        spring.jump(targetValue)\n      }\n\n      onUpdate?.(targetValue)\n      onKeyframe?.(index)\n    },\n\n    destroy: () => {\n      destroyed = true\n      isPlaying = false\n      isPaused = false\n\n      if (spring) {\n        spring.destroy()\n        spring = null\n      }\n    },\n  }\n\n  return animation\n}\n\n/**\n * Helper to create a keyframe sequence from an array shorthand\n *\n * @example\n * ```ts\n * // Equivalent to: keyframes([0, 100, 50])\n * const values = parseKeyframeArray([0, 100, 50])\n * ```\n */\nexport function parseKeyframeArray(\n  values: number[],\n  times?: number[]\n): Keyframe<number>[] {\n  return values.map((value, index) => ({\n    value,\n    at: times?.[index],\n  }))\n}\n\n/**\n * Check if a value is a keyframe array (for animate prop detection)\n */\nexport function isKeyframeArray(value: unknown): value is number[] {\n  return Array.isArray(value) && value.every((v) => typeof v === 'number')\n}\n","import type { SpringValue } from '../core/spring-value.js'\n\n/**\n * Interpolation options interface\n */\nexport interface InterpolateOptions {\n  /** Clamp output to output range */\n  clamp?: boolean\n  /** Default extrapolation mode */\n  extrapolate?: 'extend' | 'clamp' | 'identity'\n  /** Extrapolation mode for left side */\n  extrapolateLeft?: 'extend' | 'clamp' | 'identity'\n  /** Extrapolation mode for right side */\n  extrapolateRight?: 'extend' | 'clamp' | 'identity'\n}\n\n/**\n * Interpolation interface\n */\nexport interface Interpolation {\n  /** Get current interpolated value */\n  get(): number\n}\n\n/**\n * Default interpolation options\n * Note: extrapolate is handled inline to allow proper branch coverage\n */\nconst defaultInterpolateOptions: Required<Pick<InterpolateOptions, 'clamp'>> = {\n  clamp: false,\n}\n\n/**\n * Value interpolation implementation\n */\nclass InterpolationImpl implements Interpolation {\n  private source: SpringValue | (() => number)\n  private input: number[]\n  private output: number[]\n  private options: InterpolateOptions\n\n  constructor(\n    source: SpringValue | (() => number),\n    input: number[],\n    output: number[],\n    options: InterpolateOptions = {}\n  ) {\n    this.source = source\n    this.input = input\n    this.output = output\n    this.options = { ...defaultInterpolateOptions, ...options }\n  }\n\n  get(): number {\n    const value = typeof this.source === 'function' ? this.source() : this.source.get()\n    return this.interpolate(value)\n  }\n\n  private interpolate(value: number): number {\n    const { input, output } = this\n    const { extrapolate, extrapolateLeft, extrapolateRight, clamp } = this.options\n\n    // Handle single point case - just return the output value\n    if (input.length === 1) {\n      return output[0]!\n    }\n\n    // Handle extrapolation\n    if (value < input[0]!) {\n      // Pass extrapolate as-is (may be undefined to test default branch)\n      const mode = this.getExtrapolationMode(extrapolateLeft, extrapolate)\n      if (mode === 'clamp') {\n        value = input[0]!\n      } else if (mode === 'identity') {\n        return value\n      }\n    } else if (value > input[input.length - 1]!) {\n      // Pass extrapolate as-is (may be undefined to test default branch)\n      const mode = this.getExtrapolationMode(extrapolateRight, extrapolate)\n      if (mode === 'clamp') {\n        value = input[input.length - 1]!\n      } else if (mode === 'identity') {\n        return value\n      }\n    }\n\n    // Find the segment\n    let i = 1\n    while (i < input.length - 1 && value > input[i]!) {\n      i++\n    }\n\n    // Linear interpolation within segment\n    const ratio = (value - input[i - 1]!) / (input[i]! - input[i - 1]!)\n    const result = output[i - 1]! + ratio * (output[i]! - output[i - 1]!)\n\n    if (clamp) {\n      const min = Math.min(...output)\n      const max = Math.max(...output)\n      return Math.max(min, Math.min(max, result))\n    }\n\n    return result\n  }\n\n  private getExtrapolationMode(\n    specificMode: 'extend' | 'clamp' | 'identity' | undefined,\n    fallbackMode: 'extend' | 'clamp' | 'identity' | undefined\n  ): 'extend' | 'clamp' | 'identity' {\n    if (specificMode !== undefined) {\n      return specificMode\n    }\n    if (fallbackMode !== undefined) {\n      return fallbackMode\n    }\n    return 'extend'\n  }\n}\n\n/**\n * Create a value interpolation\n *\n * @param value - Spring value or function that returns a number\n * @param input - Input range (array of numbers)\n * @param output - Output range (array of numbers)\n * @param options - Interpolation options\n * @returns Interpolation controller\n *\n * @example\n * ```ts\n * const x = createSpringValue(0)\n *\n * // Map 0-100 to 0-1 (opacity)\n * const opacity = interpolate(x, [0, 100], [0, 1])\n *\n * x.subscribe(() => {\n *   element.style.opacity = String(opacity.get())\n * })\n *\n * x.set(100) // opacity animates to 1\n * ```\n */\nexport function interpolate(\n  value: SpringValue | (() => number),\n  input: number[],\n  output: number[],\n  options?: InterpolateOptions\n): Interpolation {\n  return new InterpolationImpl(value, input, output, options)\n}\n","import type { SpringValue } from '../core/spring-value.js'\nimport type { InterpolateOptions } from './interpolate.js'\n\n/**\n * Color interpolation interface\n */\nexport interface ColorInterpolation {\n  /** Get current interpolated color */\n  get(): string\n}\n\n/**\n * Color interpolation implementation\n */\nclass ColorInterpolationImpl implements ColorInterpolation {\n  private source: SpringValue | (() => number)\n  private input: number[]\n  private colors: [number, number, number][]\n  private options: InterpolateOptions\n\n  constructor(\n    source: SpringValue | (() => number),\n    input: number[],\n    colorStrings: string[],\n    options: InterpolateOptions = {}\n  ) {\n    this.source = source\n    this.input = input\n    this.colors = colorStrings.map((c) => this.parseColor(c))\n    this.options = options\n  }\n\n  get(): string {\n    let value = typeof this.source === 'function' ? this.source() : this.source.get()\n    const { extrapolate, extrapolateLeft, extrapolateRight } = this.options\n\n    // Handle single color case\n    if (this.input.length === 1) {\n      const [r, g, b] = this.colors[0]!\n      return `rgb(${r}, ${g}, ${b})`\n    }\n\n    // Handle extrapolation\n    if (value < this.input[0]!) {\n      const mode = extrapolateLeft ?? extrapolate ?? 'extend'\n      if (mode === 'clamp') {\n        value = this.input[0]!\n      } else if (mode === 'identity') {\n        // For color, we can't return identity, so we clamp\n        value = this.input[0]!\n      }\n    } else if (value > this.input[this.input.length - 1]!) {\n      const mode = extrapolateRight ?? extrapolate ?? 'extend'\n      if (mode === 'clamp') {\n        value = this.input[this.input.length - 1]!\n      } else if (mode === 'identity') {\n        // For color, we can't return identity, so we clamp\n        value = this.input[this.input.length - 1]!\n      }\n    }\n\n    // Find the segment\n    let i = 1\n    while (i < this.input.length - 1 && value > this.input[i]!) {\n      i++\n    }\n\n    // Calculate interpolation ratio\n    const ratio = (value - this.input[i - 1]!) / (this.input[i]! - this.input[i - 1]!)\n\n    // Interpolate each color channel\n    const r = this.lerp(this.colors[i - 1]![0], this.colors[i]![0], ratio)\n    const g = this.lerp(this.colors[i - 1]![1], this.colors[i]![1], ratio)\n    const b = this.lerp(this.colors[i - 1]![2], this.colors[i]![2], ratio)\n\n    return `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`\n  }\n\n  private parseColor(color: string): [number, number, number] {\n    // Try to parse hex\n    const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\n    if (hexMatch) {\n      const hex = hexMatch[1]!\n      if (hex.length === 3) {\n        return [\n          parseInt(hex.charAt(0) + hex.charAt(0), 16),\n          parseInt(hex.charAt(1) + hex.charAt(1), 16),\n          parseInt(hex.charAt(2) + hex.charAt(2), 16),\n        ]\n      }\n      return [\n        parseInt(hex.slice(0, 2), 16),\n        parseInt(hex.slice(2, 4), 16),\n        parseInt(hex.slice(4, 6), 16),\n      ]\n    }\n\n    // Try to parse rgb()\n    const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\n    if (rgbMatch) {\n      return [\n        parseInt(rgbMatch[1]!, 10),\n        parseInt(rgbMatch[2]!, 10),\n        parseInt(rgbMatch[3]!, 10),\n      ]\n    }\n\n    // Try to parse rgba()\n    const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\n    if (rgbaMatch) {\n      return [\n        parseInt(rgbaMatch[1]!, 10),\n        parseInt(rgbaMatch[2]!, 10),\n        parseInt(rgbaMatch[3]!, 10),\n      ]\n    }\n\n    // Try to parse hsl()\n    const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\n    if (hslMatch) {\n      return this.hslToRgb(\n        parseInt(hslMatch[1]!, 10),\n        parseInt(hslMatch[2]!, 10),\n        parseInt(hslMatch[3]!, 10)\n      )\n    }\n\n    // Default to black\n    return [0, 0, 0]\n  }\n\n  private hslToRgb(h: number, s: number, l: number): [number, number, number] {\n    h = ((h % 360) + 360) % 360\n    s = Math.max(0, Math.min(100, s)) / 100\n    l = Math.max(0, Math.min(100, l)) / 100\n\n    if (s === 0) {\n      const gray = Math.round(l * 255)\n      return [gray, gray, gray]\n    }\n\n    const hue2rgb = (p: number, q: number, t: number): number => {\n      if (t < 0) t += 1\n      if (t > 1) t -= 1\n      if (t < 1 / 6) return p + (q - p) * 6 * t\n      if (t < 1 / 2) return q\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n      return p\n    }\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n    const p = 2 * l - q\n\n    return [\n      Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\n      Math.round(hue2rgb(p, q, h / 360) * 255),\n      Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\n    ]\n  }\n\n  private lerp(a: number, b: number, t: number): number {\n    return a + (b - a) * t\n  }\n}\n\n/**\n * Create a color interpolation\n *\n * @param value - Spring value or function that returns a number\n * @param input - Input range (array of numbers)\n * @param colors - Array of color strings (hex, rgb, hsl)\n * @param options - Interpolation options\n * @returns Color interpolation controller\n *\n * @example\n * ```ts\n * const progress = createSpringValue(0)\n *\n * // Interpolate through colors\n * const color = interpolateColor(\n *   progress,\n *   [0, 50, 100],\n *   ['#ff0000', '#00ff00', '#0000ff']\n * )\n *\n * progress.subscribe(() => {\n *   element.style.backgroundColor = color.get()\n * })\n *\n * progress.set(50) // color is '#00ff00'\n * ```\n */\nexport function interpolateColor(\n  value: SpringValue | (() => number),\n  input: number[],\n  colors: string[],\n  options?: InterpolateOptions\n): ColorInterpolation {\n  return new ColorInterpolationImpl(value, input, colors, options)\n}\n","import { defaultConfig } from '../core/config.js'\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { clamp } from '../utils/math.js'\n\n/**\n * Drag spring configuration interface\n */\nexport interface DragSpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Initial velocity */\n  velocity?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Axis constraint */\n  axis?: 'x' | 'y' | 'both'\n  /** Boundary constraints */\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n  /** Enable rubber band effect at bounds */\n  rubberBand?: boolean\n  /** Rubber band stretch factor (0-1) */\n  rubberBandFactor?: number\n  /** Callback called when drag starts */\n  onDragStart?: (event: PointerEvent) => void\n  /** Callback called during drag */\n  onDrag?: (x: number, y: number, event: PointerEvent) => void\n  /** Callback called when drag ends */\n  onDragEnd?: (x: number, y: number, velocity: { x: number; y: number }) => void\n  /** Callback called on position update */\n  onUpdate?: (x: number, y: number) => void\n}\n\n/**\n * Drag spring interface\n */\nexport interface DragSpring {\n  /** Enable drag interaction */\n  enable(): void\n  /** Disable drag interaction */\n  disable(): void\n  /** Check if currently enabled */\n  isEnabled(): boolean\n  /** Reset to initial position */\n  reset(): void\n  /** Get current position */\n  getPosition(): { x: number; y: number }\n  /** Set position (animated) */\n  setPosition(x: number, y: number): void\n  /** Release with velocity */\n  release(velocityX: number, velocityY: number): void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Default drag spring configuration\n */\nconst defaultDragConfig: Required<Omit<DragSpringConfig, 'onDragStart' | 'onDrag' | 'onDragEnd' | 'onUpdate' | 'velocity' | 'bounds'>> = {\n  axis: 'both',\n  rubberBand: false,\n  rubberBandFactor: 0.5,\n  stiffness: 200,\n  damping: 20,\n  mass: 1,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Drag spring implementation\n */\nclass DragSpringImpl implements DragSpring {\n  private element: HTMLElement\n  private config: DragSpringConfig\n  private enabled = true\n  private position = { x: 0, y: 0 }\n  private isDragging = false\n  private startPosition = { x: 0, y: 0 }\n  private pointerStart = { x: 0, y: 0 }\n  private lastPosition = { x: 0, y: 0 }\n  private lastTime = 0\n  private velocity = { x: 0, y: 0 }\n\n  // Springs for each axis\n  private springX: SpringValue\n  private springY: SpringValue\n\n  constructor(element: HTMLElement, config: DragSpringConfig = {}) {\n    this.element = element\n    this.config = { ...defaultDragConfig, ...config }\n\n    // Extract only spring physics config for createSpringValue\n    const springConfig = {\n      stiffness: this.config.stiffness,\n      damping: this.config.damping,\n      mass: this.config.mass,\n      restSpeed: this.config.restSpeed,\n      restDelta: this.config.restDelta,\n      clamp: this.config.clamp,\n    }\n\n    this.springX = createSpringValue(0, springConfig)\n    this.springY = createSpringValue(0, springConfig)\n\n    // Subscribe to spring updates\n    this.springX.subscribe(() => {\n      if (!this.isDragging) {\n        this.position.x = this.springX.get()\n        if (this.config.onUpdate) {\n          this.config.onUpdate(this.position.x, this.position.y)\n        }\n      }\n    })\n\n    this.springY.subscribe(() => {\n      if (!this.isDragging) {\n        this.position.y = this.springY.get()\n        if (this.config.onUpdate) {\n          this.config.onUpdate(this.position.x, this.position.y)\n        }\n      }\n    })\n\n    this.setupPointerEvents()\n  }\n\n  private setupPointerEvents(): void {\n    this.element.addEventListener('pointerdown', this.onPointerDown)\n  }\n\n  private onPointerDown = (e: PointerEvent): void => {\n    if (!this.enabled || e.button !== 0) return\n\n    this.isDragging = true\n    this.startPosition = { ...this.position }\n    this.pointerStart = { x: e.clientX, y: e.clientY }\n    this.lastPosition = { x: e.clientX, y: e.clientY }\n    this.lastTime = performance.now()\n    this.velocity = { x: 0, y: 0 }\n\n    this.element.setPointerCapture(e.pointerId)\n    this.element.addEventListener('pointermove', this.onPointerMove)\n    this.element.addEventListener('pointerup', this.onPointerUp)\n    this.element.addEventListener('pointercancel', this.onPointerUp)\n\n    // Explicit if for better branch coverage\n    if (this.config.onDragStart) {\n      this.config.onDragStart(e)\n    }\n  }\n\n  private onPointerMove = (e: PointerEvent): void => {\n    const now = performance.now()\n    const dt = now - this.lastTime\n\n    // Calculate velocity (pixels per ms, scaled to pixels per second)\n    this.velocity = {\n      x: (e.clientX - this.lastPosition.x) / Math.max(dt, 1),\n      y: (e.clientY - this.lastPosition.y) / Math.max(dt, 1),\n    }\n\n    this.lastPosition = { x: e.clientX, y: e.clientY }\n    this.lastTime = now\n\n    // Calculate new position\n    let newX = this.startPosition.x + (e.clientX - this.pointerStart.x)\n    let newY = this.startPosition.y + (e.clientY - this.pointerStart.y)\n\n    // Apply bounds with rubber band\n    if (this.config.bounds) {\n      newX = this.applyBounds(\n        newX,\n        this.config.bounds.left ?? -Infinity,\n        this.config.bounds.right ?? Infinity\n      )\n      newY = this.applyBounds(\n        newY,\n        this.config.bounds.top ?? -Infinity,\n        this.config.bounds.bottom ?? Infinity\n      )\n    }\n\n    // Apply axis constraint\n    if (this.config.axis === 'x') {\n      newY = 0\n    } else if (this.config.axis === 'y') {\n      newX = 0\n    }\n\n    this.position = { x: newX, y: newY }\n    if (this.config.onDrag) {\n      this.config.onDrag(newX, newY, e)\n    }\n    if (this.config.onUpdate) {\n      this.config.onUpdate(newX, newY)\n    }\n  }\n\n  private applyBounds(value: number, min: number, max: number): number {\n    if (!isFinite(min) && !isFinite(max)) return value\n\n    const actualMin = isFinite(min) ? min : -Infinity\n    const actualMax = isFinite(max) ? max : Infinity\n\n    if (this.config.rubberBand) {\n      const factor = this.config.rubberBandFactor || 0.5\n      if (value < actualMin) {\n        return actualMin - (actualMin - value) * factor\n      }\n      if (value > actualMax) {\n        return actualMax + (value - actualMax) * factor\n      }\n    }\n\n    return clamp(value, actualMin, actualMax)\n  }\n\n  private onPointerUp = (e: PointerEvent): void => {\n    this.isDragging = false\n\n    this.element.releasePointerCapture(e.pointerId)\n    this.element.removeEventListener('pointermove', this.onPointerMove)\n    this.element.removeEventListener('pointerup', this.onPointerUp)\n    this.element.removeEventListener('pointercancel', this.onPointerUp)\n\n    // Scale velocity for spring (convert from pixels/ms to more reasonable units)\n    this.release(this.velocity.x * 16, this.velocity.y * 16)\n\n    if (this.config.onDragEnd) {\n      this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\n    }\n  }\n\n  enable(): void {\n    this.enabled = true\n  }\n\n  disable(): void {\n    this.enabled = false\n    if (this.isDragging) {\n      this.isDragging = false\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  reset(): void {\n    this.springX.jump(0)\n    this.springY.jump(0)\n    this.position = { x: 0, y: 0 }\n    // Explicit if for better branch coverage\n    if (this.config.onUpdate) {\n      this.config.onUpdate(0, 0)\n    }\n  }\n\n  getPosition(): { x: number; y: number } {\n    return { ...this.position }\n  }\n\n  setPosition(x: number, y: number): void {\n    // Update position immediately for synchronous access\n    this.position = { x, y }\n    // Animate to the new position\n    this.springX.jump(x)\n    this.springY.jump(y)\n  }\n\n  release(velocityX: number, velocityY: number): void {\n    // Animate back to bounds if outside\n    if (this.config.bounds) {\n      const {\n        left = -Infinity,\n        right = Infinity,\n        top = -Infinity,\n        bottom = Infinity,\n      } = this.config.bounds\n\n      const targetX = clamp(this.position.x, left, right)\n      const targetY = clamp(this.position.y, top, bottom)\n\n      if (targetX !== this.position.x) {\n        this.springX.set(targetX, { velocity: velocityX })\n      }\n      if (targetY !== this.position.y) {\n        this.springY.set(targetY, { velocity: velocityY })\n      }\n    }\n  }\n\n  destroy(): void {\n    this.element.removeEventListener('pointerdown', this.onPointerDown)\n    this.springX.destroy()\n    this.springY.destroy()\n  }\n}\n\n/**\n * Create a drag spring\n *\n * @param element - HTML element to make draggable\n * @param config - Drag spring configuration\n * @returns Drag spring controller\n *\n * @example\n * ```ts\n * const drag = createDragSpring(element, {\n *   onUpdate: (x, y) => {\n *     element.style.transform = `translate(${x}px, ${y}px)`\n *   },\n * })\n * ```\n */\nexport function createDragSpring(\n  element: HTMLElement,\n  config?: DragSpringConfig\n): DragSpring {\n  return new DragSpringImpl(element, config)\n}\n","import { defaultConfig } from '../core/config.js'\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\n/**\n * Scroll spring configuration interface\n */\nexport interface ScrollSpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Scroll direction */\n  direction?: 'horizontal' | 'vertical' | 'both'\n  /** Enable momentum/inertia */\n  momentum?: boolean\n  /** Momentum decay factor (0-1) */\n  momentumDecay?: number\n  /** Enable bounce at edges */\n  bounce?: boolean\n  /** Bounce spring stiffness */\n  bounceStiffness?: number\n  /** Bounce spring damping */\n  bounceDamping?: number\n  /** Callback called on scroll */\n  onScroll?: (scrollX: number, scrollY: number) => void\n  /** Callback called when scroll starts */\n  onScrollStart?: () => void\n  /** Callback called when scroll ends */\n  onScrollEnd?: () => void\n}\n\n/**\n * Scroll spring interface\n */\nexport interface ScrollSpring {\n  /** Get current scroll position */\n  getScroll(): { x: number; y: number }\n  /** Scroll to position */\n  scrollTo(x: number, y: number): void\n  /** Scroll to element */\n  scrollToElement(element: HTMLElement, offset?: number): void\n  /** Enable scroll handling */\n  enable(): void\n  /** Disable scroll handling */\n  disable(): void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Default scroll spring configuration\n */\nconst defaultScrollConfig: Required<\n  Omit<\n    ScrollSpringConfig,\n    | 'onScroll'\n    | 'onScrollStart'\n    | 'onScrollEnd'\n    | 'bounceStiffness'\n    | 'bounceDamping'\n    | 'velocity'\n  >\n> = {\n  direction: 'vertical',\n  momentum: false,\n  momentumDecay: 0.95,\n  bounce: false,\n  stiffness: 100,\n  damping: 10,\n  mass: 1,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Scroll spring implementation\n */\nclass ScrollSpringImpl implements ScrollSpring {\n  private container: HTMLElement\n  private config: ScrollSpringConfig\n  private scroll = { x: 0, y: 0 }\n  private target = { x: 0, y: 0 }\n  private isScrolling = false\n  private isEnabled = true\n\n  private springX: SpringValue\n  private springY: SpringValue\n\n  constructor(container: HTMLElement, config: ScrollSpringConfig = {}) {\n    this.container = container\n    this.config = { ...defaultScrollConfig, ...config }\n\n    // Extract only spring physics config for createSpringValue\n    const springConfig = {\n      stiffness: this.config.stiffness,\n      damping: this.config.damping,\n      mass: this.config.mass,\n      restSpeed: this.config.restSpeed,\n      restDelta: this.config.restDelta,\n      clamp: this.config.clamp,\n    }\n\n    this.springX = createSpringValue(0, springConfig)\n    this.springY = createSpringValue(0, springConfig)\n\n    // Subscribe to spring updates\n    this.springX.subscribe(() => {\n      this.scroll.x = this.springX.get()\n      this.config.onScroll?.(this.scroll.x, this.scroll.y)\n    })\n\n    this.springY.subscribe(() => {\n      this.scroll.y = this.springY.get()\n      this.config.onScroll?.(this.scroll.x, this.scroll.y)\n    })\n\n    this.setupScrollEvents()\n  }\n\n  private setupScrollEvents(): void {\n    this.container.addEventListener('wheel', this.onWheel, { passive: false })\n  }\n\n  private onWheel = (e: WheelEvent): void => {\n    if (!this.isEnabled) return\n\n    if (!this.isScrolling) {\n      this.isScrolling = true\n      this.config.onScrollStart?.()\n    }\n\n    // Apply direction filter\n    let deltaX = e.deltaX\n    let deltaY = e.deltaY\n\n    if (this.config.direction === 'horizontal') {\n      deltaY = 0\n    } else if (this.config.direction === 'vertical') {\n      deltaX = 0\n    }\n\n    // Apply bounce at edges\n    if (this.config.bounce) {\n      const maxScrollX = this.container.scrollWidth - this.container.clientWidth\n      const maxScrollY = this.container.scrollHeight - this.container.clientHeight\n\n      this.target.x += deltaX\n      this.target.y += deltaY\n\n      // Apply rubber band at edges\n      if (this.target.x < 0) {\n        this.target.x = -Math.sqrt(-this.target.x) * 10\n      } else if (this.target.x > maxScrollX) {\n        this.target.x = maxScrollX + Math.sqrt(this.target.x - maxScrollX) * 10\n      }\n\n      if (this.target.y < 0) {\n        this.target.y = -Math.sqrt(-this.target.y) * 10\n      } else if (this.target.y > maxScrollY) {\n        this.target.y = maxScrollY + Math.sqrt(this.target.y - maxScrollY) * 10\n      }\n\n      // Prevent default to handle scroll ourselves\n      e.preventDefault()\n    } else {\n      this.target.x += deltaX\n      this.target.y += deltaY\n\n      // Clamp to bounds\n      const maxScrollX = this.container.scrollWidth - this.container.clientWidth\n      const maxScrollY = this.container.scrollHeight - this.container.clientHeight\n\n      this.target.x = Math.max(0, Math.min(this.target.x, maxScrollX))\n      this.target.y = Math.max(0, Math.min(this.target.y, maxScrollY))\n    }\n\n    this.startScrollLoop()\n  }\n\n  private startScrollLoop(): void {\n    // Update springs towards target\n    this.springX.set(this.target.x)\n    this.springY.set(this.target.y)\n\n    // Check for scroll end\n    const checkEnd = () => {\n      const settled =\n        Math.abs(this.scroll.x - this.target.x) < 0.1 &&\n        Math.abs(this.scroll.y - this.target.y) < 0.1 &&\n        !this.springX.isAnimating() &&\n        !this.springY.isAnimating()\n\n      if (settled && this.isScrolling) {\n        this.isScrolling = false\n        this.config.onScrollEnd?.()\n      } else if (this.isScrolling) {\n        requestAnimationFrame(checkEnd)\n      }\n    }\n\n    checkEnd()\n  }\n\n  getScroll(): { x: number; y: number } {\n    return { ...this.scroll }\n  }\n\n  scrollTo(x: number, y: number): void {\n    this.target = { x, y }\n    this.springX.set(x)\n    this.springY.set(y)\n  }\n\n  scrollToElement(element: HTMLElement, offset = 0): void {\n    const containerRect = this.container.getBoundingClientRect()\n    const elementRect = element.getBoundingClientRect()\n\n    const x = elementRect.left - containerRect.left + this.scroll.x + offset\n    const y = elementRect.top - containerRect.top + this.scroll.y + offset\n\n    this.scrollTo(x, y)\n  }\n\n  enable(): void {\n    this.isEnabled = true\n  }\n\n  disable(): void {\n    this.isEnabled = false\n  }\n\n  destroy(): void {\n    this.container.removeEventListener('wheel', this.onWheel)\n    this.springX.destroy()\n    this.springY.destroy()\n  }\n}\n\n/**\n * Create a scroll spring\n *\n * @param container - Scrollable container element\n * @param config - Scroll spring configuration\n * @returns Scroll spring controller\n *\n * @example\n * ```ts\n * const scroll = createScrollSpring(container, {\n *   onScroll: (x, y) => {\n *     content.style.transform = `translate(${-x}px, ${-y}px)`\n *   },\n * })\n * ```\n */\nexport function createScrollSpring(\n  container: HTMLElement,\n  config?: ScrollSpringConfig\n): ScrollSpring {\n  return new ScrollSpringImpl(container, config)\n}\n","/**\n * Advanced Gesture System - Multi-touch gestures with spring physics\n *\n * Provides pinch, rotate, swipe, and long-press detection with\n * velocity tracking and spring-based animations.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Point in 2D space\n */\nexport interface Point {\n  x: number\n  y: number\n}\n\n/**\n * Gesture state shared across all gesture types\n */\nexport interface GestureState {\n  /** Whether gesture is active */\n  active: boolean\n  /** First touch/pointer position */\n  first: boolean\n  /** Last event in gesture */\n  last: boolean\n  /** Event that triggered the gesture */\n  event: PointerEvent | TouchEvent\n  /** Time since gesture started (ms) */\n  elapsedTime: number\n  /** Gesture was cancelled */\n  cancelled: boolean\n}\n\n/**\n * Pinch gesture state\n */\nexport interface PinchState extends GestureState {\n  /** Current scale (1 = original) */\n  scale: number\n  /** Scale velocity */\n  velocity: number\n  /** Distance between fingers */\n  distance: number\n  /** Initial distance between fingers */\n  initialDistance: number\n  /** Center point between fingers */\n  origin: Point\n  /** Movement delta */\n  movement: number\n  /** Scale offset from initial */\n  offset: number\n}\n\n/**\n * Rotate gesture state\n */\nexport interface RotateState extends GestureState {\n  /** Current rotation in degrees */\n  angle: number\n  /** Angular velocity (degrees/second) */\n  velocity: number\n  /** Initial angle */\n  initialAngle: number\n  /** Center point of rotation */\n  origin: Point\n  /** Rotation movement */\n  movement: number\n  /** Rotation offset from initial */\n  offset: number\n}\n\n/**\n * Swipe gesture state\n */\nexport interface SwipeState extends GestureState {\n  /** Swipe direction */\n  direction: 'up' | 'down' | 'left' | 'right' | null\n  /** Swipe velocity */\n  velocity: Point\n  /** Distance swiped */\n  distance: Point\n  /** Movement from start */\n  movement: Point\n  /** Swipe duration in ms */\n  duration: number\n}\n\n/**\n * Long press gesture state\n */\nexport interface LongPressState extends GestureState {\n  /** Press position */\n  position: Point\n  /** Press duration in ms */\n  duration: number\n  /** Whether threshold was reached */\n  triggered: boolean\n}\n\n/**\n * Pinch gesture configuration\n */\nexport interface PinchConfig {\n  /** Minimum scale (default: 0.1) */\n  minScale?: number\n  /** Maximum scale (default: 10) */\n  maxScale?: number\n  /** Enable rubber band at limits */\n  rubberBand?: boolean\n  /** Rubber band factor (0-1) */\n  rubberBandFactor?: number\n  /** Spring config for release animation */\n  spring?: {\n    stiffness?: number\n    damping?: number\n  }\n  /** Callback on pinch */\n  onPinch?: (state: PinchState) => void\n  /** Callback when pinch starts */\n  onPinchStart?: (state: PinchState) => void\n  /** Callback when pinch ends */\n  onPinchEnd?: (state: PinchState) => void\n}\n\n/**\n * Rotate gesture configuration\n */\nexport interface RotateConfig {\n  /** Enable rotation (default: true) */\n  enabled?: boolean\n  /** Minimum rotation threshold in degrees */\n  threshold?: number\n  /** Callback on rotate */\n  onRotate?: (state: RotateState) => void\n  /** Callback when rotation starts */\n  onRotateStart?: (state: RotateState) => void\n  /** Callback when rotation ends */\n  onRotateEnd?: (state: RotateState) => void\n}\n\n/**\n * Swipe gesture configuration\n */\nexport interface SwipeConfig {\n  /** Minimum velocity to trigger swipe (pixels/ms) */\n  velocityThreshold?: number\n  /** Minimum distance to trigger swipe (pixels) */\n  distanceThreshold?: number\n  /** Maximum duration for swipe (ms) */\n  maxDuration?: number\n  /** Axis constraint */\n  axis?: 'x' | 'y' | 'both'\n  /** Callback on swipe */\n  onSwipe?: (state: SwipeState) => void\n  /** Callback when swipe starts */\n  onSwipeStart?: (state: SwipeState) => void\n  /** Callback when swipe ends */\n  onSwipeEnd?: (state: SwipeState) => void\n}\n\n/**\n * Long press gesture configuration\n */\nexport interface LongPressConfig {\n  /** Duration to trigger long press (ms, default: 500) */\n  threshold?: number\n  /** Movement tolerance (pixels) */\n  movementTolerance?: number\n  /** Callback when long press triggers */\n  onLongPress?: (state: LongPressState) => void\n  /** Callback on press start */\n  onPressStart?: (state: LongPressState) => void\n  /** Callback on press end */\n  onPressEnd?: (state: LongPressState) => void\n}\n\n/**\n * Combined gesture configuration\n */\nexport interface GestureConfig {\n  pinch?: PinchConfig\n  rotate?: RotateConfig\n  swipe?: SwipeConfig\n  longPress?: LongPressConfig\n}\n\n/**\n * Gesture controller interface\n */\nexport interface GestureController {\n  /** Enable gestures */\n  enable(): void\n  /** Disable gestures */\n  disable(): void\n  /** Check if enabled */\n  isEnabled(): boolean\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Utility Functions ============\n\n/**\n * Calculate distance between two points\n */\nfunction getDistance(p1: Point, p2: Point): number {\n  const dx = p2.x - p1.x\n  const dy = p2.y - p1.y\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\n/**\n * Calculate angle between two points in degrees\n */\nfunction getAngle(p1: Point, p2: Point): number {\n  return (Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180) / Math.PI\n}\n\n/**\n * Get center point between two points\n */\nfunction getCenter(p1: Point, p2: Point): Point {\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2,\n  }\n}\n\n/**\n * Apply rubber band effect\n */\nfunction rubberBand(value: number, min: number, max: number, factor: number): number {\n  if (value < min) {\n    return min - Math.pow(min - value, factor)\n  }\n  if (value > max) {\n    return max + Math.pow(value - max, factor)\n  }\n  return value\n}\n\n// ============ Pinch Gesture ============\n\n/**\n * Create pinch gesture handler\n *\n * @example\n * ```ts\n * const pinch = createPinchGesture(element, {\n *   onPinch: (state) => {\n *     element.style.transform = `scale(${state.scale})`\n *   },\n * })\n * ```\n */\nexport function createPinchGesture(\n  element: HTMLElement,\n  config: PinchConfig = {}\n): GestureController {\n  const {\n    minScale = 0.1,\n    maxScale = 10,\n    rubberBand: enableRubberBand = true,\n    rubberBandFactor = 0.5,\n    spring = { stiffness: 200, damping: 20 },\n    onPinch,\n    onPinchStart,\n    onPinchEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let initialDistance = 0\n  let initialScale = 1\n  let currentScale = 1\n  let lastScale = 1\n  let velocity = 0\n  let startTime = 0\n  let lastTime = 0\n\n  const touches = new Map<number, Point>()\n  let scaleSpring: SpringValue | null = null\n\n  const createState = (event: TouchEvent, first = false, last = false): PinchState => {\n    const touchArray = Array.from(touches.values())\n    const p1 = touchArray[0] ?? { x: 0, y: 0 }\n    const p2 = touchArray[1] ?? { x: 0, y: 0 }\n    const origin = touchArray.length >= 2 ? getCenter(p1, p2) : { x: 0, y: 0 }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: performance.now() - startTime,\n      cancelled: false,\n      scale: currentScale,\n      velocity,\n      distance: touchArray.length >= 2 ? getDistance(p1, p2) : 0,\n      initialDistance,\n      origin,\n      movement: currentScale - initialScale,\n      offset: currentScale - 1,\n    }\n  }\n\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!enabled) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n    }\n\n    if (touches.size === 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      initialDistance = getDistance(p1, p2)\n      initialScale = currentScale\n      startTime = performance.now()\n      lastTime = startTime\n      active = true\n\n      // Cancel any spring animation\n      scaleSpring?.destroy()\n      scaleSpring = null\n\n      onPinchStart?.(createState(e, true, false))\n    }\n  }\n\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!enabled || !active) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      if (touches.has(touch.identifier)) {\n        touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n      }\n    }\n\n    if (touches.size >= 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      const currentDistance = getDistance(p1, p2)\n      const now = performance.now()\n      const dt = now - lastTime\n\n      // Calculate new scale\n      let newScale = initialScale * (currentDistance / initialDistance)\n\n      // Apply rubber band at limits\n      if (enableRubberBand) {\n        newScale = rubberBand(newScale, minScale, maxScale, rubberBandFactor)\n      } else {\n        newScale = clamp(newScale, minScale, maxScale)\n      }\n\n      // Calculate velocity\n      velocity = dt > 0 ? ((newScale - lastScale) / dt) * 1000 : 0\n      lastScale = currentScale\n      currentScale = newScale\n      lastTime = now\n\n      onPinch?.(createState(e, false, false))\n      e.preventDefault()\n    }\n  }\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.delete(touch.identifier)\n    }\n\n    if (active && touches.size < 2) {\n      active = false\n\n      // Spring back to limits if out of bounds\n      if (currentScale < minScale || currentScale > maxScale) {\n        const targetScale = clamp(currentScale, minScale, maxScale)\n        scaleSpring = createSpringValue(currentScale, {\n          stiffness: spring.stiffness,\n          damping: spring.damping,\n        })\n\n        scaleSpring.subscribe(() => {\n          currentScale = scaleSpring!.get()\n          onPinch?.(createState(e, false, false))\n        })\n\n        scaleSpring.set(targetScale)\n      }\n\n      onPinchEnd?.(createState(e, false, true))\n    }\n  }\n\n  element.addEventListener('touchstart', handleTouchStart, { passive: false })\n  element.addEventListener('touchmove', handleTouchMove, { passive: false })\n  element.addEventListener('touchend', handleTouchEnd)\n  element.addEventListener('touchcancel', handleTouchEnd)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('touchstart', handleTouchStart)\n      element.removeEventListener('touchmove', handleTouchMove)\n      element.removeEventListener('touchend', handleTouchEnd)\n      element.removeEventListener('touchcancel', handleTouchEnd)\n      scaleSpring?.destroy()\n    },\n  }\n}\n\n// ============ Rotate Gesture ============\n\n/**\n * Create rotate gesture handler\n *\n * @example\n * ```ts\n * const rotate = createRotateGesture(element, {\n *   onRotate: (state) => {\n *     element.style.transform = `rotate(${state.angle}deg)`\n *   },\n * })\n * ```\n */\nexport function createRotateGesture(\n  element: HTMLElement,\n  config: RotateConfig = {}\n): GestureController {\n  const {\n    enabled: initialEnabled = true,\n    threshold = 0,\n    onRotate,\n    onRotateStart,\n    onRotateEnd,\n  } = config\n\n  let enabled = initialEnabled\n  let active = false\n  let initialAngle = 0\n  let currentAngle = 0\n  let lastAngle = 0\n  let velocity = 0\n  let startTime = 0\n  let lastTime = 0\n  let angleOffset = 0\n\n  const touches = new Map<number, Point>()\n\n  const createState = (event: TouchEvent, first = false, last = false): RotateState => {\n    const touchArray = Array.from(touches.values())\n    const p1 = touchArray[0] ?? { x: 0, y: 0 }\n    const p2 = touchArray[1] ?? { x: 0, y: 0 }\n    const origin = touchArray.length >= 2 ? getCenter(p1, p2) : { x: 0, y: 0 }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: performance.now() - startTime,\n      cancelled: false,\n      angle: currentAngle,\n      velocity,\n      initialAngle,\n      origin,\n      movement: currentAngle - initialAngle,\n      offset: angleOffset,\n    }\n  }\n\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!enabled) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n    }\n\n    if (touches.size === 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      initialAngle = getAngle(p1, p2)\n      startTime = performance.now()\n      lastTime = startTime\n      lastAngle = currentAngle\n      active = true\n\n      onRotateStart?.(createState(e, true, false))\n    }\n  }\n\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!enabled || !active) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      if (touches.has(touch.identifier)) {\n        touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n      }\n    }\n\n    if (touches.size >= 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      const newAngle = getAngle(p1, p2)\n      const now = performance.now()\n      const dt = now - lastTime\n\n      // Calculate angle delta (handle wrap-around)\n      let angleDelta = newAngle - initialAngle\n      if (angleDelta > 180) angleDelta -= 360\n      if (angleDelta < -180) angleDelta += 360\n\n      // Apply threshold\n      if (Math.abs(angleDelta) >= threshold) {\n        currentAngle = angleOffset + angleDelta\n\n        // Calculate velocity\n        velocity = dt > 0 ? ((currentAngle - lastAngle) / dt) * 1000 : 0\n        lastAngle = currentAngle\n        lastTime = now\n\n        onRotate?.(createState(e, false, false))\n      }\n\n      e.preventDefault()\n    }\n  }\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.delete(touch.identifier)\n    }\n\n    if (active && touches.size < 2) {\n      active = false\n      angleOffset = currentAngle\n      onRotateEnd?.(createState(e, false, true))\n    }\n  }\n\n  element.addEventListener('touchstart', handleTouchStart, { passive: false })\n  element.addEventListener('touchmove', handleTouchMove, { passive: false })\n  element.addEventListener('touchend', handleTouchEnd)\n  element.addEventListener('touchcancel', handleTouchEnd)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('touchstart', handleTouchStart)\n      element.removeEventListener('touchmove', handleTouchMove)\n      element.removeEventListener('touchend', handleTouchEnd)\n      element.removeEventListener('touchcancel', handleTouchEnd)\n    },\n  }\n}\n\n// ============ Swipe Gesture ============\n\n/**\n * Create swipe gesture handler\n *\n * @example\n * ```ts\n * const swipe = createSwipeGesture(element, {\n *   onSwipe: (state) => {\n *     if (state.direction === 'left') {\n *       goToNextSlide()\n *     }\n *   },\n * })\n * ```\n */\nexport function createSwipeGesture(\n  element: HTMLElement,\n  config: SwipeConfig = {}\n): GestureController {\n  const {\n    velocityThreshold = 0.5,\n    distanceThreshold = 50,\n    maxDuration = 300,\n    axis = 'both',\n    onSwipe,\n    onSwipeStart,\n    onSwipeEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let startPoint: Point = { x: 0, y: 0 }\n  let lastPoint: Point = { x: 0, y: 0 }\n  let startTime = 0\n  let lastTime = 0\n  let pointerId: number | null = null\n\n  const createState = (\n    event: PointerEvent,\n    first = false,\n    last = false,\n    direction: SwipeState['direction'] = null\n  ): SwipeState => {\n    const now = performance.now()\n    const duration = now - startTime\n    const dt = now - lastTime\n\n    const movement = {\n      x: event.clientX - startPoint.x,\n      y: event.clientY - startPoint.y,\n    }\n\n    const velocity = {\n      x: dt > 0 ? (event.clientX - lastPoint.x) / dt : 0,\n      y: dt > 0 ? (event.clientY - lastPoint.y) / dt : 0,\n    }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: duration,\n      cancelled: false,\n      direction,\n      velocity,\n      distance: movement,\n      movement,\n      duration,\n    }\n  }\n\n  const detectDirection = (movement: Point, velocity: Point): SwipeState['direction'] => {\n    const absX = Math.abs(movement.x)\n    const absY = Math.abs(movement.y)\n    const velX = Math.abs(velocity.x)\n    const velY = Math.abs(velocity.y)\n\n    // Check if meets thresholds\n    const meetsDistanceX = absX >= distanceThreshold\n    const meetsDistanceY = absY >= distanceThreshold\n    const meetsVelocityX = velX >= velocityThreshold\n    const meetsVelocityY = velY >= velocityThreshold\n\n    // Determine primary direction based on axis constraint\n    if (axis === 'x' || (axis === 'both' && absX > absY)) {\n      if ((meetsDistanceX || meetsVelocityX)) {\n        return movement.x > 0 ? 'right' : 'left'\n      }\n    }\n\n    if (axis === 'y' || (axis === 'both' && absY > absX)) {\n      if ((meetsDistanceY || meetsVelocityY)) {\n        return movement.y > 0 ? 'down' : 'up'\n      }\n    }\n\n    return null\n  }\n\n  const handlePointerDown = (e: PointerEvent) => {\n    if (!enabled || pointerId !== null) return\n\n    pointerId = e.pointerId\n    startPoint = { x: e.clientX, y: e.clientY }\n    lastPoint = { ...startPoint }\n    startTime = performance.now()\n    lastTime = startTime\n    active = true\n\n    element.setPointerCapture(e.pointerId)\n    onSwipeStart?.(createState(e, true, false))\n  }\n\n  const handlePointerMove = (e: PointerEvent) => {\n    if (!enabled || !active || e.pointerId !== pointerId) return\n\n    const now = performance.now()\n    lastPoint = { x: e.clientX, y: e.clientY }\n    lastTime = now\n  }\n\n  const handlePointerUp = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    active = false\n    pointerId = null\n\n    const duration = performance.now() - startTime\n\n    // Only detect swipe if within max duration\n    if (duration <= maxDuration) {\n      const movement = {\n        x: e.clientX - startPoint.x,\n        y: e.clientY - startPoint.y,\n      }\n      const dt = performance.now() - lastTime\n      const velocity = {\n        x: dt > 0 ? (e.clientX - lastPoint.x) / dt : 0,\n        y: dt > 0 ? (e.clientY - lastPoint.y) / dt : 0,\n      }\n\n      const direction = detectDirection(movement, velocity)\n      const state = createState(e, false, true, direction)\n\n      if (direction) {\n        onSwipe?.(state)\n      }\n      onSwipeEnd?.(state)\n    } else {\n      onSwipeEnd?.(createState(e, false, true, null))\n    }\n\n    element.releasePointerCapture(e.pointerId)\n  }\n\n  element.addEventListener('pointerdown', handlePointerDown)\n  element.addEventListener('pointermove', handlePointerMove)\n  element.addEventListener('pointerup', handlePointerUp)\n  element.addEventListener('pointercancel', handlePointerUp)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('pointerdown', handlePointerDown)\n      element.removeEventListener('pointermove', handlePointerMove)\n      element.removeEventListener('pointerup', handlePointerUp)\n      element.removeEventListener('pointercancel', handlePointerUp)\n    },\n  }\n}\n\n// ============ Long Press Gesture ============\n\n/**\n * Create long press gesture handler\n *\n * @example\n * ```ts\n * const longPress = createLongPressGesture(element, {\n *   threshold: 500,\n *   onLongPress: (state) => {\n *     showContextMenu(state.position)\n *   },\n * })\n * ```\n */\nexport function createLongPressGesture(\n  element: HTMLElement,\n  config: LongPressConfig = {}\n): GestureController {\n  const {\n    threshold = 500,\n    movementTolerance = 10,\n    onLongPress,\n    onPressStart,\n    onPressEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let triggered = false\n  let startPoint: Point = { x: 0, y: 0 }\n  let startTime = 0\n  let timerId: ReturnType<typeof setTimeout> | null = null\n  let pointerId: number | null = null\n\n  const createState = (event: PointerEvent, first = false, last = false): LongPressState => ({\n    active,\n    first,\n    last,\n    event,\n    elapsedTime: performance.now() - startTime,\n    cancelled: false,\n    position: startPoint,\n    duration: performance.now() - startTime,\n    triggered,\n  })\n\n  const handlePointerDown = (e: PointerEvent) => {\n    if (!enabled || pointerId !== null) return\n\n    pointerId = e.pointerId\n    startPoint = { x: e.clientX, y: e.clientY }\n    startTime = performance.now()\n    active = true\n    triggered = false\n\n    element.setPointerCapture(e.pointerId)\n    onPressStart?.(createState(e, true, false))\n\n    // Start timer for long press\n    timerId = setTimeout(() => {\n      if (active && !triggered) {\n        triggered = true\n        onLongPress?.(createState(e, false, false))\n      }\n    }, threshold)\n  }\n\n  const handlePointerMove = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    // Check if moved beyond tolerance\n    const dx = e.clientX - startPoint.x\n    const dy = e.clientY - startPoint.y\n    const distance = Math.sqrt(dx * dx + dy * dy)\n\n    if (distance > movementTolerance) {\n      // Cancel long press\n      if (timerId) {\n        clearTimeout(timerId)\n        timerId = null\n      }\n    }\n  }\n\n  const handlePointerUp = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    active = false\n    pointerId = null\n\n    if (timerId) {\n      clearTimeout(timerId)\n      timerId = null\n    }\n\n    onPressEnd?.(createState(e, false, true))\n    element.releasePointerCapture(e.pointerId)\n  }\n\n  element.addEventListener('pointerdown', handlePointerDown)\n  element.addEventListener('pointermove', handlePointerMove)\n  element.addEventListener('pointerup', handlePointerUp)\n  element.addEventListener('pointercancel', handlePointerUp)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      if (timerId) clearTimeout(timerId)\n      element.removeEventListener('pointerdown', handlePointerDown)\n      element.removeEventListener('pointermove', handlePointerMove)\n      element.removeEventListener('pointerup', handlePointerUp)\n      element.removeEventListener('pointercancel', handlePointerUp)\n    },\n  }\n}\n\n// ============ Combined Gesture Handler ============\n\n/**\n * Create combined gesture handler for multiple gesture types\n *\n * @example\n * ```ts\n * const gestures = createGestures(element, {\n *   pinch: {\n *     onPinch: (state) => console.log('Scale:', state.scale),\n *   },\n *   rotate: {\n *     onRotate: (state) => console.log('Angle:', state.angle),\n *   },\n *   swipe: {\n *     onSwipe: (state) => console.log('Direction:', state.direction),\n *   },\n * })\n * ```\n */\nexport function createGestures(\n  element: HTMLElement,\n  config: GestureConfig\n): GestureController {\n  const controllers: GestureController[] = []\n\n  if (config.pinch) {\n    controllers.push(createPinchGesture(element, config.pinch))\n  }\n  if (config.rotate) {\n    controllers.push(createRotateGesture(element, config.rotate))\n  }\n  if (config.swipe) {\n    controllers.push(createSwipeGesture(element, config.swipe))\n  }\n  if (config.longPress) {\n    controllers.push(createLongPressGesture(element, config.longPress))\n  }\n\n  return {\n    enable: () => controllers.forEach(c => c.enable()),\n    disable: () => controllers.forEach(c => c.disable()),\n    isEnabled: () => controllers.every(c => c.isEnabled()),\n    destroy: () => controllers.forEach(c => c.destroy()),\n  }\n}\n","import type { SpringValue } from '../core/spring-value.js'\n\n/**\n * RGB color representation\n */\nexport interface RGB {\n  r: number\n  g: number\n  b: number\n}\n\n/**\n * HSL color representation\n */\nexport interface HSL {\n  h: number\n  s: number\n  l: number\n}\n\n/**\n * Parse a color string to RGB\n * Supports hex (#rgb, #rrggbb), rgb(), and named colors\n * @param color - The color string to parse\n * @returns The RGB representation\n */\nexport function parseColor(color: string): RGB {\n  // Try hex format first\n  const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\n  if (hexMatch) {\n    return hexToRgb(color)\n  }\n\n  // Try rgb() format\n  const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\n  if (rgbMatch) {\n    return {\n      r: parseInt(rgbMatch[1]!, 10),\n      g: parseInt(rgbMatch[2]!, 10),\n      b: parseInt(rgbMatch[3]!, 10),\n    }\n  }\n\n  // Try rgba() format\n  const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\n  if (rgbaMatch) {\n    return {\n      r: parseInt(rgbaMatch[1]!, 10),\n      g: parseInt(rgbaMatch[2]!, 10),\n      b: parseInt(rgbaMatch[3]!, 10),\n    }\n  }\n\n  // Try hsl() format\n  const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\n  if (hslMatch) {\n    return hslToRgb(\n      parseInt(hslMatch[1]!, 10),\n      parseInt(hslMatch[2]!, 10),\n      parseInt(hslMatch[3]!, 10)\n    )\n  }\n\n  // Default to black for unknown formats\n  return { r: 0, g: 0, b: 0 }\n}\n\n/**\n * Convert RGB to hex color string\n * @param r - Red component (0-255)\n * @param g - Green component (0-255)\n * @param b - Blue component (0-255)\n * @returns Hex color string\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const toHex = (n: number): string => {\n    const clamped = Math.round(Math.max(0, Math.min(255, n)))\n    return clamped.toString(16).padStart(2, '0')\n  }\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}`\n}\n\n/**\n * Convert hex color string to RGB\n * @param hex - Hex color string (with or without #)\n * @returns RGB representation\n */\nexport function hexToRgb(hex: string): RGB {\n  const cleanHex = hex.replace('#', '')\n\n  if (cleanHex.length === 3) {\n    return {\n      r: parseInt(cleanHex.charAt(0) + cleanHex.charAt(0), 16),\n      g: parseInt(cleanHex.charAt(1) + cleanHex.charAt(1), 16),\n      b: parseInt(cleanHex.charAt(2) + cleanHex.charAt(2), 16),\n    }\n  }\n\n  return {\n    r: parseInt(cleanHex.slice(0, 2), 16),\n    g: parseInt(cleanHex.slice(2, 4), 16),\n    b: parseInt(cleanHex.slice(4, 6), 16),\n  }\n}\n\n/**\n * Convert HSL to RGB\n * @param h - Hue (0-360)\n * @param s - Saturation (0-100)\n * @param l - Lightness (0-100)\n * @returns RGB representation\n */\nexport function hslToRgb(h: number, s: number, l: number): RGB {\n  h = ((h % 360) + 360) % 360\n  s = Math.max(0, Math.min(100, s)) / 100\n  l = Math.max(0, Math.min(100, l)) / 100\n\n  if (s === 0) {\n    const gray = Math.round(l * 255)\n    return { r: gray, g: gray, b: gray }\n  }\n\n  const hue2rgb = (p: number, q: number, t: number): number => {\n    if (t < 0) t += 1\n    if (t > 1) t -= 1\n    if (t < 1 / 6) return p + (q - p) * 6 * t\n    if (t < 1 / 2) return q\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n    return p\n  }\n\n  const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n  const p = 2 * l - q\n\n  return {\n    r: Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\n    g: Math.round(hue2rgb(p, q, h / 360) * 255),\n    b: Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\n  }\n}\n\n/**\n * Convert RGB to HSL\n * @param r - Red component (0-255)\n * @param g - Green component (0-255)\n * @param b - Blue component (0-255)\n * @returns HSL representation\n */\nexport function rgbToHsl(r: number, g: number, b: number): HSL {\n  r = Math.max(0, Math.min(255, r)) / 255\n  g = Math.max(0, Math.min(255, g)) / 255\n  b = Math.max(0, Math.min(255, b)) / 255\n\n  const max = Math.max(r, g, b)\n  const min = Math.min(r, g, b)\n  const delta = max - min\n\n  let h = 0\n  let s = 0\n\n  if (delta !== 0) {\n    s = (max + min) / 2 > 0.5\n      ? delta / (2 - max - min)\n      : delta / (max + min)\n\n    if (max === r) {\n      h = ((g - b) / delta + (g < b ? 6 : 0)) / 6\n    } else if (max === g) {\n      h = ((b - r) / delta + 2) / 6\n    } else {\n      h = ((r - g) / delta + 4) / 6\n    }\n  }\n\n  return {\n    h: Math.round(h * 360),\n    s: Math.round(s * 100),\n    l: Math.round(((max + min) / 2) * 100),\n  }\n}\n","/**\n * Scroll-linked animations - Bind animations directly to scroll position\n *\n * Unlike spring-based scroll animations, these animations are directly\n * tied to scroll progress (0-1) for precise control.\n */\n\nimport { clamp, lerp } from '../utils/math.js'\nimport { parseColor, rgbToHex } from '../utils/color.js'\n\n/**\n * Simple color lerp for scroll-linked animations\n */\nfunction lerpColor(colorA: string, colorB: string, t: number): string {\n  const a = parseColor(colorA)\n  const b = parseColor(colorB)\n  return rgbToHex(\n    Math.round(lerp(a.r, b.r, t)),\n    Math.round(lerp(a.g, b.g, t)),\n    Math.round(lerp(a.b, b.b, t))\n  )\n}\n\n/**\n * Scroll progress info passed to callbacks\n */\nexport interface ScrollInfo {\n  /** Progress from 0 to 1 */\n  progress: number\n  /** Absolute scroll position in pixels */\n  scrollY: number\n  /** Scroll velocity in pixels per second */\n  velocity: number\n  /** Scroll direction: 1 = down, -1 = up, 0 = stationary */\n  direction: -1 | 0 | 1\n  /** Whether element is in viewport */\n  isInView: boolean\n  /** How much of the element is visible (0-1) */\n  visibleRatio: number\n}\n\n/**\n * Scroll trigger configuration\n */\nexport interface ScrollTriggerConfig {\n  /** Start trigger position: 'top', 'center', 'bottom', or pixel value */\n  start?: 'top' | 'center' | 'bottom' | number\n  /** End trigger position: 'top', 'center', 'bottom', or pixel value */\n  end?: 'top' | 'center' | 'bottom' | number\n  /** Offset from start position in pixels */\n  startOffset?: number\n  /** Offset from end position in pixels */\n  endOffset?: number\n  /** Callback when entering viewport */\n  onEnter?: (info: ScrollInfo) => void\n  /** Callback when leaving viewport */\n  onLeave?: (info: ScrollInfo) => void\n  /** Callback on progress update */\n  onProgress?: (info: ScrollInfo) => void\n  /** Only trigger once */\n  once?: boolean\n  /** Scrub animation to scroll (true = instant, number = smoothing factor) */\n  scrub?: boolean | number\n}\n\n/**\n * Parallax configuration\n */\nexport interface ParallaxConfig {\n  /** Speed multiplier (negative = opposite direction) */\n  speed?: number\n  /** Direction of parallax effect */\n  direction?: 'vertical' | 'horizontal'\n  /** Easing function */\n  easing?: (t: number) => number\n  /** Root margin for intersection observer */\n  rootMargin?: string\n}\n\n/**\n * Scroll-linked value configuration\n */\nexport interface ScrollLinkedConfig {\n  /** Input range (scroll positions or progress values) */\n  inputRange: number[]\n  /** Output range (values to interpolate between) */\n  outputRange: (number | string)[]\n  /** Clamp output to range */\n  clamp?: boolean\n  /** Use smooth interpolation */\n  smooth?: number\n  /** Easing function */\n  easing?: (t: number) => number\n}\n\n/**\n * Scroll progress tracker\n */\nexport interface ScrollProgress {\n  /** Get current progress (0-1) */\n  get(): number\n  /** Get current scroll info */\n  getInfo(): ScrollInfo\n  /** Subscribe to progress changes */\n  subscribe(callback: (info: ScrollInfo) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Parallax controller\n */\nexport interface Parallax {\n  /** Get current offset */\n  getOffset(): number\n  /** Update parallax (call on scroll) */\n  update(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Scroll trigger controller\n */\nexport interface ScrollTrigger {\n  /** Check if currently active */\n  isActive(): boolean\n  /** Get current progress within trigger range */\n  getProgress(): number\n  /** Refresh trigger calculations */\n  refresh(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Scroll-linked value controller\n */\nexport interface ScrollLinkedValue {\n  /** Get current interpolated value */\n  get(): number | string\n  /** Subscribe to value changes */\n  subscribe(callback: (value: number | string) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Implementation ============\n\n/**\n * Create scroll progress tracker for an element\n */\nexport function createScrollProgress(\n  element?: HTMLElement | null,\n  options: {\n    offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\n    smooth?: number\n  } = {}\n): ScrollProgress {\n  const { offset = ['start', 'end'], smooth = 0 } = options\n\n  let progress = 0\n  let smoothedProgress = 0\n  let lastScrollY = 0\n  let lastTime = performance.now()\n  let velocity = 0\n  let direction: -1 | 0 | 1 = 0\n  let rafId: number | null = null\n  const subscribers = new Set<(info: ScrollInfo) => void>()\n\n  const calculateProgress = (): ScrollInfo => {\n    const scrollY = window.scrollY\n    const windowHeight = window.innerHeight\n    const now = performance.now()\n    const dt = Math.max(now - lastTime, 1)\n\n    // Calculate velocity and direction\n    velocity = ((scrollY - lastScrollY) / dt) * 1000\n    direction = scrollY > lastScrollY ? 1 : scrollY < lastScrollY ? -1 : 0\n    lastScrollY = scrollY\n    lastTime = now\n\n    let newProgress: number\n    let isInView = true\n    let visibleRatio = 1\n\n    if (element) {\n      const rect = element.getBoundingClientRect()\n      const elementTop = rect.top + scrollY\n      const elementHeight = rect.height\n\n      // Calculate start and end points based on offset\n      const startPoint = offset[0] === 'start' ? elementTop :\n                        offset[0] === 'center' ? elementTop + elementHeight / 2 :\n                        elementTop + elementHeight\n\n      const endPoint = offset[1] === 'start' ? windowHeight :\n                      offset[1] === 'center' ? windowHeight / 2 :\n                      0\n\n      const scrollStart = startPoint - windowHeight\n      const scrollEnd = startPoint - endPoint\n\n      newProgress = clamp((scrollY - scrollStart) / (scrollEnd - scrollStart), 0, 1)\n\n      // Check if in view\n      isInView = rect.top < windowHeight && rect.bottom > 0\n      visibleRatio = isInView ?\n        clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0\n    } else {\n      // Track overall page scroll\n      const documentHeight = document.documentElement.scrollHeight - windowHeight\n      newProgress = documentHeight > 0 ? clamp(scrollY / documentHeight, 0, 1) : 0\n    }\n\n    // Apply smoothing\n    if (smooth > 0) {\n      smoothedProgress = lerp(smoothedProgress, newProgress, 1 - smooth)\n      progress = smoothedProgress\n    } else {\n      progress = newProgress\n    }\n\n    return {\n      progress,\n      scrollY,\n      velocity,\n      direction,\n      isInView,\n      visibleRatio,\n    }\n  }\n\n  const notify = (info: ScrollInfo) => {\n    subscribers.forEach(cb => cb(info))\n  }\n\n  const onScroll = () => {\n    if (rafId) return\n    rafId = requestAnimationFrame(() => {\n      rafId = null\n      const info = calculateProgress()\n      notify(info)\n    })\n  }\n\n  // Initial calculation\n  const initialInfo = calculateProgress()\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n  window.addEventListener('resize', onScroll, { passive: true })\n\n  return {\n    get: () => progress,\n    getInfo: () => calculateProgress(),\n    subscribe: (callback) => {\n      subscribers.add(callback)\n      callback(initialInfo)\n      return () => subscribers.delete(callback)\n    },\n    destroy: () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      window.removeEventListener('scroll', onScroll)\n      window.removeEventListener('resize', onScroll)\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Create parallax effect for an element\n *\n * @example\n * ```ts\n * const parallax = createParallax(element, { speed: 0.5 })\n * // Element moves at 50% scroll speed\n * ```\n */\nexport function createParallax(\n  element: HTMLElement,\n  config: ParallaxConfig = {}\n): Parallax {\n  const {\n    speed = 0.5,\n    direction = 'vertical',\n    easing = (t: number) => t,\n    rootMargin = '0px',\n  } = config\n\n  let offset = 0\n  let isInView = false\n  let observer: IntersectionObserver | null = null\n\n  const update = () => {\n    if (!isInView) return\n\n    const rect = element.getBoundingClientRect()\n    const windowHeight = window.innerHeight\n\n    // Calculate how far through the viewport the element is\n    const elementCenter = rect.top + rect.height / 2\n    const viewportCenter = windowHeight / 2\n    const distanceFromCenter = elementCenter - viewportCenter\n\n    // Apply speed and easing\n    const normalizedDistance = distanceFromCenter / windowHeight\n    const easedDistance = easing(Math.abs(normalizedDistance)) * Math.sign(normalizedDistance)\n    offset = easedDistance * speed * 100\n\n    // Apply transform\n    if (direction === 'vertical') {\n      element.style.transform = `translate3d(0, ${offset}px, 0)`\n    } else {\n      element.style.transform = `translate3d(${offset}px, 0, 0)`\n    }\n  }\n\n  // Use IntersectionObserver for performance\n  observer = new IntersectionObserver(\n    (entries) => {\n      const entry = entries[0]\n      if (entry) {\n        isInView = entry.isIntersecting\n        if (isInView) update()\n      }\n    },\n    { rootMargin }\n  )\n  observer.observe(element)\n\n  const onScroll = () => {\n    if (isInView) {\n      requestAnimationFrame(update)\n    }\n  }\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n\n  return {\n    getOffset: () => offset,\n    update,\n    destroy: () => {\n      observer?.disconnect()\n      window.removeEventListener('scroll', onScroll)\n      element.style.transform = ''\n    },\n  }\n}\n\n/**\n * Create scroll trigger for precise scroll-based animations\n *\n * @example\n * ```ts\n * const trigger = createScrollTrigger(element, {\n *   start: 'top',\n *   end: 'bottom',\n *   onProgress: (info) => {\n *     element.style.opacity = String(info.progress)\n *   },\n * })\n * ```\n */\nexport function createScrollTrigger(\n  element: HTMLElement,\n  config: ScrollTriggerConfig = {}\n): ScrollTrigger {\n  const {\n    start = 'top',\n    end = 'bottom',\n    startOffset = 0,\n    endOffset = 0,\n    onEnter,\n    onLeave,\n    onProgress,\n    once = false,\n    scrub = false,\n  } = config\n\n  let isActive = false\n  let progress = 0\n  let hasEntered = false\n  let smoothedProgress = 0\n  let rafId: number | null = null\n\n  const getPosition = (pos: 'top' | 'center' | 'bottom' | number, rect: DOMRect): number => {\n    if (typeof pos === 'number') return pos\n    switch (pos) {\n      case 'top': return rect.top\n      case 'center': return rect.top + rect.height / 2\n      case 'bottom': return rect.bottom\n    }\n  }\n\n  const calculateProgress = (): ScrollInfo => {\n    const rect = element.getBoundingClientRect()\n    const windowHeight = window.innerHeight\n\n    const startPos = getPosition(start, rect) + startOffset\n    const endPos = getPosition(end, rect) + endOffset\n\n    // Calculate progress based on viewport position\n    const triggerStart = windowHeight\n    const triggerEnd = 0\n\n    const startProgress = (triggerStart - startPos) / (triggerStart - triggerEnd)\n    const endProgress = (triggerStart - endPos) / (triggerStart - triggerEnd)\n\n    const rawProgress = clamp(startProgress / (endProgress || 1), 0, 1)\n\n    // Apply scrub smoothing\n    if (typeof scrub === 'number' && scrub > 0) {\n      smoothedProgress = lerp(smoothedProgress, rawProgress, 1 - scrub)\n      progress = smoothedProgress\n    } else {\n      progress = rawProgress\n    }\n\n    const isInView = rect.top < windowHeight && rect.bottom > 0\n    const nowActive = progress > 0 && progress < 1\n\n    return {\n      progress,\n      scrollY: window.scrollY,\n      velocity: 0,\n      direction: 0,\n      isInView,\n      visibleRatio: isInView ? clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0,\n    }\n  }\n\n  const onScroll = () => {\n    if (rafId) return\n    rafId = requestAnimationFrame(() => {\n      rafId = null\n      const info = calculateProgress()\n\n      // Check for enter/leave\n      const wasActive = isActive\n      isActive = info.progress > 0 && info.progress < 1\n\n      if (!wasActive && isActive && (!once || !hasEntered)) {\n        hasEntered = true\n        onEnter?.(info)\n      }\n\n      if (wasActive && !isActive) {\n        onLeave?.(info)\n      }\n\n      if (isActive || scrub) {\n        onProgress?.(info)\n      }\n    })\n  }\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n  window.addEventListener('resize', onScroll, { passive: true })\n\n  // Initial check\n  onScroll()\n\n  return {\n    isActive: () => isActive,\n    getProgress: () => progress,\n    refresh: () => {\n      calculateProgress()\n    },\n    destroy: () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      window.removeEventListener('scroll', onScroll)\n      window.removeEventListener('resize', onScroll)\n    },\n  }\n}\n\n/**\n * Create a scroll-linked interpolated value\n *\n * @example\n * ```ts\n * const opacity = createScrollLinkedValue(scrollProgress, {\n *   inputRange: [0, 0.5, 1],\n *   outputRange: [0, 1, 0],\n * })\n *\n * opacity.subscribe((value) => {\n *   element.style.opacity = String(value)\n * })\n * ```\n */\nexport function createScrollLinkedValue(\n  scrollProgress: ScrollProgress,\n  config: ScrollLinkedConfig\n): ScrollLinkedValue {\n  const { inputRange, outputRange, clamp: shouldClamp = true, easing } = config\n\n  if (inputRange.length !== outputRange.length) {\n    throw new Error('inputRange and outputRange must have the same length')\n  }\n\n  const firstOutput = outputRange[0]\n  const isColorOutput = typeof firstOutput === 'string' &&\n    (firstOutput.startsWith('#') || firstOutput.startsWith('rgb') || firstOutput.startsWith('hsl'))\n\n  let currentValue: number | string = firstOutput ?? 0\n  const subscribers = new Set<(value: number | string) => void>()\n\n  const interpolate = (progress: number): number | string => {\n    let p = progress\n    if (easing) p = easing(p)\n    const firstInput = inputRange[0] ?? 0\n    const lastInput = inputRange[inputRange.length - 1] ?? 1\n    if (shouldClamp) p = clamp(p, firstInput, lastInput)\n\n    // Find the segment\n    let segmentIndex = 0\n    for (let i = 0; i < inputRange.length - 1; i++) {\n      const curr = inputRange[i] ?? 0\n      const next = inputRange[i + 1] ?? 1\n      if (p >= curr && p <= next) {\n        segmentIndex = i\n        break\n      }\n      if (p > next) {\n        segmentIndex = i + 1\n      }\n    }\n\n    const segmentStart = inputRange[segmentIndex] ?? 0\n    const segmentEnd = inputRange[segmentIndex + 1] ?? segmentStart\n    const segmentProgress = segmentEnd !== segmentStart\n      ? (p - segmentStart) / (segmentEnd - segmentStart)\n      : 0\n\n    const startValue = outputRange[segmentIndex] ?? 0\n    const endValue = outputRange[segmentIndex + 1] ?? startValue\n\n    if (isColorOutput && typeof startValue === 'string' && typeof endValue === 'string') {\n      return lerpColor(startValue, endValue, segmentProgress)\n    }\n\n    return lerp(startValue as number, endValue as number, segmentProgress)\n  }\n\n  const unsubscribe = scrollProgress.subscribe((info) => {\n    currentValue = interpolate(info.progress)\n    subscribers.forEach(cb => cb(currentValue))\n  })\n\n  return {\n    get: () => currentValue,\n    subscribe: (callback) => {\n      subscribers.add(callback)\n      callback(currentValue)\n      return () => subscribers.delete(callback)\n    },\n    destroy: () => {\n      unsubscribe()\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Easing functions for scroll-linked animations\n */\nexport const scrollEasings = {\n  linear: (t: number) => t,\n  easeIn: (t: number) => t * t,\n  easeOut: (t: number) => t * (2 - t),\n  easeInOut: (t: number) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n  easeInCubic: (t: number) => t * t * t,\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\n  easeInOutCubic: (t: number) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n  easeInQuart: (t: number) => t * t * t * t,\n  easeOutQuart: (t: number) => 1 - (--t) * t * t * t,\n  easeInOutQuart: (t: number) => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t,\n}\n","/**\n * Timeline API - GSAP-inspired animation sequencing with spring physics\n *\n * Create complex, coordinated animations with precise control over\n * timing, sequencing, and playback.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Animation target - can be element, selector, or values object\n */\nexport type TimelineTarget = HTMLElement | string | Record<string, number>\n\n/**\n * Animation values (numeric properties to animate)\n */\nexport interface TimelineValues {\n  [key: string]: number | undefined\n}\n\n/**\n * Timeline animation options\n */\nexport interface TimelineOptions {\n  /** Animation duration override (not used with springs, but for timing) */\n  duration?: number\n  /** Delay before animation starts */\n  delay?: number\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Easing function (for non-spring animations) */\n  ease?: (t: number) => number\n  /** Callback when animation starts */\n  onStart?: () => void\n  /** Callback on each update */\n  onUpdate?: (progress: number) => void\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Animation properties - combines values with options\n */\nexport type TimelineProps = TimelineValues & TimelineOptions\n\n/**\n * Position in timeline - can be absolute, relative, or label\n */\nexport type TimelinePosition = number | string | `+=${number}` | `-=${number}` | `<` | `>`\n\n/**\n * Timeline segment representing a single animation\n */\ninterface TimelineSegment {\n  id: string\n  target: TimelineTarget\n  props: TimelineProps\n  startTime: number\n  endTime: number\n  spring: SpringGroup<Record<string, number>> | null\n  isActive: boolean\n  isComplete: boolean\n}\n\n/**\n * Timeline configuration\n */\nexport interface TimelineConfig {\n  /** Default spring configuration for all animations */\n  defaults?: SpringConfig\n  /** Whether to autoplay on creation */\n  autoplay?: boolean\n  /** Repeat count (-1 = infinite) */\n  repeat?: number\n  /** Yoyo (reverse on repeat) */\n  yoyo?: boolean\n  /** Delay between repeats */\n  repeatDelay?: number\n  /** Callback when timeline starts */\n  onStart?: () => void\n  /** Callback on each frame */\n  onUpdate?: (progress: number) => void\n  /** Callback when timeline completes */\n  onComplete?: () => void\n  /** Callback on repeat */\n  onRepeat?: (iteration: number) => void\n}\n\n/**\n * Timeline controller interface\n */\nexport interface Timeline {\n  /** Add animation to end of timeline */\n  to(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add animation from initial values */\n  from(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add animation from/to values */\n  fromTo(target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add a label at current position */\n  addLabel(label: string, position?: TimelinePosition): Timeline\n  /** Add a callback at position */\n  call(callback: () => void, position?: TimelinePosition): Timeline\n  /** Set properties instantly (no animation) */\n  set(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add pause at position */\n  addPause(position?: TimelinePosition, callback?: () => void): Timeline\n\n  /** Play timeline */\n  play(): Timeline\n  /** Pause timeline */\n  pause(): Timeline\n  /** Resume from pause */\n  resume(): Timeline\n  /** Reverse timeline */\n  reverse(): Timeline\n  /** Restart timeline */\n  restart(): Timeline\n  /** Seek to position */\n  seek(position: number | string): Timeline\n  /** Kill timeline and cleanup */\n  kill(): void\n\n  /** Get current time */\n  time(): number\n  /** Get total duration */\n  duration(): number\n  /** Get current progress (0-1) */\n  progress(): number\n  /** Check if playing */\n  isPlaying(): boolean\n  /** Check if reversed */\n  isReversed(): boolean\n\n  /** Get timeline by ID */\n  getById(id: string): TimelineSegment | undefined\n}\n\n// ============ Implementation ============\n\nlet timelineIdCounter = 0\n\n/**\n * Create a new timeline\n *\n * @example\n * ```ts\n * const tl = createTimeline()\n *   .to(element, { x: 100, opacity: 1 })\n *   .to(element, { y: 50 }, '+=0.2')\n *   .to(element, { scale: 1.2 }, '<')\n *\n * tl.play()\n * ```\n */\nexport function createTimeline(config: TimelineConfig = {}): Timeline {\n  const {\n    defaults = {},\n    autoplay = false,\n    repeat = 0,\n    yoyo = false,\n    repeatDelay = 0,\n    onStart,\n    onUpdate,\n    onComplete,\n    onRepeat,\n  } = config\n\n  const segments: TimelineSegment[] = []\n  const labels = new Map<string, number>()\n  const callbacks = new Map<number, (() => void)[]>()\n  const pauses = new Map<number, (() => void) | undefined>()\n\n  let currentTime = 0\n  let totalDuration = 0\n  let isPlaying = false\n  let isReversed = false\n  let isPaused = false\n  let repeatCount = 0\n  let rafId: number | null = null\n  let lastFrameTime = 0\n  let hasStarted = false\n  let insertTime = 0\n\n  // ============ Utility Functions ============\n\n  const parsePosition = (position?: TimelinePosition): number => {\n    if (position === undefined) {\n      return insertTime\n    }\n\n    if (typeof position === 'number') {\n      return position\n    }\n\n    // Relative to previous animation\n    if (position === '<') {\n      const lastSegment = segments[segments.length - 1]\n      return lastSegment ? lastSegment.startTime : 0\n    }\n\n    if (position === '>') {\n      return insertTime\n    }\n\n    // Relative offset\n    if (position.startsWith('+=')) {\n      return insertTime + parseFloat(position.slice(2))\n    }\n\n    if (position.startsWith('-=')) {\n      return insertTime - parseFloat(position.slice(2))\n    }\n\n    // Label reference\n    if (labels.has(position)) {\n      return labels.get(position)!\n    }\n\n    // Label with offset\n    const labelMatch = position.match(/^([a-zA-Z_]\\w*)([+-]=?\\d*\\.?\\d+)?$/)\n    if (labelMatch) {\n      const labelName = labelMatch[1]\n      const offset = labelMatch[2]\n      const labelTime = labelName ? (labels.get(labelName) ?? 0) : 0\n      if (offset) {\n        const offsetValue = parseFloat(offset.replace('=', ''))\n        return labelTime + offsetValue\n      }\n      return labelTime\n    }\n\n    return insertTime\n  }\n\n  const resolveTarget = (target: TimelineTarget): HTMLElement | null => {\n    if (typeof target === 'string') {\n      return document.querySelector(target)\n    }\n    if (target instanceof HTMLElement) {\n      return target\n    }\n    return null\n  }\n\n  const extractNumericProps = (props: TimelineProps): Record<string, number> => {\n    const result: Record<string, number> = {}\n    for (const [key, value] of Object.entries(props)) {\n      if (typeof value === 'number' && !['duration', 'delay'].includes(key)) {\n        result[key] = value\n      }\n    }\n    return result\n  }\n\n  const applyPropsToElement = (element: HTMLElement, props: Record<string, number>) => {\n    const transforms: string[] = []\n    const cssProps: Record<string, string> = {}\n\n    for (const [key, value] of Object.entries(props)) {\n      switch (key) {\n        case 'x':\n          transforms.push(`translateX(${value}px)`)\n          break\n        case 'y':\n          transforms.push(`translateY(${value}px)`)\n          break\n        case 'z':\n          transforms.push(`translateZ(${value}px)`)\n          break\n        case 'scale':\n          transforms.push(`scale(${value})`)\n          break\n        case 'scaleX':\n          transforms.push(`scaleX(${value})`)\n          break\n        case 'scaleY':\n          transforms.push(`scaleY(${value})`)\n          break\n        case 'rotate':\n        case 'rotation':\n          transforms.push(`rotate(${value}deg)`)\n          break\n        case 'rotateX':\n          transforms.push(`rotateX(${value}deg)`)\n          break\n        case 'rotateY':\n          transforms.push(`rotateY(${value}deg)`)\n          break\n        case 'rotateZ':\n          transforms.push(`rotateZ(${value}deg)`)\n          break\n        case 'skewX':\n          transforms.push(`skewX(${value}deg)`)\n          break\n        case 'skewY':\n          transforms.push(`skewY(${value}deg)`)\n          break\n        case 'opacity':\n          cssProps.opacity = String(value)\n          break\n        default:\n          // Assume pixels for numeric values\n          cssProps[key] = typeof value === 'number' ? `${value}px` : String(value)\n      }\n    }\n\n    if (transforms.length > 0) {\n      element.style.transform = transforms.join(' ')\n    }\n\n    for (const [prop, val] of Object.entries(cssProps)) {\n      ;(element.style as unknown as Record<string, string>)[prop] = val\n    }\n  }\n\n  const getCurrentElementValues = (element: HTMLElement, props: Record<string, number>): Record<string, number> => {\n    const current: Record<string, number> = {}\n    const computed = getComputedStyle(element)\n\n    for (const key of Object.keys(props)) {\n      switch (key) {\n        case 'opacity':\n          current[key] = parseFloat(computed.opacity) || 1\n          break\n        case 'x':\n        case 'y':\n        case 'z':\n        case 'scale':\n        case 'scaleX':\n        case 'scaleY':\n        case 'rotate':\n        case 'rotation':\n        case 'rotateX':\n        case 'rotateY':\n        case 'rotateZ':\n        case 'skewX':\n        case 'skewY':\n          // Parse from transform matrix - simplified, defaults to 0 or 1\n          current[key] = key.startsWith('scale') ? 1 : 0\n          break\n        default:\n          current[key] = parseFloat(computed.getPropertyValue(key)) || 0\n      }\n    }\n\n    return current\n  }\n\n  // ============ Animation Loop ============\n\n  const tick = (timestamp: number) => {\n    if (!isPlaying || isPaused) return\n\n    const deltaTime = lastFrameTime ? (timestamp - lastFrameTime) / 1000 : 0\n    lastFrameTime = timestamp\n\n    // Update time\n    currentTime += isReversed ? -deltaTime : deltaTime\n    currentTime = clamp(currentTime, 0, totalDuration)\n\n    // Check for callbacks\n    const callbacksAtTime = callbacks.get(Math.floor(currentTime * 1000))\n    if (callbacksAtTime) {\n      callbacksAtTime.forEach(cb => cb())\n    }\n\n    // Check for pauses\n    const pauseCallback = pauses.get(Math.floor(currentTime * 1000))\n    if (pauseCallback !== undefined) {\n      isPaused = true\n      pauseCallback?.()\n      return\n    }\n\n    // Update segments\n    for (const segment of segments) {\n      const segmentProgress = clamp(\n        (currentTime - segment.startTime) / (segment.endTime - segment.startTime),\n        0,\n        1\n      )\n\n      const shouldBeActive = currentTime >= segment.startTime && currentTime <= segment.endTime\n\n      if (shouldBeActive && !segment.isActive) {\n        segment.isActive = true\n        segment.props.onStart?.()\n      }\n\n      if (segment.isActive && segment.spring) {\n        segment.props.onUpdate?.(segmentProgress)\n      }\n\n      if (shouldBeActive && segmentProgress >= 1 && !segment.isComplete) {\n        segment.isComplete = true\n        segment.props.onComplete?.()\n      }\n    }\n\n    onUpdate?.(currentTime / totalDuration)\n\n    // Check for completion\n    if ((isReversed && currentTime <= 0) || (!isReversed && currentTime >= totalDuration)) {\n      if (repeat === -1 || repeatCount < repeat) {\n        repeatCount++\n        onRepeat?.(repeatCount)\n\n        if (yoyo) {\n          isReversed = !isReversed\n        } else {\n          currentTime = 0\n          segments.forEach(s => {\n            s.isActive = false\n            s.isComplete = false\n          })\n        }\n\n        if (repeatDelay > 0) {\n          setTimeout(() => {\n            rafId = requestAnimationFrame(tick)\n          }, repeatDelay * 1000)\n          return\n        }\n      } else {\n        isPlaying = false\n        onComplete?.()\n        return\n      }\n    }\n\n    rafId = requestAnimationFrame(tick)\n  }\n\n  // ============ Public API ============\n\n  const timeline: Timeline = {\n    to(target, props, position) {\n      const startTime = parsePosition(position) + (props.delay || 0)\n      const duration = props.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const numericProps = extractNumericProps(props)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(numericProps).length > 0) {\n        const currentValues = getCurrentElementValues(element, numericProps)\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\n\n        segment.spring = createSpringGroup(currentValues, springConfig)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        // Set target values when segment becomes active\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(numericProps)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    from(target, props, position) {\n      const startTime = parsePosition(position) + (props.delay || 0)\n      const duration = props.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const numericProps = extractNumericProps(props)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(numericProps).length > 0) {\n        const targetValues = getCurrentElementValues(element, numericProps)\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\n\n        // Start from props, animate to current\n        segment.spring = createSpringGroup(numericProps, springConfig)\n        applyPropsToElement(element, numericProps)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(targetValues)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    fromTo(target, fromProps, toProps, position) {\n      const startTime = parsePosition(position) + (toProps.delay || 0)\n      const duration = toProps.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const fromNumeric = extractNumericProps(fromProps)\n      const toNumeric = extractNumericProps(toProps)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props: toProps,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(toNumeric).length > 0) {\n        const springConfig: SpringConfig = { ...defaults, ...toProps.spring }\n\n        segment.spring = createSpringGroup(fromNumeric, springConfig)\n        applyPropsToElement(element, fromNumeric)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(toNumeric)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    addLabel(label, position) {\n      const time = parsePosition(position)\n      labels.set(label, time)\n      return timeline\n    },\n\n    call(callback, position) {\n      const time = Math.floor(parsePosition(position) * 1000)\n      if (!callbacks.has(time)) {\n        callbacks.set(time, [])\n      }\n      callbacks.get(time)!.push(callback)\n      return timeline\n    },\n\n    set(target, props, position) {\n      const element = resolveTarget(target)\n      if (element) {\n        const time = parsePosition(position)\n        this.call(() => {\n          applyPropsToElement(element, extractNumericProps(props))\n        }, time)\n      }\n      return timeline\n    },\n\n    addPause(position, callback) {\n      const time = Math.floor(parsePosition(position) * 1000)\n      pauses.set(time, callback)\n      return timeline\n    },\n\n    play() {\n      if (!hasStarted) {\n        hasStarted = true\n        onStart?.()\n      }\n      isPlaying = true\n      isPaused = false\n      lastFrameTime = 0\n      rafId = requestAnimationFrame(tick)\n      return timeline\n    },\n\n    pause() {\n      isPaused = true\n      if (rafId) {\n        cancelAnimationFrame(rafId)\n        rafId = null\n      }\n      return timeline\n    },\n\n    resume() {\n      if (isPaused) {\n        isPaused = false\n        lastFrameTime = 0\n        rafId = requestAnimationFrame(tick)\n      }\n      return timeline\n    },\n\n    reverse() {\n      isReversed = !isReversed\n      return timeline\n    },\n\n    restart() {\n      currentTime = isReversed ? totalDuration : 0\n      repeatCount = 0\n      hasStarted = false\n      segments.forEach(s => {\n        s.isActive = false\n        s.isComplete = false\n      })\n      return this.play()\n    },\n\n    seek(position) {\n      if (typeof position === 'string') {\n        currentTime = labels.get(position) ?? 0\n      } else {\n        currentTime = clamp(position, 0, totalDuration)\n      }\n      return timeline\n    },\n\n    kill() {\n      isPlaying = false\n      if (rafId) {\n        cancelAnimationFrame(rafId)\n        rafId = null\n      }\n      segments.forEach(s => s.spring?.destroy())\n      segments.length = 0\n      labels.clear()\n      callbacks.clear()\n      pauses.clear()\n    },\n\n    time: () => currentTime,\n    duration: () => totalDuration,\n    progress: () => totalDuration > 0 ? currentTime / totalDuration : 0,\n    isPlaying: () => isPlaying && !isPaused,\n    isReversed: () => isReversed,\n\n    getById(id) {\n      return segments.find(s => s.id === id)\n    },\n  }\n\n  if (autoplay) {\n    timeline.play()\n  }\n\n  return timeline\n}\n\n/**\n * Create a simple tween (single animation)\n */\nexport function tween(\n  target: TimelineTarget,\n  props: TimelineProps\n): Timeline {\n  return createTimeline().to(target, props).play()\n}\n\n/**\n * Create a timeline that animates all targets simultaneously\n */\nexport function allTo(\n  targets: TimelineTarget[],\n  props: TimelineProps\n): Timeline {\n  const tl = createTimeline()\n  targets.forEach((target, i) => {\n    tl.to(target, props, i === 0 ? 0 : '<')\n  })\n  return tl.play()\n}\n","/**\n * SVG Morphing - Smooth path shape interpolation with spring physics\n *\n * Enables morphing between SVG paths with automatic path normalization\n * and spring-based animation.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { lerp, clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * SVG path command types\n */\ntype CommandType = 'M' | 'L' | 'C' | 'Q' | 'A' | 'Z' | 'H' | 'V' | 'S' | 'T'\n\n/**\n * Parsed path command\n */\ninterface PathCommand {\n  type: CommandType\n  values: number[]\n}\n\n/**\n * Normalized point with control points\n */\ninterface NormalizedPoint {\n  x: number\n  y: number\n  cp1x?: number\n  cp1y?: number\n  cp2x?: number\n  cp2y?: number\n}\n\n/**\n * Morph configuration\n */\nexport interface MorphConfig {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Number of samples for path normalization (higher = smoother) */\n  samples?: number\n  /** Callback on progress update */\n  onProgress?: (progress: number) => void\n  /** Callback when morph completes */\n  onComplete?: () => void\n}\n\n/**\n * Morph controller interface\n */\nexport interface MorphController {\n  /** Get current morphed path */\n  getPath(): string\n  /** Get current progress (0-1) */\n  getProgress(): number\n  /** Morph to a new path */\n  morphTo(path: string): void\n  /** Set progress directly (0-1) */\n  setProgress(progress: number): void\n  /** Subscribe to path changes */\n  subscribe(callback: (path: string) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Path Parsing ============\n\n/**\n * Parse SVG path string into commands\n */\nfunction parsePath(d: string): PathCommand[] {\n  const commands: PathCommand[] = []\n  const regex = /([MLCQAZHVST])([^MLCQAZHVST]*)/gi\n\n  let match: RegExpMatchArray | null\n  // Use matchAll instead of regex.exec for safer iteration\n  const matches = d.matchAll(regex)\n\n  for (const matchItem of matches) {\n    const typeChar = matchItem[1]\n    const valuesStr = matchItem[2]\n    if (!typeChar || valuesStr === undefined) continue\n\n    const type = typeChar.toUpperCase() as CommandType\n    const values = valuesStr\n      .trim()\n      .split(/[\\s,]+/)\n      .filter(v => v !== '')\n      .map(parseFloat)\n      .filter(v => !isNaN(v))\n\n    commands.push({ type, values })\n  }\n\n  return commands\n}\n\n/**\n * Convert path commands to absolute coordinates\n */\nfunction toAbsolute(commands: PathCommand[]): PathCommand[] {\n  let currentX = 0\n  let currentY = 0\n  let startX = 0\n  let startY = 0\n\n  return commands.map(cmd => {\n    const { type, values } = cmd\n    const absValues = [...values]\n\n    switch (type) {\n      case 'M':\n        currentX = values[0] ?? 0\n        currentY = values[1] ?? 0\n        startX = currentX\n        startY = currentY\n        break\n\n      case 'L':\n        currentX = values[0] ?? 0\n        currentY = values[1] ?? 0\n        break\n\n      case 'H':\n        absValues[0] = values[0] ?? 0\n        currentX = values[0] ?? 0\n        break\n\n      case 'V':\n        absValues[0] = values[0] ?? 0\n        currentY = values[0] ?? 0\n        break\n\n      case 'C':\n        currentX = values[4] ?? 0\n        currentY = values[5] ?? 0\n        break\n\n      case 'Q':\n        currentX = values[2] ?? 0\n        currentY = values[3] ?? 0\n        break\n\n      case 'A':\n        currentX = values[5] ?? 0\n        currentY = values[6] ?? 0\n        break\n\n      case 'Z':\n        currentX = startX\n        currentY = startY\n        break\n    }\n\n    return { type, values: absValues }\n  })\n}\n\n/**\n * Sample points along a path at regular intervals\n */\nfunction samplePath(commands: PathCommand[], samples: number): NormalizedPoint[] {\n  const points: NormalizedPoint[] = []\n\n  // Check if we're in browser\n  if (typeof document === 'undefined') {\n    // Server-side fallback - simple linear sampling\n    for (const cmd of commands) {\n      if (cmd.type === 'M' || cmd.type === 'L') {\n        points.push({ x: cmd.values[0] ?? 0, y: cmd.values[1] ?? 0 })\n      } else if (cmd.type === 'C') {\n        points.push({\n          x: cmd.values[4] ?? 0,\n          y: cmd.values[5] ?? 0,\n          cp1x: cmd.values[0] ?? 0,\n          cp1y: cmd.values[1] ?? 0,\n          cp2x: cmd.values[2] ?? 0,\n          cp2y: cmd.values[3] ?? 0,\n        })\n      }\n    }\n    return points\n  }\n\n  const svgNS = 'http://www.w3.org/2000/svg'\n  const svg = document.createElementNS(svgNS, 'svg')\n  const path = document.createElementNS(svgNS, 'path')\n\n  // Build path string\n  let d = ''\n  for (const cmd of commands) {\n    d += cmd.type + cmd.values.join(' ')\n  }\n  path.setAttribute('d', d)\n  svg.appendChild(path)\n  document.body.appendChild(svg)\n\n  try {\n    const totalLength = path.getTotalLength()\n    const step = totalLength / (samples - 1)\n\n    for (let i = 0; i < samples; i++) {\n      const point = path.getPointAtLength(i * step)\n      points.push({ x: point.x, y: point.y })\n    }\n  } finally {\n    document.body.removeChild(svg)\n  }\n\n  return points\n}\n\n/**\n * Interpolate between two points\n */\nfunction interpolatePoint(p1: NormalizedPoint, p2: NormalizedPoint, t: number): NormalizedPoint {\n  return {\n    x: lerp(p1.x, p2.x, t),\n    y: lerp(p1.y, p2.y, t),\n  }\n}\n\n/**\n * Convert normalized points back to path string\n */\nfunction pointsToPath(points: NormalizedPoint[]): string {\n  if (points.length === 0) return ''\n\n  const firstPoint = points[0]!\n  let d = `M ${firstPoint.x} ${firstPoint.y}`\n\n  for (let i = 1; i < points.length; i++) {\n    const point = points[i]!\n    d += ` L ${point.x} ${point.y}`\n  }\n\n  return d\n}\n\n// ============ Morph Implementation ============\n\n/**\n * Create SVG path morph controller\n *\n * @example\n * ```ts\n * const morph = createMorph(circlePath, {\n *   spring: { stiffness: 120, damping: 14 },\n *   onProgress: (p) => console.log('Progress:', p),\n * })\n *\n * morph.subscribe((path) => {\n *   element.setAttribute('d', path)\n * })\n *\n * morph.morphTo(starPath)\n * ```\n */\nexport function createMorph(\n  initialPath: string,\n  config: MorphConfig = {}\n): MorphController {\n  const {\n    spring: springConfig = { stiffness: 120, damping: 14 },\n    samples = 100,\n    onProgress,\n    onComplete,\n  } = config\n\n  let currentPath = initialPath\n  let fromPoints: NormalizedPoint[] = []\n  let toPoints: NormalizedPoint[] = []\n  let currentPoints: NormalizedPoint[] = []\n\n  const subscribers = new Set<(path: string) => void>()\n\n  // Parse initial path\n  const initialCommands = parsePath(initialPath)\n  fromPoints = samplePath(toAbsolute(initialCommands), samples)\n  currentPoints = [...fromPoints]\n  toPoints = [...fromPoints]\n\n  // Create spring for progress\n  const progressSpring = createSpringValue(0, springConfig)\n\n  progressSpring.subscribe(() => {\n    const progress = progressSpring.get()\n    onProgress?.(progress)\n\n    // Interpolate points\n    currentPoints = fromPoints.map((from, i) =>\n      interpolatePoint(from, toPoints[i] ?? from, progress)\n    )\n\n    currentPath = pointsToPath(currentPoints)\n    subscribers.forEach(cb => cb(currentPath))\n\n    if (progress >= 0.999) {\n      onComplete?.()\n    }\n  })\n\n  return {\n    getPath: () => currentPath,\n    getProgress: () => progressSpring.get(),\n\n    morphTo(path: string) {\n      // Normalize paths\n      const targetCommands = parsePath(path)\n      const targetPoints = samplePath(toAbsolute(targetCommands), samples)\n\n      fromPoints = [...currentPoints]\n      toPoints = targetPoints\n\n      // Ensure same number of points\n      while (fromPoints.length < toPoints.length) {\n        fromPoints.push(fromPoints[fromPoints.length - 1] || { x: 0, y: 0 })\n      }\n      while (toPoints.length < fromPoints.length) {\n        toPoints.push(toPoints[toPoints.length - 1] || { x: 0, y: 0 })\n      }\n\n      // Reset and animate\n      progressSpring.jump(0)\n      progressSpring.set(1)\n    },\n\n    setProgress(progress: number) {\n      const p = clamp(progress, 0, 1)\n      progressSpring.jump(p)\n\n      currentPoints = fromPoints.map((from, i) =>\n        interpolatePoint(from, toPoints[i] ?? from, p)\n      )\n\n      currentPath = pointsToPath(currentPoints)\n      subscribers.forEach(cb => cb(currentPath))\n    },\n\n    subscribe(callback) {\n      subscribers.add(callback)\n      callback(currentPath)\n      return () => subscribers.delete(callback)\n    },\n\n    destroy() {\n      progressSpring.destroy()\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Create a morph between multiple paths (morphing sequence)\n *\n * @example\n * ```ts\n * const sequence = createMorphSequence([\n *   circlePath,\n *   squarePath,\n *   starPath,\n * ])\n *\n * sequence.subscribe((path) => {\n *   element.setAttribute('d', path)\n * })\n *\n * sequence.morphToIndex(2) // Morph to star\n * ```\n */\nexport function createMorphSequence(\n  paths: string[],\n  config: MorphConfig = {}\n): {\n  getPath(): string\n  getCurrentIndex(): number\n  morphToIndex(index: number): void\n  morphToNext(): void\n  morphToPrevious(): void\n  subscribe(callback: (path: string) => void): () => void\n  destroy(): void\n} {\n  if (paths.length === 0) {\n    throw new Error('At least one path is required')\n  }\n\n  let currentIndex = 0\n  const firstPath = paths[0]!\n  const morph = createMorph(firstPath, config)\n\n  return {\n    getPath: () => morph.getPath(),\n    getCurrentIndex: () => currentIndex,\n\n    morphToIndex(index: number) {\n      const targetIndex = clamp(index, 0, paths.length - 1)\n      if (targetIndex !== currentIndex) {\n        currentIndex = targetIndex\n        const targetPath = paths[targetIndex]!\n        morph.morphTo(targetPath)\n      }\n    },\n\n    morphToNext() {\n      this.morphToIndex((currentIndex + 1) % paths.length)\n    },\n\n    morphToPrevious() {\n      this.morphToIndex((currentIndex - 1 + paths.length) % paths.length)\n    },\n\n    subscribe: (callback) => morph.subscribe(callback),\n    destroy: () => morph.destroy(),\n  }\n}\n\n// ============ Preset Shapes ============\n\n/**\n * Generate common SVG shape paths\n */\nexport const shapes = {\n  /**\n   * Generate circle path\n   */\n  circle(cx: number, cy: number, r: number): string {\n    return `M ${cx - r} ${cy}\n            A ${r} ${r} 0 1 1 ${cx + r} ${cy}\n            A ${r} ${r} 0 1 1 ${cx - r} ${cy}`\n  },\n\n  /**\n   * Generate rectangle path\n   */\n  rect(x: number, y: number, width: number, height: number, rx = 0): string {\n    if (rx === 0) {\n      return `M ${x} ${y}\n              L ${x + width} ${y}\n              L ${x + width} ${y + height}\n              L ${x} ${y + height}\n              Z`\n    }\n\n    return `M ${x + rx} ${y}\n            L ${x + width - rx} ${y}\n            Q ${x + width} ${y} ${x + width} ${y + rx}\n            L ${x + width} ${y + height - rx}\n            Q ${x + width} ${y + height} ${x + width - rx} ${y + height}\n            L ${x + rx} ${y + height}\n            Q ${x} ${y + height} ${x} ${y + height - rx}\n            L ${x} ${y + rx}\n            Q ${x} ${y} ${x + rx} ${y}\n            Z`\n  },\n\n  /**\n   * Generate polygon path\n   */\n  polygon(cx: number, cy: number, r: number, sides: number): string {\n    const points: string[] = []\n\n    for (let i = 0; i < sides; i++) {\n      const angle = (i / sides) * Math.PI * 2 - Math.PI / 2\n      const x = cx + r * Math.cos(angle)\n      const y = cy + r * Math.sin(angle)\n      points.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\n    }\n\n    return points.join(' ') + ' Z'\n  },\n\n  /**\n   * Generate star path\n   */\n  star(cx: number, cy: number, outerR: number, innerR: number, points: number): string {\n    const path: string[] = []\n    const step = Math.PI / points\n\n    for (let i = 0; i < points * 2; i++) {\n      const r = i % 2 === 0 ? outerR : innerR\n      const angle = i * step - Math.PI / 2\n      const x = cx + r * Math.cos(angle)\n      const y = cy + r * Math.sin(angle)\n      path.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\n    }\n\n    return path.join(' ') + ' Z'\n  },\n\n  /**\n   * Generate heart path\n   */\n  heart(cx: number, cy: number, size: number): string {\n    const d = size / 4\n    return `M ${cx} ${cy + d}\n            C ${cx} ${cy} ${cx - 2 * d} ${cy} ${cx - 2 * d} ${cy - d}\n            C ${cx - 2 * d} ${cy - 2 * d} ${cx} ${cy - 2 * d} ${cx} ${cy - d}\n            C ${cx} ${cy - 2 * d} ${cx + 2 * d} ${cy - 2 * d} ${cx + 2 * d} ${cy - d}\n            C ${cx + 2 * d} ${cy} ${cx} ${cy} ${cx} ${cy + d}\n            Z`\n  },\n\n  /**\n   * Generate arrow path\n   */\n  arrow(x: number, y: number, width: number, height: number, direction: 'up' | 'down' | 'left' | 'right' = 'right'): string {\n    const hw = width / 2\n    const hh = height / 2\n\n    switch (direction) {\n      case 'right':\n        return `M ${x} ${y - hh} L ${x + width} ${y} L ${x} ${y + hh} Z`\n      case 'left':\n        return `M ${x + width} ${y - hh} L ${x} ${y} L ${x + width} ${y + hh} Z`\n      case 'up':\n        return `M ${x - hw} ${y + height} L ${x} ${y} L ${x + hw} ${y + height} Z`\n      case 'down':\n        return `M ${x - hw} ${y} L ${x} ${y + height} L ${x + hw} ${y} Z`\n    }\n  },\n}\n","/**\n * Shared Layout Animations - Cross-component FLIP animations with layoutId\n *\n * Enables smooth transitions between components that share the same layoutId,\n * similar to Framer Motion's layout animations.\n */\n\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Element measurement for FLIP\n */\nexport interface LayoutMeasurement {\n  x: number\n  y: number\n  width: number\n  height: number\n  opacity?: number\n  borderRadius?: number\n  scaleX?: number\n  scaleY?: number\n}\n\n/**\n * Shared layout element info\n */\ninterface SharedLayoutElement {\n  id: string\n  element: HTMLElement\n  measurement: LayoutMeasurement\n  spring: SpringGroup<Record<string, number>> | null\n  isAnimating: boolean\n}\n\n/**\n * Layout animation configuration\n */\nexport interface LayoutAnimationConfig {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Duration hint for spring (optional) */\n  duration?: number\n  /** Callback when animation starts */\n  onAnimationStart?: (id: string) => void\n  /** Callback when animation completes */\n  onAnimationComplete?: (id: string) => void\n  /** Enable crossfade during transition */\n  crossfade?: boolean\n  /** Custom transition properties */\n  transition?: {\n    x?: SpringConfig\n    y?: SpringConfig\n    width?: SpringConfig\n    height?: SpringConfig\n    opacity?: SpringConfig\n    borderRadius?: SpringConfig\n  }\n}\n\n/**\n * Layout group for managing shared elements\n */\nexport interface LayoutGroup {\n  /** Register element with layoutId */\n  register(id: string, element: HTMLElement): void\n  /** Unregister element */\n  unregister(id: string, element: HTMLElement): void\n  /** Update layout (call after DOM changes) */\n  update(): void\n  /** Force re-measure all elements */\n  forceUpdate(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Shared layout context for cross-component animations\n */\nexport interface SharedLayoutContext {\n  /** Register a layout group */\n  createGroup(id?: string): LayoutGroup\n  /** Get group by id */\n  getGroup(id: string): LayoutGroup | undefined\n  /** Update all groups */\n  updateAll(): void\n  /** Destroy all groups */\n  destroy(): void\n}\n\n// ============ Measurement Utilities ============\n\n/**\n * Measure element position and size\n */\nfunction measureElement(element: HTMLElement): LayoutMeasurement {\n  const rect = element.getBoundingClientRect()\n  const styles = getComputedStyle(element)\n\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n    opacity: parseFloat(styles.opacity) || 1,\n    borderRadius: parseFloat(styles.borderRadius) || 0,\n    scaleX: 1,\n    scaleY: 1,\n  }\n}\n\n/**\n * Apply FLIP transform to element\n */\nfunction applyTransform(\n  element: HTMLElement,\n  from: LayoutMeasurement,\n  to: LayoutMeasurement,\n  current: Record<string, number>\n): void {\n  // Calculate deltas\n  const dx = current.x !== undefined ? from.x - to.x + (current.x - from.x) : 0\n  const dy = current.y !== undefined ? from.y - to.y + (current.y - from.y) : 0\n  const scaleX = current.width !== undefined ? current.width / to.width : 1\n  const scaleY = current.height !== undefined ? current.height / to.height : 1\n\n  // Apply transform\n  element.style.transform = `translate(${dx}px, ${dy}px) scale(${scaleX}, ${scaleY})`\n  element.style.transformOrigin = 'top left'\n\n  // Apply opacity if transitioning\n  if (current.opacity !== undefined) {\n    element.style.opacity = String(current.opacity)\n  }\n\n  // Apply border radius (scale-compensated)\n  if (current.borderRadius !== undefined) {\n    const compensatedRadius = current.borderRadius / Math.max(scaleX, scaleY)\n    element.style.borderRadius = `${compensatedRadius}px`\n  }\n}\n\n/**\n * Reset element transform\n */\nfunction resetTransform(element: HTMLElement): void {\n  element.style.transform = ''\n  element.style.transformOrigin = ''\n  element.style.opacity = ''\n  element.style.borderRadius = ''\n}\n\n// ============ Layout Group Implementation ============\n\n/**\n * Create a layout group for managing shared layout elements\n *\n * @example\n * ```ts\n * const group = createLayoutGroup({\n *   spring: { stiffness: 300, damping: 30 },\n * })\n *\n * // Register elements with same layoutId\n * group.register('card-1', cardElement)\n *\n * // After DOM changes\n * group.update()\n * ```\n */\nexport function createLayoutGroup(config: LayoutAnimationConfig = {}): LayoutGroup {\n  const {\n    spring: defaultSpring = { stiffness: 300, damping: 30 },\n    onAnimationStart,\n    onAnimationComplete,\n    crossfade = false,\n    transition = {},\n  } = config\n\n  const elements = new Map<string, SharedLayoutElement[]>()\n  const previousMeasurements = new Map<string, LayoutMeasurement>()\n\n  const register = (id: string, element: HTMLElement): void => {\n    if (!elements.has(id)) {\n      elements.set(id, [])\n    }\n\n    const existing = elements.get(id)!\n    const alreadyRegistered = existing.some(e => e.element === element)\n\n    if (!alreadyRegistered) {\n      const measurement = measureElement(element)\n      existing.push({\n        id,\n        element,\n        measurement,\n        spring: null,\n        isAnimating: false,\n      })\n\n      // Store measurement for future animations\n      if (!previousMeasurements.has(id)) {\n        previousMeasurements.set(id, measurement)\n      }\n    }\n  }\n\n  const unregister = (id: string, element: HTMLElement): void => {\n    const group = elements.get(id)\n    if (!group) return\n\n    const index = group.findIndex(e => e.element === element)\n    if (index !== -1) {\n      const entry = group[index]!\n\n      // Store final measurement before removal\n      previousMeasurements.set(id, measureElement(element))\n\n      // Cleanup spring\n      entry.spring?.destroy()\n      group.splice(index, 1)\n\n      if (group.length === 0) {\n        elements.delete(id)\n      }\n    }\n  }\n\n  const animateElement = (\n    entry: SharedLayoutElement,\n    from: LayoutMeasurement,\n    to: LayoutMeasurement\n  ): void => {\n    // Cleanup previous animation\n    entry.spring?.destroy()\n\n    const springConfig = {\n      x: transition.x || defaultSpring,\n      y: transition.y || defaultSpring,\n      width: transition.width || defaultSpring,\n      height: transition.height || defaultSpring,\n      opacity: transition.opacity || defaultSpring,\n      borderRadius: transition.borderRadius || defaultSpring,\n    }\n\n    // Create spring with initial values\n    const initialValues: Record<string, number> = {\n      x: from.x,\n      y: from.y,\n      width: from.width,\n      height: from.height,\n    }\n\n    if (crossfade) {\n      initialValues.opacity = from.opacity ?? 1\n    }\n\n    if (from.borderRadius !== undefined) {\n      initialValues.borderRadius = from.borderRadius\n    }\n\n    entry.spring = createSpringGroup(initialValues, defaultSpring)\n    entry.isAnimating = true\n\n    onAnimationStart?.(entry.id)\n\n    entry.spring.subscribe((values: Record<string, number>) => {\n      applyTransform(entry.element, from, to, values)\n    })\n\n    // Set target values\n    const targetValues: Record<string, number> = {\n      x: to.x,\n      y: to.y,\n      width: to.width,\n      height: to.height,\n    }\n\n    if (crossfade) {\n      targetValues.opacity = to.opacity ?? 1\n    }\n\n    if (to.borderRadius !== undefined) {\n      targetValues.borderRadius = to.borderRadius\n    }\n\n    entry.spring.set(targetValues)\n\n    // Check for animation completion\n    const checkComplete = () => {\n      if (entry.spring && !entry.spring.isAnimating()) {\n        entry.isAnimating = false\n        resetTransform(entry.element)\n        onAnimationComplete?.(entry.id)\n      } else if (entry.isAnimating) {\n        requestAnimationFrame(checkComplete)\n      }\n    }\n\n    requestAnimationFrame(checkComplete)\n  }\n\n  const update = (): void => {\n    for (const [id, group] of elements) {\n      for (const entry of group) {\n        const previousMeasurement = previousMeasurements.get(id)\n        const currentMeasurement = measureElement(entry.element)\n\n        // Check if position/size changed\n        if (previousMeasurement) {\n          const hasChanged =\n            previousMeasurement.x !== currentMeasurement.x ||\n            previousMeasurement.y !== currentMeasurement.y ||\n            previousMeasurement.width !== currentMeasurement.width ||\n            previousMeasurement.height !== currentMeasurement.height\n\n          if (hasChanged) {\n            animateElement(entry, previousMeasurement, currentMeasurement)\n          }\n        }\n\n        // Update stored measurement\n        entry.measurement = currentMeasurement\n        previousMeasurements.set(id, currentMeasurement)\n      }\n    }\n  }\n\n  const forceUpdate = (): void => {\n    // Re-measure all elements\n    for (const [id, group] of elements) {\n      for (const entry of group) {\n        entry.measurement = measureElement(entry.element)\n        previousMeasurements.set(id, entry.measurement)\n      }\n    }\n  }\n\n  const destroy = (): void => {\n    for (const group of elements.values()) {\n      for (const entry of group) {\n        entry.spring?.destroy()\n        resetTransform(entry.element)\n      }\n    }\n    elements.clear()\n    previousMeasurements.clear()\n  }\n\n  return {\n    register,\n    unregister,\n    update,\n    forceUpdate,\n    destroy,\n  }\n}\n\n// ============ Shared Layout Context ============\n\nlet groupIdCounter = 0\n\n/**\n * Create a shared layout context for managing multiple layout groups\n *\n * @example\n * ```ts\n * const context = createSharedLayoutContext()\n *\n * // Create groups for different animation contexts\n * const listGroup = context.createGroup('list')\n * const cardGroup = context.createGroup('cards')\n *\n * // Register elements\n * listGroup.register('item-1', element1)\n * cardGroup.register('card-1', element2)\n *\n * // After route change or DOM update\n * context.updateAll()\n * ```\n */\nexport function createSharedLayoutContext(): SharedLayoutContext {\n  const groups = new Map<string, LayoutGroup>()\n\n  return {\n    createGroup(id?: string) {\n      const groupId = id ?? `layout-group-${groupIdCounter++}`\n      const group = createLayoutGroup()\n      groups.set(groupId, group)\n      return group\n    },\n\n    getGroup(id: string) {\n      return groups.get(id)\n    },\n\n    updateAll() {\n      for (const group of groups.values()) {\n        group.update()\n      }\n    },\n\n    destroy() {\n      for (const group of groups.values()) {\n        group.destroy()\n      }\n      groups.clear()\n    },\n  }\n}\n\n// ============ Auto Layout Observer ============\n\n/**\n * Configuration for auto layout observer\n */\nexport interface AutoLayoutConfig extends LayoutAnimationConfig {\n  /** Root element to observe (default: document.body) */\n  root?: HTMLElement\n  /** Attribute name for layout ID (default: 'data-layout-id') */\n  attribute?: string\n  /** Debounce time for mutations (ms) */\n  debounce?: number\n}\n\n/**\n * Create auto layout observer that automatically animates\n * elements with layoutId attribute\n *\n * @example\n * ```html\n * <div data-layout-id=\"card-1\">Content</div>\n * ```\n *\n * ```ts\n * const observer = createAutoLayout({\n *   spring: { stiffness: 200, damping: 20 },\n * })\n *\n * // Elements with data-layout-id will automatically animate\n * // when their position changes\n *\n * observer.destroy() // Cleanup when done\n * ```\n */\nexport function createAutoLayout(config: AutoLayoutConfig = {}): {\n  update(): void\n  forceUpdate(): void\n  destroy(): void\n} {\n  const {\n    root = typeof document !== 'undefined' ? document.body : null,\n    attribute = 'data-layout-id',\n    debounce: debounceTime = 0,\n    ...layoutConfig\n  } = config\n\n  if (!root) {\n    return {\n      update: () => {},\n      forceUpdate: () => {},\n      destroy: () => {},\n    }\n  }\n\n  const group = createLayoutGroup(layoutConfig)\n  let observer: MutationObserver | null = null\n  let resizeObserver: ResizeObserver | null = null\n  let debounceTimer: ReturnType<typeof setTimeout> | null = null\n\n  const scanAndRegister = () => {\n    const elements = root.querySelectorAll(`[${attribute}]`)\n    elements.forEach((el) => {\n      const id = el.getAttribute(attribute)\n      if (id && el instanceof HTMLElement) {\n        group.register(id, el)\n      }\n    })\n  }\n\n  const debouncedUpdate = () => {\n    if (debounceTimer) {\n      clearTimeout(debounceTimer)\n    }\n\n    if (debounceTime > 0) {\n      debounceTimer = setTimeout(() => {\n        scanAndRegister()\n        group.update()\n      }, debounceTime)\n    } else {\n      scanAndRegister()\n      group.update()\n    }\n  }\n\n  // Initial scan\n  scanAndRegister()\n\n  // Observe DOM changes\n  observer = new MutationObserver((mutations) => {\n    let shouldUpdate = false\n\n    for (const mutation of mutations) {\n      if (mutation.type === 'childList') {\n        // Check added nodes\n        mutation.addedNodes.forEach((node) => {\n          if (node instanceof HTMLElement) {\n            if (node.hasAttribute(attribute)) {\n              shouldUpdate = true\n            }\n            // Check descendants\n            if (node.querySelector(`[${attribute}]`)) {\n              shouldUpdate = true\n            }\n          }\n        })\n\n        // Check removed nodes\n        mutation.removedNodes.forEach((node) => {\n          if (node instanceof HTMLElement) {\n            const id = node.getAttribute(attribute)\n            if (id) {\n              group.unregister(id, node)\n            }\n          }\n        })\n      }\n\n      if (mutation.type === 'attributes' && mutation.attributeName === attribute) {\n        shouldUpdate = true\n      }\n    }\n\n    if (shouldUpdate) {\n      debouncedUpdate()\n    }\n  })\n\n  observer.observe(root, {\n    childList: true,\n    subtree: true,\n    attributes: true,\n    attributeFilter: [attribute],\n  })\n\n  // Observe resize changes\n  resizeObserver = new ResizeObserver(() => {\n    debouncedUpdate()\n  })\n\n  resizeObserver.observe(root)\n\n  return {\n    update: () => {\n      scanAndRegister()\n      group.update()\n    },\n\n    forceUpdate: () => {\n      scanAndRegister()\n      group.forceUpdate()\n    },\n\n    destroy: () => {\n      if (debounceTimer) {\n        clearTimeout(debounceTimer)\n      }\n      observer?.disconnect()\n      resizeObserver?.disconnect()\n      group.destroy()\n    },\n  }\n}\n","/**\n * Enhanced Stagger Patterns - Advanced staggering for complex animations\n *\n * Provides grid, spiral, wave, and custom stagger patterns for\n * sophisticated animation orchestration.\n */\n\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Stagger pattern configuration\n */\nexport interface StaggerPatternConfig {\n  /** Total number of items */\n  count: number\n  /** Base delay between items (seconds) */\n  delay?: number\n  /** Easing function for delay distribution */\n  easing?: (t: number) => number\n}\n\n/**\n * Grid stagger configuration\n */\nexport interface GridStaggerConfig extends StaggerPatternConfig {\n  /** Number of columns */\n  columns: number\n  /** Grid origin for stagger direction */\n  origin?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right' | 'center'\n  /** Direction of stagger flow */\n  direction?: 'row' | 'column' | 'diagonal' | 'radial'\n}\n\n/**\n * Wave stagger configuration\n */\nexport interface WaveStaggerConfig extends StaggerPatternConfig {\n  /** Wave direction */\n  direction?: 'horizontal' | 'vertical' | 'diagonal'\n  /** Wave frequency (number of waves) */\n  frequency?: number\n  /** Wave amplitude (affects delay variation) */\n  amplitude?: number\n}\n\n/**\n * Spiral stagger configuration\n */\nexport interface SpiralStaggerConfig extends StaggerPatternConfig {\n  /** Number of columns for grid layout */\n  columns: number\n  /** Spiral direction */\n  direction?: 'clockwise' | 'counter-clockwise'\n  /** Start from center or edge */\n  startFrom?: 'center' | 'edge'\n}\n\n/**\n * Random stagger configuration\n */\nexport interface RandomStaggerConfig extends StaggerPatternConfig {\n  /** Seed for reproducible randomness */\n  seed?: number\n  /** Minimum delay multiplier */\n  minMultiplier?: number\n  /** Maximum delay multiplier */\n  maxMultiplier?: number\n}\n\n/**\n * Custom stagger function\n */\nexport type CustomStaggerFn = (index: number, total: number) => number\n\n// ============ Utility Functions ============\n\n/**\n * Seeded random number generator for reproducible results\n */\nfunction seededRandom(seed: number): () => number {\n  let state = seed\n  return () => {\n    state = (state * 1103515245 + 12345) & 0x7fffffff\n    return state / 0x7fffffff\n  }\n}\n\n/**\n * Calculate distance from origin in a grid\n */\nfunction gridDistance(\n  index: number,\n  columns: number,\n  rows: number,\n  origin: GridStaggerConfig['origin']\n): number {\n  const col = index % columns\n  const row = Math.floor(index / columns)\n\n  let originCol: number\n  let originRow: number\n\n  switch (origin) {\n    case 'top-left':\n      originCol = 0\n      originRow = 0\n      break\n    case 'top-right':\n      originCol = columns - 1\n      originRow = 0\n      break\n    case 'bottom-left':\n      originCol = 0\n      originRow = rows - 1\n      break\n    case 'bottom-right':\n      originCol = columns - 1\n      originRow = rows - 1\n      break\n    case 'center':\n    default:\n      originCol = (columns - 1) / 2\n      originRow = (rows - 1) / 2\n      break\n  }\n\n  const dx = col - originCol\n  const dy = row - originRow\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\n// ============ Stagger Pattern Functions ============\n\n/**\n * Create linear stagger delays\n *\n * @example\n * ```ts\n * const delays = linearStagger({ count: 10, delay: 0.1 })\n * // [0, 0.1, 0.2, 0.3, ...]\n * ```\n */\nexport function linearStagger(config: StaggerPatternConfig): number[] {\n  const { count, delay = 0.1, easing = (t) => t } = config\n  const delays: number[] = []\n\n  for (let i = 0; i < count; i++) {\n    const t = count > 1 ? i / (count - 1) : 0\n    delays.push(easing(t) * delay * (count - 1))\n  }\n\n  return delays\n}\n\n/**\n * Create reverse stagger delays (last to first)\n */\nexport function reverseStagger(config: StaggerPatternConfig): number[] {\n  return linearStagger(config).reverse()\n}\n\n/**\n * Create center-out stagger delays\n *\n * @example\n * ```ts\n * const delays = centerStagger({ count: 5, delay: 0.1 })\n * // Center items animate first, edges last\n * ```\n */\nexport function centerStagger(config: StaggerPatternConfig): number[] {\n  const { count, delay = 0.1, easing = (t) => t } = config\n  const delays: number[] = []\n  const center = (count - 1) / 2\n\n  for (let i = 0; i < count; i++) {\n    const distanceFromCenter = Math.abs(i - center)\n    const maxDistance = center\n    const t = maxDistance > 0 ? distanceFromCenter / maxDistance : 0\n    delays.push(easing(t) * delay * maxDistance)\n  }\n\n  return delays\n}\n\n/**\n * Create edge-in stagger delays (edges first, center last)\n */\nexport function edgeStagger(config: StaggerPatternConfig): number[] {\n  const { count, delay = 0.1, easing = (t) => t } = config\n  const delays: number[] = []\n  const center = (count - 1) / 2\n  const maxDelay = delay * center\n\n  for (let i = 0; i < count; i++) {\n    const distanceFromCenter = Math.abs(i - center)\n    const maxDistance = center\n    const t = maxDistance > 0 ? 1 - distanceFromCenter / maxDistance : 0\n    delays.push(easing(t) * maxDelay)\n  }\n\n  return delays\n}\n\n/**\n * Create grid-based stagger delays\n *\n * @example\n * ```ts\n * const delays = gridStagger({\n *   count: 12,\n *   columns: 4,\n *   origin: 'center',\n *   direction: 'radial',\n *   delay: 0.05,\n * })\n * ```\n */\nexport function gridStagger(config: GridStaggerConfig): number[] {\n  const {\n    count,\n    columns,\n    origin = 'top-left',\n    direction = 'diagonal',\n    delay = 0.1,\n    easing = (t) => t,\n  } = config\n\n  const rows = Math.ceil(count / columns)\n  const delays: number[] = []\n\n  for (let i = 0; i < count; i++) {\n    const col = i % columns\n    const row = Math.floor(i / columns)\n\n    let t: number\n\n    switch (direction) {\n      case 'row':\n        // Row by row\n        t = row / Math.max(rows - 1, 1)\n        break\n\n      case 'column':\n        // Column by column\n        t = col / Math.max(columns - 1, 1)\n        break\n\n      case 'diagonal':\n        // Diagonal wave\n        t = (col + row) / (columns + rows - 2)\n        break\n\n      case 'radial':\n      default:\n        // Distance from origin\n        const maxDistance = gridDistance(\n          origin === 'center' ? 0 : count - 1,\n          columns,\n          rows,\n          origin === 'center' ? 'top-left' : origin\n        )\n        const distance = gridDistance(i, columns, rows, origin)\n        t = maxDistance > 0 ? distance / maxDistance : 0\n        break\n    }\n\n    delays.push(easing(clamp(t, 0, 1)) * delay * Math.max(columns, rows))\n  }\n\n  return delays\n}\n\n/**\n * Create wave-based stagger delays\n *\n * @example\n * ```ts\n * const delays = waveStagger({\n *   count: 20,\n *   direction: 'horizontal',\n *   frequency: 2,\n *   amplitude: 0.5,\n *   delay: 0.1,\n * })\n * ```\n */\nexport function waveStagger(config: WaveStaggerConfig): number[] {\n  const {\n    count,\n    direction = 'horizontal',\n    frequency = 1,\n    amplitude = 0.5,\n    delay = 0.1,\n    easing = (t) => t,\n  } = config\n\n  const delays: number[] = []\n\n  for (let i = 0; i < count; i++) {\n    const t = count > 1 ? i / (count - 1) : 0\n\n    // Base linear delay\n    let d = t\n\n    // Add wave modulation\n    const waveOffset = Math.sin(t * Math.PI * 2 * frequency) * amplitude\n\n    // Apply wave based on direction\n    switch (direction) {\n      case 'horizontal':\n        d = t + waveOffset * 0.5\n        break\n      case 'vertical':\n        d = t + Math.abs(waveOffset)\n        break\n      case 'diagonal':\n        d = t + waveOffset\n        break\n    }\n\n    delays.push(easing(clamp(d, 0, 1.5)) * delay * (count - 1))\n  }\n\n  return delays\n}\n\n/**\n * Create spiral stagger delays for grid layouts\n *\n * @example\n * ```ts\n * const delays = spiralStagger({\n *   count: 16,\n *   columns: 4,\n *   direction: 'clockwise',\n *   startFrom: 'edge',\n *   delay: 0.1,\n * })\n * ```\n */\nexport function spiralStagger(config: SpiralStaggerConfig): number[] {\n  const {\n    count,\n    columns,\n    direction = 'clockwise',\n    startFrom = 'edge',\n    delay = 0.1,\n    easing = (t) => t,\n  } = config\n\n  const rows = Math.ceil(count / columns)\n  const spiral: number[] = []\n  const visited = new Set<string>()\n\n  let top = 0\n  let bottom = rows - 1\n  let left = 0\n  let right = columns - 1\n\n  // Generate spiral order\n  while (top <= bottom && left <= right) {\n    // Top row\n    for (let col = left; col <= right; col++) {\n      const idx = top * columns + col\n      if (idx < count && !visited.has(`${top},${col}`)) {\n        spiral.push(idx)\n        visited.add(`${top},${col}`)\n      }\n    }\n    top++\n\n    // Right column\n    for (let row = top; row <= bottom; row++) {\n      const idx = row * columns + right\n      if (idx < count && !visited.has(`${row},${right}`)) {\n        spiral.push(idx)\n        visited.add(`${row},${right}`)\n      }\n    }\n    right--\n\n    // Bottom row\n    if (top <= bottom) {\n      for (let col = right; col >= left; col--) {\n        const idx = bottom * columns + col\n        if (idx < count && !visited.has(`${bottom},${col}`)) {\n          spiral.push(idx)\n          visited.add(`${bottom},${col}`)\n        }\n      }\n      bottom--\n    }\n\n    // Left column\n    if (left <= right) {\n      for (let row = bottom; row >= top; row--) {\n        const idx = row * columns + left\n        if (idx < count && !visited.has(`${row},${left}`)) {\n          spiral.push(idx)\n          visited.add(`${row},${left}`)\n        }\n      }\n      left++\n    }\n  }\n\n  // Reverse for center start or counter-clockwise\n  if (startFrom === 'center') {\n    spiral.reverse()\n  }\n  if (direction === 'counter-clockwise') {\n    spiral.reverse()\n  }\n\n  // Create delay array\n  const delays = new Array(count).fill(0)\n  const maxDelay = delay * (spiral.length - 1)\n\n  spiral.forEach((originalIndex, spiralPosition) => {\n    const t = spiral.length > 1 ? spiralPosition / (spiral.length - 1) : 0\n    delays[originalIndex] = easing(t) * maxDelay\n  })\n\n  return delays\n}\n\n/**\n * Create random stagger delays\n *\n * @example\n * ```ts\n * const delays = randomStagger({\n *   count: 10,\n *   seed: 12345, // Reproducible\n *   delay: 0.1,\n *   minMultiplier: 0,\n *   maxMultiplier: 1,\n * })\n * ```\n */\nexport function randomStagger(config: RandomStaggerConfig): number[] {\n  const {\n    count,\n    seed = Date.now(),\n    delay = 0.1,\n    minMultiplier = 0,\n    maxMultiplier = 1,\n    easing = (t) => t,\n  } = config\n\n  const random = seededRandom(seed)\n  const delays: number[] = []\n  const maxDelay = delay * (count - 1)\n\n  for (let i = 0; i < count; i++) {\n    const r = random()\n    const multiplier = minMultiplier + r * (maxMultiplier - minMultiplier)\n    delays.push(easing(multiplier) * maxDelay)\n  }\n\n  return delays\n}\n\n/**\n * Create custom stagger delays using a function\n *\n * @example\n * ```ts\n * const delays = customStagger({\n *   count: 10,\n *   delay: 0.1,\n * }, (index, total) => {\n *   // Custom pattern: faster in middle\n *   const center = (total - 1) / 2\n *   return 1 - Math.abs(index - center) / center\n * })\n * ```\n */\nexport function customStagger(\n  config: StaggerPatternConfig,\n  fn: CustomStaggerFn\n): number[] {\n  const { count, delay = 0.1 } = config\n  const delays: number[] = []\n  const maxDelay = delay * (count - 1)\n\n  for (let i = 0; i < count; i++) {\n    const t = fn(i, count)\n    delays.push(clamp(t, 0, 1) * maxDelay)\n  }\n\n  return delays\n}\n\n// ============ Stagger Utilities ============\n\n/**\n * Apply stagger delays to animation options\n *\n * @example\n * ```ts\n * const items = document.querySelectorAll('.item')\n * const delays = gridStagger({ count: items.length, columns: 4 })\n *\n * items.forEach((item, i) => {\n *   spring(item, { opacity: 1 }, { delay: delays[i] })\n * })\n * ```\n */\nexport function applyStagger<T extends { delay?: number }>(\n  options: T[],\n  delays: number[]\n): T[] {\n  return options.map((opt, i) => ({\n    ...opt,\n    delay: (opt.delay ?? 0) + (delays[i] ?? 0),\n  }))\n}\n\n/**\n * Stagger pattern presets\n */\nexport const staggerPresets = {\n  /** Quick cascade from first to last */\n  cascade: (count: number) => linearStagger({ count, delay: 0.05 }),\n\n  /** Slow reveal from first to last */\n  reveal: (count: number) => linearStagger({ count, delay: 0.15 }),\n\n  /** Pop from center outward */\n  pop: (count: number) => centerStagger({ count, delay: 0.08 }),\n\n  /** Ripple from edges to center */\n  ripple: (count: number) => edgeStagger({ count, delay: 0.08 }),\n\n  /** Random scatter effect */\n  scatter: (count: number) => randomStagger({ count, delay: 0.1, seed: 42 }),\n\n  /** Grid diagonal wave */\n  gridWave: (count: number, columns: number) =>\n    gridStagger({ count, columns, direction: 'diagonal', delay: 0.05 }),\n\n  /** Grid radial from center */\n  gridRadial: (count: number, columns: number) =>\n    gridStagger({ count, columns, origin: 'center', direction: 'radial', delay: 0.05 }),\n\n  /** Spiral inward */\n  spiralIn: (count: number, columns: number) =>\n    spiralStagger({ count, columns, startFrom: 'edge', delay: 0.05 }),\n\n  /** Spiral outward */\n  spiralOut: (count: number, columns: number) =>\n    spiralStagger({ count, columns, startFrom: 'center', delay: 0.05 }),\n}\n","/**\n * MotionValue - High-performance animated value without React re-renders\n *\n * Unlike React state, MotionValue updates don't trigger component re-renders.\n * This makes it ideal for high-frequency animations like drag, scroll, and gestures.\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n *\n * // Subscribe to changes (no React re-render)\n * x.on('change', (value) => {\n *   element.style.transform = `translateX(${value}px)`\n * })\n *\n * // Update value\n * x.set(100)  // Triggers spring animation\n * x.jump(100) // Instant update, no animation\n * ```\n */\n\nimport { createSpringValue } from './spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\nexport type MotionValueSubscriber<T> = (value: T) => void\nexport type MotionValueEvent = 'change' | 'animationStart' | 'animationEnd'\n\nexport interface MotionValueOptions {\n  /** Spring configuration for animated transitions */\n  spring?: SpringConfig\n}\n\n/**\n * MotionValue class - Performant animated values\n *\n * Key advantages over React state:\n * - No re-renders on value change\n * - Direct DOM manipulation for 60fps animations\n * - Chainable with useTransform\n * - Memory efficient with automatic cleanup\n */\nexport class MotionValue<T = number> {\n  private _value: T\n  private _velocity: number = 0\n  private _subscribers: Set<MotionValueSubscriber<T>> = new Set()\n  private _eventListeners: Map<MotionValueEvent, Set<() => void>> = new Map()\n  private _springValue: ReturnType<typeof createSpringValue> | null = null\n  private _springConfig: SpringConfig\n  private _isAnimating: boolean = false\n  private _destroyed: boolean = false\n\n  constructor(initialValue: T, options: MotionValueOptions = {}) {\n    this._value = initialValue\n    this._springConfig = options.spring ?? { stiffness: 100, damping: 15 }\n\n    // Initialize spring for numeric values\n    if (typeof initialValue === 'number') {\n      this._springValue = createSpringValue(initialValue as number, {\n        ...this._springConfig,\n        onUpdate: (v: number) => {\n          if (this._destroyed) return\n          this._value = v as T\n          this._velocity = this._springValue?.getVelocity() ?? 0\n          this._notify()\n        },\n      })\n    }\n  }\n\n  /**\n   * Get current value synchronously\n   */\n  get(): T {\n    return this._value\n  }\n\n  /**\n   * Get current velocity (for numeric values)\n   */\n  getVelocity(): number {\n    return this._velocity\n  }\n\n  /**\n   * Check if currently animating\n   */\n  isAnimating(): boolean {\n    return this._isAnimating\n  }\n\n  /**\n   * Set value with spring animation\n   */\n  set(newValue: T, animate: boolean = true): void {\n    if (this._destroyed) return\n\n    if (typeof newValue === 'number' && this._springValue && animate) {\n      this._isAnimating = true\n      this._emit('animationStart')\n\n      this._springValue.set(newValue as number)\n\n      // Check for animation end\n      const checkEnd = () => {\n        if (this._springValue && Math.abs(this._springValue.getVelocity()) < 0.01) {\n          this._isAnimating = false\n          this._emit('animationEnd')\n        } else if (this._isAnimating) {\n          requestAnimationFrame(checkEnd)\n        }\n      }\n      requestAnimationFrame(checkEnd)\n    } else {\n      this._value = newValue\n      this._velocity = 0\n      this._notify()\n    }\n  }\n\n  /**\n   * Instantly set value without animation\n   */\n  jump(newValue: T): void {\n    if (this._destroyed) return\n\n    this._value = newValue\n    this._velocity = 0\n\n    if (typeof newValue === 'number' && this._springValue) {\n      this._springValue.jump(newValue as number)\n    }\n\n    this._isAnimating = false\n    this._notify()\n  }\n\n  /**\n   * Stop any running animation\n   */\n  stop(): void {\n    // SpringValue doesn't have stop(), so we jump to current value\n    if (this._springValue) {\n      this._springValue.jump(this._springValue.get())\n    }\n    this._isAnimating = false\n    this._emit('animationEnd')\n  }\n\n  /**\n   * Subscribe to value changes\n   * Returns unsubscribe function\n   */\n  subscribe(callback: MotionValueSubscriber<T>): () => void {\n    this._subscribers.add(callback)\n\n    // Immediately call with current value\n    callback(this._value)\n\n    return () => {\n      this._subscribers.delete(callback)\n    }\n  }\n\n  /**\n   * Add event listener\n   */\n  on(event: MotionValueEvent, callback: () => void): () => void {\n    if (!this._eventListeners.has(event)) {\n      this._eventListeners.set(event, new Set())\n    }\n    this._eventListeners.get(event)!.add(callback)\n\n    return () => {\n      this._eventListeners.get(event)?.delete(callback)\n    }\n  }\n\n  /**\n   * Update spring configuration\n   */\n  setConfig(config: Partial<SpringConfig>): void {\n    this._springConfig = { ...this._springConfig, ...config }\n    // Note: Config change takes effect on next animation\n  }\n\n  /**\n   * Destroy and cleanup\n   */\n  destroy(): void {\n    this._destroyed = true\n    this._subscribers.clear()\n    this._eventListeners.clear()\n\n    if (this._springValue) {\n      this._springValue.destroy()\n      this._springValue = null\n    }\n  }\n\n  private _notify(): void {\n    this._subscribers.forEach((callback) => {\n      try {\n        callback(this._value)\n      } catch (e) {\n        console.error('MotionValue subscriber error:', e)\n      }\n    })\n    this._emit('change')\n  }\n\n  private _emit(event: MotionValueEvent): void {\n    this._eventListeners.get(event)?.forEach((callback) => {\n      try {\n        callback()\n      } catch (e) {\n        console.error(`MotionValue ${event} listener error:`, e)\n      }\n    })\n  }\n}\n\n/**\n * Create a new MotionValue\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * const opacity = createMotionValue(1)\n * const scale = createMotionValue(1, { spring: { stiffness: 300, damping: 30 } })\n * ```\n */\nexport function createMotionValue<T = number>(\n  initialValue: T,\n  options?: MotionValueOptions\n): MotionValue<T> {\n  return new MotionValue(initialValue, options)\n}\n\n/**\n * Transform a MotionValue using a mapping function\n *\n * Creates a derived MotionValue that automatically updates\n * when the source value changes.\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * const opacity = transformValue(x, (v) => 1 - v / 100)\n * const inverted = transformValue(x, (v) => -v)\n * ```\n */\nexport function transformValue<T, U>(\n  source: MotionValue<T>,\n  transform: (value: T) => U\n): MotionValue<U> {\n  const derived = new MotionValue<U>(transform(source.get()))\n\n  source.subscribe((value) => {\n    derived.jump(transform(value))\n  })\n\n  return derived\n}\n\n/**\n * Map a MotionValue from one range to another\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * // Map 0-100 to 0-1\n * const progress = mapRange(x, [0, 100], [0, 1])\n * // Map with extrapolation clamped\n * const clamped = mapRange(x, [0, 100], [0, 1], { clamp: true })\n * ```\n */\nexport function mapRange(\n  source: MotionValue<number>,\n  inputRange: [number, number],\n  outputRange: [number, number],\n  options: { clamp?: boolean } = {}\n): MotionValue<number> {\n  const [inMin, inMax] = inputRange\n  const [outMin, outMax] = outputRange\n\n  return transformValue(source, (value) => {\n    let normalized = (value - inMin) / (inMax - inMin)\n\n    if (options.clamp) {\n      normalized = Math.max(0, Math.min(1, normalized))\n    }\n\n    return outMin + normalized * (outMax - outMin)\n  })\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Options for path animation\n */\nexport interface PathAnimationOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to auto-play on creation */\n  autoPlay?: boolean\n  /** Callback for value updates */\n  onUpdate?: (value: number) => void\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Path animation controller\n */\nexport interface PathAnimation {\n  /** Start the animation from 0 to target */\n  play: (target?: number) => Promise<void>\n  /** Reverse the animation */\n  reverse: () => Promise<void>\n  /** Set path length directly (0-1) */\n  set: (value: number, animate?: boolean) => void\n  /** Get current path length */\n  get: () => number\n  /** Pause the animation */\n  pause: () => void\n  /** Resume the animation */\n  resume: () => void\n  /** Stop and reset */\n  reset: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n  /** Destroy and cleanup */\n  destroy: () => void\n}\n\n/**\n * Create a path length animation for SVG stroke drawing effects.\n * Animates stroke-dashoffset to reveal/hide a path.\n *\n * @example Basic path drawing\n * ```ts\n * const pathAnim = createPathAnimation(pathElement, {\n *   config: { stiffness: 100, damping: 15 },\n * })\n *\n * // Draw the path\n * await pathAnim.play()\n *\n * // Erase the path\n * await pathAnim.reverse()\n * ```\n *\n * @example With offset control\n * ```ts\n * const anim = createPathAnimation(path)\n *\n * // Draw 50% of the path\n * anim.set(0.5)\n *\n * // Draw full path with animation\n * anim.set(1, true)\n * ```\n */\nexport function createPathAnimation(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement,\n  options: PathAnimationOptions = {}\n): PathAnimation {\n  const {\n    config = {},\n    autoPlay = false,\n    onUpdate,\n    onComplete,\n  } = options\n\n  // Get total path length\n  const totalLength = element.getTotalLength?.() ?? 0\n\n  // Set initial stroke properties\n  element.style.strokeDasharray = String(totalLength)\n  element.style.strokeDashoffset = String(totalLength)\n\n  let currentValue = 0\n  let destroyed = false\n  const spring = createSpringValue(0, config)\n\n  // Subscribe to updates\n  const unsubscribe = spring.subscribe((value) => {\n    if (destroyed) return\n\n    currentValue = value\n    // Convert 0-1 to offset (1 = hidden, 0 = visible)\n    const offset = totalLength * (1 - value)\n    element.style.strokeDashoffset = String(offset)\n    onUpdate?.(value)\n  })\n\n  const waitForRest = (): Promise<void> => {\n    return new Promise((resolve) => {\n      const check = () => {\n        if (destroyed || !spring.isAnimating()) {\n          resolve()\n        } else {\n          requestAnimationFrame(check)\n        }\n      }\n      setTimeout(check, 16)\n    })\n  }\n\n  const animation: PathAnimation = {\n    play: async (target = 1) => {\n      if (destroyed) return\n      spring.set(target)\n      await waitForRest()\n      onComplete?.()\n    },\n\n    reverse: async () => {\n      if (destroyed) return\n      spring.set(0)\n      await waitForRest()\n      onComplete?.()\n    },\n\n    set: (value: number, animate = false) => {\n      if (destroyed) return\n\n      if (animate) {\n        spring.set(value)\n      } else {\n        spring.jump(value)\n        currentValue = value\n        const offset = totalLength * (1 - value)\n        element.style.strokeDashoffset = String(offset)\n      }\n    },\n\n    get: () => currentValue,\n\n    pause: () => {\n      if (destroyed) return\n      spring.stop()\n    },\n\n    resume: () => {\n      if (destroyed) return\n      // Resume by re-setting target\n      spring.set(currentValue)\n    },\n\n    reset: () => {\n      if (destroyed) return\n      spring.jump(0)\n      currentValue = 0\n      element.style.strokeDashoffset = String(totalLength)\n    },\n\n    isAnimating: () => spring.isAnimating(),\n\n    destroy: () => {\n      destroyed = true\n      unsubscribe()\n      spring.destroy()\n    },\n  }\n\n  if (autoPlay) {\n    animation.play()\n  }\n\n  return animation\n}\n\n/**\n * Get the total length of an SVG path element\n */\nexport function getPathLength(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement\n): number {\n  return element.getTotalLength?.() ?? 0\n}\n\n/**\n * Set up an element for path animation (sets dasharray and dashoffset)\n */\nexport function preparePathForAnimation(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement,\n  initialProgress = 0\n): void {\n  const length = element.getTotalLength?.() ?? 0\n  element.style.strokeDasharray = String(length)\n  element.style.strokeDashoffset = String(length * (1 - initialProgress))\n}\n\n/**\n * Calculate the point on a path at a given percentage\n */\nexport function getPointAtProgress(\n  path: SVGPathElement,\n  progress: number\n): DOMPoint | null {\n  try {\n    const length = path.getTotalLength()\n    return path.getPointAtLength(length * Math.max(0, Math.min(1, progress)))\n  } catch {\n    return null\n  }\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Measured box dimensions\n */\nexport interface MeasuredBox {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n/**\n * FLIP animation options\n */\nexport interface FlipOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to animate position */\n  position?: boolean\n  /** Whether to animate size */\n  size?: boolean\n  /** Callback when animation completes */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (progress: number) => void\n}\n\n/**\n * FLIP animation controller\n */\nexport interface FlipAnimation {\n  /** Play the FLIP animation */\n  play: () => Promise<void>\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Cancel the animation */\n  cancel: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n}\n\n/**\n * Measure the bounding box of an element\n */\nexport function measureElement(element: HTMLElement): MeasuredBox {\n  const rect = element.getBoundingClientRect()\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n  }\n}\n\n/**\n * Create a FLIP (First, Last, Invert, Play) animation.\n *\n * FLIP is a technique for animating layout changes performantly:\n * 1. First: Measure the element's initial position\n * 2. Last: Apply the change and measure final position\n * 3. Invert: Apply transforms to make it look like it's still in the first position\n * 4. Play: Animate the transforms to zero\n *\n * @example Basic FLIP\n * ```ts\n * // Measure first position\n * const first = measureElement(element)\n *\n * // Make layout change\n * element.classList.toggle('expanded')\n *\n * // Measure last position\n * const last = measureElement(element)\n *\n * // Create and play FLIP animation\n * const flip = createFlip(element, first, last)\n * await flip.play()\n * ```\n *\n * @example With options\n * ```ts\n * const flip = createFlip(element, first, last, {\n *   config: { stiffness: 300, damping: 30 },\n *   position: true,  // Animate position\n *   size: true,      // Animate size\n *   onComplete: () => console.log('Done!'),\n * })\n * ```\n */\nexport function createFlip(\n  element: HTMLElement,\n  first: MeasuredBox,\n  last: MeasuredBox,\n  options: FlipOptions = {}\n): FlipAnimation {\n  const {\n    config = {},\n    position = true,\n    size = true,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Calculate the inversion (how much to transform to get back to \"first\")\n  const deltaX = first.x - last.x\n  const deltaY = first.y - last.y\n  const deltaWidth = first.width / last.width\n  const deltaHeight = first.height / last.height\n\n  let progress = 0\n  let isPlaying = false\n  let cancelled = false\n\n  const spring = createSpringValue(0, config)\n\n  // Store original transform\n  const originalTransform = element.style.transform\n  const originalTransformOrigin = element.style.transformOrigin\n\n  // Set transform origin to top-left for size animations\n  if (size) {\n    element.style.transformOrigin = '0 0'\n  }\n\n  const applyTransform = (t: number) => {\n    progress = t\n    const invertedT = 1 - t\n\n    const transforms: string[] = []\n\n    if (position) {\n      transforms.push(`translate(${deltaX * invertedT}px, ${deltaY * invertedT}px)`)\n    }\n\n    if (size && (deltaWidth !== 1 || deltaHeight !== 1)) {\n      const scaleX = 1 + (deltaWidth - 1) * invertedT\n      const scaleY = 1 + (deltaHeight - 1) * invertedT\n      transforms.push(`scale(${scaleX}, ${scaleY})`)\n    }\n\n    element.style.transform = transforms.length > 0 ? transforms.join(' ') : ''\n    onUpdate?.(t)\n  }\n\n  // Apply initial inversion\n  applyTransform(0)\n\n  const cleanup = () => {\n    // Restore original styles\n    element.style.transform = originalTransform\n    element.style.transformOrigin = originalTransformOrigin\n  }\n\n  return {\n    play: async () => {\n      if (cancelled) return\n\n      isPlaying = true\n\n      return new Promise<void>((resolve) => {\n        const unsubscribe = spring.subscribe((value) => {\n          if (cancelled) {\n            unsubscribe()\n            resolve()\n            return\n          }\n          applyTransform(value)\n        })\n\n        spring.set(1)\n\n        // Wait for animation to complete\n        const checkComplete = () => {\n          if (cancelled) {\n            unsubscribe()\n            cleanup()\n            resolve()\n            return\n          }\n\n          if (!spring.isAnimating()) {\n            isPlaying = false\n            unsubscribe()\n            cleanup()\n            onComplete?.()\n            resolve()\n          } else {\n            requestAnimationFrame(checkComplete)\n          }\n        }\n\n        setTimeout(checkComplete, 16)\n      })\n    },\n\n    getProgress: () => progress,\n\n    cancel: () => {\n      cancelled = true\n      isPlaying = false\n      spring.stop()\n      cleanup()\n    },\n\n    isAnimating: () => isPlaying,\n  }\n}\n\n/**\n * Higher-level helper that handles the full FLIP flow.\n * Automatically measures before/after states.\n *\n * @example\n * ```ts\n * await flip(element, () => {\n *   element.classList.toggle('expanded')\n * }, { config: { stiffness: 200 } })\n * ```\n */\nexport async function flip(\n  element: HTMLElement,\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure initial state\n  const first = measureElement(element)\n\n  // Last: apply mutation and measure final state\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetHeight\n\n  const last = measureElement(element)\n\n  // Invert & Play\n  const animation = createFlip(element, first, last, options)\n  await animation.play()\n}\n\n/**\n * Batch FLIP animations for multiple elements.\n * Useful when multiple elements change position together.\n *\n * @example\n * ```ts\n * await flipBatch(\n *   [card1, card2, card3],\n *   () => container.classList.toggle('grid'),\n *   { config: { stiffness: 150 } }\n * )\n * ```\n */\nexport async function flipBatch(\n  elements: HTMLElement[],\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure all elements\n  const firstStates = elements.map((el) => measureElement(el))\n\n  // Last: apply mutation\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  document.body.offsetHeight\n\n  // Measure all final states and create animations\n  const animations = elements.map((element, i) => {\n    const last = measureElement(element)\n    return createFlip(element, firstStates[i]!, last, options)\n  })\n\n  // Play all animations\n  await Promise.all(animations.map((anim) => anim.play()))\n}\n"]}