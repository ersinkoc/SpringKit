{"version":3,"sources":["../src/core/config.ts","../src/core/physics.ts","../src/animation/loop.ts","../src/utils/math.ts","../src/utils/warnings.ts","../src/core/spring.ts","../src/core/spring-value.ts","../src/core/spring-group.ts","../src/core/variants.ts","../src/animation/sequence.ts","../src/animation/trail.ts","../src/animation/decay.ts","../src/animation/keyframes.ts","../src/animation/animate.ts","../src/interpolation/interpolate.ts","../src/interpolation/color.ts","../src/gesture/drag.ts","../src/gesture/scroll.ts","../src/gesture/advanced.ts","../src/utils/color.ts","../src/scroll/scroll-linked.ts","../src/animation/timeline.ts","../src/svg/morph.ts","../src/layout/shared.ts","../src/animation/stagger-patterns.ts","../src/core/MotionValue.ts","../src/svg/path.ts","../src/layout/flip.ts"],"names":["defaultConfig","springPresets","physicsPresets","getPhysicsPreset","name","createFeeling","feeling","adjustSpeed","preset","speed","stiffness","damping","adjustBounce","bounce","configFromDuration","ms","configFromBounce","simulateSpring","position","velocity","target","config","mass","restSpeed","restDelta","displacement","absDisplacement","absVelocity","dt","springForce","dampingForce","acceleration","newVelocity","newPosition","isRest","calculatePeriod","calculateDampingRatio","isUnderdamped","isCriticallyDamped","ratio","isOverdamped","AnimationState","AnimationLoop","id","cb","now","rawDelta","clampedDelta","listener","toRemove","ref","animation","i","existingId","callback","count","delta","globalLoop","clamp","value","min","max","actualMin","actualMax","lerp","a","b","t","mapRange","inMin","inMax","outMin","outMax","inputRange","degToRad","degrees","radToDeg","radians","isDev","warnedMessages","warnOnce","message","validateSpringConfig","validateDragConfig","rubberBandFactor","bounds","validateDecayConfig","deceleration","clearWarnings","SpringAnimationImpl","from","to","resolve","temp","_now","result","spring","SpringValueImpl","initial","animationResolver","mergedConfig","originalOnUpdate","originalOnComplete","subscriber","createSpringValue","SpringGroupImpl","initialValues","key","springValue","values","promises","createSpringGroup","resolveVariant","variant","custom","resolved","transition","getVariant","variants","mergeVariants","merged","isTransformProperty","isAnimatable","parseValueWithUnit","match","buildTransformString","transforms","x","y","applyValuesToElement","element","transform","calculateStaggerDelays","options","staggerChildren","staggerDirection","delayChildren","delays","index","createOrchestration","parentAnim","childrenAnims","when","delay","parent","children","anim","variantPresets","createVariantPreset","animate","exit","isVariants","v","isVariant","sequence","animations","createAnimation","parallel","stagger","items","startIndex","indices","used","offset","left","right","getDelay","_i","delayMs","TrailImpl","followDelay","springConfig","targetValue","delayFrames","targetFrame","_delayFrames","startFrame","framesToWait","s","unsubscribers","unsubscribe","createTrail","DecayAnimationImpl","decay","keyframes","times","onKeyframe","onComplete","onUpdate","normalizedKeyframes","keyframeCount","kf","currentIndex","isPlaying","isPaused","currentValue","destroyed","createSpring","animateToNext","targetKf","checkComplete","parseKeyframeArray","isKeyframeArray","transformProperties","pxProperties","buildTransform","parts","z","scale","scaleX","scaleY","rotate","rotateX","rotateY","skewX","skewY","applyStylesToElement","el","transformValues","styleValues","property","prop","val","parseCurrentValue","computed","elementOrSelector","createNoopControls","springs","currentValues","isRunning","resolveFinished","rafIds","delayTimeoutId","finished","_reject","startAnimation","entries","completedCount","totalAnimations","startValue","valuesObj","numValue","checkDone","timeoutId","rafId","initialRafId","cleanup","totalProgress","animateAll","selector","animateOptions","elements","defaultInterpolateOptions","InterpolationImpl","source","input","output","extrapolate","extrapolateLeft","extrapolateRight","mode","specificMode","fallbackMode","interpolate","ColorInterpolationImpl","colorStrings","c","r","g","color","hexMatch","hex","rgbMatch","rgbaMatch","hslMatch","h","l","gray","hue2rgb","p","q","interpolateColor","colors","defaultDragConfig","DragSpringImpl","safeDt","instantVelocity","smoothingFactor","newX","newY","snapPoint","edge","dragElastic","axis","elasticFactor","snap","gridX","gridY","velocityMagnitude","threshold","nearestPoint","nearestDistance","point","dx","dy","distance","radius","constraints","parentRect","elementRect","padding","constraintRect","offsetX","offsetY","velocityX","velocityY","top","bottom","targetX","targetY","rawDecay","decayFactor","momentumX","momentumY","modified","createDragSpring","defaultScrollConfig","ScrollSpringImpl","container","deltaX","deltaY","maxScrollX","maxScrollY","checkEnd","containerRect","createScrollSpring","getDistance","p1","p2","getAngle","getCenter","rubberBand","factor","createPinchGesture","minScale","maxScale","enableRubberBand","onPinch","onPinchStart","onPinchEnd","enabled","active","initialDistance","initialScale","currentScale","lastScale","startTime","lastTime","touches","scaleSpring","createState","event","first","last","touchArray","origin","handleTouchStart","e","touch","handleTouchMove","currentDistance","newScale","handleTouchEnd","targetScale","createRotateGesture","initialEnabled","onRotate","onRotateStart","onRotateEnd","initialAngle","currentAngle","lastAngle","angleOffset","newAngle","angleDelta","createSwipeGesture","velocityThreshold","distanceThreshold","maxDuration","onSwipe","onSwipeStart","onSwipeEnd","startPoint","lastPoint","pointerId","direction","duration","movement","detectDirection","absX","absY","velX","velY","meetsDistanceX","meetsDistanceY","meetsVelocityX","meetsVelocityY","handlePointerDown","handlePointerMove","handlePointerUp","state","createLongPressGesture","movementTolerance","onLongPress","onPressStart","onPressEnd","triggered","timerId","createGestures","controllers","parseColor","hexToRgb","hslToRgb","rgbToHex","toHex","n","cleanHex","rgbToHsl","lerpColor","colorA","colorB","createScrollProgress","smooth","progress","smoothedProgress","lastScrollY","subscribers","calculateProgress","scrollY","windowHeight","newProgress","isInView","visibleRatio","rect","elementTop","elementHeight","endPoint","scrollStart","scrollEnd","documentHeight","notify","info","onScroll","initialInfo","createParallax","easing","rootMargin","observer","update","elementCenter","viewportCenter","normalizedDistance","entry","createScrollTrigger","start","end","startOffset","endOffset","onEnter","onLeave","onProgress","once","scrub","isActive","hasEntered","getPosition","pos","startPos","endPos","triggerStart","triggerEnd","startProgress","endProgress","rawProgress","wasActive","createScrollLinkedValue","scrollProgress","outputRange","shouldClamp","firstOutput","isColorOutput","firstInput","lastInput","segmentIndex","curr","next","segmentStart","segmentEnd","segmentProgress","endValue","scrollEasings","timelineIdCounter","createTimeline","defaults","autoplay","repeat","yoyo","repeatDelay","onStart","onRepeat","segments","labels","callbacks","pauses","currentTime","totalDuration","isReversed","repeatCount","lastFrameTime","hasStarted","insertTime","parsePosition","lastSegment","labelMatch","labelName","labelTime","offsetValue","resolveTarget","extractNumericProps","props","applyPropsToElement","cssProps","getCurrentElementValues","current","MAX_DELTA_TIME","tick","timestamp","deltaTime","callbacksAtTime","pauseCallback","segment","shouldBeActive","timeline","endTime","numericProps","originalOnStart","targetValues","fromProps","toProps","fromNumeric","toNumeric","label","time","tween","allTo","targets","tl","parsePath","d","commands","regex","matches","matchItem","typeChar","valuesStr","type","toAbsolute","cmd","absValues","currentY","samplePath","samples","points","svgNS","svg","path","step","interpolatePoint","pointsToPath","firstPoint","createMorph","initialPath","currentPath","fromPoints","toPoints","currentPoints","initialCommands","progressSpring","targetCommands","targetPoints","createMorphSequence","paths","firstPath","morph","targetIndex","targetPath","shapes","cx","cy","width","height","rx","sides","angle","outerR","innerR","size","hw","hh","measureElement","styles","applyTransform","compensatedRadius","resetTransform","createLayoutGroup","defaultSpring","onAnimationStart","onAnimationComplete","crossfade","_transition","previousMeasurements","register","existing","measurement","unregister","group","animateElement","previousMeasurement","currentMeasurement","groupIdCounter","createSharedLayoutContext","groups","groupId","createAutoLayout","root","attribute","debounceTime","layoutConfig","resizeObserver","debounceTimer","scanAndRegister","debouncedUpdate","mutations","shouldUpdate","mutation","node","seededRandom","seed","gridDistance","columns","rows","col","row","originCol","originRow","linearStagger","reverseStagger","centerStagger","center","distanceFromCenter","maxDistance","edgeStagger","maxDelay","gridStagger","waveStagger","frequency","amplitude","waveOffset","spiralStagger","startFrom","spiral","visited","idx","originalIndex","spiralPosition","randomStagger","minMultiplier","maxMultiplier","random","multiplier","customStagger","fn","applyStagger","opt","staggerPresets","MotionValue","initialValue","newValue","createMotionValue","transformValue","derived","originalDestroy","inputDelta","normalized","createPathAnimation","autoPlay","totalLength","waitForRest","check","getPathLength","preparePathForAnimation","initialProgress","length","getPointAtProgress","createFlip","deltaWidth","deltaHeight","cancelled","originalTransform","originalTransformOrigin","invertedT","flip","mutate","flipBatch","firstStates"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * Spring configuration interface\n */\nexport interface SpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Initial velocity */\n  velocity?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Callback called on each update */\n  onUpdate?: (value: number) => void\n  /** Callback called when animation starts */\n  onStart?: () => void\n  /** Callback called when animation reaches target */\n  onComplete?: () => void\n  /** Callback called when spring is at rest */\n  onRest?: () => void\n}\n\n/**\n * Default spring configuration\n */\nexport const defaultConfig: SpringConfig = {\n  stiffness: 100,\n  damping: 10,\n  mass: 1,\n  velocity: 0,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Spring presets interface\n */\nexport interface SpringPresets {\n  /** Default spring: { stiffness: 100, damping: 10 } */\n  default: SpringConfig\n  /** Gentle spring: { stiffness: 120, damping: 14 } */\n  gentle: SpringConfig\n  /** Wobbly spring: { stiffness: 180, damping: 12 } */\n  wobbly: SpringConfig\n  /** Stiff spring: { stiffness: 210, damping: 20 } */\n  stiff: SpringConfig\n  /** Slow spring: { stiffness: 280, damping: 60 } */\n  slow: SpringConfig\n  /** Molasses spring: { stiffness: 280, damping: 120 } */\n  molasses: SpringConfig\n  /** Bouncy spring: { stiffness: 200, damping: 8 } */\n  bounce: SpringConfig\n  /** No wobble spring: { stiffness: 170, damping: 26 } */\n  noWobble: SpringConfig\n}\n\n/**\n * Built-in spring presets\n */\nexport const springPresets: SpringPresets = {\n  default: { stiffness: 100, damping: 10 },\n  gentle: { stiffness: 120, damping: 14 },\n  wobbly: { stiffness: 180, damping: 12 },\n  stiff: { stiffness: 210, damping: 20 },\n  slow: { stiffness: 280, damping: 60 },\n  molasses: { stiffness: 280, damping: 120 },\n  bounce: { stiffness: 200, damping: 8 },\n  noWobble: { stiffness: 170, damping: 26 },\n}\n\n// ============ Semantic Physics Presets ============\n\n/**\n * Physics presets with semantic, use-case oriented names\n * These presets are designed for specific UI interactions and feel natural\n */\nexport const physicsPresets = {\n  // ---- UI Interactions ----\n\n  /** Button press/release - snappy response */\n  button: { stiffness: 400, damping: 30, mass: 1 },\n\n  /** Toggle switch - quick but smooth */\n  toggle: { stiffness: 500, damping: 35, mass: 0.8 },\n\n  /** Checkbox/Radio - instant feedback */\n  checkbox: { stiffness: 600, damping: 40, mass: 0.5 },\n\n  /** Hover state - subtle and responsive */\n  hover: { stiffness: 300, damping: 25, mass: 0.8 },\n\n  /** Focus ring - gentle attention */\n  focus: { stiffness: 200, damping: 20, mass: 1 },\n\n  // ---- Layout & Navigation ----\n\n  /** Page transitions - smooth and professional */\n  pageTransition: { stiffness: 100, damping: 20, mass: 1.5 },\n\n  /** Modal/Dialog entry - dramatic but controlled */\n  modalEnter: { stiffness: 300, damping: 25, mass: 1 },\n\n  /** Modal/Dialog exit - quick departure */\n  modalExit: { stiffness: 400, damping: 35, mass: 0.8 },\n\n  /** Sidebar slide - smooth glide */\n  sidebar: { stiffness: 200, damping: 28, mass: 1.2 },\n\n  /** Dropdown menu - snappy reveal */\n  dropdown: { stiffness: 400, damping: 30, mass: 0.8 },\n\n  /** Toast notification - attention-grabbing */\n  toast: { stiffness: 350, damping: 25, mass: 0.9 },\n\n  /** Tooltip - quick and subtle */\n  tooltip: { stiffness: 500, damping: 40, mass: 0.6 },\n\n  // ---- Gestures & Drag ----\n\n  /** Drag release - momentum with settle */\n  dragRelease: { stiffness: 150, damping: 20, mass: 1 },\n\n  /** Swipe action - decisive movement */\n  swipe: { stiffness: 250, damping: 22, mass: 0.9 },\n\n  /** Pull to refresh - elastic and responsive */\n  pullToRefresh: { stiffness: 180, damping: 18, mass: 1.2 },\n\n  /** Snap to position - magnetic feel */\n  snap: { stiffness: 400, damping: 35, mass: 0.8 },\n\n  /** Rubber band - iOS-style overscroll */\n  rubberBand: { stiffness: 300, damping: 15, mass: 0.8 },\n\n  // ---- Cards & Items ----\n\n  /** Card flip - dramatic reveal */\n  cardFlip: { stiffness: 150, damping: 18, mass: 1.5 },\n\n  /** Card hover lift - subtle elevation */\n  cardHover: { stiffness: 400, damping: 30, mass: 0.7 },\n\n  /** List item enter - staggered animation */\n  listItem: { stiffness: 300, damping: 28, mass: 0.9 },\n\n  /** Accordion expand - smooth reveal */\n  accordion: { stiffness: 200, damping: 25, mass: 1.1 },\n\n  // ---- Loading & Progress ----\n\n  /** Skeleton shimmer - continuous flow */\n  skeleton: { stiffness: 80, damping: 15, mass: 2 },\n\n  /** Progress bar - steady advancement */\n  progress: { stiffness: 150, damping: 25, mass: 1 },\n\n  /** Spinner rotation - smooth continuous */\n  spinner: { stiffness: 100, damping: 12, mass: 1.5 },\n\n  // ---- Emphasis & Attention ----\n\n  /** Pulse effect - gentle attention */\n  pulse: { stiffness: 120, damping: 10, mass: 1.2 },\n\n  /** Shake effect - error emphasis */\n  shake: { stiffness: 500, damping: 15, mass: 0.6 },\n\n  /** Bounce effect - playful emphasis */\n  bounceAttention: { stiffness: 400, damping: 10, mass: 0.7 },\n\n  /** Pop effect - sudden appearance */\n  pop: { stiffness: 500, damping: 20, mass: 0.6 },\n\n  /** Wiggle effect - playful motion */\n  wiggle: { stiffness: 300, damping: 8, mass: 0.8 },\n\n  // ---- Mobile-Specific ----\n\n  /** iOS spring - Apple-like feel */\n  ios: { stiffness: 300, damping: 20, mass: 1 },\n\n  /** Android spring - Material Design feel */\n  android: { stiffness: 350, damping: 25, mass: 0.9 },\n\n  /** Haptic feedback - quick micro-interaction */\n  haptic: { stiffness: 600, damping: 45, mass: 0.4 },\n\n  // ---- Natural Physics ----\n\n  /** Pendulum - gravity-like swing */\n  pendulum: { stiffness: 50, damping: 5, mass: 2 },\n\n  /** Jelly - soft and wobbly */\n  jelly: { stiffness: 150, damping: 8, mass: 1.5 },\n\n  /** Elastic - stretchy rubber */\n  elastic: { stiffness: 200, damping: 10, mass: 1.2 },\n\n  /** Heavy - weighted and deliberate */\n  heavy: { stiffness: 150, damping: 30, mass: 3 },\n\n  /** Light - airy and quick */\n  light: { stiffness: 400, damping: 25, mass: 0.5 },\n\n  /** Liquid - fluid motion */\n  liquid: { stiffness: 100, damping: 20, mass: 2 },\n\n} as const\n\nexport type PhysicsPresetName = keyof typeof physicsPresets\n\n/**\n * Get a physics preset by name\n */\nexport function getPhysicsPreset(name: PhysicsPresetName): SpringConfig {\n  return { ...physicsPresets[name] }\n}\n\n/**\n * Create a custom preset based on a semantic description\n * @param feeling - How the animation should feel\n */\nexport function createFeeling(feeling: 'snappy' | 'smooth' | 'bouncy' | 'heavy' | 'light' | 'elastic'): SpringConfig {\n  switch (feeling) {\n    case 'snappy':\n      return { stiffness: 400, damping: 30, mass: 0.8 }\n    case 'smooth':\n      return { stiffness: 150, damping: 25, mass: 1.2 }\n    case 'bouncy':\n      return { stiffness: 300, damping: 12, mass: 1 }\n    case 'heavy':\n      return { stiffness: 100, damping: 30, mass: 2.5 }\n    case 'light':\n      return { stiffness: 400, damping: 25, mass: 0.5 }\n    case 'elastic':\n      return { stiffness: 200, damping: 10, mass: 1.2 }\n    default:\n      return { stiffness: 100, damping: 10, mass: 1 }\n  }\n}\n\n/**\n * Adjust a preset for speed\n * @param preset - Base preset config\n * @param speed - Speed multiplier (0.5 = half speed, 2 = double speed)\n */\nexport function adjustSpeed(preset: SpringConfig, speed: number): SpringConfig {\n  const stiffness = (preset.stiffness ?? 100) * speed\n  const damping = (preset.damping ?? 10) * Math.sqrt(speed)\n  return { ...preset, stiffness, damping }\n}\n\n/**\n * Adjust a preset for bounciness\n * @param preset - Base preset config\n * @param bounce - Bounce factor (0 = no bounce, 1 = very bouncy)\n */\nexport function adjustBounce(preset: SpringConfig, bounce: number): SpringConfig {\n  const minDamping = 5\n  const maxDamping = 40\n  const damping = maxDamping - (bounce * (maxDamping - minDamping))\n  return { ...preset, damping: Math.max(minDamping, Math.min(maxDamping, damping)) }\n}\n\n/**\n * Create a spring config that settles in approximately the given duration\n * @param ms - Approximate settling time in milliseconds\n * @returns Spring config\n */\nexport function configFromDuration(ms: number): SpringConfig {\n  if (ms < 300) {\n    return { stiffness: 170, damping: 26 }\n  }\n  if (ms < 500) {\n    return { stiffness: 100, damping: 20 }\n  }\n  return { stiffness: 80, damping: 15 }\n}\n\n/**\n * Create a spring config with specific bounce amount\n * @param bounce - Bounce factor (0 = no bounce, 0.5 = 50% overshoot)\n * @returns Spring config\n */\nexport function configFromBounce(bounce: number): SpringConfig {\n  if (bounce <= 0) {\n    return { stiffness: 170, damping: 26 }\n  }\n  if (bounce <= 0.25) {\n    return { stiffness: 200, damping: 12 }\n  }\n  return { stiffness: 200, damping: 8 }\n}\n","import type { SpringConfig } from './config.js'\n\n/**\n * Result of a spring physics simulation step\n */\nexport interface SimulationResult {\n  /** New position */\n  position: number\n  /** New velocity */\n  velocity: number\n  /** Whether the spring is at rest */\n  isRest: boolean\n}\n\n/**\n * Simulate one step of spring physics using semi-implicit Euler integration\n *\n * The spring follows the damped harmonic oscillator equation:\n * F = -k * x - c * v\n * a = F / m\n *\n * Where:\n * - k = stiffness (spring constant)\n * - c = damping coefficient\n * - m = mass\n * - x = displacement from rest (target - position)\n * - v = velocity\n * - a = acceleration\n * - dt = time step (1/60 for 60fps animation)\n *\n * @param position - Current position\n * @param velocity - Current velocity\n * @param target - Target position (rest position)\n * @param config - Spring configuration\n * @returns Simulation result with new position, velocity, and rest state\n */\nexport function simulateSpring(\n  position: number,\n  velocity: number,\n  target: number,\n  config: SpringConfig\n): SimulationResult {\n  const {\n    stiffness = 100,\n    damping = 10,\n    mass = 1,\n    restSpeed = 0.01,\n    restDelta = 0.01,\n  } = config\n\n  // Calculate displacement from target (cached for reuse)\n  const displacement = target - position\n  const absDisplacement = Math.abs(displacement)\n  const absVelocity = Math.abs(velocity)\n\n  // Early exit optimization: if already at rest, skip expensive calculations\n  // This significantly improves performance for springs that have settled\n  if (absDisplacement <= restDelta && absVelocity <= restSpeed) {\n    return {\n      position: target, // Snap to exact target\n      velocity: 0,\n      isRest: true,\n    }\n  }\n\n  // Time step for 60fps animation\n  // This ensures the spring simulation is stable with typical stiffness values\n  const dt = 1 / 60\n\n  // Calculate spring force (Hooke's law: F = -k * x)\n  const springForce = stiffness * displacement\n\n  // Calculate damping force (opposes velocity: F = -c * v)\n  // Optimization: skip multiplication if velocity is negligible\n  const dampingForce = absVelocity > 0.0001 ? damping * velocity : 0\n\n  // Calculate total force and acceleration (Newton's second law: a = F/m)\n  const acceleration = (springForce - dampingForce) / mass\n\n  // Semi-implicit Euler integration\n  // Update velocity first, then use new velocity to update position\n  // This provides better energy conservation than standard Euler\n  const newVelocity = velocity + acceleration * dt\n  const newPosition = position + newVelocity * dt\n\n  // Check if spring is at rest\n  // Spring is at rest when:\n  // 1. Close to target position (displacement < restDelta)\n  // 2. Moving slowly (velocity < restSpeed)\n  const isRest =\n    absDisplacement <= restDelta &&\n    Math.abs(newVelocity) <= restSpeed\n\n  return {\n    position: newPosition,\n    velocity: newVelocity,\n    isRest,\n  }\n}\n\n/**\n * Calculate the period of oscillation for a spring\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Period in seconds\n */\nexport function calculatePeriod(stiffness: number, mass: number): number {\n  return 2 * Math.PI * Math.sqrt(mass / stiffness)\n}\n\n/**\n * Calculate the damping ratio for a spring\n * @param damping - Damping coefficient\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Damping ratio\n */\nexport function calculateDampingRatio(\n  damping: number,\n  stiffness: number,\n  mass: number\n): number {\n  return damping / (2 * Math.sqrt(stiffness * mass))\n}\n\n/**\n * Check if a spring is underdamped (will oscillate)\n * @param config - Spring configuration\n * @returns True if underdamped\n */\nexport function isUnderdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio < 1\n}\n\n/**\n * Check if a spring is critically damped (fastest return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if critically damped\n */\nexport function isCriticallyDamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return Math.abs(ratio - 1) < 0.001\n}\n\n/**\n * Check if a spring is overdamped (slow return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if overdamped\n */\nexport function isOverdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio > 1\n}\n","/**\n * Animation state enum\n */\nexport enum AnimationState {\n  Idle = 'idle',\n  Running = 'running',\n  Paused = 'paused',\n  Complete = 'complete',\n}\n\n/**\n * Interface for objects that can be animated\n */\nexport interface Animatable {\n  /**\n   * Update the animation\n   * @param now - Current timestamp from performance.now()\n   */\n  update(now: number): void\n\n  /**\n   * Check if the animation is complete\n   */\n  isComplete(): boolean\n}\n\n/**\n * Callback type for cleanup notifications\n */\nexport type CleanupCallback = (id: number) => void\n\n/**\n * Maximum allowed delta time (ms) to prevent physics explosions after tab suspension\n * If more time has passed, we clamp to this value for stable simulation\n */\nconst MAX_DELTA_TIME = 64 // ~15fps minimum, prevents huge jumps\n\n/**\n * Global animation loop manager\n * Uses requestAnimationFrame to drive all animations\n * Features:\n * - WeakRef-based animation tracking for memory safety\n * - FinalizationRegistry for cleanup callbacks\n * - Frame-drop resilience with delta time clamping\n * - Single-pass update + cleanup for O(n) performance\n * - Frame event listeners for external monitoring\n */\nclass AnimationLoop {\n  private animations = new Set<WeakRef<Animatable>>()\n  private animationMap = new WeakMap<Animatable, WeakRef<Animatable>>()\n  private rafId: number | null = null\n  private isRunning = false\n  private lastTime: number = 0\n  private nextId = 1\n  private idMap = new WeakMap<Animatable, number>()\n  private frameListeners = new Set<(deltaTime: number) => void>()\n\n  // FinalizationRegistry for automatic cleanup notifications\n  private registry = new FinalizationRegistry<number>((id) => {\n    this.cleanupCallbacks.forEach((cb) => cb(id))\n  })\n  private cleanupCallbacks = new Set<CleanupCallback>()\n\n  /**\n   * Add an animation to the loop\n   * Uses WeakRef to prevent memory leaks if animation is garbage collected\n   * @returns Unique ID for this animation\n   */\n  add(animation: Animatable): number {\n    // Check if already added\n    const existingId = this.idMap.get(animation)\n    if (existingId !== undefined) return existingId\n\n    const id = this.nextId++\n    const ref = new WeakRef(animation)\n    this.animations.add(ref)\n    this.animationMap.set(animation, ref)\n    this.idMap.set(animation, id)\n\n    // Register for finalization callback\n    this.registry.register(animation, id)\n\n    this.start()\n    return id\n  }\n\n  /**\n   * Remove an animation from the loop\n   */\n  remove(animation: Animatable): void {\n    const ref = this.animationMap.get(animation)\n    if (ref) {\n      this.animations.delete(ref)\n      this.animationMap.delete(animation)\n      this.idMap.delete(animation)\n      // Note: unregister not strictly needed as registry uses weak refs\n    }\n    if (this.animations.size === 0) {\n      this.stop()\n    }\n  }\n\n  /**\n   * Register a callback for when animations are garbage collected\n   * Useful for debugging memory leaks\n   */\n  onCleanup(callback: CleanupCallback): () => void {\n    this.cleanupCallbacks.add(callback)\n    return () => this.cleanupCallbacks.delete(callback)\n  }\n\n  /**\n   * Register a callback for each frame\n   * Receives delta time in milliseconds\n   */\n  onFrame(callback: (deltaTime: number) => void): () => void {\n    this.frameListeners.add(callback)\n    return () => this.frameListeners.delete(callback)\n  }\n\n  /**\n   * Start the animation loop\n   */\n  private start(): void {\n    if (this.isRunning) return\n    this.isRunning = true\n    this.lastTime = performance.now()\n    this.tick()\n  }\n\n  /**\n   * Stop the animation loop\n   */\n  private stop(): void {\n    this.isRunning = false\n    if (this.rafId !== null) {\n      cancelAnimationFrame(this.rafId)\n      this.rafId = null\n    }\n  }\n\n  /**\n   * Single animation frame - optimized single-pass update + cleanup\n   * Features:\n   * - WeakRef dereferencing with automatic cleanup of dead refs\n   * - Delta time clamping for frame-drop resilience\n   * - O(n) single-pass performance\n   * - Frame listener notifications\n   */\n  private tick = (): void => {\n    const now = performance.now()\n\n    // Calculate and clamp delta time to prevent physics explosions\n    // This handles tab suspension, debugger pauses, etc.\n    const rawDelta = now - this.lastTime\n    const clampedDelta = Math.min(rawDelta, MAX_DELTA_TIME)\n    this.lastTime = now\n\n    // Notify frame listeners\n    for (const listener of this.frameListeners) {\n      listener(clampedDelta)\n    }\n\n    // Single pass: update all animations and collect refs to remove\n    const toRemove: WeakRef<Animatable>[] = []\n\n    for (const ref of this.animations) {\n      const animation = ref.deref()\n\n      // If WeakRef is dead (animation was garbage collected), mark for removal\n      if (!animation) {\n        toRemove.push(ref)\n        continue\n      }\n\n      animation.update(now)\n\n      if (animation.isComplete()) {\n        toRemove.push(ref)\n        this.animationMap.delete(animation)\n        this.idMap.delete(animation)\n      }\n    }\n\n    // Remove dead/completed refs\n    for (let i = 0; i < toRemove.length; i++) {\n      this.animations.delete(toRemove[i]!)\n    }\n\n    // Continue or stop loop\n    if (this.animations.size > 0) {\n      this.rafId = requestAnimationFrame(this.tick)\n    } else {\n      this.stop()\n    }\n  }\n\n  /**\n   * Get the number of active animations (including potentially dead refs)\n   */\n  get size(): number {\n    return this.animations.size\n  }\n\n  /**\n   * Get count of actually alive animations (for debugging/testing)\n   */\n  getAliveCount(): number {\n    let count = 0\n    for (const ref of this.animations) {\n      if (ref.deref()) count++\n    }\n    return count\n  }\n\n  /**\n   * Get current frame rate (based on last delta)\n   */\n  getFPS(): number {\n    const delta = performance.now() - this.lastTime\n    return delta > 0 ? Math.round(1000 / delta) : 60\n  }\n}\n\n/**\n * Global animation loop instance\n */\nexport const globalLoop = new AnimationLoop()\n","/**\n * Clamp a value between a minimum and maximum\n * @param value - The value to clamp\n * @param min - The minimum allowed value\n * @param max - The maximum allowed value\n * @returns The clamped value\n */\nexport function clamp(value: number, min: number, max: number): number {\n  // Handle inverted min/max (swap them)\n  const actualMin = Math.min(min, max)\n  const actualMax = Math.max(min, max)\n  return Math.max(actualMin, Math.min(actualMax, value))\n}\n\n/**\n * Linear interpolation between two values\n * @param a - The start value\n * @param b - The end value\n * @param t - The interpolation factor (0-1)\n * @returns The interpolated value\n */\nexport function lerp(a: number, b: number, t: number): number {\n  return a + (b - a) * t\n}\n\n/**\n * Map a value from one range to another\n * @param value - The value to map\n * @param inMin - The minimum of the input range\n * @param inMax - The maximum of the input range\n * @param outMin - The minimum of the output range\n * @param outMax - The maximum of the output range\n * @returns The mapped value\n */\nexport function mapRange(\n  value: number,\n  inMin: number,\n  inMax: number,\n  outMin: number,\n  outMax: number\n): number {\n  // Guard against division by zero - return outMin when input range is zero\n  const inputRange = inMax - inMin\n  if (inputRange === 0) {\n    return outMin\n  }\n  return ((value - inMin) * (outMax - outMin)) / inputRange + outMin\n}\n\n/**\n * Convert degrees to radians\n * @param degrees - The angle in degrees\n * @returns The angle in radians\n */\nexport function degToRad(degrees: number): number {\n  return (degrees * Math.PI) / 180\n}\n\n/**\n * Convert radians to degrees\n * @param radians - The angle in radians\n * @returns The angle in degrees\n */\nexport function radToDeg(radians: number): number {\n  return (radians * 180) / Math.PI\n}\n","/**\n * Development mode warnings for SpringKit\n * These warnings help developers avoid common configuration mistakes\n */\n\nconst isDev = typeof process !== 'undefined' && process.env?.NODE_ENV !== 'production'\nconst warnedMessages = new Set<string>()\n\n/**\n * Log a warning message once (won't repeat the same message)\n */\nfunction warnOnce(message: string): void {\n  if (!isDev || warnedMessages.has(message)) return\n  warnedMessages.add(message)\n  console.warn(`[SpringKit] ${message}`)\n}\n\n/**\n * Validate spring configuration and warn about potential issues\n */\nexport function validateSpringConfig(config: {\n  stiffness?: number\n  damping?: number\n  mass?: number\n}): void {\n  if (!isDev) return\n\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n\n  // Check for extreme stiffness with low damping (unstable oscillation)\n  if (stiffness > 400 && damping < 10) {\n    warnOnce(\n      `High stiffness (${stiffness}) with low damping (${damping}) may cause excessive oscillation. ` +\n      `Consider increasing damping to at least ${Math.round(stiffness / 20)} for smoother animation.`\n    )\n  }\n\n  // Check for very low stiffness (sluggish animation)\n  if (stiffness < 20) {\n    warnOnce(\n      `Very low stiffness (${stiffness}) will result in sluggish animation. ` +\n      `Consider using stiffness >= 50 for more responsive feel.`\n    )\n  }\n\n  // Check for very high damping (overdamped, no spring feel)\n  if (damping > stiffness) {\n    warnOnce(\n      `Damping (${damping}) is higher than stiffness (${stiffness}), ` +\n      `which removes the \"springy\" feel. Consider reducing damping for bouncier animation.`\n    )\n  }\n\n  // Check for zero or negative mass\n  if (mass <= 0) {\n    warnOnce(\n      `Mass must be positive. Got ${mass}. Using default mass of 1.`\n    )\n  }\n\n  // Check for very high mass (slow animation)\n  if (mass > 10) {\n    warnOnce(\n      `High mass (${mass}) will make the animation very slow. ` +\n      `Consider mass between 0.5 and 5 for typical use cases.`\n    )\n  }\n}\n\n/**\n * Validate drag configuration\n */\nexport function validateDragConfig(config: {\n  rubberBandFactor?: number\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n}): void {\n  if (!isDev) return\n\n  const { rubberBandFactor, bounds } = config\n\n  // Check rubber band factor range\n  if (rubberBandFactor !== undefined && (rubberBandFactor < 0 || rubberBandFactor > 1)) {\n    warnOnce(\n      `rubberBandFactor should be between 0 and 1. Got ${rubberBandFactor}. ` +\n      `Values outside this range may cause unexpected behavior.`\n    )\n  }\n\n  // Check for inverted bounds\n  if (bounds) {\n    if (bounds.left !== undefined && bounds.right !== undefined && bounds.left > bounds.right) {\n      warnOnce(\n        `Drag bounds are inverted: left (${bounds.left}) > right (${bounds.right}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n    if (bounds.top !== undefined && bounds.bottom !== undefined && bounds.top > bounds.bottom) {\n      warnOnce(\n        `Drag bounds are inverted: top (${bounds.top}) > bottom (${bounds.bottom}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n  }\n}\n\n/**\n * Validate decay configuration\n */\nexport function validateDecayConfig(config: {\n  velocity: number\n  deceleration?: number\n}): void {\n  if (!isDev) return\n\n  const { velocity, deceleration = 0.998 } = config\n\n  // Check for zero velocity\n  if (velocity === 0) {\n    warnOnce(\n      `Decay animation started with zero velocity. ` +\n      `The animation will complete immediately.`\n    )\n  }\n\n  // Check deceleration range\n  if (deceleration <= 0 || deceleration >= 1) {\n    warnOnce(\n      `Deceleration should be between 0 and 1 (exclusive). Got ${deceleration}. ` +\n      `Typical values are 0.99-0.999.`\n    )\n  }\n}\n\n/**\n * Clear warned messages (useful for testing)\n */\nexport function clearWarnings(): void {\n  warnedMessages.clear()\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { simulateSpring } from './physics.js'\nimport { globalLoop, type Animatable, AnimationState } from '../animation/loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateSpringConfig } from '../utils/warnings.js'\n\n/**\n * Spring animation control interface\n */\nexport interface SpringAnimation {\n  /** Start the animation */\n  start(): SpringAnimation\n  /** Stop the animation immediately */\n  stop(): void\n  /** Pause the animation */\n  pause(): void\n  /** Resume the animation */\n  resume(): void\n  /** Reverse the animation direction */\n  reverse(): void\n  /** Update the target value */\n  set(to: number): void\n  /** Update target while preserving current velocity (for smooth interruptions) */\n  setWithVelocity(to: number, velocity?: number): void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Check if paused */\n  isPaused(): boolean\n  /** Check if complete */\n  isComplete(): boolean\n  /** Get current value */\n  getValue(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring animation implementation\n */\nclass SpringAnimationImpl implements SpringAnimation, Animatable {\n  private position: number\n  private velocity: number\n  private target: number\n  private config: SpringConfig & Required<Pick<SpringConfig, 'stiffness' | 'damping' | 'mass' | 'restSpeed' | 'restDelta'>>\n  private state: AnimationState = AnimationState.Idle\n  private resolveComplete: (() => void) | null = null\n  private from: number\n  private to: number\n  private clampedFrom: number\n  private clampedTo: number\n\n  finished: Promise<void>\n\n  constructor(\n    from: number,\n    to: number,\n    config: SpringConfig = {}\n  ) {\n    // Validate config in development mode\n    validateSpringConfig(config)\n\n    this.from = from\n    this.to = to\n    this.clampedFrom = from\n    this.clampedTo = to\n    this.position = from\n    this.velocity = config.velocity ?? 0\n    this.target = to\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      stiffness: config.stiffness ?? defaultConfig.stiffness!,\n      damping: config.damping ?? defaultConfig.damping!,\n      mass: config.mass ?? defaultConfig.mass!,\n      restSpeed: config.restSpeed ?? defaultConfig.restSpeed!,\n      restDelta: config.restDelta ?? defaultConfig.restDelta!,\n    }\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): SpringAnimation {\n    if (this.state === AnimationState.Running) return this\n\n    this.state = AnimationState.Running\n    this.config.onStart?.()\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  pause(): void {\n    if (this.state === AnimationState.Running) {\n      this.state = AnimationState.Paused\n      globalLoop.remove(this)\n    }\n  }\n\n  resume(): void {\n    if (this.state === AnimationState.Paused) {\n      this.state = AnimationState.Running\n      globalLoop.add(this)\n    }\n  }\n\n  reverse(): void {\n    const temp = this.from\n    this.from = this.to\n    this.to = temp\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.target = this.to\n  }\n\n  set(to: number): void {\n    this.to = to\n    this.clampedTo = to\n    this.target = to\n  }\n\n  setWithVelocity(to: number, velocity?: number): void {\n    // Update from to current position for smooth continuation\n    this.from = this.position\n    this.clampedFrom = this.position\n    this.to = to\n    this.clampedTo = to\n    this.target = to\n\n    // Use provided velocity or preserve current velocity\n    if (velocity !== undefined) {\n      this.velocity = velocity\n    }\n    // If not running, start the animation\n    if (this.state !== AnimationState.Running) {\n      this.start()\n    }\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    const result = simulateSpring(\n      this.position,\n      this.velocity,\n      this.target,\n      this.config\n    )\n\n    this.position = result.position\n    this.velocity = result.velocity\n\n    // Handle clamping\n    if (this.config.clamp) {\n      const min = Math.min(this.clampedFrom, this.clampedTo)\n      const max = Math.max(this.clampedFrom, this.clampedTo)\n      this.position = clamp(this.position, min, max)\n    }\n\n    // Emit update\n    this.config.onUpdate?.(this.position)\n\n    // Check rest state\n    if (result.isRest) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.position = this.target // Ensure we end exactly at target\n      this.config.onUpdate?.(this.position)\n      this.config.onComplete?.()\n      this.config.onRest?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.state === AnimationState.Running\n  }\n\n  isPaused(): boolean {\n    return this.state === AnimationState.Paused\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  getValue(): number {\n    return this.position\n  }\n\n  getVelocity(): number {\n    return this.velocity\n  }\n\n  destroy(): void {\n    this.stop()\n    this.config.onUpdate = undefined\n    this.config.onStart = undefined\n    this.config.onComplete = undefined\n    this.config.onRest = undefined\n  }\n}\n\n/**\n * Create a spring animation\n *\n * @param from - Starting value\n * @param to - Target value\n * @param config - Spring configuration\n * @returns Spring animation controller\n *\n * @example\n * ```ts\n * const anim = spring(0, 100, {\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function spring(\n  from: number,\n  to: number,\n  config?: SpringConfig\n): SpringAnimation {\n  return new SpringAnimationImpl(from, to, config)\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { spring, type SpringAnimation } from './spring.js'\n\n/**\n * Spring value interface\n */\nexport interface SpringValue {\n  /** Get current value */\n  get(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Animate to a new value */\n  set(to: number, config?: Partial<SpringConfig>): void\n  /** Set value immediately without animation */\n  jump(to: number): void\n  /** Stop current animation at current position */\n  stop(): void\n  /** Update spring configuration */\n  setConfig(config: Partial<SpringConfig>): void\n  /** Subscribe to value changes */\n  subscribe(callback: (value: number) => void): () => void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Promise that resolves when current animation completes */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring value implementation\n */\nclass SpringValueImpl implements SpringValue {\n  private value: number\n  private config: SpringConfig\n  private currentAnimation: SpringAnimation | null = null\n  private subscribers = new Set<(value: number) => void>()\n  private resolveComplete: (() => void) | null = null\n  private finishedPromise: Promise<void>\n\n  constructor(initial: number, config: SpringConfig = {}) {\n    this.value = initial\n    this.config = { ...defaultConfig, ...config }\n\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  get(): number {\n    return this.value\n  }\n\n  getVelocity(): number {\n    return this.currentAnimation?.getVelocity() ?? 0\n  }\n\n  set(to: number, config: Partial<SpringConfig> = {}): void {\n    // Cancel existing animation\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n\n    // Capture resolver in local scope to prevent race condition\n    // Each animation gets its own resolver that won't be overwritten\n    let animationResolver: (() => void) | null = null\n\n    // Create new promise for this animation\n    this.finishedPromise = new Promise((resolve) => {\n      animationResolver = resolve\n      this.resolveComplete = resolve\n    })\n\n    // Create new animation\n    const mergedConfig = { ...this.config, ...config }\n    const originalOnUpdate = mergedConfig.onUpdate\n    const originalOnComplete = mergedConfig.onComplete\n\n    this.currentAnimation = spring(this.value, to, {\n      ...mergedConfig,\n      onUpdate: (value) => {\n        this.value = value\n        this.notify()\n        // Also call original onUpdate if provided\n        originalOnUpdate?.(value)\n      },\n      onComplete: () => {\n        originalOnComplete?.()\n        // Use captured resolver to prevent race condition\n        animationResolver?.()\n      },\n    })\n\n    this.currentAnimation.start()\n  }\n\n  jump(to: number): void {\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n    this.value = to\n    this.notify()\n  }\n\n  stop(): void {\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n    if (this.resolveComplete) {\n      this.resolveComplete()\n    }\n  }\n\n  setConfig(config: Partial<SpringConfig>): void {\n    this.config = { ...this.config, ...config }\n  }\n\n  subscribe(callback: (value: number) => void): () => void {\n    this.subscribers.add(callback)\n\n    // Immediately call with current value\n    callback(this.value)\n\n    return () => {\n      this.subscribers.delete(callback)\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.currentAnimation?.isAnimating() ?? false\n  }\n\n  get finished(): Promise<void> {\n    return this.finishedPromise\n  }\n\n  private notify(): void {\n    for (const subscriber of this.subscribers) {\n      subscriber(this.value)\n    }\n  }\n\n  destroy(): void {\n    this.currentAnimation?.destroy()\n    this.currentAnimation = null\n    this.subscribers.clear()\n  }\n}\n\n/**\n * Create a spring value\n *\n * @param initial - Initial value\n * @param config - Spring configuration\n * @returns Spring value controller\n *\n * @example\n * ```ts\n * const x = createSpringValue(0, { stiffness: 100, damping: 10 })\n *\n * x.subscribe((value) => {\n *   element.style.transform = `translateX(${value}px)`\n * })\n *\n * x.set(100) // Animates to 100\n * x.jump(0)  // Jumps to 0 immediately\n * ```\n */\nexport function createSpringValue(\n  initial: number,\n  config?: SpringConfig\n): SpringValue {\n  return new SpringValueImpl(initial, config)\n}\n\n// Re-export for type usage\nexport { SpringValueImpl as SpringValueClass }\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { createSpringValue, type SpringValue } from './spring-value.js'\n\n/**\n * Spring group interface\n */\nexport interface SpringGroup<T extends Record<string, number>> {\n  /** Get all current values */\n  get(): T\n  /** Get a single value by key */\n  getValue(key: keyof T): number\n  /** Animate to new values (partial update) */\n  set(values: Partial<T>, config?: Partial<SpringConfig>): void\n  /** Set values immediately without animation */\n  jump(values: Partial<T>): void\n  /** Subscribe to value changes */\n  subscribe(callback: (values: T) => void): () => void\n  /** Check if any spring is animating */\n  isAnimating(): boolean\n  /** Promise that resolves when all animations complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring group implementation\n */\nclass SpringGroupImpl<T extends Record<string, number>> implements SpringGroup<T> {\n  private values: Map<keyof T, SpringValue>\n  private config: SpringConfig\n  private subscribers = new Set<(values: T) => void>()\n  private resolveComplete: (() => void) | null = null\n  private finishedPromise: Promise<void>\n  private notifyRafId: number | null = null\n  private destroyed = false\n\n  constructor(initialValues: T, config: SpringConfig = {}) {\n    this.config = { ...defaultConfig, ...config }\n\n    // Create SpringValue for each key\n    this.values = new Map()\n    for (const [key, value] of Object.entries(initialValues)) {\n      const springValue = createSpringValue(value, this.config)\n      springValue.subscribe(() => this.scheduleNotify())\n      this.values.set(key as keyof T, springValue)\n    }\n\n    this.finishedPromise = Promise.resolve()\n\n    // Initialize promise handler\n    this.resetPromise()\n  }\n\n  private resetPromise(): void {\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  get(): T {\n    const result = {} as T\n    for (const [key, springValue] of this.values) {\n      (result as Record<string, number>)[key as string] = springValue.get()\n    }\n    return result\n  }\n\n  getValue(key: keyof T): number {\n    return this.values.get(key)?.get() ?? 0\n  }\n\n  set(values: Partial<T>, config: Partial<SpringConfig> = {}): void {\n    // Reset promise for new batch of animations\n    this.resetPromise()\n\n    const promises: Promise<void>[] = []\n\n    for (const [key, value] of Object.entries(values)) {\n      const springValue = this.values.get(key as keyof T)\n      if (springValue) {\n        springValue.set(value, config)\n        promises.push(springValue.finished)\n      }\n    }\n\n    // Resolve when all animations complete\n    Promise.all(promises).then(() => {\n      if (this.resolveComplete) {\n        this.resolveComplete()\n      }\n    })\n  }\n\n  jump(values: Partial<T>): void {\n    for (const [key, value] of Object.entries(values)) {\n      const springValue = this.values.get(key as keyof T)\n      if (springValue) {\n        springValue.jump(value)\n      }\n    }\n    // Note: notify() is already called by the spring subscriptions, so we don't call it again\n  }\n\n  subscribe(callback: (values: T) => void): () => void {\n    this.subscribers.add(callback)\n    callback(this.get())\n    return () => this.subscribers.delete(callback)\n  }\n\n  isAnimating(): boolean {\n    for (const springValue of this.values.values()) {\n      if (springValue.isAnimating()) return true\n    }\n    return false\n  }\n\n  get finished(): Promise<void> {\n    return this.finishedPromise\n  }\n\n  /**\n   * Schedule notification for next animation frame to prevent excessive updates.\n   * When animating multiple properties, this debounces notifications to once per frame\n   * instead of once per property update.\n   */\n  private scheduleNotify(): void {\n    // Skip if destroyed or already scheduled\n    if (this.destroyed || this.notifyRafId !== null) return\n\n    this.notifyRafId = requestAnimationFrame(() => {\n      this.notifyRafId = null\n      // Double-check destroyed state after RAF\n      if (!this.destroyed) {\n        this.notify()\n      }\n    })\n  }\n\n  private notify(): void {\n    const values = this.get()\n    for (const subscriber of this.subscribers) {\n      subscriber(values)\n    }\n  }\n\n  destroy(): void {\n    this.destroyed = true\n\n    // Cancel pending RAF to prevent memory leak\n    if (this.notifyRafId !== null) {\n      cancelAnimationFrame(this.notifyRafId)\n      this.notifyRafId = null\n    }\n\n    for (const springValue of this.values.values()) {\n      springValue.destroy()\n    }\n    this.subscribers.clear()\n  }\n}\n\n/**\n * Create a spring group for animating multiple values together\n *\n * @param initialValues - Initial values object\n * @param config - Spring configuration\n * @returns Spring group controller\n *\n * @example\n * ```ts\n * const group = createSpringGroup(\n *   { x: 0, y: 0, scale: 1 },\n *   { stiffness: 100, damping: 10 }\n * )\n *\n * group.subscribe((values) => {\n *   element.style.transform = `\n *     translate(${values.x}px, ${values.y}px)\n *     scale(${values.scale})\n *   `\n * })\n *\n * group.set({ x: 100, scale: 1.5 })\n * ```\n */\nexport function createSpringGroup<T extends Record<string, number>>(\n  initialValues: T,\n  config?: SpringConfig\n): SpringGroup<T> {\n  return new SpringGroupImpl(initialValues, config)\n}\n\n// Re-export for type usage\nexport { SpringGroupImpl as SpringGroupClass }\n","/**\n * Variants System - Named animation states with cascading support\n *\n * Provides a declarative way to define and orchestrate animations\n * across component hierarchies.\n */\n\nimport type { SpringConfig } from './config.js'\n\n// ============ Types ============\n\n/**\n * Animation values that can be animated\n */\nexport interface AnimationValues {\n  x?: number | string\n  y?: number | string\n  scale?: number\n  scaleX?: number\n  scaleY?: number\n  rotate?: number\n  rotateX?: number\n  rotateY?: number\n  rotateZ?: number\n  skewX?: number\n  skewY?: number\n  opacity?: number\n  width?: number | string\n  height?: number | string\n  backgroundColor?: string\n  borderRadius?: number | string\n  borderColor?: string\n  boxShadow?: string\n  color?: string\n  [key: string]: number | string | VariantTransition | undefined\n}\n\n/**\n * Transition configuration for a variant\n */\nexport interface VariantTransition {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Stagger children by this amount (ms) */\n  staggerChildren?: number\n  /** Delay children by this amount (ms) */\n  delayChildren?: number\n  /** Animate children before or after parent */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Custom stagger direction */\n  staggerDirection?: 1 | -1\n  /** Duration override for non-spring animations */\n  duration?: number\n  /** Easing function */\n  ease?: (t: number) => number\n}\n\n/**\n * A single variant definition\n */\nexport interface Variant extends AnimationValues {\n  transition?: VariantTransition\n}\n\n/**\n * Map of variant names to their definitions\n */\nexport interface Variants {\n  [key: string]: Variant | ((custom?: unknown) => Variant)\n}\n\n/**\n * Orchestration options for variant animations\n */\nexport interface OrchestrationOptions {\n  /** Delay before starting */\n  delay?: number\n  /** Animate children before or after */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Stagger children animations */\n  staggerChildren?: number\n  /** Delay before children start */\n  delayChildren?: number\n  /** Direction of stagger (-1 for reverse) */\n  staggerDirection?: 1 | -1\n}\n\n/**\n * Resolved variant with all values computed\n */\nexport interface ResolvedVariant {\n  values: AnimationValues\n  transition: VariantTransition\n}\n\n// ============ Variant Resolution ============\n\n/**\n * Resolve a variant definition to concrete values\n */\nexport function resolveVariant(\n  variant: Variant | ((custom?: unknown) => Variant) | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variant) {\n    return { values: {}, transition: {} }\n  }\n\n  // Handle function variants\n  const resolved = typeof variant === 'function' ? variant(custom) : variant\n\n  // Extract transition from values\n  const { transition = {}, ...values } = resolved\n\n  return { values, transition }\n}\n\n/**\n * Get variant from variants object by name\n */\nexport function getVariant(\n  variants: Variants | undefined,\n  name: string | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variants || !name) {\n    return { values: {}, transition: {} }\n  }\n\n  return resolveVariant(variants[name], custom)\n}\n\n/**\n * Merge multiple variants together\n */\nexport function mergeVariants(...variants: (Variant | undefined)[]): Variant {\n  const merged: Variant = {}\n\n  for (const variant of variants) {\n    if (variant) {\n      Object.assign(merged, variant)\n      // Merge transitions\n      if (variant.transition) {\n        merged.transition = { ...merged.transition, ...variant.transition }\n      }\n    }\n  }\n\n  return merged\n}\n\n// ============ Animation Value Helpers ============\n\n/**\n * Check if a value is a transform property\n */\nexport function isTransformProperty(key: string): boolean {\n  return [\n    'x', 'y', 'z',\n    'scale', 'scaleX', 'scaleY', 'scaleZ',\n    'rotate', 'rotateX', 'rotateY', 'rotateZ',\n    'skew', 'skewX', 'skewY',\n    'perspective',\n    'transformOrigin',\n  ].includes(key)\n}\n\n/**\n * Check if a value is animatable\n */\nexport function isAnimatable(value: unknown): value is number | string {\n  return typeof value === 'number' || typeof value === 'string'\n}\n\n/**\n * Parse a value with unit (e.g., \"100px\" -> { value: 100, unit: \"px\" })\n */\nexport function parseValueWithUnit(value: string | number): { value: number; unit: string } {\n  if (typeof value === 'number') {\n    return { value, unit: '' }\n  }\n\n  const match = value.match(/^(-?[\\d.]+)(.*)$/)\n  if (match && match[1]) {\n    return { value: parseFloat(match[1]), unit: match[2] || '' }\n  }\n\n  return { value: 0, unit: '' }\n}\n\n/**\n * Build transform string from values\n */\nexport function buildTransformString(values: AnimationValues): string {\n  const transforms: string[] = []\n\n  if (values.x !== undefined || values.y !== undefined) {\n    const x = values.x ?? 0\n    const y = values.y ?? 0\n    transforms.push(`translate(${x}px, ${y}px)`)\n  }\n\n  if (values.scale !== undefined) {\n    transforms.push(`scale(${values.scale})`)\n  } else {\n    if (values.scaleX !== undefined) {\n      transforms.push(`scaleX(${values.scaleX})`)\n    }\n    if (values.scaleY !== undefined) {\n      transforms.push(`scaleY(${values.scaleY})`)\n    }\n  }\n\n  if (values.rotate !== undefined) {\n    transforms.push(`rotate(${values.rotate}deg)`)\n  }\n  if (values.rotateX !== undefined) {\n    transforms.push(`rotateX(${values.rotateX}deg)`)\n  }\n  if (values.rotateY !== undefined) {\n    transforms.push(`rotateY(${values.rotateY}deg)`)\n  }\n  if (values.rotateZ !== undefined) {\n    transforms.push(`rotateZ(${values.rotateZ}deg)`)\n  }\n\n  if (values.skewX !== undefined) {\n    transforms.push(`skewX(${values.skewX}deg)`)\n  }\n  if (values.skewY !== undefined) {\n    transforms.push(`skewY(${values.skewY}deg)`)\n  }\n\n  return transforms.join(' ')\n}\n\n/**\n * Apply animation values to an element's style\n */\nexport function applyValuesToElement(element: HTMLElement, values: AnimationValues): void {\n  const transform = buildTransformString(values)\n  if (transform) {\n    element.style.transform = transform\n  }\n\n  // Apply non-transform properties\n  if (values.opacity !== undefined) {\n    element.style.opacity = String(values.opacity)\n  }\n  if (values.backgroundColor !== undefined) {\n    element.style.backgroundColor = values.backgroundColor\n  }\n  if (values.borderRadius !== undefined) {\n    element.style.borderRadius =\n      typeof values.borderRadius === 'number' ? `${values.borderRadius}px` : values.borderRadius\n  }\n  if (values.borderColor !== undefined) {\n    element.style.borderColor = values.borderColor\n  }\n  if (values.boxShadow !== undefined) {\n    element.style.boxShadow = values.boxShadow\n  }\n  if (values.color !== undefined) {\n    element.style.color = values.color\n  }\n  if (values.width !== undefined) {\n    element.style.width =\n      typeof values.width === 'number' ? `${values.width}px` : values.width\n  }\n  if (values.height !== undefined) {\n    element.style.height =\n      typeof values.height === 'number' ? `${values.height}px` : values.height\n  }\n}\n\n// ============ Orchestration ============\n\n/**\n * Calculate stagger delays for children\n */\nexport function calculateStaggerDelays(\n  count: number,\n  options: OrchestrationOptions\n): number[] {\n  const { staggerChildren = 0, staggerDirection = 1, delayChildren = 0 } = options\n\n  const delays: number[] = []\n  for (let i = 0; i < count; i++) {\n    const index = staggerDirection === -1 ? count - 1 - i : i\n    delays.push(delayChildren + index * staggerChildren)\n  }\n\n  return delays\n}\n\n/**\n * Create an orchestrated animation sequence\n */\nexport interface OrchestrationSequence {\n  /** Execute parent animation */\n  parent: () => Promise<void>\n  /** Execute children animations */\n  children: () => Promise<void>\n  /** Execute all with proper ordering */\n  execute: () => Promise<void>\n}\n\nexport function createOrchestration(\n  parentAnim: () => Promise<void>,\n  childrenAnims: (() => Promise<void>)[],\n  options: OrchestrationOptions = {}\n): OrchestrationSequence {\n  const { when = false, delay = 0 } = options\n  const delays = calculateStaggerDelays(childrenAnims.length, options)\n\n  const parent = async () => {\n    if (delay > 0) {\n      await new Promise((resolve) => setTimeout(resolve, delay))\n    }\n    await parentAnim()\n  }\n\n  const children = async () => {\n    await Promise.all(\n      childrenAnims.map((anim, i) =>\n        new Promise<void>((resolve) => {\n          setTimeout(async () => {\n            await anim()\n            resolve()\n          }, delays[i])\n        })\n      )\n    )\n  }\n\n  const execute = async () => {\n    switch (when) {\n      case 'beforeChildren':\n        await parent()\n        await children()\n        break\n      case 'afterChildren':\n        await children()\n        await parent()\n        break\n      default:\n        // Run in parallel\n        await Promise.all([parent(), children()])\n    }\n  }\n\n  return { parent, children, execute }\n}\n\n// ============ Variant Presets ============\n\n/**\n * Common animation presets\n */\nexport const variantPresets: Record<string, { initial: Variant; animate: Variant; exit: Variant }> = {\n  /** Fade in from invisible */\n  fadeIn: {\n    initial: { opacity: 0 },\n    animate: { opacity: 1 },\n    exit: { opacity: 0 },\n  },\n\n  /** Fade in and slide up */\n  fadeInUp: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n\n  /** Fade in and slide down */\n  fadeInDown: {\n    initial: { opacity: 0, y: -20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: 20 },\n  },\n\n  /** Fade in and slide from left */\n  fadeInLeft: {\n    initial: { opacity: 0, x: -20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: 20 },\n  },\n\n  /** Fade in and slide from right */\n  fadeInRight: {\n    initial: { opacity: 0, x: 20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: -20 },\n  },\n\n  /** Scale up from small */\n  scaleIn: {\n    initial: { opacity: 0, scale: 0.8 },\n    animate: { opacity: 1, scale: 1 },\n    exit: { opacity: 0, scale: 0.8 },\n  },\n\n  /** Pop in with overshoot */\n  popIn: {\n    initial: { opacity: 0, scale: 0.5 },\n    animate: {\n      opacity: 1,\n      scale: 1,\n      transition: { spring: { stiffness: 400, damping: 15 } },\n    },\n    exit: { opacity: 0, scale: 0.5 },\n  },\n\n  /** Slide in from bottom (percentage-based) */\n  slideUp: {\n    initial: { y: 100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: 100, opacity: 0 },\n  },\n\n  /** Slide in from top */\n  slideDown: {\n    initial: { y: -100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: -100, opacity: 0 },\n  },\n\n  /** Slide in from left */\n  slideLeft: {\n    initial: { x: -100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: -100, opacity: 0 },\n  },\n\n  /** Slide in from right */\n  slideRight: {\n    initial: { x: 100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: 100, opacity: 0 },\n  },\n\n  /** Container with staggered children */\n  staggerContainer: {\n    initial: {},\n    animate: {\n      transition: {\n        staggerChildren: 0.1,\n        delayChildren: 0.1,\n      },\n    },\n    exit: {\n      transition: {\n        staggerChildren: 0.05,\n        staggerDirection: -1,\n      },\n    },\n  },\n\n  /** Item for staggered lists */\n  staggerItem: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n}\n\n/**\n * Create a custom variant preset\n */\nexport function createVariantPreset(\n  initial: Variant,\n  animate: Variant,\n  exit?: Variant\n): { initial: Variant; animate: Variant; exit: Variant } {\n  return {\n    initial,\n    animate,\n    exit: exit || initial,\n  }\n}\n\n// ============ Type Guards ============\n\n/**\n * Check if a value is a Variants object\n */\nexport function isVariants(value: unknown): value is Variants {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    !Array.isArray(value) &&\n    Object.values(value).every(\n      (v) => typeof v === 'object' || typeof v === 'function'\n    )\n  )\n}\n\n/**\n * Check if a value is a Variant\n */\nexport function isVariant(value: unknown): value is Variant {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n}\n","import type { SpringAnimation } from '../core/spring.js'\n\n/**\n * Stagger options interface\n */\nexport interface StaggerOptions {\n  /** Delay between animations (ms) or function returning delay */\n  delay?: number | ((index: number) => number)\n  /** Where to start staggering from */\n  from?: 'first' | 'last' | 'center' | number\n}\n\n/**\n * Run animations one after another (sequentially)\n *\n * @param animations - Array of functions that create animations\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * await sequence([\n *   () => spring(0, 100, { onUpdate: updateOpacity }).start(),\n *   () => spring(0, 200, { onUpdate: updateX }).start(),\n *   () => spring(0, 50, { onUpdate: updateY }).start(),\n * ])\n *\n * console.log('All animations complete!')\n * ```\n */\nexport async function sequence(\n  animations: Array<() => SpringAnimation>\n): Promise<void> {\n  for (const createAnimation of animations) {\n    const anim = createAnimation()\n    await anim.finished\n  }\n}\n\n/**\n * Run animations simultaneously (in parallel)\n *\n * @param animations - Array of functions that create animations\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * await parallel([\n *   () => spring(0, 100, { onUpdate: updateOpacity }).start(),\n *   () => spring(0, 200, { onUpdate: updateX }).start(),\n *   () => spring(1, 2, { onUpdate: updateScale }).start(),\n * ])\n *\n * console.log('All animations complete!')\n * ```\n */\nexport async function parallel(\n  animations: Array<() => SpringAnimation>\n): Promise<void> {\n  const promises = animations.map((createAnimation) => {\n    const anim = createAnimation()\n    return anim.finished\n  })\n  await Promise.all(promises)\n}\n\n/**\n * Run animations with staggered delays\n *\n * @param items - Array of items to animate\n * @param animate - Function that creates an animation for each item\n * @param options - Stagger options\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * const elements = document.querySelectorAll('.item')\n *\n * await stagger(\n *   elements,\n *   (element, index) => {\n *     return spring(0, 1, {\n *       onUpdate: (value) => {\n *         element.style.opacity = String(value)\n *       },\n *     }).start()\n *   },\n *   { delay: 50 }\n * )\n * ```\n */\nexport async function stagger<T>(\n  items: T[],\n  animate: (item: T, index: number) => SpringAnimation,\n  options: StaggerOptions = {}\n): Promise<void> {\n  const { delay = 0, from = 'first' } = options\n\n  // Calculate start index based on 'from' option\n  let startIndex = 0\n  if (from === 'last') startIndex = items.length - 1\n  else if (from === 'center') startIndex = Math.floor(items.length / 2)\n  else if (typeof from === 'number') startIndex = from\n\n  // Build index order from start point outward\n  const indices: number[] = []\n  const used = new Set<number>()\n\n  indices.push(startIndex)\n  used.add(startIndex)\n\n  for (let offset = 1; offset < items.length; offset++) {\n    const left = startIndex - offset\n    const right = startIndex + offset\n\n    // Add right first if it exists\n    if (right < items.length && !used.has(right)) {\n      indices.push(right)\n      used.add(right)\n    }\n\n    // Then add left if it exists\n    if (left >= 0 && !used.has(left)) {\n      indices.push(left)\n      used.add(left)\n    }\n  }\n\n  // All indices are already added by the main loop above\n  // No need for defensive fallback as the logic is complete\n\n  // Start animations with delay\n  const getDelay = typeof delay === 'function' ? delay : (_i: number) => delay\n  const animations: SpringAnimation[] = []\n\n  for (let i = 0; i < indices.length; i++) {\n    const index = indices[i]!\n    const anim = animate(items[index]!, index)\n    animations.push(anim)\n\n    const delayMs = getDelay(i)\n\n    if (delayMs > 0) {\n      setTimeout(() => {\n        anim.start()\n      }, delayMs)\n    } else {\n      anim.start()\n    }\n  }\n\n  await Promise.all(animations.map((a) => a.finished))\n}\n","import type { SpringConfig } from '../core/config.js'\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\n/**\n * Trail configuration interface\n */\nexport interface TrailConfig extends SpringConfig {\n  /** Frames delay between items following each other */\n  followDelay?: number\n}\n\n/**\n * Trail interface\n */\nexport interface Trail {\n  /** Set the leader value (followers will follow with delay) */\n  set(value: number): void\n  /** Set all values immediately without animation */\n  jump(value: number): void\n  /** Get all current values */\n  getValues(): number[]\n  /** Subscribe to value changes */\n  subscribe(callback: (values: number[]) => void): () => void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Trail implementation\n * Creates a chain of springs where each spring follows the previous one\n */\nclass TrailImpl implements Trail {\n  private springs: SpringValue[]\n  private leader: SpringValue\n  private followDelay: number\n  private subscribers = new Set<(values: number[]) => void>()\n  private frameCount: number = 0\n  private pendingUpdates: Map<number, number> = new Map()\n\n  constructor(count: number, config: TrailConfig = {}) {\n    const { followDelay = 2, ...springConfig } = config\n\n    this.followDelay = followDelay\n\n    // Create leader spring\n    this.leader = createSpringValue(0, springConfig)\n\n    // Create follower springs\n    this.springs = []\n    for (let i = 0; i < count; i++) {\n      const spring = createSpringValue(0, springConfig)\n      this.springs.push(spring)\n    }\n\n    // Connect leader to followers with delay\n    this.leader.subscribe(() => {\n      this.frameCount++\n      this.scheduleFollowerUpdates()\n    })\n  }\n\n  private scheduleFollowerUpdates(): void {\n    const targetValue = this.leader.get()\n\n    for (let i = 0; i < this.springs.length; i++) {\n      const delayFrames = (i + 1) * this.followDelay\n      const targetFrame = this.frameCount + delayFrames\n\n      // Store the pending update\n      this.pendingUpdates.set(i, targetFrame)\n\n      // Schedule the update\n      this.scheduleFollowerUpdate(i, targetValue, targetFrame, delayFrames)\n    }\n  }\n\n  private scheduleFollowerUpdate(\n    index: number,\n    targetValue: number,\n    targetFrame: number,\n    _delayFrames: number\n  ): void {\n    const startFrame = this.frameCount\n    const framesToWait = targetFrame - startFrame\n\n    if (framesToWait <= 0) {\n      // Update immediately if delay has passed\n      this.springs[index]!.set(targetValue)\n    } else {\n      // Use setTimeout for delay (approximately 16ms per frame at 60fps)\n      const delayMs = Math.max(framesToWait * 16, 0)\n\n      setTimeout(() => {\n        // Only update if this is still the current pending update\n        const currentTarget = this.pendingUpdates.get(index)\n        if (currentTarget === targetFrame) {\n          this.springs[index]!.set(targetValue)\n        }\n      }, delayMs)\n    }\n  }\n\n  set(value: number): void {\n    this.leader.set(value)\n  }\n\n  jump(value: number): void {\n    this.leader.jump(value)\n    for (const spring of this.springs) {\n      spring.jump(value)\n    }\n  }\n\n  getValues(): number[] {\n    return this.springs.map((s) => s.get())\n  }\n\n  subscribe(callback: (values: number[]) => void): () => void {\n    this.subscribers.add(callback)\n\n    // Subscribe to each follower spring\n    const unsubscribers: (() => void)[] = []\n    for (const spring of this.springs) {\n      unsubscribers.push(\n        spring.subscribe(() => {\n          this.notify()\n        })\n      )\n    }\n\n    // Immediately call with current values\n    callback(this.getValues())\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback)\n      for (const unsubscribe of unsubscribers) {\n        unsubscribe()\n      }\n    }\n  }\n\n  private notify(): void {\n    const values = this.getValues()\n    for (const subscriber of this.subscribers) {\n      subscriber(values)\n    }\n  }\n\n  destroy(): void {\n    this.leader.destroy()\n    for (const spring of this.springs) {\n      spring.destroy()\n    }\n    this.subscribers.clear()\n    this.pendingUpdates.clear()\n  }\n}\n\n/**\n * Create a trail animation\n *\n * @param count - Number of items in the trail\n * @param config - Trail configuration\n * @returns Trail controller\n *\n * @example\n * ```ts\n * const trail = createTrail(5, {\n *   stiffness: 200,\n *   damping: 25,\n *   followDelay: 3,\n * })\n *\n * trail.subscribe((values) => {\n *   elements.forEach((el, i) => {\n *     el.style.transform = `translateX(${values[i]}px)`\n *   })\n * })\n *\n * trail.set(100) // First item moves immediately, others follow\n * ```\n */\nexport function createTrail(count: number, config?: TrailConfig): Trail {\n  return new TrailImpl(count, config)\n}\n","import { globalLoop, type Animatable, AnimationState } from './loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateDecayConfig } from '../utils/warnings.js'\n\n/**\n * Decay animation configuration interface\n */\nexport interface DecayConfig {\n  /** Initial velocity */\n  velocity: number\n  /** Deceleration factor (0-1, higher = slower decay) */\n  deceleration?: number\n  /** Optional clamp range [min, max] */\n  clamp?: [number, number]\n  /** Callback called on each update */\n  onUpdate?: (value: number) => void\n  /** Callback called when complete */\n  onComplete?: () => void\n}\n\n/**\n * Decay animation interface\n */\nexport interface DecayAnimation {\n  /** Start the decay animation */\n  start(): DecayAnimation\n  /** Stop the decay animation */\n  stop(): void\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n}\n\n/**\n * Decay animation implementation\n * Simulates natural momentum/deceleration\n */\nclass DecayAnimationImpl implements DecayAnimation, Animatable {\n  private value: number\n  private velocity: number\n  private deceleration: number\n  private clampRange: [number, number] | undefined\n  private state: AnimationState = AnimationState.Idle\n  private rafId: number | null = null\n  private resolveComplete: (() => void) | null = null\n  private config: DecayConfig\n\n  finished: Promise<void>\n\n  constructor(config: DecayConfig) {\n    // Validate config in development mode\n    validateDecayConfig(config)\n\n    this.value = 0\n    this.velocity = config.velocity\n    this.deceleration = config.deceleration ?? 0.998\n    this.clampRange = config.clamp\n    this.state = AnimationState.Idle\n    this.config = config\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): DecayAnimation {\n    if (this.state === AnimationState.Running) return this\n    this.state = AnimationState.Running\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    // Apply deceleration\n    this.velocity *= this.deceleration\n    this.value += this.velocity\n\n    // Apply clamp\n    if (this.clampRange) {\n      const [min, max] = this.clampRange\n      this.value = clamp(this.value, min, max)\n\n      // Stop if we hit a boundary with velocity in that direction\n      if ((this.value <= min && this.velocity < 0) || (this.value >= max && this.velocity > 0)) {\n        this.velocity = 0\n      }\n    }\n\n    this.config.onUpdate?.(this.value)\n\n    // Check if stopped\n    if (Math.abs(this.velocity) < 0.01) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.config.onComplete?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  destroy(): void {\n    this.stop()\n    this.config.onUpdate = undefined\n    this.config.onComplete = undefined\n  }\n}\n\n/**\n * Create a decay animation\n *\n * @param config - Decay configuration\n * @returns Decay animation controller\n *\n * @example\n * ```ts\n * const anim = decay({\n *   velocity: 1000,\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function decay(config: DecayConfig): DecayAnimation {\n  return new DecayAnimationImpl(config)\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Keyframe definition with optional per-keyframe config\n */\nexport interface Keyframe<T = number> {\n  /** Target value at this keyframe */\n  value: T\n  /** Time position (0-1) for this keyframe. If not provided, evenly distributed */\n  at?: number\n  /** Spring config override for transition TO this keyframe */\n  config?: SpringConfig\n}\n\n/**\n * Options for keyframe animation\n */\nexport interface KeyframesOptions {\n  /** Default spring configuration */\n  config?: SpringConfig\n  /** Time positions for keyframes (0-1). Length must match values array */\n  times?: number[]\n  /** Callback for each keyframe transition start */\n  onKeyframe?: (index: number) => void\n  /** Callback when all keyframes complete */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (value: number) => void\n}\n\n/**\n * Keyframes animation controller\n */\nexport interface KeyframesAnimation {\n  /** Start the animation */\n  play: () => Promise<void>\n  /** Pause the animation */\n  pause: () => void\n  /** Resume a paused animation */\n  resume: () => void\n  /** Stop and reset to initial value */\n  stop: () => void\n  /** Get current value */\n  get: () => number\n  /** Get current keyframe index */\n  getCurrentKeyframe: () => number\n  /** Check if animation is playing */\n  isPlaying: () => boolean\n  /** Jump to specific keyframe */\n  jumpTo: (index: number) => void\n  /** Destroy and cleanup */\n  destroy: () => void\n}\n\n/**\n * Create a keyframe-based spring animation.\n * Animates through a sequence of values using spring physics.\n *\n * @example Basic keyframes\n * ```ts\n * const anim = keyframes([0, 100, 50, 100], {\n *   config: { stiffness: 200, damping: 20 },\n *   onUpdate: (value) => element.style.opacity = value / 100,\n * })\n * await anim.play()\n * ```\n *\n * @example With time positions\n * ```ts\n * const anim = keyframes([0, 100, 0], {\n *   times: [0, 0.3, 1], // 100 at 30%, back to 0 at 100%\n *   onUpdate: (value) => console.log(value),\n * })\n * ```\n *\n * @example With per-keyframe configs\n * ```ts\n * const anim = keyframes([\n *   { value: 0 },\n *   { value: 100, config: { stiffness: 500 } }, // Quick to 100\n *   { value: 50, config: { stiffness: 100 } },  // Slow to 50\n * ])\n * ```\n */\nexport function keyframes(\n  values: (number | Keyframe<number>)[],\n  options: KeyframesOptions = {}\n): KeyframesAnimation {\n  const {\n    config = {},\n    times,\n    onKeyframe,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Normalize keyframes\n  const normalizedKeyframes = values.map((v, i): Keyframe<number> => {\n    if (typeof v === 'number') {\n      return {\n        value: v,\n        at: times?.[i],\n      }\n    }\n    return { ...v, at: v.at ?? times?.[i] }\n  })\n\n  // Fill in missing time positions (evenly distributed)\n  const keyframeCount = normalizedKeyframes.length\n  normalizedKeyframes.forEach((kf, i) => {\n    if (kf.at === undefined) {\n      kf.at = keyframeCount > 1 ? i / (keyframeCount - 1) : 0\n    }\n  })\n\n  // Sort by time position\n  normalizedKeyframes.sort((a, b) => (a.at ?? 0) - (b.at ?? 0))\n\n  // State\n  let currentIndex = 0\n  let isPlaying = false\n  let isPaused = false\n  let spring: ReturnType<typeof createSpringValue> | null = null\n  let currentValue = normalizedKeyframes[0]?.value ?? 0\n  let destroyed = false\n\n  const createSpring = () => {\n    if (spring) {\n      spring.destroy()\n    }\n\n    const currentKf = normalizedKeyframes[currentIndex]\n    const springConfig = currentKf?.config ?? config\n\n    spring = createSpringValue(currentValue, springConfig)\n    spring.subscribe((value) => {\n      currentValue = value\n      onUpdate?.(value)\n    })\n  }\n\n  const animateToNext = async (): Promise<boolean> => {\n    if (destroyed || isPaused) return false\n    if (currentIndex >= normalizedKeyframes.length - 1) return false\n\n    currentIndex++\n    const targetKf = normalizedKeyframes[currentIndex]\n    if (!targetKf) return false\n\n    // Create new spring with keyframe-specific config if needed\n    if (targetKf.config) {\n      createSpring()\n    }\n\n    onKeyframe?.(currentIndex)\n\n    if (spring) {\n      spring.set(targetKf.value)\n\n      // Wait for spring to settle\n      await new Promise<void>((resolve) => {\n        const checkComplete = () => {\n          if (destroyed || isPaused) {\n            resolve()\n            return\n          }\n\n          if (spring && !spring.isAnimating()) {\n            resolve()\n          } else {\n            requestAnimationFrame(checkComplete)\n          }\n        }\n        // Give spring time to start\n        setTimeout(checkComplete, 16)\n      })\n    }\n\n    return true\n  }\n\n  const animation: KeyframesAnimation = {\n    play: async () => {\n      if (destroyed) return\n      if (isPlaying) return\n\n      isPlaying = true\n      isPaused = false\n\n      // Reset if at end\n      if (currentIndex >= normalizedKeyframes.length - 1) {\n        currentIndex = 0\n        currentValue = normalizedKeyframes[0]?.value ?? 0\n      }\n\n      createSpring()\n      onKeyframe?.(0)\n\n      // Animate through all keyframes\n      while (await animateToNext()) {\n        // Continue to next keyframe\n      }\n\n      if (!isPaused && !destroyed) {\n        isPlaying = false\n        onComplete?.()\n      }\n    },\n\n    pause: () => {\n      isPaused = true\n      isPlaying = false\n      if (spring) {\n        spring.stop()\n      }\n    },\n\n    resume: () => {\n      if (!isPaused || destroyed) return\n      isPaused = false\n      isPlaying = true\n\n      // Continue from current position\n      const continueAnimation = async () => {\n        while (await animateToNext()) {\n          // Continue to next keyframe\n        }\n\n        if (!isPaused && !destroyed) {\n          isPlaying = false\n          onComplete?.()\n        }\n      }\n\n      continueAnimation()\n    },\n\n    stop: () => {\n      isPaused = false\n      isPlaying = false\n      currentIndex = 0\n      currentValue = normalizedKeyframes[0]?.value ?? 0\n\n      if (spring) {\n        spring.jump(currentValue)\n      }\n    },\n\n    get: () => currentValue,\n\n    getCurrentKeyframe: () => currentIndex,\n\n    isPlaying: () => isPlaying,\n\n    jumpTo: (index: number) => {\n      if (index < 0 || index >= normalizedKeyframes.length) return\n\n      currentIndex = index\n      const targetValue = normalizedKeyframes[index]?.value ?? 0\n      currentValue = targetValue\n\n      if (spring) {\n        spring.jump(targetValue)\n      }\n\n      onUpdate?.(targetValue)\n      onKeyframe?.(index)\n    },\n\n    destroy: () => {\n      destroyed = true\n      isPlaying = false\n      isPaused = false\n\n      if (spring) {\n        spring.destroy()\n        spring = null\n      }\n    },\n  }\n\n  return animation\n}\n\n/**\n * Helper to create a keyframe sequence from an array shorthand\n *\n * @example\n * ```ts\n * // Equivalent to: keyframes([0, 100, 50])\n * const values = parseKeyframeArray([0, 100, 50])\n * ```\n */\nexport function parseKeyframeArray(\n  values: number[],\n  times?: number[]\n): Keyframe<number>[] {\n  return values.map((value, index) => ({\n    value,\n    at: times?.[index],\n  }))\n}\n\n/**\n * Check if a value is a keyframe array (for animate prop detection)\n */\nexport function isKeyframeArray(value: unknown): value is number[] {\n  return Array.isArray(value) && value.every((v) => typeof v === 'number')\n}\n","/**\n * Imperative animate function for direct element animation\n *\n * Similar to Framer Motion's animate() function - allows animating elements\n * without React hooks.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\nexport interface AnimateTarget {\n  [property: string]: number | string | number[] | string[]\n}\n\nexport interface AnimateOptions {\n  /** Spring stiffness */\n  stiffness?: number\n  /** Spring damping */\n  damping?: number\n  /** Spring mass */\n  mass?: number\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Duration hint for non-spring animations */\n  duration?: number\n  /** Ease function for non-spring animations */\n  ease?: (t: number) => number\n  /** Called on each frame with current values */\n  onUpdate?: (values: Record<string, number>) => void\n  /** Called when animation completes */\n  onComplete?: () => void\n}\n\nexport interface AnimateControls {\n  /** Stop the animation */\n  stop: () => void\n  /** Pause the animation */\n  pause: () => void\n  /** Resume a paused animation */\n  resume: () => void\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Check if animation is running */\n  isAnimating: () => boolean\n  /** Promise that resolves when animation completes */\n  finished: Promise<void>\n}\n\n// Transform properties that should be combined\nconst transformProperties = new Set([\n  'x', 'y', 'z',\n  'scale', 'scaleX', 'scaleY', 'scaleZ',\n  'rotate', 'rotateX', 'rotateY', 'rotateZ',\n  'skew', 'skewX', 'skewY',\n])\n\n// Properties that need 'px' suffix\nconst pxProperties = new Set([\n  'x', 'y', 'z',\n  'width', 'height',\n  'top', 'right', 'bottom', 'left',\n  'padding', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft',\n  'margin', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft',\n  'borderWidth', 'borderRadius',\n  'fontSize', 'letterSpacing', 'lineHeight',\n])\n\nfunction buildTransform(values: Map<string, number>): string {\n  const parts: string[] = []\n\n  const x = values.get('x')\n  const y = values.get('y')\n  const z = values.get('z')\n\n  if (x !== undefined || y !== undefined || z !== undefined) {\n    parts.push(`translate3d(${x ?? 0}px, ${y ?? 0}px, ${z ?? 0}px)`)\n  }\n\n  const scale = values.get('scale')\n  const scaleX = values.get('scaleX')\n  const scaleY = values.get('scaleY')\n\n  if (scale !== undefined) {\n    parts.push(`scale(${scale})`)\n  } else if (scaleX !== undefined || scaleY !== undefined) {\n    parts.push(`scale(${scaleX ?? 1}, ${scaleY ?? 1})`)\n  }\n\n  const rotate = values.get('rotate') ?? values.get('rotateZ')\n  const rotateX = values.get('rotateX')\n  const rotateY = values.get('rotateY')\n\n  if (rotateX !== undefined) parts.push(`rotateX(${rotateX}deg)`)\n  if (rotateY !== undefined) parts.push(`rotateY(${rotateY}deg)`)\n  if (rotate !== undefined) parts.push(`rotate(${rotate}deg)`)\n\n  const skewX = values.get('skewX')\n  const skewY = values.get('skewY')\n  if (skewX !== undefined || skewY !== undefined) {\n    parts.push(`skew(${skewX ?? 0}deg, ${skewY ?? 0}deg)`)\n  }\n\n  return parts.join(' ')\n}\n\nfunction applyStylesToElement(element: Element, values: Map<string, number>): void {\n  const el = element as HTMLElement\n  const transformValues = new Map<string, number>()\n  const styleValues: Record<string, string> = {}\n\n  values.forEach((value, property) => {\n    if (transformProperties.has(property)) {\n      transformValues.set(property, value)\n    } else if (property === 'opacity') {\n      styleValues.opacity = String(value)\n    } else if (pxProperties.has(property)) {\n      styleValues[property] = `${value}px`\n    } else {\n      styleValues[property] = String(value)\n    }\n  })\n\n  if (transformValues.size > 0) {\n    el.style.transform = buildTransform(transformValues)\n  }\n\n  Object.entries(styleValues).forEach(([prop, val]) => {\n    el.style.setProperty(prop, val)\n  })\n}\n\nfunction parseCurrentValue(element: Element, property: string): number {\n  const el = element as HTMLElement\n  const computed = getComputedStyle(el)\n\n  if (property === 'opacity') {\n    return parseFloat(computed.opacity) || 1\n  }\n\n  if (transformProperties.has(property)) {\n    // Parse from transform matrix - simplified, return 0 as default\n    const transform = computed.transform\n    if (transform === 'none') {\n      if (property === 'scale' || property === 'scaleX' || property === 'scaleY') {\n        return 1\n      }\n      return 0\n    }\n    // For complex parsing, return sensible defaults\n    if (property === 'scale' || property === 'scaleX' || property === 'scaleY') {\n      return 1\n    }\n    return 0\n  }\n\n  const value = computed.getPropertyValue(property)\n  return parseFloat(value) || 0\n}\n\n/**\n * Animate an element or selector with spring physics\n *\n * @example Basic usage\n * ```ts\n * import { animate } from '@oxog/springkit'\n *\n * // Animate a single element\n * const controls = animate(element, { x: 100, opacity: 0.5 })\n *\n * // Wait for completion\n * await controls.finished\n * ```\n *\n * @example With selector\n * ```ts\n * animate('.box', { scale: 1.2, rotate: 45 }, {\n *   stiffness: 300,\n *   damping: 20,\n *   onComplete: () => console.log('Done!')\n * })\n * ```\n *\n * @example Keyframes\n * ```ts\n * animate(element, { opacity: [0, 1, 0.5, 1] })\n * ```\n *\n * @example Control animation\n * ```ts\n * const controls = animate(element, { x: 200 })\n * controls.pause()\n * controls.resume()\n * controls.stop()\n * ```\n */\nexport function animate(\n  elementOrSelector: Element | string,\n  target: AnimateTarget,\n  options: AnimateOptions = {}\n): AnimateControls {\n  const { delay = 0, onUpdate, onComplete, ...springConfig } = options\n\n  // Resolve element\n  const element = typeof elementOrSelector === 'string'\n    ? document.querySelector(elementOrSelector)\n    : elementOrSelector\n\n  if (!element) {\n    console.warn('animate: Element not found')\n    return createNoopControls()\n  }\n\n  const springs = new Map<string, SpringValue>()\n  const currentValues = new Map<string, number>()\n  let isRunning = true\n  let isPaused = false\n  let resolveFinished: () => void\n  // Track all RAF IDs for proper cleanup\n  const rafIds = new Set<number>()\n  let delayTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  const finished = new Promise<void>((resolve, _reject) => {\n    resolveFinished = resolve\n  })\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const checkAllComplete = () => {\n    let allComplete = true\n    springs.forEach((spring) => {\n      if (spring.isAnimating()) {\n        allComplete = false\n      }\n    })\n    return allComplete\n  }\n\n  const startAnimation = () => {\n    const entries = Object.entries(target)\n    let completedCount = 0\n    const totalAnimations = entries.length\n\n    entries.forEach(([property, value]) => {\n      const values = Array.isArray(value) ? value : [value]\n      const startValue = parseCurrentValue(element, property)\n\n      // Create spring for this property\n      const spring = createSpringValue(startValue, {\n        stiffness: springConfig.stiffness ?? 100,\n        damping: springConfig.damping ?? 10,\n        mass: springConfig.mass ?? 1,\n      })\n\n      springs.set(property, spring)\n      currentValues.set(property, startValue)\n\n      // Subscribe to updates\n      spring.subscribe((v) => {\n        if (!isRunning || isPaused) return\n        currentValues.set(property, v)\n        applyStylesToElement(element, currentValues)\n\n        if (onUpdate) {\n          const valuesObj: Record<string, number> = {}\n          currentValues.forEach((val, key) => {\n            valuesObj[key] = val\n          })\n          onUpdate(valuesObj)\n        }\n      })\n\n      // Animate through keyframes sequentially\n      const animateKeyframes = async () => {\n        for (const targetValue of values) {\n          // Early exit if stopped\n          if (!isRunning) break\n\n          const numValue = typeof targetValue === 'string'\n            ? parseFloat(targetValue) || 0\n            : targetValue\n\n          await new Promise<void>((resolve) => {\n            spring.set(numValue)\n\n            const checkDone = () => {\n              // If stopped or animation complete, resolve and cleanup\n              if (!isRunning || !spring.isAnimating()) {\n                resolve()\n              } else if (!isPaused) {\n                const rafId = requestAnimationFrame(checkDone)\n                rafIds.add(rafId)\n              } else {\n                // If paused, schedule check later instead of RAF loop\n                const timeoutId = setTimeout(checkDone, 100)\n                // Store timeout for cleanup (reusing rafIds set for simplicity)\n                rafIds.add(timeoutId as unknown as number)\n              }\n            }\n            // Initial check after one frame\n            const initialRafId = requestAnimationFrame(checkDone)\n            rafIds.add(initialRafId)\n          })\n        }\n\n        completedCount++\n        if (completedCount === totalAnimations && isRunning) {\n          isRunning = false\n          try {\n            onComplete?.()\n          } catch {\n            // Ignore callback errors\n          }\n          resolveFinished()\n        }\n      }\n\n      animateKeyframes()\n    })\n  }\n\n  // Start with delay\n  if (delay > 0) {\n    delayTimeoutId = setTimeout(startAnimation, delay)\n  } else {\n    startAnimation()\n  }\n\n  // Cleanup function to cancel all pending RAF and timeouts\n  const cleanup = () => {\n    rafIds.forEach((id) => {\n      cancelAnimationFrame(id)\n      clearTimeout(id)\n    })\n    rafIds.clear()\n    if (delayTimeoutId !== null) {\n      clearTimeout(delayTimeoutId)\n      delayTimeoutId = null\n    }\n  }\n\n  return {\n    stop: () => {\n      isRunning = false\n      cleanup()\n      springs.forEach((spring) => spring.stop())\n      resolveFinished()\n    },\n    pause: () => {\n      isPaused = true\n      // Note: SpringValue doesn't have pause, we just set flag to skip updates\n    },\n    resume: () => {\n      isPaused = false\n      // Resume by allowing updates to continue\n    },\n    getProgress: () => {\n      // Simplified progress calculation\n      let totalProgress = 0\n      let count = 0\n      springs.forEach((spring) => {\n        totalProgress += spring.isAnimating() ? 0.5 : 1\n        count++\n      })\n      return count > 0 ? totalProgress / count : 1\n    },\n    isAnimating: () => isRunning && !isPaused,\n    finished,\n  }\n}\n\nfunction createNoopControls(): AnimateControls {\n  return {\n    stop: () => {},\n    pause: () => {},\n    resume: () => {},\n    getProgress: () => 1,\n    isAnimating: () => false,\n    finished: Promise.resolve(),\n  }\n}\n\n/**\n * Animate multiple elements with staggered timing\n *\n * @example\n * ```ts\n * import { animateAll } from '@oxog/springkit'\n *\n * animateAll('.item', { opacity: 1, y: 0 }, {\n *   stagger: 50,\n *   stiffness: 200,\n * })\n * ```\n */\nexport function animateAll(\n  selector: string,\n  target: AnimateTarget,\n  options: AnimateOptions & { stagger?: number } = {}\n): AnimateControls[] {\n  const { stagger = 0, ...animateOptions } = options\n  const elements = document.querySelectorAll(selector)\n\n  return Array.from(elements).map((element, index) => {\n    return animate(element, target, {\n      ...animateOptions,\n      delay: (animateOptions.delay ?? 0) + (stagger * index),\n    })\n  })\n}\n","import type { SpringValue } from '../core/spring-value.js'\n\n/**\n * Interpolation options interface\n */\nexport interface InterpolateOptions {\n  /** Clamp output to output range */\n  clamp?: boolean\n  /** Default extrapolation mode */\n  extrapolate?: 'extend' | 'clamp' | 'identity'\n  /** Extrapolation mode for left side */\n  extrapolateLeft?: 'extend' | 'clamp' | 'identity'\n  /** Extrapolation mode for right side */\n  extrapolateRight?: 'extend' | 'clamp' | 'identity'\n}\n\n/**\n * Interpolation interface\n */\nexport interface Interpolation {\n  /** Get current interpolated value */\n  get(): number\n}\n\n/**\n * Default interpolation options\n * Note: extrapolate is handled inline to allow proper branch coverage\n */\nconst defaultInterpolateOptions: Required<Pick<InterpolateOptions, 'clamp'>> = {\n  clamp: false,\n}\n\n/**\n * Value interpolation implementation\n */\nclass InterpolationImpl implements Interpolation {\n  private source: SpringValue | (() => number)\n  private input: number[]\n  private output: number[]\n  private options: InterpolateOptions\n\n  constructor(\n    source: SpringValue | (() => number),\n    input: number[],\n    output: number[],\n    options: InterpolateOptions = {}\n  ) {\n    this.source = source\n    this.input = input\n    this.output = output\n    this.options = { ...defaultInterpolateOptions, ...options }\n  }\n\n  get(): number {\n    const value = typeof this.source === 'function' ? this.source() : this.source.get()\n    return this.interpolate(value)\n  }\n\n  private interpolate(value: number): number {\n    const { input, output } = this\n    const { extrapolate, extrapolateLeft, extrapolateRight, clamp } = this.options\n\n    // Handle single point case - just return the output value\n    if (input.length === 1) {\n      return output[0]!\n    }\n\n    // Handle extrapolation\n    if (value < input[0]!) {\n      // Pass extrapolate as-is (may be undefined to test default branch)\n      const mode = this.getExtrapolationMode(extrapolateLeft, extrapolate)\n      if (mode === 'clamp') {\n        value = input[0]!\n      } else if (mode === 'identity') {\n        return value\n      }\n    } else if (value > input[input.length - 1]!) {\n      // Pass extrapolate as-is (may be undefined to test default branch)\n      const mode = this.getExtrapolationMode(extrapolateRight, extrapolate)\n      if (mode === 'clamp') {\n        value = input[input.length - 1]!\n      } else if (mode === 'identity') {\n        return value\n      }\n    }\n\n    // Find the segment\n    let i = 1\n    while (i < input.length - 1 && value > input[i]!) {\n      i++\n    }\n\n    // Linear interpolation within segment\n    const ratio = (value - input[i - 1]!) / (input[i]! - input[i - 1]!)\n    const result = output[i - 1]! + ratio * (output[i]! - output[i - 1]!)\n\n    if (clamp) {\n      const min = Math.min(...output)\n      const max = Math.max(...output)\n      return Math.max(min, Math.min(max, result))\n    }\n\n    return result\n  }\n\n  private getExtrapolationMode(\n    specificMode: 'extend' | 'clamp' | 'identity' | undefined,\n    fallbackMode: 'extend' | 'clamp' | 'identity' | undefined\n  ): 'extend' | 'clamp' | 'identity' {\n    if (specificMode !== undefined) {\n      return specificMode\n    }\n    if (fallbackMode !== undefined) {\n      return fallbackMode\n    }\n    return 'extend'\n  }\n}\n\n/**\n * Create a value interpolation\n *\n * @param value - Spring value or function that returns a number\n * @param input - Input range (array of numbers)\n * @param output - Output range (array of numbers)\n * @param options - Interpolation options\n * @returns Interpolation controller\n *\n * @example\n * ```ts\n * const x = createSpringValue(0)\n *\n * // Map 0-100 to 0-1 (opacity)\n * const opacity = interpolate(x, [0, 100], [0, 1])\n *\n * x.subscribe(() => {\n *   element.style.opacity = String(opacity.get())\n * })\n *\n * x.set(100) // opacity animates to 1\n * ```\n */\nexport function interpolate(\n  value: SpringValue | (() => number),\n  input: number[],\n  output: number[],\n  options?: InterpolateOptions\n): Interpolation {\n  return new InterpolationImpl(value, input, output, options)\n}\n","import type { SpringValue } from '../core/spring-value.js'\nimport type { InterpolateOptions } from './interpolate.js'\n\n/**\n * Color interpolation interface\n */\nexport interface ColorInterpolation {\n  /** Get current interpolated color */\n  get(): string\n}\n\n/**\n * Color interpolation implementation\n */\nclass ColorInterpolationImpl implements ColorInterpolation {\n  private source: SpringValue | (() => number)\n  private input: number[]\n  private colors: [number, number, number][]\n  private options: InterpolateOptions\n\n  constructor(\n    source: SpringValue | (() => number),\n    input: number[],\n    colorStrings: string[],\n    options: InterpolateOptions = {}\n  ) {\n    this.source = source\n    this.input = input\n    this.colors = colorStrings.map((c) => this.parseColor(c))\n    this.options = options\n  }\n\n  get(): string {\n    let value = typeof this.source === 'function' ? this.source() : this.source.get()\n    const { extrapolate, extrapolateLeft, extrapolateRight } = this.options\n\n    // Handle single color case\n    if (this.input.length === 1) {\n      const [r, g, b] = this.colors[0]!\n      return `rgb(${r}, ${g}, ${b})`\n    }\n\n    // Handle extrapolation\n    if (value < this.input[0]!) {\n      const mode = extrapolateLeft ?? extrapolate ?? 'extend'\n      if (mode === 'clamp') {\n        value = this.input[0]!\n      } else if (mode === 'identity') {\n        // For color, we can't return identity, so we clamp\n        value = this.input[0]!\n      }\n    } else if (value > this.input[this.input.length - 1]!) {\n      const mode = extrapolateRight ?? extrapolate ?? 'extend'\n      if (mode === 'clamp') {\n        value = this.input[this.input.length - 1]!\n      } else if (mode === 'identity') {\n        // For color, we can't return identity, so we clamp\n        value = this.input[this.input.length - 1]!\n      }\n    }\n\n    // Find the segment\n    let i = 1\n    while (i < this.input.length - 1 && value > this.input[i]!) {\n      i++\n    }\n\n    // Calculate interpolation ratio\n    const ratio = (value - this.input[i - 1]!) / (this.input[i]! - this.input[i - 1]!)\n\n    // Interpolate each color channel\n    const r = this.lerp(this.colors[i - 1]![0], this.colors[i]![0], ratio)\n    const g = this.lerp(this.colors[i - 1]![1], this.colors[i]![1], ratio)\n    const b = this.lerp(this.colors[i - 1]![2], this.colors[i]![2], ratio)\n\n    return `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`\n  }\n\n  private parseColor(color: string): [number, number, number] {\n    // Try to parse hex\n    const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\n    if (hexMatch) {\n      const hex = hexMatch[1]!\n      if (hex.length === 3) {\n        return [\n          parseInt(hex.charAt(0) + hex.charAt(0), 16),\n          parseInt(hex.charAt(1) + hex.charAt(1), 16),\n          parseInt(hex.charAt(2) + hex.charAt(2), 16),\n        ]\n      }\n      return [\n        parseInt(hex.slice(0, 2), 16),\n        parseInt(hex.slice(2, 4), 16),\n        parseInt(hex.slice(4, 6), 16),\n      ]\n    }\n\n    // Try to parse rgb()\n    const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\n    if (rgbMatch) {\n      return [\n        parseInt(rgbMatch[1]!, 10),\n        parseInt(rgbMatch[2]!, 10),\n        parseInt(rgbMatch[3]!, 10),\n      ]\n    }\n\n    // Try to parse rgba()\n    const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\n    if (rgbaMatch) {\n      return [\n        parseInt(rgbaMatch[1]!, 10),\n        parseInt(rgbaMatch[2]!, 10),\n        parseInt(rgbaMatch[3]!, 10),\n      ]\n    }\n\n    // Try to parse hsl()\n    const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\n    if (hslMatch) {\n      return this.hslToRgb(\n        parseInt(hslMatch[1]!, 10),\n        parseInt(hslMatch[2]!, 10),\n        parseInt(hslMatch[3]!, 10)\n      )\n    }\n\n    // Default to black\n    return [0, 0, 0]\n  }\n\n  private hslToRgb(h: number, s: number, l: number): [number, number, number] {\n    h = ((h % 360) + 360) % 360\n    s = Math.max(0, Math.min(100, s)) / 100\n    l = Math.max(0, Math.min(100, l)) / 100\n\n    if (s === 0) {\n      const gray = Math.round(l * 255)\n      return [gray, gray, gray]\n    }\n\n    const hue2rgb = (p: number, q: number, t: number): number => {\n      if (t < 0) t += 1\n      if (t > 1) t -= 1\n      if (t < 1 / 6) return p + (q - p) * 6 * t\n      if (t < 1 / 2) return q\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n      return p\n    }\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n    const p = 2 * l - q\n\n    return [\n      Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\n      Math.round(hue2rgb(p, q, h / 360) * 255),\n      Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\n    ]\n  }\n\n  private lerp(a: number, b: number, t: number): number {\n    return a + (b - a) * t\n  }\n}\n\n/**\n * Create a color interpolation\n *\n * @param value - Spring value or function that returns a number\n * @param input - Input range (array of numbers)\n * @param colors - Array of color strings (hex, rgb, hsl)\n * @param options - Interpolation options\n * @returns Color interpolation controller\n *\n * @example\n * ```ts\n * const progress = createSpringValue(0)\n *\n * // Interpolate through colors\n * const color = interpolateColor(\n *   progress,\n *   [0, 50, 100],\n *   ['#ff0000', '#00ff00', '#0000ff']\n * )\n *\n * progress.subscribe(() => {\n *   element.style.backgroundColor = color.get()\n * })\n *\n * progress.set(50) // color is '#00ff00'\n * ```\n */\nexport function interpolateColor(\n  value: SpringValue | (() => number),\n  input: number[],\n  colors: string[],\n  options?: InterpolateOptions\n): ColorInterpolation {\n  return new ColorInterpolationImpl(value, input, colors, options)\n}\n","import { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { clamp } from '../utils/math.js'\n\n/**\n * Snap point configuration\n */\nexport interface SnapPoint {\n  x: number\n  y: number\n  /** Attraction radius (pixels) */\n  radius?: number\n}\n\n/**\n * Snap configuration\n */\nexport interface SnapConfig {\n  /** Array of snap points */\n  points?: SnapPoint[]\n  /** Snap to grid with given cell size */\n  grid?: { x: number; y: number }\n  /** Velocity threshold to snap (lower = snap more easily) */\n  velocityThreshold?: number\n  /** Whether to snap only on release */\n  snapOnRelease?: boolean\n}\n\n/**\n * Constraint configuration - supports multiple constraint types\n */\nexport interface DragConstraints {\n  /** Simple box bounds */\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n  /** Constrain to parent element */\n  constrainToParent?: boolean\n  /** Constrain to specific element */\n  constrainToElement?: HTMLElement\n  /** Padding when constrained to element */\n  constraintPadding?: number | { top?: number; right?: number; bottom?: number; left?: number }\n  /** Lock to specific axis */\n  lockAxis?: 'x' | 'y' | null\n  /** Lock to 45-degree diagonal lines */\n  lockToDiagonal?: boolean\n}\n\n/**\n * Drag spring configuration interface\n */\nexport interface DragSpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Initial velocity */\n  velocity?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Axis constraint (deprecated, use constraints.lockAxis) */\n  axis?: 'x' | 'y' | 'both'\n  /** Boundary constraints (deprecated, use constraints.bounds) */\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n  /** Enhanced constraint configuration */\n  constraints?: DragConstraints\n  /** Snap configuration */\n  snap?: SnapConfig\n  /** Enable rubber band effect at bounds */\n  rubberBand?: boolean\n  /** Rubber band stretch factor (0-1, default: 0.5) */\n  rubberBandFactor?: number\n  /** Elastic bounce power (0-1, default: 0.3) */\n  elasticBounce?: number\n  /** Momentum after release (true = continue with velocity) */\n  momentum?: boolean\n  /** Deceleration rate for momentum (0-1, default: 0.95) */\n  momentumDecay?: number\n  /** Elastic factor (0-1) - how much element can be dragged outside bounds */\n  dragElastic?: number | boolean | { top?: number; right?: number; bottom?: number; left?: number }\n  /** Modify the target position during inertia (useful for snap-to-grid) */\n  modifyTarget?: (target: { x: number; y: number }) => { x: number; y: number }\n  /** Callback called when drag starts */\n  onDragStart?: (event: PointerEvent) => void\n  /** Callback called during drag */\n  onDrag?: (x: number, y: number, event: PointerEvent) => void\n  /** Callback called when drag ends */\n  onDragEnd?: (x: number, y: number, velocity: { x: number; y: number }) => void\n  /** Callback called on position update */\n  onUpdate?: (x: number, y: number) => void\n  /** Callback when snapping to a point */\n  onSnapStart?: (point: SnapPoint) => void\n  /** Callback when snap animation completes */\n  onSnapComplete?: (point: SnapPoint) => void\n  /** Callback when hitting bounds */\n  onBoundsHit?: (edge: 'left' | 'right' | 'top' | 'bottom') => void\n}\n\n/**\n * Drag spring interface\n */\nexport interface DragSpring {\n  /** Enable drag interaction */\n  enable(): void\n  /** Disable drag interaction */\n  disable(): void\n  /** Check if currently enabled */\n  isEnabled(): boolean\n  /** Check if currently dragging */\n  isDragging(): boolean\n  /** Reset to initial position */\n  reset(): void\n  /** Get current position */\n  getPosition(): { x: number; y: number }\n  /** Get current velocity */\n  getVelocity(): { x: number; y: number }\n  /** Set position instantly */\n  setPosition(x: number, y: number): void\n  /** Jump to position (instant, alias for setPosition) */\n  jumpTo(x: number, y: number): void\n  /** Animate to position with spring physics */\n  animateTo(x: number, y: number): void\n  /** Release with velocity */\n  release(velocityX: number, velocityY: number): void\n  /** Snap to nearest point */\n  snapToNearest(): void\n  /** Snap to specific point */\n  snapTo(point: SnapPoint): void\n  /** Update constraints dynamically */\n  setConstraints(constraints: DragConstraints): void\n  /** Update snap configuration dynamically */\n  setSnap(snap: SnapConfig): void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Default drag spring configuration\n */\nconst defaultDragConfig = {\n  axis: 'both' as const,\n  rubberBand: false,\n  rubberBandFactor: 0.5,\n  elasticBounce: 0.3,\n  momentum: true,\n  momentumDecay: 0.95,\n  stiffness: 200,\n  damping: 20,\n  mass: 1,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Drag spring implementation\n */\nclass DragSpringImpl implements DragSpring {\n  private element: HTMLElement\n  private config: DragSpringConfig\n  private enabled = true\n  private position = { x: 0, y: 0 }\n  private _isDragging = false\n  private startPosition = { x: 0, y: 0 }\n  private pointerStart = { x: 0, y: 0 }\n  private lastPosition = { x: 0, y: 0 }\n  private lastTime = 0\n  private velocity = { x: 0, y: 0 }\n  private currentSnap: SnapPoint | null = null\n  private snapTimeoutId: ReturnType<typeof setTimeout> | null = null\n  private destroyed = false\n\n  // Springs for each axis\n  private springX: SpringValue\n  private springY: SpringValue\n\n  constructor(element: HTMLElement, config: DragSpringConfig = {}) {\n    this.element = element\n    this.config = { ...defaultDragConfig, ...config }\n\n    // Extract only spring physics config for createSpringValue\n    const springConfig = {\n      stiffness: this.config.stiffness,\n      damping: this.config.damping,\n      mass: this.config.mass,\n      restSpeed: this.config.restSpeed,\n      restDelta: this.config.restDelta,\n      clamp: this.config.clamp,\n    }\n\n    this.springX = createSpringValue(0, springConfig)\n    this.springY = createSpringValue(0, springConfig)\n\n    // Subscribe to spring updates\n    this.springX.subscribe(() => {\n      if (!this._isDragging) {\n        this.position.x = this.springX.get()\n        if (this.config.onUpdate) {\n          this.config.onUpdate(this.position.x, this.position.y)\n        }\n      }\n    })\n\n    this.springY.subscribe(() => {\n      if (!this._isDragging) {\n        this.position.y = this.springY.get()\n        if (this.config.onUpdate) {\n          this.config.onUpdate(this.position.x, this.position.y)\n        }\n      }\n    })\n\n    this.setupPointerEvents()\n  }\n\n  private setupPointerEvents(): void {\n    this.element.addEventListener('pointerdown', this.onPointerDown)\n  }\n\n  private onPointerDown = (e: PointerEvent): void => {\n    if (!this.enabled || e.button !== 0) return\n\n    this._isDragging = true\n    this.startPosition = { ...this.position }\n    this.pointerStart = { x: e.clientX, y: e.clientY }\n    this.lastPosition = { x: e.clientX, y: e.clientY }\n    this.lastTime = performance.now()\n    this.velocity = { x: 0, y: 0 }\n\n    this.element.setPointerCapture(e.pointerId)\n    this.element.addEventListener('pointermove', this.onPointerMove)\n    this.element.addEventListener('pointerup', this.onPointerUp)\n    this.element.addEventListener('pointercancel', this.onPointerUp)\n\n    // Explicit if for better branch coverage\n    if (this.config.onDragStart) {\n      this.config.onDragStart(e)\n    }\n  }\n\n  private onPointerMove = (e: PointerEvent): void => {\n    const now = performance.now()\n    const dt = now - this.lastTime\n\n    // Calculate instant velocity with minimum dt to prevent spikes\n    // Use at least 16ms (one frame) to avoid unrealistic velocity on first move\n    const safeDt = Math.max(dt, 16)\n    const instantVelocity = {\n      x: (e.clientX - this.lastPosition.x) / safeDt,\n      y: (e.clientY - this.lastPosition.y) / safeDt,\n    }\n\n    // Smooth velocity using exponential moving average to prevent jarring animations\n    // This prevents velocity spikes on quick movements or first move events\n    const smoothingFactor = 0.2\n    this.velocity = {\n      x: this.velocity.x * (1 - smoothingFactor) + instantVelocity.x * smoothingFactor,\n      y: this.velocity.y * (1 - smoothingFactor) + instantVelocity.y * smoothingFactor,\n    }\n\n    this.lastPosition = { x: e.clientX, y: e.clientY }\n    this.lastTime = now\n\n    // Calculate new position\n    let newX = this.startPosition.x + (e.clientX - this.pointerStart.x)\n    let newY = this.startPosition.y + (e.clientY - this.pointerStart.y)\n\n    // Apply bounds with elastic effect\n    if (this.config.bounds) {\n      newX = this.applyBounds(\n        newX,\n        this.config.bounds.left ?? -Infinity,\n        this.config.bounds.right ?? Infinity,\n        'x'\n      )\n      newY = this.applyBounds(\n        newY,\n        this.config.bounds.top ?? -Infinity,\n        this.config.bounds.bottom ?? Infinity,\n        'y'\n      )\n    }\n\n    // Apply axis constraint\n    if (this.config.axis === 'x') {\n      newY = 0\n    } else if (this.config.axis === 'y') {\n      newX = 0\n    }\n\n    this.position = { x: newX, y: newY }\n    if (this.config.onDrag) {\n      this.config.onDrag(newX, newY, e)\n    }\n    if (this.config.onUpdate) {\n      this.config.onUpdate(newX, newY)\n    }\n  }\n\n  private getElasticFactor(edge: 'left' | 'right' | 'top' | 'bottom'): number {\n    const dragElastic = this.config.dragElastic\n\n    // If not specified, use rubberBand settings\n    if (dragElastic === undefined) {\n      if (this.config.rubberBand) {\n        return this.config.rubberBandFactor ?? 0.5\n      }\n      return 0 // No elasticity\n    }\n\n    // Boolean: true = 0.5, false = 0\n    if (typeof dragElastic === 'boolean') {\n      return dragElastic ? 0.5 : 0\n    }\n\n    // Number: use directly\n    if (typeof dragElastic === 'number') {\n      return clamp(dragElastic, 0, 1)\n    }\n\n    // Object: per-edge configuration\n    return clamp(dragElastic[edge] ?? 0.5, 0, 1)\n  }\n\n  private applyBounds(value: number, min: number, max: number, axis: 'x' | 'y' = 'x'): number {\n    if (!isFinite(min) && !isFinite(max)) return value\n\n    const actualMin = isFinite(min) ? min : -Infinity\n    const actualMax = isFinite(max) ? max : Infinity\n\n    // Determine elastic factor based on which edge\n    const hasElastic = this.config.dragElastic !== undefined || this.config.rubberBand\n\n    if (hasElastic) {\n      if (value < actualMin) {\n        const elasticFactor = this.getElasticFactor(axis === 'x' ? 'left' : 'top')\n        return actualMin - (actualMin - value) * elasticFactor\n      }\n      if (value > actualMax) {\n        const elasticFactor = this.getElasticFactor(axis === 'x' ? 'right' : 'bottom')\n        return actualMax + (value - actualMax) * elasticFactor\n      }\n    }\n\n    return clamp(value, actualMin, actualMax)\n  }\n\n  private onPointerUp = (e: PointerEvent): void => {\n    this._isDragging = false\n\n    // Safety check: element might be removed from DOM during drag\n    if (this.element && document.contains(this.element)) {\n      try {\n        this.element.releasePointerCapture(e.pointerId)\n      } catch {\n        // Ignore errors if pointer capture was already released\n      }\n      this.element.removeEventListener('pointermove', this.onPointerMove)\n      this.element.removeEventListener('pointerup', this.onPointerUp)\n      this.element.removeEventListener('pointercancel', this.onPointerUp)\n    }\n\n    // Check for snap points first\n    if (this.config.snap?.snapOnRelease !== false) {\n      const snapPoint = this.findNearestSnapPoint()\n      if (snapPoint) {\n        this.snapTo(snapPoint)\n        if (this.config.onDragEnd) {\n          this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\n        }\n        return\n      }\n    }\n\n    // Scale velocity for spring (convert from pixels/ms to more reasonable units)\n    this.release(this.velocity.x * 16, this.velocity.y * 16)\n\n    if (this.config.onDragEnd) {\n      this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\n    }\n  }\n\n  private findNearestSnapPoint(): SnapPoint | null {\n    const snap = this.config.snap\n    if (!snap) return null\n\n    // Check grid snapping first\n    if (snap.grid) {\n      const gridX = Math.round(this.position.x / snap.grid.x) * snap.grid.x\n      const gridY = Math.round(this.position.y / snap.grid.y) * snap.grid.y\n      return { x: gridX, y: gridY }\n    }\n\n    // Check snap points\n    if (snap.points && snap.points.length > 0) {\n      const velocityMagnitude = Math.sqrt(this.velocity.x ** 2 + this.velocity.y ** 2)\n      const threshold = snap.velocityThreshold ?? 0.5\n\n      // Don't snap if moving too fast\n      if (velocityMagnitude > threshold) return null\n\n      let nearestPoint: SnapPoint | null = null\n      let nearestDistance = Infinity\n\n      for (const point of snap.points) {\n        const dx = this.position.x - point.x\n        const dy = this.position.y - point.y\n        const distance = Math.sqrt(dx * dx + dy * dy)\n        const radius = point.radius ?? 50\n\n        if (distance < radius && distance < nearestDistance) {\n          nearestDistance = distance\n          nearestPoint = point\n        }\n      }\n\n      return nearestPoint\n    }\n\n    return null\n  }\n\n  private getEffectiveBounds(): { left: number; right: number; top: number; bottom: number } {\n    // Start with explicit bounds\n    const bounds = {\n      left: this.config.bounds?.left ?? this.config.constraints?.bounds?.left ?? -Infinity,\n      right: this.config.bounds?.right ?? this.config.constraints?.bounds?.right ?? Infinity,\n      top: this.config.bounds?.top ?? this.config.constraints?.bounds?.top ?? -Infinity,\n      bottom: this.config.bounds?.bottom ?? this.config.constraints?.bounds?.bottom ?? Infinity,\n    }\n\n    const constraints = this.config.constraints\n\n    // Handle constrainToParent\n    if (constraints?.constrainToParent && this.element.parentElement) {\n      const parent = this.element.parentElement\n      const parentRect = parent.getBoundingClientRect()\n      const elementRect = this.element.getBoundingClientRect()\n\n      const padding = this.normalizePadding(constraints.constraintPadding)\n\n      bounds.left = Math.max(bounds.left, padding.left)\n      bounds.right = Math.min(bounds.right, parentRect.width - elementRect.width - padding.right)\n      bounds.top = Math.max(bounds.top, padding.top)\n      bounds.bottom = Math.min(bounds.bottom, parentRect.height - elementRect.height - padding.bottom)\n    }\n\n    // Handle constrainToElement\n    if (constraints?.constrainToElement) {\n      const constraintRect = constraints.constrainToElement.getBoundingClientRect()\n      const elementRect = this.element.getBoundingClientRect()\n      const parentRect = this.element.parentElement?.getBoundingClientRect() ?? { left: 0, top: 0 }\n\n      const padding = this.normalizePadding(constraints.constraintPadding)\n\n      const offsetX = constraintRect.left - parentRect.left\n      const offsetY = constraintRect.top - parentRect.top\n\n      bounds.left = Math.max(bounds.left, offsetX + padding.left)\n      bounds.right = Math.min(bounds.right, offsetX + constraintRect.width - elementRect.width - padding.right)\n      bounds.top = Math.max(bounds.top, offsetY + padding.top)\n      bounds.bottom = Math.min(bounds.bottom, offsetY + constraintRect.height - elementRect.height - padding.bottom)\n    }\n\n    return bounds\n  }\n\n  private normalizePadding(padding: number | { top?: number; right?: number; bottom?: number; left?: number } | undefined): { top: number; right: number; bottom: number; left: number } {\n    if (typeof padding === 'number') {\n      return { top: padding, right: padding, bottom: padding, left: padding }\n    }\n    return {\n      top: padding?.top ?? 0,\n      right: padding?.right ?? 0,\n      bottom: padding?.bottom ?? 0,\n      left: padding?.left ?? 0,\n    }\n  }\n\n  enable(): void {\n    this.enabled = true\n  }\n\n  disable(): void {\n    this.enabled = false\n    if (this._isDragging) {\n      this._isDragging = false\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  isDragging(): boolean {\n    return this._isDragging\n  }\n\n  reset(): void {\n    this.springX.jump(0)\n    this.springY.jump(0)\n    this.position = { x: 0, y: 0 }\n    this.velocity = { x: 0, y: 0 }\n    this.currentSnap = null\n    // Explicit if for better branch coverage\n    if (this.config.onUpdate) {\n      this.config.onUpdate(0, 0)\n    }\n  }\n\n  getPosition(): { x: number; y: number } {\n    return { ...this.position }\n  }\n\n  getVelocity(): { x: number; y: number } {\n    return { ...this.velocity }\n  }\n\n  setPosition(x: number, y: number): void {\n    // Instant position change (same as jumpTo for backwards compatibility)\n    this.position = { x, y }\n    this.springX.jump(x)\n    this.springY.jump(y)\n  }\n\n  jumpTo(x: number, y: number): void {\n    // Update position immediately for synchronous access\n    this.position = { x, y }\n    this.springX.jump(x)\n    this.springY.jump(y)\n    if (this.config.onUpdate) {\n      this.config.onUpdate(x, y)\n    }\n  }\n\n  animateTo(x: number, y: number): void {\n    // Animate to the position with spring physics\n    this.springX.set(x)\n    this.springY.set(y)\n  }\n\n  release(velocityX: number, velocityY: number): void {\n    const bounds = this.getEffectiveBounds()\n    const { left, right, top, bottom } = bounds\n\n    let targetX = this.position.x\n    let targetY = this.position.y\n\n    // Apply momentum if enabled\n    if (this.config.momentum) {\n      // Clamp decay to valid range [0, 0.99] to prevent division by zero\n      const rawDecay = this.config.momentumDecay ?? 0.95\n      const decay = Math.max(0, Math.min(0.99, rawDecay))\n      const decayFactor = decay < 1 ? (1 / (1 - decay)) : 100 // Fallback for edge case\n      const momentumX = velocityX * decayFactor * 0.1\n      const momentumY = velocityY * decayFactor * 0.1\n      targetX += momentumX\n      targetY += momentumY\n    }\n\n    // Apply modifyTarget for snap-to-grid or custom modifications\n    if (this.config.modifyTarget) {\n      const modified = this.config.modifyTarget({ x: targetX, y: targetY })\n      targetX = modified.x\n      targetY = modified.y\n    }\n\n    // Clamp to bounds\n    targetX = clamp(targetX, left, right)\n    targetY = clamp(targetY, top, bottom)\n\n    // Notify bounds hit\n    if (this.config.onBoundsHit) {\n      if (this.position.x < left) this.config.onBoundsHit('left')\n      if (this.position.x > right) this.config.onBoundsHit('right')\n      if (this.position.y < top) this.config.onBoundsHit('top')\n      if (this.position.y > bottom) this.config.onBoundsHit('bottom')\n    }\n\n    // Animate to target with elastic bounce\n    if (targetX !== this.position.x || this.position.x < left || this.position.x > right) {\n      this.springX.set(targetX, { velocity: velocityX })\n    }\n    if (targetY !== this.position.y || this.position.y < top || this.position.y > bottom) {\n      this.springY.set(targetY, { velocity: velocityY })\n    }\n  }\n\n  snapToNearest(): void {\n    const snapPoint = this.findNearestSnapPoint()\n    if (snapPoint) {\n      this.snapTo(snapPoint)\n    }\n  }\n\n  snapTo(point: SnapPoint): void {\n    this.currentSnap = point\n    if (this.config.onSnapStart) {\n      this.config.onSnapStart(point)\n    }\n\n    this.springX.set(point.x)\n    this.springY.set(point.y)\n\n    // Cancel previous snap timeout to prevent memory leak\n    if (this.snapTimeoutId !== null) {\n      clearTimeout(this.snapTimeoutId)\n    }\n\n    // Simple completion detection with tracked timeout\n    this.snapTimeoutId = setTimeout(() => {\n      this.snapTimeoutId = null\n      if (!this.destroyed && this.currentSnap === point && this.config.onSnapComplete) {\n        this.config.onSnapComplete(point)\n      }\n    }, 500)\n  }\n\n  setConstraints(constraints: DragConstraints): void {\n    this.config.constraints = constraints\n  }\n\n  setSnap(snap: SnapConfig): void {\n    this.config.snap = snap\n  }\n\n  destroy(): void {\n    this.destroyed = true\n\n    // Cancel any pending snap timeout\n    if (this.snapTimeoutId !== null) {\n      clearTimeout(this.snapTimeoutId)\n      this.snapTimeoutId = null\n    }\n\n    this.element.removeEventListener('pointerdown', this.onPointerDown)\n    this.springX.destroy()\n    this.springY.destroy()\n  }\n}\n\n/**\n * Create a drag spring\n *\n * @param element - HTML element to make draggable\n * @param config - Drag spring configuration\n * @returns Drag spring controller\n *\n * @example\n * ```ts\n * const drag = createDragSpring(element, {\n *   onUpdate: (x, y) => {\n *     element.style.transform = `translate(${x}px, ${y}px)`\n *   },\n * })\n * ```\n */\nexport function createDragSpring(\n  element: HTMLElement,\n  config?: DragSpringConfig\n): DragSpring {\n  return new DragSpringImpl(element, config)\n}\n","import { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\n/**\n * Scroll spring configuration interface\n */\nexport interface ScrollSpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Scroll direction */\n  direction?: 'horizontal' | 'vertical' | 'both'\n  /** Enable momentum/inertia */\n  momentum?: boolean\n  /** Momentum decay factor (0-1) */\n  momentumDecay?: number\n  /** Enable bounce at edges */\n  bounce?: boolean\n  /** Bounce spring stiffness */\n  bounceStiffness?: number\n  /** Bounce spring damping */\n  bounceDamping?: number\n  /** Callback called on scroll */\n  onScroll?: (scrollX: number, scrollY: number) => void\n  /** Callback called when scroll starts */\n  onScrollStart?: () => void\n  /** Callback called when scroll ends */\n  onScrollEnd?: () => void\n}\n\n/**\n * Scroll spring interface\n */\nexport interface ScrollSpring {\n  /** Get current scroll position */\n  getScroll(): { x: number; y: number }\n  /** Scroll to position */\n  scrollTo(x: number, y: number): void\n  /** Scroll to element */\n  scrollToElement(element: HTMLElement, offset?: number): void\n  /** Enable scroll handling */\n  enable(): void\n  /** Disable scroll handling */\n  disable(): void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Default scroll spring configuration\n */\nconst defaultScrollConfig: Required<\n  Omit<\n    ScrollSpringConfig,\n    | 'onScroll'\n    | 'onScrollStart'\n    | 'onScrollEnd'\n    | 'bounceStiffness'\n    | 'bounceDamping'\n    | 'velocity'\n  >\n> = {\n  direction: 'vertical',\n  momentum: false,\n  momentumDecay: 0.95,\n  bounce: false,\n  stiffness: 100,\n  damping: 10,\n  mass: 1,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Scroll spring implementation\n */\nclass ScrollSpringImpl implements ScrollSpring {\n  private container: HTMLElement\n  private config: ScrollSpringConfig\n  private scroll = { x: 0, y: 0 }\n  private target = { x: 0, y: 0 }\n  private isScrolling = false\n  private isEnabled = true\n\n  private springX: SpringValue\n  private springY: SpringValue\n\n  constructor(container: HTMLElement, config: ScrollSpringConfig = {}) {\n    this.container = container\n    this.config = { ...defaultScrollConfig, ...config }\n\n    // Extract only spring physics config for createSpringValue\n    const springConfig = {\n      stiffness: this.config.stiffness,\n      damping: this.config.damping,\n      mass: this.config.mass,\n      restSpeed: this.config.restSpeed,\n      restDelta: this.config.restDelta,\n      clamp: this.config.clamp,\n    }\n\n    this.springX = createSpringValue(0, springConfig)\n    this.springY = createSpringValue(0, springConfig)\n\n    // Subscribe to spring updates\n    this.springX.subscribe(() => {\n      this.scroll.x = this.springX.get()\n      this.config.onScroll?.(this.scroll.x, this.scroll.y)\n    })\n\n    this.springY.subscribe(() => {\n      this.scroll.y = this.springY.get()\n      this.config.onScroll?.(this.scroll.x, this.scroll.y)\n    })\n\n    this.setupScrollEvents()\n  }\n\n  private setupScrollEvents(): void {\n    this.container.addEventListener('wheel', this.onWheel, { passive: false })\n  }\n\n  private onWheel = (e: WheelEvent): void => {\n    if (!this.isEnabled) return\n\n    if (!this.isScrolling) {\n      this.isScrolling = true\n      this.config.onScrollStart?.()\n    }\n\n    // Apply direction filter\n    let deltaX = e.deltaX\n    let deltaY = e.deltaY\n\n    if (this.config.direction === 'horizontal') {\n      deltaY = 0\n    } else if (this.config.direction === 'vertical') {\n      deltaX = 0\n    }\n\n    // Apply bounce at edges\n    if (this.config.bounce) {\n      const maxScrollX = this.container.scrollWidth - this.container.clientWidth\n      const maxScrollY = this.container.scrollHeight - this.container.clientHeight\n\n      this.target.x += deltaX\n      this.target.y += deltaY\n\n      // Apply rubber band at edges with safe Math.sqrt (use Math.abs to prevent NaN)\n      if (this.target.x < 0) {\n        this.target.x = -Math.sqrt(Math.abs(this.target.x)) * 10\n      } else if (this.target.x > maxScrollX) {\n        this.target.x = maxScrollX + Math.sqrt(Math.abs(this.target.x - maxScrollX)) * 10\n      }\n\n      if (this.target.y < 0) {\n        this.target.y = -Math.sqrt(Math.abs(this.target.y)) * 10\n      } else if (this.target.y > maxScrollY) {\n        this.target.y = maxScrollY + Math.sqrt(Math.abs(this.target.y - maxScrollY)) * 10\n      }\n\n      // Prevent default to handle scroll ourselves\n      e.preventDefault()\n    } else {\n      this.target.x += deltaX\n      this.target.y += deltaY\n\n      // Clamp to bounds\n      const maxScrollX = this.container.scrollWidth - this.container.clientWidth\n      const maxScrollY = this.container.scrollHeight - this.container.clientHeight\n\n      this.target.x = Math.max(0, Math.min(this.target.x, maxScrollX))\n      this.target.y = Math.max(0, Math.min(this.target.y, maxScrollY))\n    }\n\n    this.startScrollLoop()\n  }\n\n  private startScrollLoop(): void {\n    // Update springs towards target\n    this.springX.set(this.target.x)\n    this.springY.set(this.target.y)\n\n    // Check for scroll end\n    const checkEnd = () => {\n      const settled =\n        Math.abs(this.scroll.x - this.target.x) < 0.1 &&\n        Math.abs(this.scroll.y - this.target.y) < 0.1 &&\n        !this.springX.isAnimating() &&\n        !this.springY.isAnimating()\n\n      if (settled && this.isScrolling) {\n        this.isScrolling = false\n        this.config.onScrollEnd?.()\n      } else if (this.isScrolling) {\n        requestAnimationFrame(checkEnd)\n      }\n    }\n\n    checkEnd()\n  }\n\n  getScroll(): { x: number; y: number } {\n    return { ...this.scroll }\n  }\n\n  scrollTo(x: number, y: number): void {\n    this.target = { x, y }\n    this.springX.set(x)\n    this.springY.set(y)\n  }\n\n  scrollToElement(element: HTMLElement, offset = 0): void {\n    const containerRect = this.container.getBoundingClientRect()\n    const elementRect = element.getBoundingClientRect()\n\n    const x = elementRect.left - containerRect.left + this.scroll.x + offset\n    const y = elementRect.top - containerRect.top + this.scroll.y + offset\n\n    this.scrollTo(x, y)\n  }\n\n  enable(): void {\n    this.isEnabled = true\n  }\n\n  disable(): void {\n    this.isEnabled = false\n  }\n\n  destroy(): void {\n    this.container.removeEventListener('wheel', this.onWheel)\n    this.springX.destroy()\n    this.springY.destroy()\n  }\n}\n\n/**\n * Create a scroll spring\n *\n * @param container - Scrollable container element\n * @param config - Scroll spring configuration\n * @returns Scroll spring controller\n *\n * @example\n * ```ts\n * const scroll = createScrollSpring(container, {\n *   onScroll: (x, y) => {\n *     content.style.transform = `translate(${-x}px, ${-y}px)`\n *   },\n * })\n * ```\n */\nexport function createScrollSpring(\n  container: HTMLElement,\n  config?: ScrollSpringConfig\n): ScrollSpring {\n  return new ScrollSpringImpl(container, config)\n}\n","/**\n * Advanced Gesture System - Multi-touch gestures with spring physics\n *\n * Provides pinch, rotate, swipe, and long-press detection with\n * velocity tracking and spring-based animations.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Point in 2D space\n */\nexport interface Point {\n  x: number\n  y: number\n}\n\n/**\n * Gesture state shared across all gesture types\n */\nexport interface GestureState {\n  /** Whether gesture is active */\n  active: boolean\n  /** First touch/pointer position */\n  first: boolean\n  /** Last event in gesture */\n  last: boolean\n  /** Event that triggered the gesture */\n  event: PointerEvent | TouchEvent\n  /** Time since gesture started (ms) */\n  elapsedTime: number\n  /** Gesture was cancelled */\n  cancelled: boolean\n}\n\n/**\n * Pinch gesture state\n */\nexport interface PinchState extends GestureState {\n  /** Current scale (1 = original) */\n  scale: number\n  /** Scale velocity */\n  velocity: number\n  /** Distance between fingers */\n  distance: number\n  /** Initial distance between fingers */\n  initialDistance: number\n  /** Center point between fingers */\n  origin: Point\n  /** Movement delta */\n  movement: number\n  /** Scale offset from initial */\n  offset: number\n}\n\n/**\n * Rotate gesture state\n */\nexport interface RotateState extends GestureState {\n  /** Current rotation in degrees */\n  angle: number\n  /** Angular velocity (degrees/second) */\n  velocity: number\n  /** Initial angle */\n  initialAngle: number\n  /** Center point of rotation */\n  origin: Point\n  /** Rotation movement */\n  movement: number\n  /** Rotation offset from initial */\n  offset: number\n}\n\n/**\n * Swipe gesture state\n */\nexport interface SwipeState extends GestureState {\n  /** Swipe direction */\n  direction: 'up' | 'down' | 'left' | 'right' | null\n  /** Swipe velocity */\n  velocity: Point\n  /** Distance swiped */\n  distance: Point\n  /** Movement from start */\n  movement: Point\n  /** Swipe duration in ms */\n  duration: number\n}\n\n/**\n * Long press gesture state\n */\nexport interface LongPressState extends GestureState {\n  /** Press position */\n  position: Point\n  /** Press duration in ms */\n  duration: number\n  /** Whether threshold was reached */\n  triggered: boolean\n}\n\n/**\n * Pinch gesture configuration\n */\nexport interface PinchConfig {\n  /** Minimum scale (default: 0.1) */\n  minScale?: number\n  /** Maximum scale (default: 10) */\n  maxScale?: number\n  /** Enable rubber band at limits */\n  rubberBand?: boolean\n  /** Rubber band factor (0-1) */\n  rubberBandFactor?: number\n  /** Spring config for release animation */\n  spring?: {\n    stiffness?: number\n    damping?: number\n  }\n  /** Callback on pinch */\n  onPinch?: (state: PinchState) => void\n  /** Callback when pinch starts */\n  onPinchStart?: (state: PinchState) => void\n  /** Callback when pinch ends */\n  onPinchEnd?: (state: PinchState) => void\n}\n\n/**\n * Rotate gesture configuration\n */\nexport interface RotateConfig {\n  /** Enable rotation (default: true) */\n  enabled?: boolean\n  /** Minimum rotation threshold in degrees */\n  threshold?: number\n  /** Callback on rotate */\n  onRotate?: (state: RotateState) => void\n  /** Callback when rotation starts */\n  onRotateStart?: (state: RotateState) => void\n  /** Callback when rotation ends */\n  onRotateEnd?: (state: RotateState) => void\n}\n\n/**\n * Swipe gesture configuration\n */\nexport interface SwipeConfig {\n  /** Minimum velocity to trigger swipe (pixels/ms) */\n  velocityThreshold?: number\n  /** Minimum distance to trigger swipe (pixels) */\n  distanceThreshold?: number\n  /** Maximum duration for swipe (ms) */\n  maxDuration?: number\n  /** Axis constraint */\n  axis?: 'x' | 'y' | 'both'\n  /** Callback on swipe */\n  onSwipe?: (state: SwipeState) => void\n  /** Callback when swipe starts */\n  onSwipeStart?: (state: SwipeState) => void\n  /** Callback when swipe ends */\n  onSwipeEnd?: (state: SwipeState) => void\n}\n\n/**\n * Long press gesture configuration\n */\nexport interface LongPressConfig {\n  /** Duration to trigger long press (ms, default: 500) */\n  threshold?: number\n  /** Movement tolerance (pixels) */\n  movementTolerance?: number\n  /** Callback when long press triggers */\n  onLongPress?: (state: LongPressState) => void\n  /** Callback on press start */\n  onPressStart?: (state: LongPressState) => void\n  /** Callback on press end */\n  onPressEnd?: (state: LongPressState) => void\n}\n\n/**\n * Combined gesture configuration\n */\nexport interface GestureConfig {\n  pinch?: PinchConfig\n  rotate?: RotateConfig\n  swipe?: SwipeConfig\n  longPress?: LongPressConfig\n}\n\n/**\n * Gesture controller interface\n */\nexport interface GestureController {\n  /** Enable gestures */\n  enable(): void\n  /** Disable gestures */\n  disable(): void\n  /** Check if enabled */\n  isEnabled(): boolean\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Utility Functions ============\n\n/**\n * Calculate distance between two points\n */\nfunction getDistance(p1: Point, p2: Point): number {\n  const dx = p2.x - p1.x\n  const dy = p2.y - p1.y\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\n/**\n * Calculate angle between two points in degrees\n */\nfunction getAngle(p1: Point, p2: Point): number {\n  return (Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180) / Math.PI\n}\n\n/**\n * Get center point between two points\n */\nfunction getCenter(p1: Point, p2: Point): Point {\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2,\n  }\n}\n\n/**\n * Apply rubber band effect\n */\nfunction rubberBand(value: number, min: number, max: number, factor: number): number {\n  if (value < min) {\n    return min - Math.pow(min - value, factor)\n  }\n  if (value > max) {\n    return max + Math.pow(value - max, factor)\n  }\n  return value\n}\n\n// ============ Pinch Gesture ============\n\n/**\n * Create pinch gesture handler\n *\n * @example\n * ```ts\n * const pinch = createPinchGesture(element, {\n *   onPinch: (state) => {\n *     element.style.transform = `scale(${state.scale})`\n *   },\n * })\n * ```\n */\nexport function createPinchGesture(\n  element: HTMLElement,\n  config: PinchConfig = {}\n): GestureController {\n  const {\n    minScale = 0.1,\n    maxScale = 10,\n    rubberBand: enableRubberBand = true,\n    rubberBandFactor = 0.5,\n    spring = { stiffness: 200, damping: 20 },\n    onPinch,\n    onPinchStart,\n    onPinchEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let initialDistance = 0\n  let initialScale = 1\n  let currentScale = 1\n  let lastScale = 1\n  let velocity = 0\n  let startTime = 0\n  let lastTime = 0\n\n  const touches = new Map<number, Point>()\n  let scaleSpring: SpringValue | null = null\n\n  const createState = (event: TouchEvent, first = false, last = false): PinchState => {\n    const touchArray = Array.from(touches.values())\n    const p1 = touchArray[0] ?? { x: 0, y: 0 }\n    const p2 = touchArray[1] ?? { x: 0, y: 0 }\n    const origin = touchArray.length >= 2 ? getCenter(p1, p2) : { x: 0, y: 0 }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: performance.now() - startTime,\n      cancelled: false,\n      scale: currentScale,\n      velocity,\n      distance: touchArray.length >= 2 ? getDistance(p1, p2) : 0,\n      initialDistance,\n      origin,\n      movement: currentScale - initialScale,\n      offset: currentScale - 1,\n    }\n  }\n\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!enabled) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n    }\n\n    if (touches.size === 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      initialDistance = getDistance(p1, p2)\n      initialScale = currentScale\n      startTime = performance.now()\n      lastTime = startTime\n      active = true\n\n      // Cancel any spring animation\n      scaleSpring?.destroy()\n      scaleSpring = null\n\n      onPinchStart?.(createState(e, true, false))\n    }\n  }\n\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!enabled || !active) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      if (touches.has(touch.identifier)) {\n        touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n      }\n    }\n\n    if (touches.size >= 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      const currentDistance = getDistance(p1, p2)\n      const now = performance.now()\n      const dt = now - lastTime\n\n      // Calculate new scale\n      let newScale = initialScale * (currentDistance / initialDistance)\n\n      // Apply rubber band at limits\n      if (enableRubberBand) {\n        newScale = rubberBand(newScale, minScale, maxScale, rubberBandFactor)\n      } else {\n        newScale = clamp(newScale, minScale, maxScale)\n      }\n\n      // Calculate velocity\n      velocity = dt > 0 ? ((newScale - lastScale) / dt) * 1000 : 0\n      lastScale = currentScale\n      currentScale = newScale\n      lastTime = now\n\n      onPinch?.(createState(e, false, false))\n      e.preventDefault()\n    }\n  }\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.delete(touch.identifier)\n    }\n\n    if (active && touches.size < 2) {\n      active = false\n\n      // Spring back to limits if out of bounds\n      if (currentScale < minScale || currentScale > maxScale) {\n        const targetScale = clamp(currentScale, minScale, maxScale)\n        scaleSpring = createSpringValue(currentScale, {\n          stiffness: spring.stiffness,\n          damping: spring.damping,\n        })\n\n        scaleSpring.subscribe(() => {\n          currentScale = scaleSpring!.get()\n          onPinch?.(createState(e, false, false))\n        })\n\n        scaleSpring.set(targetScale)\n      }\n\n      onPinchEnd?.(createState(e, false, true))\n    }\n  }\n\n  element.addEventListener('touchstart', handleTouchStart, { passive: false })\n  element.addEventListener('touchmove', handleTouchMove, { passive: false })\n  element.addEventListener('touchend', handleTouchEnd)\n  element.addEventListener('touchcancel', handleTouchEnd)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('touchstart', handleTouchStart)\n      element.removeEventListener('touchmove', handleTouchMove)\n      element.removeEventListener('touchend', handleTouchEnd)\n      element.removeEventListener('touchcancel', handleTouchEnd)\n      scaleSpring?.destroy()\n    },\n  }\n}\n\n// ============ Rotate Gesture ============\n\n/**\n * Create rotate gesture handler\n *\n * @example\n * ```ts\n * const rotate = createRotateGesture(element, {\n *   onRotate: (state) => {\n *     element.style.transform = `rotate(${state.angle}deg)`\n *   },\n * })\n * ```\n */\nexport function createRotateGesture(\n  element: HTMLElement,\n  config: RotateConfig = {}\n): GestureController {\n  const {\n    enabled: initialEnabled = true,\n    threshold = 0,\n    onRotate,\n    onRotateStart,\n    onRotateEnd,\n  } = config\n\n  let enabled = initialEnabled\n  let active = false\n  let initialAngle = 0\n  let currentAngle = 0\n  let lastAngle = 0\n  let velocity = 0\n  let startTime = 0\n  let lastTime = 0\n  let angleOffset = 0\n\n  const touches = new Map<number, Point>()\n\n  const createState = (event: TouchEvent, first = false, last = false): RotateState => {\n    const touchArray = Array.from(touches.values())\n    const p1 = touchArray[0] ?? { x: 0, y: 0 }\n    const p2 = touchArray[1] ?? { x: 0, y: 0 }\n    const origin = touchArray.length >= 2 ? getCenter(p1, p2) : { x: 0, y: 0 }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: performance.now() - startTime,\n      cancelled: false,\n      angle: currentAngle,\n      velocity,\n      initialAngle,\n      origin,\n      movement: currentAngle - initialAngle,\n      offset: angleOffset,\n    }\n  }\n\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!enabled) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n    }\n\n    if (touches.size === 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      initialAngle = getAngle(p1, p2)\n      startTime = performance.now()\n      lastTime = startTime\n      lastAngle = currentAngle\n      active = true\n\n      onRotateStart?.(createState(e, true, false))\n    }\n  }\n\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!enabled || !active) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      if (touches.has(touch.identifier)) {\n        touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n      }\n    }\n\n    if (touches.size >= 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      const newAngle = getAngle(p1, p2)\n      const now = performance.now()\n      const dt = now - lastTime\n\n      // Calculate angle delta (handle wrap-around)\n      let angleDelta = newAngle - initialAngle\n      if (angleDelta > 180) angleDelta -= 360\n      if (angleDelta < -180) angleDelta += 360\n\n      // Apply threshold\n      if (Math.abs(angleDelta) >= threshold) {\n        currentAngle = angleOffset + angleDelta\n\n        // Calculate velocity\n        velocity = dt > 0 ? ((currentAngle - lastAngle) / dt) * 1000 : 0\n        lastAngle = currentAngle\n        lastTime = now\n\n        onRotate?.(createState(e, false, false))\n      }\n\n      e.preventDefault()\n    }\n  }\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.delete(touch.identifier)\n    }\n\n    if (active && touches.size < 2) {\n      active = false\n      angleOffset = currentAngle\n      onRotateEnd?.(createState(e, false, true))\n    }\n  }\n\n  element.addEventListener('touchstart', handleTouchStart, { passive: false })\n  element.addEventListener('touchmove', handleTouchMove, { passive: false })\n  element.addEventListener('touchend', handleTouchEnd)\n  element.addEventListener('touchcancel', handleTouchEnd)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('touchstart', handleTouchStart)\n      element.removeEventListener('touchmove', handleTouchMove)\n      element.removeEventListener('touchend', handleTouchEnd)\n      element.removeEventListener('touchcancel', handleTouchEnd)\n    },\n  }\n}\n\n// ============ Swipe Gesture ============\n\n/**\n * Create swipe gesture handler\n *\n * @example\n * ```ts\n * const swipe = createSwipeGesture(element, {\n *   onSwipe: (state) => {\n *     if (state.direction === 'left') {\n *       goToNextSlide()\n *     }\n *   },\n * })\n * ```\n */\nexport function createSwipeGesture(\n  element: HTMLElement,\n  config: SwipeConfig = {}\n): GestureController {\n  const {\n    velocityThreshold = 0.5,\n    distanceThreshold = 50,\n    maxDuration = 300,\n    axis = 'both',\n    onSwipe,\n    onSwipeStart,\n    onSwipeEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let startPoint: Point = { x: 0, y: 0 }\n  let lastPoint: Point = { x: 0, y: 0 }\n  let startTime = 0\n  let lastTime = 0\n  let pointerId: number | null = null\n\n  const createState = (\n    event: PointerEvent,\n    first = false,\n    last = false,\n    direction: SwipeState['direction'] = null\n  ): SwipeState => {\n    const now = performance.now()\n    const duration = now - startTime\n    const dt = now - lastTime\n\n    const movement = {\n      x: event.clientX - startPoint.x,\n      y: event.clientY - startPoint.y,\n    }\n\n    const velocity = {\n      x: dt > 0 ? (event.clientX - lastPoint.x) / dt : 0,\n      y: dt > 0 ? (event.clientY - lastPoint.y) / dt : 0,\n    }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: duration,\n      cancelled: false,\n      direction,\n      velocity,\n      distance: movement,\n      movement,\n      duration,\n    }\n  }\n\n  const detectDirection = (movement: Point, velocity: Point): SwipeState['direction'] => {\n    const absX = Math.abs(movement.x)\n    const absY = Math.abs(movement.y)\n    const velX = Math.abs(velocity.x)\n    const velY = Math.abs(velocity.y)\n\n    // Check if meets thresholds\n    const meetsDistanceX = absX >= distanceThreshold\n    const meetsDistanceY = absY >= distanceThreshold\n    const meetsVelocityX = velX >= velocityThreshold\n    const meetsVelocityY = velY >= velocityThreshold\n\n    // Determine primary direction based on axis constraint\n    if (axis === 'x' || (axis === 'both' && absX > absY)) {\n      if ((meetsDistanceX || meetsVelocityX)) {\n        return movement.x > 0 ? 'right' : 'left'\n      }\n    }\n\n    if (axis === 'y' || (axis === 'both' && absY > absX)) {\n      if ((meetsDistanceY || meetsVelocityY)) {\n        return movement.y > 0 ? 'down' : 'up'\n      }\n    }\n\n    return null\n  }\n\n  const handlePointerDown = (e: PointerEvent) => {\n    if (!enabled || pointerId !== null) return\n\n    pointerId = e.pointerId\n    startPoint = { x: e.clientX, y: e.clientY }\n    lastPoint = { ...startPoint }\n    startTime = performance.now()\n    lastTime = startTime\n    active = true\n\n    element.setPointerCapture(e.pointerId)\n    onSwipeStart?.(createState(e, true, false))\n  }\n\n  const handlePointerMove = (e: PointerEvent) => {\n    if (!enabled || !active || e.pointerId !== pointerId) return\n\n    const now = performance.now()\n    lastPoint = { x: e.clientX, y: e.clientY }\n    lastTime = now\n  }\n\n  const handlePointerUp = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    active = false\n    pointerId = null\n\n    const duration = performance.now() - startTime\n\n    // Only detect swipe if within max duration\n    if (duration <= maxDuration) {\n      const movement = {\n        x: e.clientX - startPoint.x,\n        y: e.clientY - startPoint.y,\n      }\n      const dt = performance.now() - lastTime\n      const velocity = {\n        x: dt > 0 ? (e.clientX - lastPoint.x) / dt : 0,\n        y: dt > 0 ? (e.clientY - lastPoint.y) / dt : 0,\n      }\n\n      const direction = detectDirection(movement, velocity)\n      const state = createState(e, false, true, direction)\n\n      if (direction) {\n        onSwipe?.(state)\n      }\n      onSwipeEnd?.(state)\n    } else {\n      onSwipeEnd?.(createState(e, false, true, null))\n    }\n\n    element.releasePointerCapture(e.pointerId)\n  }\n\n  element.addEventListener('pointerdown', handlePointerDown)\n  element.addEventListener('pointermove', handlePointerMove)\n  element.addEventListener('pointerup', handlePointerUp)\n  element.addEventListener('pointercancel', handlePointerUp)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('pointerdown', handlePointerDown)\n      element.removeEventListener('pointermove', handlePointerMove)\n      element.removeEventListener('pointerup', handlePointerUp)\n      element.removeEventListener('pointercancel', handlePointerUp)\n    },\n  }\n}\n\n// ============ Long Press Gesture ============\n\n/**\n * Create long press gesture handler\n *\n * @example\n * ```ts\n * const longPress = createLongPressGesture(element, {\n *   threshold: 500,\n *   onLongPress: (state) => {\n *     showContextMenu(state.position)\n *   },\n * })\n * ```\n */\nexport function createLongPressGesture(\n  element: HTMLElement,\n  config: LongPressConfig = {}\n): GestureController {\n  const {\n    threshold = 500,\n    movementTolerance = 10,\n    onLongPress,\n    onPressStart,\n    onPressEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let triggered = false\n  let startPoint: Point = { x: 0, y: 0 }\n  let startTime = 0\n  let timerId: ReturnType<typeof setTimeout> | null = null\n  let pointerId: number | null = null\n\n  const createState = (event: PointerEvent, first = false, last = false): LongPressState => ({\n    active,\n    first,\n    last,\n    event,\n    elapsedTime: performance.now() - startTime,\n    cancelled: false,\n    position: startPoint,\n    duration: performance.now() - startTime,\n    triggered,\n  })\n\n  const handlePointerDown = (e: PointerEvent) => {\n    if (!enabled || pointerId !== null) return\n\n    pointerId = e.pointerId\n    startPoint = { x: e.clientX, y: e.clientY }\n    startTime = performance.now()\n    active = true\n    triggered = false\n\n    element.setPointerCapture(e.pointerId)\n    onPressStart?.(createState(e, true, false))\n\n    // Start timer for long press\n    timerId = setTimeout(() => {\n      if (active && !triggered) {\n        triggered = true\n        onLongPress?.(createState(e, false, false))\n      }\n    }, threshold)\n  }\n\n  const handlePointerMove = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    // Check if moved beyond tolerance\n    const dx = e.clientX - startPoint.x\n    const dy = e.clientY - startPoint.y\n    const distance = Math.sqrt(dx * dx + dy * dy)\n\n    if (distance > movementTolerance) {\n      // Cancel long press\n      if (timerId) {\n        clearTimeout(timerId)\n        timerId = null\n      }\n    }\n  }\n\n  const handlePointerUp = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    active = false\n    pointerId = null\n\n    if (timerId) {\n      clearTimeout(timerId)\n      timerId = null\n    }\n\n    onPressEnd?.(createState(e, false, true))\n    element.releasePointerCapture(e.pointerId)\n  }\n\n  element.addEventListener('pointerdown', handlePointerDown)\n  element.addEventListener('pointermove', handlePointerMove)\n  element.addEventListener('pointerup', handlePointerUp)\n  element.addEventListener('pointercancel', handlePointerUp)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      if (timerId) clearTimeout(timerId)\n      element.removeEventListener('pointerdown', handlePointerDown)\n      element.removeEventListener('pointermove', handlePointerMove)\n      element.removeEventListener('pointerup', handlePointerUp)\n      element.removeEventListener('pointercancel', handlePointerUp)\n    },\n  }\n}\n\n// ============ Combined Gesture Handler ============\n\n/**\n * Create combined gesture handler for multiple gesture types\n *\n * @example\n * ```ts\n * const gestures = createGestures(element, {\n *   pinch: {\n *     onPinch: (state) => console.log('Scale:', state.scale),\n *   },\n *   rotate: {\n *     onRotate: (state) => console.log('Angle:', state.angle),\n *   },\n *   swipe: {\n *     onSwipe: (state) => console.log('Direction:', state.direction),\n *   },\n * })\n * ```\n */\nexport function createGestures(\n  element: HTMLElement,\n  config: GestureConfig\n): GestureController {\n  const controllers: GestureController[] = []\n\n  if (config.pinch) {\n    controllers.push(createPinchGesture(element, config.pinch))\n  }\n  if (config.rotate) {\n    controllers.push(createRotateGesture(element, config.rotate))\n  }\n  if (config.swipe) {\n    controllers.push(createSwipeGesture(element, config.swipe))\n  }\n  if (config.longPress) {\n    controllers.push(createLongPressGesture(element, config.longPress))\n  }\n\n  return {\n    enable: () => controllers.forEach(c => c.enable()),\n    disable: () => controllers.forEach(c => c.disable()),\n    isEnabled: () => controllers.every(c => c.isEnabled()),\n    destroy: () => controllers.forEach(c => c.destroy()),\n  }\n}\n","\n/**\n * RGB color representation\n */\nexport interface RGB {\n  r: number\n  g: number\n  b: number\n}\n\n/**\n * HSL color representation\n */\nexport interface HSL {\n  h: number\n  s: number\n  l: number\n}\n\n/**\n * Parse a color string to RGB\n * Supports hex (#rgb, #rrggbb), rgb(), and named colors\n * @param color - The color string to parse\n * @returns The RGB representation\n */\nexport function parseColor(color: string): RGB {\n  // Try hex format first\n  const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\n  if (hexMatch) {\n    return hexToRgb(color)\n  }\n\n  // Try rgb() format\n  const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\n  if (rgbMatch) {\n    return {\n      r: parseInt(rgbMatch[1]!, 10),\n      g: parseInt(rgbMatch[2]!, 10),\n      b: parseInt(rgbMatch[3]!, 10),\n    }\n  }\n\n  // Try rgba() format\n  const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\n  if (rgbaMatch) {\n    return {\n      r: parseInt(rgbaMatch[1]!, 10),\n      g: parseInt(rgbaMatch[2]!, 10),\n      b: parseInt(rgbaMatch[3]!, 10),\n    }\n  }\n\n  // Try hsl() format\n  const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\n  if (hslMatch) {\n    return hslToRgb(\n      parseInt(hslMatch[1]!, 10),\n      parseInt(hslMatch[2]!, 10),\n      parseInt(hslMatch[3]!, 10)\n    )\n  }\n\n  // Default to black for unknown formats\n  return { r: 0, g: 0, b: 0 }\n}\n\n/**\n * Convert RGB to hex color string\n * @param r - Red component (0-255)\n * @param g - Green component (0-255)\n * @param b - Blue component (0-255)\n * @returns Hex color string\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const toHex = (n: number): string => {\n    const clamped = Math.round(Math.max(0, Math.min(255, n)))\n    return clamped.toString(16).padStart(2, '0')\n  }\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}`\n}\n\n/**\n * Convert hex color string to RGB\n * @param hex - Hex color string (with or without #)\n * @returns RGB representation\n */\nexport function hexToRgb(hex: string): RGB {\n  const cleanHex = hex.replace('#', '')\n\n  if (cleanHex.length === 3) {\n    return {\n      r: parseInt(cleanHex.charAt(0) + cleanHex.charAt(0), 16),\n      g: parseInt(cleanHex.charAt(1) + cleanHex.charAt(1), 16),\n      b: parseInt(cleanHex.charAt(2) + cleanHex.charAt(2), 16),\n    }\n  }\n\n  return {\n    r: parseInt(cleanHex.slice(0, 2), 16),\n    g: parseInt(cleanHex.slice(2, 4), 16),\n    b: parseInt(cleanHex.slice(4, 6), 16),\n  }\n}\n\n/**\n * Convert HSL to RGB\n * @param h - Hue (0-360)\n * @param s - Saturation (0-100)\n * @param l - Lightness (0-100)\n * @returns RGB representation\n */\nexport function hslToRgb(h: number, s: number, l: number): RGB {\n  h = ((h % 360) + 360) % 360\n  s = Math.max(0, Math.min(100, s)) / 100\n  l = Math.max(0, Math.min(100, l)) / 100\n\n  if (s === 0) {\n    const gray = Math.round(l * 255)\n    return { r: gray, g: gray, b: gray }\n  }\n\n  const hue2rgb = (p: number, q: number, t: number): number => {\n    if (t < 0) t += 1\n    if (t > 1) t -= 1\n    if (t < 1 / 6) return p + (q - p) * 6 * t\n    if (t < 1 / 2) return q\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n    return p\n  }\n\n  const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n  const p = 2 * l - q\n\n  return {\n    r: Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\n    g: Math.round(hue2rgb(p, q, h / 360) * 255),\n    b: Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\n  }\n}\n\n/**\n * Convert RGB to HSL\n * @param r - Red component (0-255)\n * @param g - Green component (0-255)\n * @param b - Blue component (0-255)\n * @returns HSL representation\n */\nexport function rgbToHsl(r: number, g: number, b: number): HSL {\n  r = Math.max(0, Math.min(255, r)) / 255\n  g = Math.max(0, Math.min(255, g)) / 255\n  b = Math.max(0, Math.min(255, b)) / 255\n\n  const max = Math.max(r, g, b)\n  const min = Math.min(r, g, b)\n  const delta = max - min\n\n  let h = 0\n  let s = 0\n\n  if (delta !== 0) {\n    s = (max + min) / 2 > 0.5\n      ? delta / (2 - max - min)\n      : delta / (max + min)\n\n    if (max === r) {\n      h = ((g - b) / delta + (g < b ? 6 : 0)) / 6\n    } else if (max === g) {\n      h = ((b - r) / delta + 2) / 6\n    } else {\n      h = ((r - g) / delta + 4) / 6\n    }\n  }\n\n  return {\n    h: Math.round(h * 360),\n    s: Math.round(s * 100),\n    l: Math.round(((max + min) / 2) * 100),\n  }\n}\n","/**\n * Scroll-linked animations - Bind animations directly to scroll position\n *\n * Unlike spring-based scroll animations, these animations are directly\n * tied to scroll progress (0-1) for precise control.\n */\n\nimport { clamp, lerp } from '../utils/math.js'\nimport { parseColor, rgbToHex } from '../utils/color.js'\n\n/**\n * Simple color lerp for scroll-linked animations\n */\nfunction lerpColor(colorA: string, colorB: string, t: number): string {\n  const a = parseColor(colorA)\n  const b = parseColor(colorB)\n  return rgbToHex(\n    Math.round(lerp(a.r, b.r, t)),\n    Math.round(lerp(a.g, b.g, t)),\n    Math.round(lerp(a.b, b.b, t))\n  )\n}\n\n/**\n * Scroll progress info passed to callbacks\n */\nexport interface ScrollInfo {\n  /** Progress from 0 to 1 */\n  progress: number\n  /** Absolute scroll position in pixels */\n  scrollY: number\n  /** Scroll velocity in pixels per second */\n  velocity: number\n  /** Scroll direction: 1 = down, -1 = up, 0 = stationary */\n  direction: -1 | 0 | 1\n  /** Whether element is in viewport */\n  isInView: boolean\n  /** How much of the element is visible (0-1) */\n  visibleRatio: number\n}\n\n/**\n * Scroll trigger configuration\n */\nexport interface ScrollTriggerConfig {\n  /** Start trigger position: 'top', 'center', 'bottom', or pixel value */\n  start?: 'top' | 'center' | 'bottom' | number\n  /** End trigger position: 'top', 'center', 'bottom', or pixel value */\n  end?: 'top' | 'center' | 'bottom' | number\n  /** Offset from start position in pixels */\n  startOffset?: number\n  /** Offset from end position in pixels */\n  endOffset?: number\n  /** Callback when entering viewport */\n  onEnter?: (info: ScrollInfo) => void\n  /** Callback when leaving viewport */\n  onLeave?: (info: ScrollInfo) => void\n  /** Callback on progress update */\n  onProgress?: (info: ScrollInfo) => void\n  /** Only trigger once */\n  once?: boolean\n  /** Scrub animation to scroll (true = instant, number = smoothing factor) */\n  scrub?: boolean | number\n}\n\n/**\n * Parallax configuration\n */\nexport interface ParallaxConfig {\n  /** Speed multiplier (negative = opposite direction) */\n  speed?: number\n  /** Direction of parallax effect */\n  direction?: 'vertical' | 'horizontal'\n  /** Easing function */\n  easing?: (t: number) => number\n  /** Root margin for intersection observer */\n  rootMargin?: string\n}\n\n/**\n * Scroll-linked value configuration\n */\nexport interface ScrollLinkedConfig {\n  /** Input range (scroll positions or progress values) */\n  inputRange: number[]\n  /** Output range (values to interpolate between) */\n  outputRange: (number | string)[]\n  /** Clamp output to range */\n  clamp?: boolean\n  /** Use smooth interpolation */\n  smooth?: number\n  /** Easing function */\n  easing?: (t: number) => number\n}\n\n/**\n * Scroll progress tracker\n */\nexport interface ScrollProgress {\n  /** Get current progress (0-1) */\n  get(): number\n  /** Get current scroll info */\n  getInfo(): ScrollInfo\n  /** Subscribe to progress changes */\n  subscribe(callback: (info: ScrollInfo) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Parallax controller\n */\nexport interface Parallax {\n  /** Get current offset */\n  getOffset(): number\n  /** Update parallax (call on scroll) */\n  update(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Scroll trigger controller\n */\nexport interface ScrollTrigger {\n  /** Check if currently active */\n  isActive(): boolean\n  /** Get current progress within trigger range */\n  getProgress(): number\n  /** Refresh trigger calculations */\n  refresh(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Scroll-linked value controller\n */\nexport interface ScrollLinkedValue {\n  /** Get current interpolated value */\n  get(): number | string\n  /** Subscribe to value changes */\n  subscribe(callback: (value: number | string) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Implementation ============\n\n/**\n * Create scroll progress tracker for an element\n */\nexport function createScrollProgress(\n  element?: HTMLElement | null,\n  options: {\n    offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\n    smooth?: number\n  } = {}\n): ScrollProgress {\n  const { offset = ['start', 'end'], smooth = 0 } = options\n\n  let progress = 0\n  let smoothedProgress = 0\n  let lastScrollY = 0\n  let lastTime = performance.now()\n  let velocity = 0\n  let direction: -1 | 0 | 1 = 0\n  let rafId: number | null = null\n  const subscribers = new Set<(info: ScrollInfo) => void>()\n\n  const calculateProgress = (): ScrollInfo => {\n    const scrollY = window.scrollY\n    const windowHeight = window.innerHeight\n    const now = performance.now()\n    const dt = Math.max(now - lastTime, 1)\n\n    // Calculate velocity and direction\n    velocity = ((scrollY - lastScrollY) / dt) * 1000\n    direction = scrollY > lastScrollY ? 1 : scrollY < lastScrollY ? -1 : 0\n    lastScrollY = scrollY\n    lastTime = now\n\n    let newProgress: number\n    let isInView = true\n    let visibleRatio = 1\n\n    if (element) {\n      const rect = element.getBoundingClientRect()\n      const elementTop = rect.top + scrollY\n      const elementHeight = rect.height\n\n      // Calculate start and end points based on offset\n      const startPoint = offset[0] === 'start' ? elementTop :\n                        offset[0] === 'center' ? elementTop + elementHeight / 2 :\n                        elementTop + elementHeight\n\n      const endPoint = offset[1] === 'start' ? windowHeight :\n                      offset[1] === 'center' ? windowHeight / 2 :\n                      0\n\n      const scrollStart = startPoint - windowHeight\n      const scrollEnd = startPoint - endPoint\n\n      newProgress = clamp((scrollY - scrollStart) / (scrollEnd - scrollStart), 0, 1)\n\n      // Check if in view\n      isInView = rect.top < windowHeight && rect.bottom > 0\n      visibleRatio = isInView ?\n        clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0\n    } else {\n      // Track overall page scroll\n      const documentHeight = document.documentElement.scrollHeight - windowHeight\n      newProgress = documentHeight > 0 ? clamp(scrollY / documentHeight, 0, 1) : 0\n    }\n\n    // Apply smoothing\n    if (smooth > 0) {\n      smoothedProgress = lerp(smoothedProgress, newProgress, 1 - smooth)\n      progress = smoothedProgress\n    } else {\n      progress = newProgress\n    }\n\n    return {\n      progress,\n      scrollY,\n      velocity,\n      direction,\n      isInView,\n      visibleRatio,\n    }\n  }\n\n  const notify = (info: ScrollInfo) => {\n    subscribers.forEach(cb => cb(info))\n  }\n\n  const onScroll = () => {\n    if (rafId) return\n    rafId = requestAnimationFrame(() => {\n      rafId = null\n      const info = calculateProgress()\n      notify(info)\n    })\n  }\n\n  // Initial calculation\n  const initialInfo = calculateProgress()\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n  window.addEventListener('resize', onScroll, { passive: true })\n\n  return {\n    get: () => progress,\n    getInfo: () => calculateProgress(),\n    subscribe: (callback) => {\n      subscribers.add(callback)\n      callback(initialInfo)\n      return () => subscribers.delete(callback)\n    },\n    destroy: () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      window.removeEventListener('scroll', onScroll)\n      window.removeEventListener('resize', onScroll)\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Create parallax effect for an element\n *\n * @example\n * ```ts\n * const parallax = createParallax(element, { speed: 0.5 })\n * // Element moves at 50% scroll speed\n * ```\n */\nexport function createParallax(\n  element: HTMLElement,\n  config: ParallaxConfig = {}\n): Parallax {\n  const {\n    speed = 0.5,\n    direction = 'vertical',\n    easing = (t: number) => t,\n    rootMargin = '0px',\n  } = config\n\n  let offset = 0\n  let isInView = false\n  let observer: IntersectionObserver | null = null\n\n  const update = () => {\n    if (!isInView) return\n\n    const rect = element.getBoundingClientRect()\n    const windowHeight = window.innerHeight\n\n    // Calculate how far through the viewport the element is\n    const elementCenter = rect.top + rect.height / 2\n    const viewportCenter = windowHeight / 2\n    const distanceFromCenter = elementCenter - viewportCenter\n\n    // Apply speed and easing\n    const normalizedDistance = distanceFromCenter / windowHeight\n    const easedDistance = easing(Math.abs(normalizedDistance)) * Math.sign(normalizedDistance)\n    offset = easedDistance * speed * 100\n\n    // Apply transform\n    if (direction === 'vertical') {\n      element.style.transform = `translate3d(0, ${offset}px, 0)`\n    } else {\n      element.style.transform = `translate3d(${offset}px, 0, 0)`\n    }\n  }\n\n  // Use IntersectionObserver for performance\n  observer = new IntersectionObserver(\n    (entries) => {\n      const entry = entries[0]\n      if (entry) {\n        isInView = entry.isIntersecting\n        if (isInView) update()\n      }\n    },\n    { rootMargin }\n  )\n  observer.observe(element)\n\n  const onScroll = () => {\n    if (isInView) {\n      requestAnimationFrame(update)\n    }\n  }\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n\n  return {\n    getOffset: () => offset,\n    update,\n    destroy: () => {\n      observer?.disconnect()\n      window.removeEventListener('scroll', onScroll)\n      element.style.transform = ''\n    },\n  }\n}\n\n/**\n * Create scroll trigger for precise scroll-based animations\n *\n * @example\n * ```ts\n * const trigger = createScrollTrigger(element, {\n *   start: 'top',\n *   end: 'bottom',\n *   onProgress: (info) => {\n *     element.style.opacity = String(info.progress)\n *   },\n * })\n * ```\n */\nexport function createScrollTrigger(\n  element: HTMLElement,\n  config: ScrollTriggerConfig = {}\n): ScrollTrigger {\n  const {\n    start = 'top',\n    end = 'bottom',\n    startOffset = 0,\n    endOffset = 0,\n    onEnter,\n    onLeave,\n    onProgress,\n    once = false,\n    scrub = false,\n  } = config\n\n  let isActive = false\n  let progress = 0\n  let hasEntered = false\n  let smoothedProgress = 0\n  let rafId: number | null = null\n\n  const getPosition = (pos: 'top' | 'center' | 'bottom' | number, rect: DOMRect): number => {\n    if (typeof pos === 'number') return pos\n    switch (pos) {\n      case 'top': return rect.top\n      case 'center': return rect.top + rect.height / 2\n      case 'bottom': return rect.bottom\n    }\n  }\n\n  const calculateProgress = (): ScrollInfo => {\n    const rect = element.getBoundingClientRect()\n    const windowHeight = window.innerHeight\n\n    const startPos = getPosition(start, rect) + startOffset\n    const endPos = getPosition(end, rect) + endOffset\n\n    // Calculate progress based on viewport position\n    const triggerStart = windowHeight\n    const triggerEnd = 0\n\n    const startProgress = (triggerStart - startPos) / (triggerStart - triggerEnd)\n    const endProgress = (triggerStart - endPos) / (triggerStart - triggerEnd)\n\n    const rawProgress = clamp(startProgress / (endProgress || 1), 0, 1)\n\n    // Apply scrub smoothing\n    if (typeof scrub === 'number' && scrub > 0) {\n      smoothedProgress = lerp(smoothedProgress, rawProgress, 1 - scrub)\n      progress = smoothedProgress\n    } else {\n      progress = rawProgress\n    }\n\n    const isInView = rect.top < windowHeight && rect.bottom > 0\n\n    return {\n      progress,\n      scrollY: window.scrollY,\n      velocity: 0,\n      direction: 0,\n      isInView,\n      visibleRatio: isInView ? clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0,\n    }\n  }\n\n  const onScroll = () => {\n    if (rafId) return\n    rafId = requestAnimationFrame(() => {\n      rafId = null\n      const info = calculateProgress()\n\n      // Check for enter/leave\n      const wasActive = isActive\n      isActive = info.progress > 0 && info.progress < 1\n\n      if (!wasActive && isActive && (!once || !hasEntered)) {\n        hasEntered = true\n        onEnter?.(info)\n      }\n\n      if (wasActive && !isActive) {\n        onLeave?.(info)\n      }\n\n      if (isActive || scrub) {\n        onProgress?.(info)\n      }\n    })\n  }\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n  window.addEventListener('resize', onScroll, { passive: true })\n\n  // Initial check\n  onScroll()\n\n  return {\n    isActive: () => isActive,\n    getProgress: () => progress,\n    refresh: () => {\n      calculateProgress()\n    },\n    destroy: () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      window.removeEventListener('scroll', onScroll)\n      window.removeEventListener('resize', onScroll)\n    },\n  }\n}\n\n/**\n * Create a scroll-linked interpolated value\n *\n * @example\n * ```ts\n * const opacity = createScrollLinkedValue(scrollProgress, {\n *   inputRange: [0, 0.5, 1],\n *   outputRange: [0, 1, 0],\n * })\n *\n * opacity.subscribe((value) => {\n *   element.style.opacity = String(value)\n * })\n * ```\n */\nexport function createScrollLinkedValue(\n  scrollProgress: ScrollProgress,\n  config: ScrollLinkedConfig\n): ScrollLinkedValue {\n  const { inputRange, outputRange, clamp: shouldClamp = true, easing } = config\n\n  if (inputRange.length !== outputRange.length) {\n    throw new Error('inputRange and outputRange must have the same length')\n  }\n\n  const firstOutput = outputRange[0]\n  const isColorOutput = typeof firstOutput === 'string' &&\n    (firstOutput.startsWith('#') || firstOutput.startsWith('rgb') || firstOutput.startsWith('hsl'))\n\n  let currentValue: number | string = firstOutput ?? 0\n  const subscribers = new Set<(value: number | string) => void>()\n\n  const interpolate = (progress: number): number | string => {\n    let p = progress\n    if (easing) p = easing(p)\n    const firstInput = inputRange[0] ?? 0\n    const lastInput = inputRange[inputRange.length - 1] ?? 1\n    if (shouldClamp) p = clamp(p, firstInput, lastInput)\n\n    // Find the segment\n    let segmentIndex = 0\n    for (let i = 0; i < inputRange.length - 1; i++) {\n      const curr = inputRange[i] ?? 0\n      const next = inputRange[i + 1] ?? 1\n      if (p >= curr && p <= next) {\n        segmentIndex = i\n        break\n      }\n      if (p > next) {\n        segmentIndex = i + 1\n      }\n    }\n\n    const segmentStart = inputRange[segmentIndex] ?? 0\n    const segmentEnd = inputRange[segmentIndex + 1] ?? segmentStart\n    const segmentProgress = segmentEnd !== segmentStart\n      ? (p - segmentStart) / (segmentEnd - segmentStart)\n      : 0\n\n    const startValue = outputRange[segmentIndex] ?? 0\n    const endValue = outputRange[segmentIndex + 1] ?? startValue\n\n    if (isColorOutput && typeof startValue === 'string' && typeof endValue === 'string') {\n      return lerpColor(startValue, endValue, segmentProgress)\n    }\n\n    return lerp(startValue as number, endValue as number, segmentProgress)\n  }\n\n  const unsubscribe = scrollProgress.subscribe((info) => {\n    currentValue = interpolate(info.progress)\n    subscribers.forEach(cb => cb(currentValue))\n  })\n\n  return {\n    get: () => currentValue,\n    subscribe: (callback) => {\n      subscribers.add(callback)\n      callback(currentValue)\n      return () => subscribers.delete(callback)\n    },\n    destroy: () => {\n      unsubscribe()\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Easing functions for scroll-linked animations\n */\nexport const scrollEasings = {\n  linear: (t: number) => t,\n  easeIn: (t: number) => t * t,\n  easeOut: (t: number) => t * (2 - t),\n  easeInOut: (t: number) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n  easeInCubic: (t: number) => t * t * t,\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\n  easeInOutCubic: (t: number) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n  easeInQuart: (t: number) => t * t * t * t,\n  easeOutQuart: (t: number) => 1 - (--t) * t * t * t,\n  easeInOutQuart: (t: number) => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t,\n}\n","/**\n * Timeline API - GSAP-inspired animation sequencing with spring physics\n *\n * Create complex, coordinated animations with precise control over\n * timing, sequencing, and playback.\n */\n\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Animation target - can be element, selector, or values object\n */\nexport type TimelineTarget = HTMLElement | string | Record<string, number>\n\n/**\n * Animation values (numeric properties to animate)\n */\nexport interface TimelineValues {\n  [key: string]: number | undefined\n}\n\n/**\n * Timeline animation options\n */\nexport interface TimelineOptions {\n  /** Animation duration override (not used with springs, but for timing) */\n  duration?: number\n  /** Delay before animation starts */\n  delay?: number\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Easing function (for non-spring animations) */\n  ease?: (t: number) => number\n  /** Callback when animation starts */\n  onStart?: () => void\n  /** Callback on each update */\n  onUpdate?: (progress: number) => void\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Animation properties - combines values with options\n */\nexport type TimelineProps = TimelineValues & TimelineOptions\n\n/**\n * Position in timeline - can be absolute, relative, or label\n */\nexport type TimelinePosition = number | string | `+=${number}` | `-=${number}` | `<` | `>`\n\n/**\n * Timeline segment representing a single animation\n */\ninterface TimelineSegment {\n  id: string\n  target: TimelineTarget\n  props: TimelineProps\n  startTime: number\n  endTime: number\n  spring: SpringGroup<Record<string, number>> | null\n  isActive: boolean\n  isComplete: boolean\n}\n\n/**\n * Timeline configuration\n */\nexport interface TimelineConfig {\n  /** Default spring configuration for all animations */\n  defaults?: SpringConfig\n  /** Whether to autoplay on creation */\n  autoplay?: boolean\n  /** Repeat count (-1 = infinite) */\n  repeat?: number\n  /** Yoyo (reverse on repeat) */\n  yoyo?: boolean\n  /** Delay between repeats */\n  repeatDelay?: number\n  /** Callback when timeline starts */\n  onStart?: () => void\n  /** Callback on each frame */\n  onUpdate?: (progress: number) => void\n  /** Callback when timeline completes */\n  onComplete?: () => void\n  /** Callback on repeat */\n  onRepeat?: (iteration: number) => void\n}\n\n/**\n * Timeline controller interface\n */\nexport interface Timeline {\n  /** Add animation to end of timeline */\n  to(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add animation from initial values */\n  from(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add animation from/to values */\n  fromTo(target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add a label at current position */\n  addLabel(label: string, position?: TimelinePosition): Timeline\n  /** Add a callback at position */\n  call(callback: () => void, position?: TimelinePosition): Timeline\n  /** Set properties instantly (no animation) */\n  set(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add pause at position */\n  addPause(position?: TimelinePosition, callback?: () => void): Timeline\n\n  /** Play timeline */\n  play(): Timeline\n  /** Pause timeline */\n  pause(): Timeline\n  /** Resume from pause */\n  resume(): Timeline\n  /** Reverse timeline */\n  reverse(): Timeline\n  /** Restart timeline */\n  restart(): Timeline\n  /** Seek to position */\n  seek(position: number | string): Timeline\n  /** Kill timeline and cleanup */\n  kill(): void\n\n  /** Get current time */\n  time(): number\n  /** Get total duration */\n  duration(): number\n  /** Get current progress (0-1) */\n  progress(): number\n  /** Check if playing */\n  isPlaying(): boolean\n  /** Check if reversed */\n  isReversed(): boolean\n\n  /** Get timeline by ID */\n  getById(id: string): TimelineSegment | undefined\n}\n\n// ============ Implementation ============\n\nlet timelineIdCounter = 0\n\n/**\n * Create a new timeline\n *\n * @example\n * ```ts\n * const tl = createTimeline()\n *   .to(element, { x: 100, opacity: 1 })\n *   .to(element, { y: 50 }, '+=0.2')\n *   .to(element, { scale: 1.2 }, '<')\n *\n * tl.play()\n * ```\n */\nexport function createTimeline(config: TimelineConfig = {}): Timeline {\n  const {\n    defaults = {},\n    autoplay = false,\n    repeat = 0,\n    yoyo = false,\n    repeatDelay = 0,\n    onStart,\n    onUpdate,\n    onComplete,\n    onRepeat,\n  } = config\n\n  const segments: TimelineSegment[] = []\n  const labels = new Map<string, number>()\n  const callbacks = new Map<number, (() => void)[]>()\n  const pauses = new Map<number, (() => void) | undefined>()\n\n  let currentTime = 0\n  let totalDuration = 0\n  let isPlaying = false\n  let isReversed = false\n  let isPaused = false\n  let repeatCount = 0\n  let rafId: number | null = null\n  let lastFrameTime = 0\n  let hasStarted = false\n  let insertTime = 0\n\n  // ============ Utility Functions ============\n\n  const parsePosition = (position?: TimelinePosition): number => {\n    if (position === undefined) {\n      return insertTime\n    }\n\n    if (typeof position === 'number') {\n      return position\n    }\n\n    // Relative to previous animation\n    if (position === '<') {\n      const lastSegment = segments[segments.length - 1]\n      return lastSegment ? lastSegment.startTime : 0\n    }\n\n    if (position === '>') {\n      return insertTime\n    }\n\n    // Relative offset\n    if (position.startsWith('+=')) {\n      return insertTime + parseFloat(position.slice(2))\n    }\n\n    if (position.startsWith('-=')) {\n      return insertTime - parseFloat(position.slice(2))\n    }\n\n    // Label reference\n    if (labels.has(position)) {\n      return labels.get(position)!\n    }\n\n    // Label with offset\n    const labelMatch = position.match(/^([a-zA-Z_]\\w*)([+-]=?\\d*\\.?\\d+)?$/)\n    if (labelMatch) {\n      const labelName = labelMatch[1]\n      const offset = labelMatch[2]\n      const labelTime = labelName ? (labels.get(labelName) ?? 0) : 0\n      if (offset) {\n        const offsetValue = parseFloat(offset.replace('=', ''))\n        return labelTime + offsetValue\n      }\n      return labelTime\n    }\n\n    return insertTime\n  }\n\n  const resolveTarget = (target: TimelineTarget): HTMLElement | null => {\n    if (typeof target === 'string') {\n      return document.querySelector(target)\n    }\n    if (target instanceof HTMLElement) {\n      return target\n    }\n    return null\n  }\n\n  const extractNumericProps = (props: TimelineProps): Record<string, number> => {\n    const result: Record<string, number> = {}\n    for (const [key, value] of Object.entries(props)) {\n      if (typeof value === 'number' && !['duration', 'delay'].includes(key)) {\n        result[key] = value\n      }\n    }\n    return result\n  }\n\n  const applyPropsToElement = (element: HTMLElement, props: Record<string, number>) => {\n    const transforms: string[] = []\n    const cssProps: Record<string, string> = {}\n\n    for (const [key, value] of Object.entries(props)) {\n      switch (key) {\n        case 'x':\n          transforms.push(`translateX(${value}px)`)\n          break\n        case 'y':\n          transforms.push(`translateY(${value}px)`)\n          break\n        case 'z':\n          transforms.push(`translateZ(${value}px)`)\n          break\n        case 'scale':\n          transforms.push(`scale(${value})`)\n          break\n        case 'scaleX':\n          transforms.push(`scaleX(${value})`)\n          break\n        case 'scaleY':\n          transforms.push(`scaleY(${value})`)\n          break\n        case 'rotate':\n        case 'rotation':\n          transforms.push(`rotate(${value}deg)`)\n          break\n        case 'rotateX':\n          transforms.push(`rotateX(${value}deg)`)\n          break\n        case 'rotateY':\n          transforms.push(`rotateY(${value}deg)`)\n          break\n        case 'rotateZ':\n          transforms.push(`rotateZ(${value}deg)`)\n          break\n        case 'skewX':\n          transforms.push(`skewX(${value}deg)`)\n          break\n        case 'skewY':\n          transforms.push(`skewY(${value}deg)`)\n          break\n        case 'opacity':\n          cssProps.opacity = String(value)\n          break\n        default:\n          // Assume pixels for numeric values\n          cssProps[key] = typeof value === 'number' ? `${value}px` : String(value)\n      }\n    }\n\n    if (transforms.length > 0) {\n      element.style.transform = transforms.join(' ')\n    }\n\n    for (const [prop, val] of Object.entries(cssProps)) {\n      ;(element.style as unknown as Record<string, string>)[prop] = val\n    }\n  }\n\n  const getCurrentElementValues = (element: HTMLElement, props: Record<string, number>): Record<string, number> => {\n    const current: Record<string, number> = {}\n    const computed = getComputedStyle(element)\n\n    for (const key of Object.keys(props)) {\n      switch (key) {\n        case 'opacity':\n          current[key] = parseFloat(computed.opacity) || 1\n          break\n        case 'x':\n        case 'y':\n        case 'z':\n        case 'scale':\n        case 'scaleX':\n        case 'scaleY':\n        case 'rotate':\n        case 'rotation':\n        case 'rotateX':\n        case 'rotateY':\n        case 'rotateZ':\n        case 'skewX':\n        case 'skewY':\n          // Parse from transform matrix - simplified, defaults to 0 or 1\n          current[key] = key.startsWith('scale') ? 1 : 0\n          break\n        default:\n          current[key] = parseFloat(computed.getPropertyValue(key)) || 0\n      }\n    }\n\n    return current\n  }\n\n  // ============ Animation Loop ============\n\n  // Maximum delta time to prevent jumps after tab suspension (64ms = ~15fps minimum)\n  const MAX_DELTA_TIME = 64\n\n  const tick = (timestamp: number) => {\n    if (!isPlaying || isPaused) return\n\n    // Clamp delta time to prevent jumps after tab suspension or debugger pauses\n    const rawDelta = lastFrameTime ? (timestamp - lastFrameTime) : 0\n    const deltaTime = Math.min(rawDelta, MAX_DELTA_TIME) / 1000\n    lastFrameTime = timestamp\n\n    // Update time\n    currentTime += isReversed ? -deltaTime : deltaTime\n    currentTime = clamp(currentTime, 0, totalDuration)\n\n    // Check for callbacks\n    const callbacksAtTime = callbacks.get(Math.floor(currentTime * 1000))\n    if (callbacksAtTime) {\n      callbacksAtTime.forEach(cb => cb())\n    }\n\n    // Check for pauses\n    const pauseCallback = pauses.get(Math.floor(currentTime * 1000))\n    if (pauseCallback !== undefined) {\n      isPaused = true\n      pauseCallback?.()\n      return\n    }\n\n    // Update segments\n    for (const segment of segments) {\n      const segmentProgress = clamp(\n        (currentTime - segment.startTime) / (segment.endTime - segment.startTime),\n        0,\n        1\n      )\n\n      const shouldBeActive = currentTime >= segment.startTime && currentTime <= segment.endTime\n\n      if (shouldBeActive && !segment.isActive) {\n        segment.isActive = true\n        segment.props.onStart?.()\n      }\n\n      if (segment.isActive && segment.spring) {\n        segment.props.onUpdate?.(segmentProgress)\n      }\n\n      if (shouldBeActive && segmentProgress >= 1 && !segment.isComplete) {\n        segment.isComplete = true\n        segment.props.onComplete?.()\n      }\n    }\n\n    onUpdate?.(currentTime / totalDuration)\n\n    // Check for completion\n    if ((isReversed && currentTime <= 0) || (!isReversed && currentTime >= totalDuration)) {\n      if (repeat === -1 || repeatCount < repeat) {\n        repeatCount++\n        onRepeat?.(repeatCount)\n\n        if (yoyo) {\n          isReversed = !isReversed\n        } else {\n          currentTime = 0\n          segments.forEach(s => {\n            s.isActive = false\n            s.isComplete = false\n          })\n        }\n\n        if (repeatDelay > 0) {\n          setTimeout(() => {\n            rafId = requestAnimationFrame(tick)\n          }, repeatDelay * 1000)\n          return\n        }\n      } else {\n        isPlaying = false\n        onComplete?.()\n        return\n      }\n    }\n\n    rafId = requestAnimationFrame(tick)\n  }\n\n  // ============ Public API ============\n\n  const timeline: Timeline = {\n    to(target, props, position) {\n      const startTime = parsePosition(position) + (props.delay || 0)\n      const duration = props.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const numericProps = extractNumericProps(props)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(numericProps).length > 0) {\n        const currentValues = getCurrentElementValues(element, numericProps)\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\n\n        segment.spring = createSpringGroup(currentValues, springConfig)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        // Set target values when segment becomes active\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(numericProps)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    from(target, props, position) {\n      const startTime = parsePosition(position) + (props.delay || 0)\n      const duration = props.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const numericProps = extractNumericProps(props)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(numericProps).length > 0) {\n        const targetValues = getCurrentElementValues(element, numericProps)\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\n\n        // Start from props, animate to current\n        segment.spring = createSpringGroup(numericProps, springConfig)\n        applyPropsToElement(element, numericProps)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(targetValues)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    fromTo(target, fromProps, toProps, position) {\n      const startTime = parsePosition(position) + (toProps.delay || 0)\n      const duration = toProps.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const fromNumeric = extractNumericProps(fromProps)\n      const toNumeric = extractNumericProps(toProps)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props: toProps,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(toNumeric).length > 0) {\n        const springConfig: SpringConfig = { ...defaults, ...toProps.spring }\n\n        segment.spring = createSpringGroup(fromNumeric, springConfig)\n        applyPropsToElement(element, fromNumeric)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(toNumeric)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    addLabel(label, position) {\n      const time = parsePosition(position)\n      labels.set(label, time)\n      return timeline\n    },\n\n    call(callback, position) {\n      const time = Math.floor(parsePosition(position) * 1000)\n      if (!callbacks.has(time)) {\n        callbacks.set(time, [])\n      }\n      callbacks.get(time)!.push(callback)\n      return timeline\n    },\n\n    set(target, props, position) {\n      const element = resolveTarget(target)\n      if (element) {\n        const time = parsePosition(position)\n        this.call(() => {\n          applyPropsToElement(element, extractNumericProps(props))\n        }, time)\n      }\n      return timeline\n    },\n\n    addPause(position, callback) {\n      const time = Math.floor(parsePosition(position) * 1000)\n      pauses.set(time, callback)\n      return timeline\n    },\n\n    play() {\n      if (!hasStarted) {\n        hasStarted = true\n        onStart?.()\n      }\n      isPlaying = true\n      isPaused = false\n      lastFrameTime = 0\n      rafId = requestAnimationFrame(tick)\n      return timeline\n    },\n\n    pause() {\n      isPaused = true\n      if (rafId) {\n        cancelAnimationFrame(rafId)\n        rafId = null\n      }\n      return timeline\n    },\n\n    resume() {\n      if (isPaused) {\n        isPaused = false\n        lastFrameTime = 0\n        rafId = requestAnimationFrame(tick)\n      }\n      return timeline\n    },\n\n    reverse() {\n      isReversed = !isReversed\n      return timeline\n    },\n\n    restart() {\n      currentTime = isReversed ? totalDuration : 0\n      repeatCount = 0\n      hasStarted = false\n      segments.forEach(s => {\n        s.isActive = false\n        s.isComplete = false\n      })\n      return this.play()\n    },\n\n    seek(position) {\n      if (typeof position === 'string') {\n        currentTime = labels.get(position) ?? 0\n      } else {\n        currentTime = clamp(position, 0, totalDuration)\n      }\n      return timeline\n    },\n\n    kill() {\n      isPlaying = false\n      if (rafId) {\n        cancelAnimationFrame(rafId)\n        rafId = null\n      }\n      segments.forEach(s => s.spring?.destroy())\n      segments.length = 0\n      labels.clear()\n      callbacks.clear()\n      pauses.clear()\n    },\n\n    time: () => currentTime,\n    duration: () => totalDuration,\n    progress: () => totalDuration > 0 ? currentTime / totalDuration : 0,\n    isPlaying: () => isPlaying && !isPaused,\n    isReversed: () => isReversed,\n\n    getById(id) {\n      return segments.find(s => s.id === id)\n    },\n  }\n\n  if (autoplay) {\n    timeline.play()\n  }\n\n  return timeline\n}\n\n/**\n * Create a simple tween (single animation)\n */\nexport function tween(\n  target: TimelineTarget,\n  props: TimelineProps\n): Timeline {\n  return createTimeline().to(target, props).play()\n}\n\n/**\n * Create a timeline that animates all targets simultaneously\n */\nexport function allTo(\n  targets: TimelineTarget[],\n  props: TimelineProps\n): Timeline {\n  const tl = createTimeline()\n  targets.forEach((target, i) => {\n    tl.to(target, props, i === 0 ? 0 : '<')\n  })\n  return tl.play()\n}\n","/**\n * SVG Morphing - Smooth path shape interpolation with spring physics\n *\n * Enables morphing between SVG paths with automatic path normalization\n * and spring-based animation.\n */\n\nimport { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { lerp, clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * SVG path command types\n */\ntype CommandType = 'M' | 'L' | 'C' | 'Q' | 'A' | 'Z' | 'H' | 'V' | 'S' | 'T'\n\n/**\n * Parsed path command\n */\ninterface PathCommand {\n  type: CommandType\n  values: number[]\n}\n\n/**\n * Normalized point with control points\n */\ninterface NormalizedPoint {\n  x: number\n  y: number\n  cp1x?: number\n  cp1y?: number\n  cp2x?: number\n  cp2y?: number\n}\n\n/**\n * Morph configuration\n */\nexport interface MorphConfig {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Number of samples for path normalization (higher = smoother) */\n  samples?: number\n  /** Callback on progress update */\n  onProgress?: (progress: number) => void\n  /** Callback when morph completes */\n  onComplete?: () => void\n}\n\n/**\n * Morph controller interface\n */\nexport interface MorphController {\n  /** Get current morphed path */\n  getPath(): string\n  /** Get current progress (0-1) */\n  getProgress(): number\n  /** Morph to a new path */\n  morphTo(path: string): void\n  /** Set progress directly (0-1) */\n  setProgress(progress: number): void\n  /** Subscribe to path changes */\n  subscribe(callback: (path: string) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Path Parsing ============\n\n/**\n * Parse SVG path string into commands\n */\nfunction parsePath(d: string): PathCommand[] {\n  const commands: PathCommand[] = []\n  const regex = /([MLCQAZHVST])([^MLCQAZHVST]*)/gi\n\n  // Use matchAll instead of regex.exec for safer iteration\n  const matches = d.matchAll(regex)\n\n  for (const matchItem of matches) {\n    const typeChar = matchItem[1]\n    const valuesStr = matchItem[2]\n    if (!typeChar || valuesStr === undefined) continue\n\n    const type = typeChar.toUpperCase() as CommandType\n    const values = valuesStr\n      .trim()\n      .split(/[\\s,]+/)\n      .filter(v => v !== '')\n      .map(parseFloat)\n      .filter(v => !isNaN(v))\n\n    commands.push({ type, values })\n  }\n\n  return commands\n}\n\n/**\n * Convert path commands to absolute coordinates\n */\nfunction toAbsolute(commands: PathCommand[]): PathCommand[] {\n  let currentX = 0\n  let currentY = 0\n  let startX = 0\n  let startY = 0\n\n  return commands.map(cmd => {\n    const { type, values } = cmd\n    const absValues = [...values]\n\n    switch (type) {\n      case 'M':\n        currentX = values[0] ?? 0\n        currentY = values[1] ?? 0\n        startX = currentX\n        startY = currentY\n        break\n\n      case 'L':\n        currentX = values[0] ?? 0\n        currentY = values[1] ?? 0\n        break\n\n      case 'H':\n        absValues[0] = values[0] ?? 0\n        currentX = values[0] ?? 0\n        break\n\n      case 'V':\n        absValues[0] = values[0] ?? 0\n        currentY = values[0] ?? 0\n        break\n\n      case 'C':\n        currentX = values[4] ?? 0\n        currentY = values[5] ?? 0\n        break\n\n      case 'Q':\n        currentX = values[2] ?? 0\n        currentY = values[3] ?? 0\n        break\n\n      case 'A':\n        currentX = values[5] ?? 0\n        currentY = values[6] ?? 0\n        break\n\n      case 'Z':\n        currentX = startX\n        currentY = startY\n        break\n    }\n\n    return { type, values: absValues }\n  })\n}\n\n/**\n * Sample points along a path at regular intervals\n */\nfunction samplePath(commands: PathCommand[], samples: number): NormalizedPoint[] {\n  const points: NormalizedPoint[] = []\n\n  // Check if we're in browser\n  if (typeof document === 'undefined') {\n    // Server-side fallback - simple linear sampling\n    for (const cmd of commands) {\n      if (cmd.type === 'M' || cmd.type === 'L') {\n        points.push({ x: cmd.values[0] ?? 0, y: cmd.values[1] ?? 0 })\n      } else if (cmd.type === 'C') {\n        points.push({\n          x: cmd.values[4] ?? 0,\n          y: cmd.values[5] ?? 0,\n          cp1x: cmd.values[0] ?? 0,\n          cp1y: cmd.values[1] ?? 0,\n          cp2x: cmd.values[2] ?? 0,\n          cp2y: cmd.values[3] ?? 0,\n        })\n      }\n    }\n    return points\n  }\n\n  const svgNS = 'http://www.w3.org/2000/svg'\n  const svg = document.createElementNS(svgNS, 'svg')\n  const path = document.createElementNS(svgNS, 'path')\n\n  // Build path string\n  let d = ''\n  for (const cmd of commands) {\n    d += cmd.type + cmd.values.join(' ')\n  }\n  path.setAttribute('d', d)\n  svg.appendChild(path)\n  document.body.appendChild(svg)\n\n  try {\n    const totalLength = path.getTotalLength()\n    const step = totalLength / (samples - 1)\n\n    for (let i = 0; i < samples; i++) {\n      const point = path.getPointAtLength(i * step)\n      points.push({ x: point.x, y: point.y })\n    }\n  } finally {\n    document.body.removeChild(svg)\n  }\n\n  return points\n}\n\n/**\n * Interpolate between two points\n */\nfunction interpolatePoint(p1: NormalizedPoint, p2: NormalizedPoint, t: number): NormalizedPoint {\n  return {\n    x: lerp(p1.x, p2.x, t),\n    y: lerp(p1.y, p2.y, t),\n  }\n}\n\n/**\n * Convert normalized points back to path string\n */\nfunction pointsToPath(points: NormalizedPoint[]): string {\n  if (points.length === 0) return ''\n\n  const firstPoint = points[0]!\n  let d = `M ${firstPoint.x} ${firstPoint.y}`\n\n  for (let i = 1; i < points.length; i++) {\n    const point = points[i]!\n    d += ` L ${point.x} ${point.y}`\n  }\n\n  return d\n}\n\n// ============ Morph Implementation ============\n\n/**\n * Create SVG path morph controller\n *\n * @example\n * ```ts\n * const morph = createMorph(circlePath, {\n *   spring: { stiffness: 120, damping: 14 },\n *   onProgress: (p) => console.log('Progress:', p),\n * })\n *\n * morph.subscribe((path) => {\n *   element.setAttribute('d', path)\n * })\n *\n * morph.morphTo(starPath)\n * ```\n */\nexport function createMorph(\n  initialPath: string,\n  config: MorphConfig = {}\n): MorphController {\n  const {\n    spring: springConfig = { stiffness: 120, damping: 14 },\n    samples = 100,\n    onProgress,\n    onComplete,\n  } = config\n\n  let currentPath = initialPath\n  let fromPoints: NormalizedPoint[] = []\n  let toPoints: NormalizedPoint[] = []\n  let currentPoints: NormalizedPoint[] = []\n\n  const subscribers = new Set<(path: string) => void>()\n\n  // Parse initial path\n  const initialCommands = parsePath(initialPath)\n  fromPoints = samplePath(toAbsolute(initialCommands), samples)\n  currentPoints = [...fromPoints]\n  toPoints = [...fromPoints]\n\n  // Create spring for progress\n  const progressSpring = createSpringValue(0, springConfig)\n\n  progressSpring.subscribe(() => {\n    const progress = progressSpring.get()\n    onProgress?.(progress)\n\n    // Interpolate points\n    currentPoints = fromPoints.map((from, i) =>\n      interpolatePoint(from, toPoints[i] ?? from, progress)\n    )\n\n    currentPath = pointsToPath(currentPoints)\n    subscribers.forEach(cb => cb(currentPath))\n\n    if (progress >= 0.999) {\n      onComplete?.()\n    }\n  })\n\n  return {\n    getPath: () => currentPath,\n    getProgress: () => progressSpring.get(),\n\n    morphTo(path: string) {\n      // Normalize paths\n      const targetCommands = parsePath(path)\n      const targetPoints = samplePath(toAbsolute(targetCommands), samples)\n\n      fromPoints = [...currentPoints]\n      toPoints = targetPoints\n\n      // Ensure same number of points\n      while (fromPoints.length < toPoints.length) {\n        fromPoints.push(fromPoints[fromPoints.length - 1] || { x: 0, y: 0 })\n      }\n      while (toPoints.length < fromPoints.length) {\n        toPoints.push(toPoints[toPoints.length - 1] || { x: 0, y: 0 })\n      }\n\n      // Reset and animate\n      progressSpring.jump(0)\n      progressSpring.set(1)\n    },\n\n    setProgress(progress: number) {\n      const p = clamp(progress, 0, 1)\n      progressSpring.jump(p)\n\n      currentPoints = fromPoints.map((from, i) =>\n        interpolatePoint(from, toPoints[i] ?? from, p)\n      )\n\n      currentPath = pointsToPath(currentPoints)\n      subscribers.forEach(cb => cb(currentPath))\n    },\n\n    subscribe(callback) {\n      subscribers.add(callback)\n      callback(currentPath)\n      return () => subscribers.delete(callback)\n    },\n\n    destroy() {\n      progressSpring.destroy()\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Create a morph between multiple paths (morphing sequence)\n *\n * @example\n * ```ts\n * const sequence = createMorphSequence([\n *   circlePath,\n *   squarePath,\n *   starPath,\n * ])\n *\n * sequence.subscribe((path) => {\n *   element.setAttribute('d', path)\n * })\n *\n * sequence.morphToIndex(2) // Morph to star\n * ```\n */\nexport function createMorphSequence(\n  paths: string[],\n  config: MorphConfig = {}\n): {\n  getPath(): string\n  getCurrentIndex(): number\n  morphToIndex(index: number): void\n  morphToNext(): void\n  morphToPrevious(): void\n  subscribe(callback: (path: string) => void): () => void\n  destroy(): void\n} {\n  if (paths.length === 0) {\n    throw new Error('At least one path is required')\n  }\n\n  let currentIndex = 0\n  const firstPath = paths[0]!\n  const morph = createMorph(firstPath, config)\n\n  return {\n    getPath: () => morph.getPath(),\n    getCurrentIndex: () => currentIndex,\n\n    morphToIndex(index: number) {\n      const targetIndex = clamp(index, 0, paths.length - 1)\n      if (targetIndex !== currentIndex) {\n        currentIndex = targetIndex\n        const targetPath = paths[targetIndex]!\n        morph.morphTo(targetPath)\n      }\n    },\n\n    morphToNext() {\n      this.morphToIndex((currentIndex + 1) % paths.length)\n    },\n\n    morphToPrevious() {\n      this.morphToIndex((currentIndex - 1 + paths.length) % paths.length)\n    },\n\n    subscribe: (callback) => morph.subscribe(callback),\n    destroy: () => morph.destroy(),\n  }\n}\n\n// ============ Preset Shapes ============\n\n/**\n * Generate common SVG shape paths\n */\nexport const shapes = {\n  /**\n   * Generate circle path\n   */\n  circle(cx: number, cy: number, r: number): string {\n    return `M ${cx - r} ${cy}\n            A ${r} ${r} 0 1 1 ${cx + r} ${cy}\n            A ${r} ${r} 0 1 1 ${cx - r} ${cy}`\n  },\n\n  /**\n   * Generate rectangle path\n   */\n  rect(x: number, y: number, width: number, height: number, rx = 0): string {\n    if (rx === 0) {\n      return `M ${x} ${y}\n              L ${x + width} ${y}\n              L ${x + width} ${y + height}\n              L ${x} ${y + height}\n              Z`\n    }\n\n    return `M ${x + rx} ${y}\n            L ${x + width - rx} ${y}\n            Q ${x + width} ${y} ${x + width} ${y + rx}\n            L ${x + width} ${y + height - rx}\n            Q ${x + width} ${y + height} ${x + width - rx} ${y + height}\n            L ${x + rx} ${y + height}\n            Q ${x} ${y + height} ${x} ${y + height - rx}\n            L ${x} ${y + rx}\n            Q ${x} ${y} ${x + rx} ${y}\n            Z`\n  },\n\n  /**\n   * Generate polygon path\n   */\n  polygon(cx: number, cy: number, r: number, sides: number): string {\n    const points: string[] = []\n\n    for (let i = 0; i < sides; i++) {\n      const angle = (i / sides) * Math.PI * 2 - Math.PI / 2\n      const x = cx + r * Math.cos(angle)\n      const y = cy + r * Math.sin(angle)\n      points.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\n    }\n\n    return points.join(' ') + ' Z'\n  },\n\n  /**\n   * Generate star path\n   */\n  star(cx: number, cy: number, outerR: number, innerR: number, points: number): string {\n    const path: string[] = []\n    const step = Math.PI / points\n\n    for (let i = 0; i < points * 2; i++) {\n      const r = i % 2 === 0 ? outerR : innerR\n      const angle = i * step - Math.PI / 2\n      const x = cx + r * Math.cos(angle)\n      const y = cy + r * Math.sin(angle)\n      path.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\n    }\n\n    return path.join(' ') + ' Z'\n  },\n\n  /**\n   * Generate heart path\n   */\n  heart(cx: number, cy: number, size: number): string {\n    const d = size / 4\n    return `M ${cx} ${cy + d}\n            C ${cx} ${cy} ${cx - 2 * d} ${cy} ${cx - 2 * d} ${cy - d}\n            C ${cx - 2 * d} ${cy - 2 * d} ${cx} ${cy - 2 * d} ${cx} ${cy - d}\n            C ${cx} ${cy - 2 * d} ${cx + 2 * d} ${cy - 2 * d} ${cx + 2 * d} ${cy - d}\n            C ${cx + 2 * d} ${cy} ${cx} ${cy} ${cx} ${cy + d}\n            Z`\n  },\n\n  /**\n   * Generate arrow path\n   */\n  arrow(x: number, y: number, width: number, height: number, direction: 'up' | 'down' | 'left' | 'right' = 'right'): string {\n    const hw = width / 2\n    const hh = height / 2\n\n    switch (direction) {\n      case 'right':\n        return `M ${x} ${y - hh} L ${x + width} ${y} L ${x} ${y + hh} Z`\n      case 'left':\n        return `M ${x + width} ${y - hh} L ${x} ${y} L ${x + width} ${y + hh} Z`\n      case 'up':\n        return `M ${x - hw} ${y + height} L ${x} ${y} L ${x + hw} ${y + height} Z`\n      case 'down':\n        return `M ${x - hw} ${y} L ${x} ${y + height} L ${x + hw} ${y} Z`\n    }\n  },\n}\n","/**\n * Shared Layout Animations - Cross-component FLIP animations with layoutId\n *\n * Enables smooth transitions between components that share the same layoutId,\n * similar to Framer Motion's layout animations.\n */\n\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\nimport type { SpringConfig } from '../core/config.js'\n\n// ============ Types ============\n\n/**\n * Element measurement for FLIP\n */\nexport interface LayoutMeasurement {\n  x: number\n  y: number\n  width: number\n  height: number\n  opacity?: number\n  borderRadius?: number\n  scaleX?: number\n  scaleY?: number\n}\n\n/**\n * Shared layout element info\n */\ninterface SharedLayoutElement {\n  id: string\n  element: HTMLElement\n  measurement: LayoutMeasurement\n  spring: SpringGroup<Record<string, number>> | null\n  isAnimating: boolean\n}\n\n/**\n * Layout animation configuration\n */\nexport interface LayoutAnimationConfig {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Duration hint for spring (optional) */\n  duration?: number\n  /** Callback when animation starts */\n  onAnimationStart?: (id: string) => void\n  /** Callback when animation completes */\n  onAnimationComplete?: (id: string) => void\n  /** Enable crossfade during transition */\n  crossfade?: boolean\n  /** Custom transition properties */\n  transition?: {\n    x?: SpringConfig\n    y?: SpringConfig\n    width?: SpringConfig\n    height?: SpringConfig\n    opacity?: SpringConfig\n    borderRadius?: SpringConfig\n  }\n}\n\n/**\n * Layout group for managing shared elements\n */\nexport interface LayoutGroup {\n  /** Register element with layoutId */\n  register(id: string, element: HTMLElement): void\n  /** Unregister element */\n  unregister(id: string, element: HTMLElement): void\n  /** Update layout (call after DOM changes) */\n  update(): void\n  /** Force re-measure all elements */\n  forceUpdate(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Shared layout context for cross-component animations\n */\nexport interface SharedLayoutContext {\n  /** Register a layout group */\n  createGroup(id?: string): LayoutGroup\n  /** Get group by id */\n  getGroup(id: string): LayoutGroup | undefined\n  /** Update all groups */\n  updateAll(): void\n  /** Destroy all groups */\n  destroy(): void\n}\n\n// ============ Measurement Utilities ============\n\n/**\n * Measure element position and size\n */\nfunction measureElement(element: HTMLElement): LayoutMeasurement {\n  const rect = element.getBoundingClientRect()\n  const styles = getComputedStyle(element)\n\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n    opacity: parseFloat(styles.opacity) || 1,\n    borderRadius: parseFloat(styles.borderRadius) || 0,\n    scaleX: 1,\n    scaleY: 1,\n  }\n}\n\n/**\n * Apply FLIP transform to element\n */\nfunction applyTransform(\n  element: HTMLElement,\n  from: LayoutMeasurement,\n  to: LayoutMeasurement,\n  current: Record<string, number>\n): void {\n  // Calculate deltas\n  const dx = current.x !== undefined ? from.x - to.x + (current.x - from.x) : 0\n  const dy = current.y !== undefined ? from.y - to.y + (current.y - from.y) : 0\n  const scaleX = current.width !== undefined ? current.width / to.width : 1\n  const scaleY = current.height !== undefined ? current.height / to.height : 1\n\n  // Apply transform\n  element.style.transform = `translate(${dx}px, ${dy}px) scale(${scaleX}, ${scaleY})`\n  element.style.transformOrigin = 'top left'\n\n  // Apply opacity if transitioning\n  if (current.opacity !== undefined) {\n    element.style.opacity = String(current.opacity)\n  }\n\n  // Apply border radius (scale-compensated)\n  if (current.borderRadius !== undefined) {\n    const compensatedRadius = current.borderRadius / Math.max(scaleX, scaleY)\n    element.style.borderRadius = `${compensatedRadius}px`\n  }\n}\n\n/**\n * Reset element transform\n */\nfunction resetTransform(element: HTMLElement): void {\n  element.style.transform = ''\n  element.style.transformOrigin = ''\n  element.style.opacity = ''\n  element.style.borderRadius = ''\n}\n\n// ============ Layout Group Implementation ============\n\n/**\n * Create a layout group for managing shared layout elements\n *\n * @example\n * ```ts\n * const group = createLayoutGroup({\n *   spring: { stiffness: 300, damping: 30 },\n * })\n *\n * // Register elements with same layoutId\n * group.register('card-1', cardElement)\n *\n * // After DOM changes\n * group.update()\n * ```\n */\nexport function createLayoutGroup(config: LayoutAnimationConfig = {}): LayoutGroup {\n  const {\n    spring: defaultSpring = { stiffness: 300, damping: 30 },\n    onAnimationStart,\n    onAnimationComplete,\n    crossfade = false,\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    transition: _transition = {},\n  } = config\n\n  const elements = new Map<string, SharedLayoutElement[]>()\n  const previousMeasurements = new Map<string, LayoutMeasurement>()\n\n  const register = (id: string, element: HTMLElement): void => {\n    if (!elements.has(id)) {\n      elements.set(id, [])\n    }\n\n    const existing = elements.get(id)!\n    const alreadyRegistered = existing.some(e => e.element === element)\n\n    if (!alreadyRegistered) {\n      const measurement = measureElement(element)\n      existing.push({\n        id,\n        element,\n        measurement,\n        spring: null,\n        isAnimating: false,\n      })\n\n      // Store measurement for future animations\n      if (!previousMeasurements.has(id)) {\n        previousMeasurements.set(id, measurement)\n      }\n    }\n  }\n\n  const unregister = (id: string, element: HTMLElement): void => {\n    const group = elements.get(id)\n    if (!group) return\n\n    const index = group.findIndex(e => e.element === element)\n    if (index !== -1) {\n      const entry = group[index]!\n\n      // Store final measurement before removal\n      previousMeasurements.set(id, measureElement(element))\n\n      // Cleanup spring\n      entry.spring?.destroy()\n      group.splice(index, 1)\n\n      if (group.length === 0) {\n        elements.delete(id)\n      }\n    }\n  }\n\n  const animateElement = (\n    entry: SharedLayoutElement,\n    from: LayoutMeasurement,\n    to: LayoutMeasurement\n  ): void => {\n    // Cleanup previous animation\n    entry.spring?.destroy()\n\n    // Create spring with initial values\n    const initialValues: Record<string, number> = {\n      x: from.x,\n      y: from.y,\n      width: from.width,\n      height: from.height,\n    }\n\n    if (crossfade) {\n      initialValues.opacity = from.opacity ?? 1\n    }\n\n    if (from.borderRadius !== undefined) {\n      initialValues.borderRadius = from.borderRadius\n    }\n\n    entry.spring = createSpringGroup(initialValues, defaultSpring)\n    entry.isAnimating = true\n\n    onAnimationStart?.(entry.id)\n\n    entry.spring.subscribe((values: Record<string, number>) => {\n      applyTransform(entry.element, from, to, values)\n    })\n\n    // Set target values\n    const targetValues: Record<string, number> = {\n      x: to.x,\n      y: to.y,\n      width: to.width,\n      height: to.height,\n    }\n\n    if (crossfade) {\n      targetValues.opacity = to.opacity ?? 1\n    }\n\n    if (to.borderRadius !== undefined) {\n      targetValues.borderRadius = to.borderRadius\n    }\n\n    entry.spring.set(targetValues)\n\n    // Check for animation completion\n    const checkComplete = () => {\n      if (entry.spring && !entry.spring.isAnimating()) {\n        entry.isAnimating = false\n        resetTransform(entry.element)\n        onAnimationComplete?.(entry.id)\n      } else if (entry.isAnimating) {\n        requestAnimationFrame(checkComplete)\n      }\n    }\n\n    requestAnimationFrame(checkComplete)\n  }\n\n  const update = (): void => {\n    for (const [id, group] of elements) {\n      for (const entry of group) {\n        const previousMeasurement = previousMeasurements.get(id)\n        const currentMeasurement = measureElement(entry.element)\n\n        // Check if position/size changed\n        if (previousMeasurement) {\n          const hasChanged =\n            previousMeasurement.x !== currentMeasurement.x ||\n            previousMeasurement.y !== currentMeasurement.y ||\n            previousMeasurement.width !== currentMeasurement.width ||\n            previousMeasurement.height !== currentMeasurement.height\n\n          if (hasChanged) {\n            animateElement(entry, previousMeasurement, currentMeasurement)\n          }\n        }\n\n        // Update stored measurement\n        entry.measurement = currentMeasurement\n        previousMeasurements.set(id, currentMeasurement)\n      }\n    }\n  }\n\n  const forceUpdate = (): void => {\n    // Re-measure all elements\n    for (const [id, group] of elements) {\n      for (const entry of group) {\n        entry.measurement = measureElement(entry.element)\n        previousMeasurements.set(id, entry.measurement)\n      }\n    }\n  }\n\n  const destroy = (): void => {\n    for (const group of elements.values()) {\n      for (const entry of group) {\n        entry.spring?.destroy()\n        resetTransform(entry.element)\n      }\n    }\n    elements.clear()\n    previousMeasurements.clear()\n  }\n\n  return {\n    register,\n    unregister,\n    update,\n    forceUpdate,\n    destroy,\n  }\n}\n\n// ============ Shared Layout Context ============\n\nlet groupIdCounter = 0\n\n/**\n * Create a shared layout context for managing multiple layout groups\n *\n * @example\n * ```ts\n * const context = createSharedLayoutContext()\n *\n * // Create groups for different animation contexts\n * const listGroup = context.createGroup('list')\n * const cardGroup = context.createGroup('cards')\n *\n * // Register elements\n * listGroup.register('item-1', element1)\n * cardGroup.register('card-1', element2)\n *\n * // After route change or DOM update\n * context.updateAll()\n * ```\n */\nexport function createSharedLayoutContext(): SharedLayoutContext {\n  const groups = new Map<string, LayoutGroup>()\n\n  return {\n    createGroup(id?: string) {\n      const groupId = id ?? `layout-group-${groupIdCounter++}`\n      const group = createLayoutGroup()\n      groups.set(groupId, group)\n      return group\n    },\n\n    getGroup(id: string) {\n      return groups.get(id)\n    },\n\n    updateAll() {\n      for (const group of groups.values()) {\n        group.update()\n      }\n    },\n\n    destroy() {\n      for (const group of groups.values()) {\n        group.destroy()\n      }\n      groups.clear()\n    },\n  }\n}\n\n// ============ Auto Layout Observer ============\n\n/**\n * Configuration for auto layout observer\n */\nexport interface AutoLayoutConfig extends LayoutAnimationConfig {\n  /** Root element to observe (default: document.body) */\n  root?: HTMLElement\n  /** Attribute name for layout ID (default: 'data-layout-id') */\n  attribute?: string\n  /** Debounce time for mutations (ms) */\n  debounce?: number\n}\n\n/**\n * Create auto layout observer that automatically animates\n * elements with layoutId attribute\n *\n * @example\n * ```html\n * <div data-layout-id=\"card-1\">Content</div>\n * ```\n *\n * ```ts\n * const observer = createAutoLayout({\n *   spring: { stiffness: 200, damping: 20 },\n * })\n *\n * // Elements with data-layout-id will automatically animate\n * // when their position changes\n *\n * observer.destroy() // Cleanup when done\n * ```\n */\nexport function createAutoLayout(config: AutoLayoutConfig = {}): {\n  update(): void\n  forceUpdate(): void\n  destroy(): void\n} {\n  const {\n    root = typeof document !== 'undefined' ? document.body : null,\n    attribute = 'data-layout-id',\n    debounce: debounceTime = 0,\n    ...layoutConfig\n  } = config\n\n  if (!root) {\n    return {\n      update: () => {},\n      forceUpdate: () => {},\n      destroy: () => {},\n    }\n  }\n\n  const group = createLayoutGroup(layoutConfig)\n  let observer: MutationObserver | null = null\n  let resizeObserver: ResizeObserver | null = null\n  let debounceTimer: ReturnType<typeof setTimeout> | null = null\n\n  const scanAndRegister = () => {\n    const elements = root.querySelectorAll(`[${attribute}]`)\n    elements.forEach((el) => {\n      const id = el.getAttribute(attribute)\n      if (id && el instanceof HTMLElement) {\n        group.register(id, el)\n      }\n    })\n  }\n\n  const debouncedUpdate = () => {\n    if (debounceTimer) {\n      clearTimeout(debounceTimer)\n    }\n\n    if (debounceTime > 0) {\n      debounceTimer = setTimeout(() => {\n        scanAndRegister()\n        group.update()\n      }, debounceTime)\n    } else {\n      scanAndRegister()\n      group.update()\n    }\n  }\n\n  // Initial scan\n  scanAndRegister()\n\n  // Observe DOM changes\n  observer = new MutationObserver((mutations) => {\n    let shouldUpdate = false\n\n    for (const mutation of mutations) {\n      if (mutation.type === 'childList') {\n        // Check added nodes\n        mutation.addedNodes.forEach((node) => {\n          if (node instanceof HTMLElement) {\n            if (node.hasAttribute(attribute)) {\n              shouldUpdate = true\n            }\n            // Check descendants\n            if (node.querySelector(`[${attribute}]`)) {\n              shouldUpdate = true\n            }\n          }\n        })\n\n        // Check removed nodes\n        mutation.removedNodes.forEach((node) => {\n          if (node instanceof HTMLElement) {\n            const id = node.getAttribute(attribute)\n            if (id) {\n              group.unregister(id, node)\n            }\n          }\n        })\n      }\n\n      if (mutation.type === 'attributes' && mutation.attributeName === attribute) {\n        shouldUpdate = true\n      }\n    }\n\n    if (shouldUpdate) {\n      debouncedUpdate()\n    }\n  })\n\n  observer.observe(root, {\n    childList: true,\n    subtree: true,\n    attributes: true,\n    attributeFilter: [attribute],\n  })\n\n  // Observe resize changes\n  resizeObserver = new ResizeObserver(() => {\n    debouncedUpdate()\n  })\n\n  resizeObserver.observe(root)\n\n  return {\n    update: () => {\n      scanAndRegister()\n      group.update()\n    },\n\n    forceUpdate: () => {\n      scanAndRegister()\n      group.forceUpdate()\n    },\n\n    destroy: () => {\n      if (debounceTimer) {\n        clearTimeout(debounceTimer)\n      }\n      observer?.disconnect()\n      resizeObserver?.disconnect()\n      group.destroy()\n    },\n  }\n}\n","/**\n * Enhanced Stagger Patterns - Advanced staggering for complex animations\n *\n * Provides grid, spiral, wave, and custom stagger patterns for\n * sophisticated animation orchestration.\n */\n\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Stagger pattern configuration\n */\nexport interface StaggerPatternConfig {\n  /** Total number of items */\n  count: number\n  /** Base delay between items (seconds) */\n  delay?: number\n  /** Easing function for delay distribution */\n  easing?: (t: number) => number\n}\n\n/**\n * Grid stagger configuration\n */\nexport interface GridStaggerConfig extends StaggerPatternConfig {\n  /** Number of columns */\n  columns: number\n  /** Grid origin for stagger direction */\n  origin?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right' | 'center'\n  /** Direction of stagger flow */\n  direction?: 'row' | 'column' | 'diagonal' | 'radial'\n}\n\n/**\n * Wave stagger configuration\n */\nexport interface WaveStaggerConfig extends StaggerPatternConfig {\n  /** Wave direction */\n  direction?: 'horizontal' | 'vertical' | 'diagonal'\n  /** Wave frequency (number of waves) */\n  frequency?: number\n  /** Wave amplitude (affects delay variation) */\n  amplitude?: number\n}\n\n/**\n * Spiral stagger configuration\n */\nexport interface SpiralStaggerConfig extends StaggerPatternConfig {\n  /** Number of columns for grid layout */\n  columns: number\n  /** Spiral direction */\n  direction?: 'clockwise' | 'counter-clockwise'\n  /** Start from center or edge */\n  startFrom?: 'center' | 'edge'\n}\n\n/**\n * Random stagger configuration\n */\nexport interface RandomStaggerConfig extends StaggerPatternConfig {\n  /** Seed for reproducible randomness */\n  seed?: number\n  /** Minimum delay multiplier */\n  minMultiplier?: number\n  /** Maximum delay multiplier */\n  maxMultiplier?: number\n}\n\n/**\n * Custom stagger function\n */\nexport type CustomStaggerFn = (index: number, total: number) => number\n\n// ============ Utility Functions ============\n\n/**\n * Seeded random number generator for reproducible results\n */\nfunction seededRandom(seed: number): () => number {\n  let state = seed\n  return () => {\n    state = (state * 1103515245 + 12345) & 0x7fffffff\n    return state / 0x7fffffff\n  }\n}\n\n/**\n * Calculate distance from origin in a grid\n */\nfunction gridDistance(\n  index: number,\n  columns: number,\n  rows: number,\n  origin: GridStaggerConfig['origin']\n): number {\n  const col = index % columns\n  const row = Math.floor(index / columns)\n\n  let originCol: number\n  let originRow: number\n\n  switch (origin) {\n    case 'top-left':\n      originCol = 0\n      originRow = 0\n      break\n    case 'top-right':\n      originCol = columns - 1\n      originRow = 0\n      break\n    case 'bottom-left':\n      originCol = 0\n      originRow = rows - 1\n      break\n    case 'bottom-right':\n      originCol = columns - 1\n      originRow = rows - 1\n      break\n    case 'center':\n    default:\n      originCol = (columns - 1) / 2\n      originRow = (rows - 1) / 2\n      break\n  }\n\n  const dx = col - originCol\n  const dy = row - originRow\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\n// ============ Stagger Pattern Functions ============\n\n/**\n * Create linear stagger delays\n *\n * @example\n * ```ts\n * const delays = linearStagger({ count: 10, delay: 0.1 })\n * // [0, 0.1, 0.2, 0.3, ...]\n * ```\n */\nexport function linearStagger(config: StaggerPatternConfig): number[] {\n  const { count, delay = 0.1, easing = (t) => t } = config\n  const delays: number[] = []\n\n  for (let i = 0; i < count; i++) {\n    const t = count > 1 ? i / (count - 1) : 0\n    delays.push(easing(t) * delay * (count - 1))\n  }\n\n  return delays\n}\n\n/**\n * Create reverse stagger delays (last to first)\n */\nexport function reverseStagger(config: StaggerPatternConfig): number[] {\n  return linearStagger(config).reverse()\n}\n\n/**\n * Create center-out stagger delays\n *\n * @example\n * ```ts\n * const delays = centerStagger({ count: 5, delay: 0.1 })\n * // Center items animate first, edges last\n * ```\n */\nexport function centerStagger(config: StaggerPatternConfig): number[] {\n  const { count, delay = 0.1, easing = (t) => t } = config\n  const delays: number[] = []\n  const center = (count - 1) / 2\n\n  for (let i = 0; i < count; i++) {\n    const distanceFromCenter = Math.abs(i - center)\n    const maxDistance = center\n    const t = maxDistance > 0 ? distanceFromCenter / maxDistance : 0\n    delays.push(easing(t) * delay * maxDistance)\n  }\n\n  return delays\n}\n\n/**\n * Create edge-in stagger delays (edges first, center last)\n */\nexport function edgeStagger(config: StaggerPatternConfig): number[] {\n  const { count, delay = 0.1, easing = (t) => t } = config\n  const delays: number[] = []\n  const center = (count - 1) / 2\n  const maxDelay = delay * center\n\n  for (let i = 0; i < count; i++) {\n    const distanceFromCenter = Math.abs(i - center)\n    const maxDistance = center\n    const t = maxDistance > 0 ? 1 - distanceFromCenter / maxDistance : 0\n    delays.push(easing(t) * maxDelay)\n  }\n\n  return delays\n}\n\n/**\n * Create grid-based stagger delays\n *\n * @example\n * ```ts\n * const delays = gridStagger({\n *   count: 12,\n *   columns: 4,\n *   origin: 'center',\n *   direction: 'radial',\n *   delay: 0.05,\n * })\n * ```\n */\nexport function gridStagger(config: GridStaggerConfig): number[] {\n  const {\n    count,\n    columns,\n    origin = 'top-left',\n    direction = 'diagonal',\n    delay = 0.1,\n    easing = (t) => t,\n  } = config\n\n  const rows = Math.ceil(count / columns)\n  const delays: number[] = []\n\n  for (let i = 0; i < count; i++) {\n    const col = i % columns\n    const row = Math.floor(i / columns)\n\n    let t: number\n\n    switch (direction) {\n      case 'row':\n        // Row by row\n        t = row / Math.max(rows - 1, 1)\n        break\n\n      case 'column':\n        // Column by column\n        t = col / Math.max(columns - 1, 1)\n        break\n\n      case 'diagonal':\n        // Diagonal wave\n        t = (col + row) / (columns + rows - 2)\n        break\n\n      case 'radial':\n      default: {\n        // Distance from origin\n        const maxDistance = gridDistance(\n          origin === 'center' ? 0 : count - 1,\n          columns,\n          rows,\n          origin === 'center' ? 'top-left' : origin\n        )\n        const distance = gridDistance(i, columns, rows, origin)\n        t = maxDistance > 0 ? distance / maxDistance : 0\n        break\n      }\n    }\n\n    delays.push(easing(clamp(t, 0, 1)) * delay * Math.max(columns, rows))\n  }\n\n  return delays\n}\n\n/**\n * Create wave-based stagger delays\n *\n * @example\n * ```ts\n * const delays = waveStagger({\n *   count: 20,\n *   direction: 'horizontal',\n *   frequency: 2,\n *   amplitude: 0.5,\n *   delay: 0.1,\n * })\n * ```\n */\nexport function waveStagger(config: WaveStaggerConfig): number[] {\n  const {\n    count,\n    direction = 'horizontal',\n    frequency = 1,\n    amplitude = 0.5,\n    delay = 0.1,\n    easing = (t) => t,\n  } = config\n\n  const delays: number[] = []\n\n  for (let i = 0; i < count; i++) {\n    const t = count > 1 ? i / (count - 1) : 0\n\n    // Base linear delay\n    let d = t\n\n    // Add wave modulation\n    const waveOffset = Math.sin(t * Math.PI * 2 * frequency) * amplitude\n\n    // Apply wave based on direction\n    switch (direction) {\n      case 'horizontal':\n        d = t + waveOffset * 0.5\n        break\n      case 'vertical':\n        d = t + Math.abs(waveOffset)\n        break\n      case 'diagonal':\n        d = t + waveOffset\n        break\n    }\n\n    delays.push(easing(clamp(d, 0, 1.5)) * delay * (count - 1))\n  }\n\n  return delays\n}\n\n/**\n * Create spiral stagger delays for grid layouts\n *\n * @example\n * ```ts\n * const delays = spiralStagger({\n *   count: 16,\n *   columns: 4,\n *   direction: 'clockwise',\n *   startFrom: 'edge',\n *   delay: 0.1,\n * })\n * ```\n */\nexport function spiralStagger(config: SpiralStaggerConfig): number[] {\n  const {\n    count,\n    columns,\n    direction = 'clockwise',\n    startFrom = 'edge',\n    delay = 0.1,\n    easing = (t) => t,\n  } = config\n\n  const rows = Math.ceil(count / columns)\n  const spiral: number[] = []\n  const visited = new Set<string>()\n\n  let top = 0\n  let bottom = rows - 1\n  let left = 0\n  let right = columns - 1\n\n  // Generate spiral order\n  while (top <= bottom && left <= right) {\n    // Top row\n    for (let col = left; col <= right; col++) {\n      const idx = top * columns + col\n      if (idx < count && !visited.has(`${top},${col}`)) {\n        spiral.push(idx)\n        visited.add(`${top},${col}`)\n      }\n    }\n    top++\n\n    // Right column\n    for (let row = top; row <= bottom; row++) {\n      const idx = row * columns + right\n      if (idx < count && !visited.has(`${row},${right}`)) {\n        spiral.push(idx)\n        visited.add(`${row},${right}`)\n      }\n    }\n    right--\n\n    // Bottom row\n    if (top <= bottom) {\n      for (let col = right; col >= left; col--) {\n        const idx = bottom * columns + col\n        if (idx < count && !visited.has(`${bottom},${col}`)) {\n          spiral.push(idx)\n          visited.add(`${bottom},${col}`)\n        }\n      }\n      bottom--\n    }\n\n    // Left column\n    if (left <= right) {\n      for (let row = bottom; row >= top; row--) {\n        const idx = row * columns + left\n        if (idx < count && !visited.has(`${row},${left}`)) {\n          spiral.push(idx)\n          visited.add(`${row},${left}`)\n        }\n      }\n      left++\n    }\n  }\n\n  // Reverse for center start or counter-clockwise\n  if (startFrom === 'center') {\n    spiral.reverse()\n  }\n  if (direction === 'counter-clockwise') {\n    spiral.reverse()\n  }\n\n  // Create delay array\n  const delays = new Array(count).fill(0)\n  const maxDelay = delay * (spiral.length - 1)\n\n  spiral.forEach((originalIndex, spiralPosition) => {\n    const t = spiral.length > 1 ? spiralPosition / (spiral.length - 1) : 0\n    delays[originalIndex] = easing(t) * maxDelay\n  })\n\n  return delays\n}\n\n/**\n * Create random stagger delays\n *\n * @example\n * ```ts\n * const delays = randomStagger({\n *   count: 10,\n *   seed: 12345, // Reproducible\n *   delay: 0.1,\n *   minMultiplier: 0,\n *   maxMultiplier: 1,\n * })\n * ```\n */\nexport function randomStagger(config: RandomStaggerConfig): number[] {\n  const {\n    count,\n    seed = Date.now(),\n    delay = 0.1,\n    minMultiplier = 0,\n    maxMultiplier = 1,\n    easing = (t) => t,\n  } = config\n\n  const random = seededRandom(seed)\n  const delays: number[] = []\n  const maxDelay = delay * (count - 1)\n\n  for (let i = 0; i < count; i++) {\n    const r = random()\n    const multiplier = minMultiplier + r * (maxMultiplier - minMultiplier)\n    delays.push(easing(multiplier) * maxDelay)\n  }\n\n  return delays\n}\n\n/**\n * Create custom stagger delays using a function\n *\n * @example\n * ```ts\n * const delays = customStagger({\n *   count: 10,\n *   delay: 0.1,\n * }, (index, total) => {\n *   // Custom pattern: faster in middle\n *   const center = (total - 1) / 2\n *   return 1 - Math.abs(index - center) / center\n * })\n * ```\n */\nexport function customStagger(\n  config: StaggerPatternConfig,\n  fn: CustomStaggerFn\n): number[] {\n  const { count, delay = 0.1 } = config\n  const delays: number[] = []\n  const maxDelay = delay * (count - 1)\n\n  for (let i = 0; i < count; i++) {\n    const t = fn(i, count)\n    delays.push(clamp(t, 0, 1) * maxDelay)\n  }\n\n  return delays\n}\n\n// ============ Stagger Utilities ============\n\n/**\n * Apply stagger delays to animation options\n *\n * @example\n * ```ts\n * const items = document.querySelectorAll('.item')\n * const delays = gridStagger({ count: items.length, columns: 4 })\n *\n * items.forEach((item, i) => {\n *   spring(item, { opacity: 1 }, { delay: delays[i] })\n * })\n * ```\n */\nexport function applyStagger<T extends { delay?: number }>(\n  options: T[],\n  delays: number[]\n): T[] {\n  return options.map((opt, i) => ({\n    ...opt,\n    delay: (opt.delay ?? 0) + (delays[i] ?? 0),\n  }))\n}\n\n/**\n * Stagger pattern presets\n */\nexport const staggerPresets = {\n  /** Quick cascade from first to last */\n  cascade: (count: number) => linearStagger({ count, delay: 0.05 }),\n\n  /** Slow reveal from first to last */\n  reveal: (count: number) => linearStagger({ count, delay: 0.15 }),\n\n  /** Pop from center outward */\n  pop: (count: number) => centerStagger({ count, delay: 0.08 }),\n\n  /** Ripple from edges to center */\n  ripple: (count: number) => edgeStagger({ count, delay: 0.08 }),\n\n  /** Random scatter effect */\n  scatter: (count: number) => randomStagger({ count, delay: 0.1, seed: 42 }),\n\n  /** Grid diagonal wave */\n  gridWave: (count: number, columns: number) =>\n    gridStagger({ count, columns, direction: 'diagonal', delay: 0.05 }),\n\n  /** Grid radial from center */\n  gridRadial: (count: number, columns: number) =>\n    gridStagger({ count, columns, origin: 'center', direction: 'radial', delay: 0.05 }),\n\n  /** Spiral inward */\n  spiralIn: (count: number, columns: number) =>\n    spiralStagger({ count, columns, startFrom: 'edge', delay: 0.05 }),\n\n  /** Spiral outward */\n  spiralOut: (count: number, columns: number) =>\n    spiralStagger({ count, columns, startFrom: 'center', delay: 0.05 }),\n}\n","/**\n * MotionValue - High-performance animated value without React re-renders\n *\n * Unlike React state, MotionValue updates don't trigger component re-renders.\n * This makes it ideal for high-frequency animations like drag, scroll, and gestures.\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n *\n * // Subscribe to changes (no React re-render)\n * x.on('change', (value) => {\n *   element.style.transform = `translateX(${value}px)`\n * })\n *\n * // Update value\n * x.set(100)  // Triggers spring animation\n * x.jump(100) // Instant update, no animation\n * ```\n */\n\nimport { createSpringValue } from './spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\nexport type MotionValueSubscriber<T> = (value: T) => void\nexport type MotionValueEvent = 'change' | 'animationStart' | 'animationEnd' | 'animationComplete' | 'animationCancel'\n\nexport interface MotionValueOptions {\n  /** Spring configuration for animated transitions */\n  spring?: SpringConfig\n}\n\n/**\n * MotionValue class - Performant animated values\n *\n * Key advantages over React state:\n * - No re-renders on value change\n * - Direct DOM manipulation for 60fps animations\n * - Chainable with useTransform\n * - Memory efficient with automatic cleanup\n */\nexport class MotionValue<T = number> {\n  private _value: T\n  private _velocity: number = 0\n  private _subscribers: Set<MotionValueSubscriber<T>> = new Set()\n  private _eventListeners: Map<MotionValueEvent, Set<() => void>> = new Map()\n  private _springValue: ReturnType<typeof createSpringValue> | null = null\n  private _springConfig: SpringConfig\n  private _isAnimating: boolean = false\n  private _destroyed: boolean = false\n  private _checkEndRafId: number | null = null\n\n  constructor(initialValue: T, options: MotionValueOptions = {}) {\n    this._value = initialValue\n    this._springConfig = options.spring ?? { stiffness: 100, damping: 15 }\n\n    // Initialize spring for numeric values\n    if (typeof initialValue === 'number') {\n      this._springValue = createSpringValue(initialValue as number, {\n        ...this._springConfig,\n        onUpdate: (v: number) => {\n          if (this._destroyed) return\n          this._value = v as T\n          this._velocity = this._springValue?.getVelocity() ?? 0\n          this._notify()\n        },\n      })\n    }\n  }\n\n  /**\n   * Get current value synchronously\n   */\n  get(): T {\n    return this._value\n  }\n\n  /**\n   * Get current velocity (for numeric values)\n   */\n  getVelocity(): number {\n    return this._velocity\n  }\n\n  /**\n   * Check if currently animating\n   */\n  isAnimating(): boolean {\n    return this._isAnimating\n  }\n\n  /**\n   * Set value with spring animation\n   */\n  set(newValue: T, animate: boolean = true): void {\n    if (this._destroyed) return\n\n    // Cancel any pending animation end check to prevent memory leak\n    if (this._checkEndRafId !== null) {\n      cancelAnimationFrame(this._checkEndRafId)\n      this._checkEndRafId = null\n    }\n\n    if (typeof newValue === 'number' && this._springValue && animate) {\n      this._isAnimating = true\n      this._emit('animationStart')\n\n      this._springValue.set(newValue as number)\n\n      // Check for animation end with proper cleanup\n      const checkEnd = () => {\n        // Bail out if destroyed during animation\n        if (this._destroyed) {\n          this._checkEndRafId = null\n          return\n        }\n\n        if (this._springValue && Math.abs(this._springValue.getVelocity()) < 0.01) {\n          this._isAnimating = false\n          this._checkEndRafId = null\n          this._emit('animationEnd')\n        } else if (this._isAnimating) {\n          this._checkEndRafId = requestAnimationFrame(checkEnd)\n        } else {\n          this._checkEndRafId = null\n        }\n      }\n      this._checkEndRafId = requestAnimationFrame(checkEnd)\n    } else {\n      this._value = newValue\n      this._velocity = 0\n      this._notify()\n    }\n  }\n\n  /**\n   * Instantly set value without animation\n   */\n  jump(newValue: T): void {\n    if (this._destroyed) return\n\n    this._value = newValue\n    this._velocity = 0\n\n    if (typeof newValue === 'number' && this._springValue) {\n      this._springValue.jump(newValue as number)\n    }\n\n    this._isAnimating = false\n    this._notify()\n  }\n\n  /**\n   * Stop any running animation\n   */\n  stop(): void {\n    // Cancel pending RAF callback\n    if (this._checkEndRafId !== null) {\n      cancelAnimationFrame(this._checkEndRafId)\n      this._checkEndRafId = null\n    }\n\n    // SpringValue doesn't have stop(), so we jump to current value\n    if (this._springValue) {\n      this._springValue.jump(this._springValue.get())\n    }\n    this._isAnimating = false\n    this._emit('animationEnd')\n  }\n\n  /**\n   * Subscribe to value changes\n   * Returns unsubscribe function\n   */\n  subscribe(callback: MotionValueSubscriber<T>): () => void {\n    this._subscribers.add(callback)\n\n    // Immediately call with current value\n    callback(this._value)\n\n    return () => {\n      this._subscribers.delete(callback)\n    }\n  }\n\n  /**\n   * Add event listener\n   */\n  on(event: MotionValueEvent, callback: () => void): () => void {\n    if (!this._eventListeners.has(event)) {\n      this._eventListeners.set(event, new Set())\n    }\n    this._eventListeners.get(event)!.add(callback)\n\n    return () => {\n      this._eventListeners.get(event)?.delete(callback)\n    }\n  }\n\n  /**\n   * Update spring configuration\n   */\n  setConfig(config: Partial<SpringConfig>): void {\n    this._springConfig = { ...this._springConfig, ...config }\n    // Note: Config change takes effect on next animation\n  }\n\n  /**\n   * Destroy and cleanup\n   */\n  destroy(): void {\n    this._destroyed = true\n\n    // Cancel pending RAF callback to prevent memory leak\n    if (this._checkEndRafId !== null) {\n      cancelAnimationFrame(this._checkEndRafId)\n      this._checkEndRafId = null\n    }\n\n    this._subscribers.clear()\n    this._eventListeners.clear()\n\n    if (this._springValue) {\n      this._springValue.destroy()\n      this._springValue = null\n    }\n  }\n\n  private _notify(): void {\n    this._subscribers.forEach((callback) => {\n      try {\n        callback(this._value)\n      } catch (e) {\n        console.error('MotionValue subscriber error:', e)\n      }\n    })\n    this._emit('change')\n  }\n\n  private _emit(event: MotionValueEvent): void {\n    this._eventListeners.get(event)?.forEach((callback) => {\n      try {\n        callback()\n      } catch (e) {\n        console.error(`MotionValue ${event} listener error:`, e)\n      }\n    })\n  }\n}\n\n/**\n * Create a new MotionValue\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * const opacity = createMotionValue(1)\n * const scale = createMotionValue(1, { spring: { stiffness: 300, damping: 30 } })\n * ```\n */\nexport function createMotionValue<T = number>(\n  initialValue: T,\n  options?: MotionValueOptions\n): MotionValue<T> {\n  return new MotionValue(initialValue, options)\n}\n\n/**\n * Transform a MotionValue using a mapping function\n *\n * Creates a derived MotionValue that automatically updates\n * when the source value changes.\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * const opacity = transformValue(x, (v) => 1 - v / 100)\n * const inverted = transformValue(x, (v) => -v)\n * ```\n */\nexport function transformValue<T, U>(\n  source: MotionValue<T>,\n  transform: (value: T) => U\n): MotionValue<U> {\n  const derived = new MotionValue<U>(transform(source.get()))\n\n  // Store unsubscribe function for cleanup\n  const unsubscribe = source.subscribe((value) => {\n    derived.jump(transform(value))\n  })\n\n  // Override destroy to clean up subscription (prevents memory leak)\n  const originalDestroy = derived.destroy.bind(derived)\n  derived.destroy = () => {\n    unsubscribe()\n    originalDestroy()\n  }\n\n  return derived\n}\n\n/**\n * Map a MotionValue from one range to another\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * // Map 0-100 to 0-1\n * const progress = mapRange(x, [0, 100], [0, 1])\n * // Map with extrapolation clamped\n * const clamped = mapRange(x, [0, 100], [0, 1], { clamp: true })\n * ```\n */\nexport function mapRange(\n  source: MotionValue<number>,\n  inputRange: [number, number],\n  outputRange: [number, number],\n  options: { clamp?: boolean } = {}\n): MotionValue<number> {\n  const [inMin, inMax] = inputRange\n  const [outMin, outMax] = outputRange\n  const inputDelta = inMax - inMin\n\n  return transformValue(source, (value) => {\n    // Guard against division by zero\n    if (inputDelta === 0) {\n      return outMin\n    }\n\n    let normalized = (value - inMin) / inputDelta\n\n    if (options.clamp) {\n      normalized = Math.max(0, Math.min(1, normalized))\n    }\n\n    return outMin + normalized * (outMax - outMin)\n  })\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Options for path animation\n */\nexport interface PathAnimationOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to auto-play on creation */\n  autoPlay?: boolean\n  /** Callback for value updates */\n  onUpdate?: (value: number) => void\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Path animation controller\n */\nexport interface PathAnimation {\n  /** Start the animation from 0 to target */\n  play: (target?: number) => Promise<void>\n  /** Reverse the animation */\n  reverse: () => Promise<void>\n  /** Set path length directly (0-1) */\n  set: (value: number, animate?: boolean) => void\n  /** Get current path length */\n  get: () => number\n  /** Pause the animation */\n  pause: () => void\n  /** Resume the animation */\n  resume: () => void\n  /** Stop and reset */\n  reset: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n  /** Destroy and cleanup */\n  destroy: () => void\n}\n\n/**\n * Create a path length animation for SVG stroke drawing effects.\n * Animates stroke-dashoffset to reveal/hide a path.\n *\n * @example Basic path drawing\n * ```ts\n * const pathAnim = createPathAnimation(pathElement, {\n *   config: { stiffness: 100, damping: 15 },\n * })\n *\n * // Draw the path\n * await pathAnim.play()\n *\n * // Erase the path\n * await pathAnim.reverse()\n * ```\n *\n * @example With offset control\n * ```ts\n * const anim = createPathAnimation(path)\n *\n * // Draw 50% of the path\n * anim.set(0.5)\n *\n * // Draw full path with animation\n * anim.set(1, true)\n * ```\n */\nexport function createPathAnimation(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement,\n  options: PathAnimationOptions = {}\n): PathAnimation {\n  const {\n    config = {},\n    autoPlay = false,\n    onUpdate,\n    onComplete,\n  } = options\n\n  // Get total path length\n  const totalLength = element.getTotalLength?.() ?? 0\n\n  // Set initial stroke properties\n  element.style.strokeDasharray = String(totalLength)\n  element.style.strokeDashoffset = String(totalLength)\n\n  let currentValue = 0\n  let destroyed = false\n  const spring = createSpringValue(0, config)\n\n  // Subscribe to updates\n  const unsubscribe = spring.subscribe((value) => {\n    if (destroyed) return\n\n    currentValue = value\n    // Convert 0-1 to offset (1 = hidden, 0 = visible)\n    const offset = totalLength * (1 - value)\n    element.style.strokeDashoffset = String(offset)\n    onUpdate?.(value)\n  })\n\n  const waitForRest = (): Promise<void> => {\n    return new Promise((resolve) => {\n      const check = () => {\n        if (destroyed || !spring.isAnimating()) {\n          resolve()\n        } else {\n          requestAnimationFrame(check)\n        }\n      }\n      setTimeout(check, 16)\n    })\n  }\n\n  const animation: PathAnimation = {\n    play: async (target = 1) => {\n      if (destroyed) return\n      spring.set(target)\n      await waitForRest()\n      onComplete?.()\n    },\n\n    reverse: async () => {\n      if (destroyed) return\n      spring.set(0)\n      await waitForRest()\n      onComplete?.()\n    },\n\n    set: (value: number, animate = false) => {\n      if (destroyed) return\n\n      if (animate) {\n        spring.set(value)\n      } else {\n        spring.jump(value)\n        currentValue = value\n        const offset = totalLength * (1 - value)\n        element.style.strokeDashoffset = String(offset)\n      }\n    },\n\n    get: () => currentValue,\n\n    pause: () => {\n      if (destroyed) return\n      spring.stop()\n    },\n\n    resume: () => {\n      if (destroyed) return\n      // Resume by re-setting target\n      spring.set(currentValue)\n    },\n\n    reset: () => {\n      if (destroyed) return\n      spring.jump(0)\n      currentValue = 0\n      element.style.strokeDashoffset = String(totalLength)\n    },\n\n    isAnimating: () => spring.isAnimating(),\n\n    destroy: () => {\n      destroyed = true\n      unsubscribe()\n      spring.destroy()\n    },\n  }\n\n  if (autoPlay) {\n    animation.play()\n  }\n\n  return animation\n}\n\n/**\n * Get the total length of an SVG path element\n */\nexport function getPathLength(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement\n): number {\n  return element.getTotalLength?.() ?? 0\n}\n\n/**\n * Set up an element for path animation (sets dasharray and dashoffset)\n */\nexport function preparePathForAnimation(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement,\n  initialProgress = 0\n): void {\n  const length = element.getTotalLength?.() ?? 0\n  element.style.strokeDasharray = String(length)\n  element.style.strokeDashoffset = String(length * (1 - initialProgress))\n}\n\n/**\n * Calculate the point on a path at a given percentage\n */\nexport function getPointAtProgress(\n  path: SVGPathElement,\n  progress: number\n): DOMPoint | null {\n  try {\n    const length = path.getTotalLength()\n    return path.getPointAtLength(length * Math.max(0, Math.min(1, progress)))\n  } catch {\n    return null\n  }\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Measured box dimensions\n */\nexport interface MeasuredBox {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n/**\n * FLIP animation options\n */\nexport interface FlipOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to animate position */\n  position?: boolean\n  /** Whether to animate size */\n  size?: boolean\n  /** Callback when animation completes */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (progress: number) => void\n}\n\n/**\n * FLIP animation controller\n */\nexport interface FlipAnimation {\n  /** Play the FLIP animation */\n  play: () => Promise<void>\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Cancel the animation */\n  cancel: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n}\n\n/**\n * Measure the bounding box of an element\n */\nexport function measureElement(element: HTMLElement): MeasuredBox {\n  const rect = element.getBoundingClientRect()\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n  }\n}\n\n/**\n * Create a FLIP (First, Last, Invert, Play) animation.\n *\n * FLIP is a technique for animating layout changes performantly:\n * 1. First: Measure the element's initial position\n * 2. Last: Apply the change and measure final position\n * 3. Invert: Apply transforms to make it look like it's still in the first position\n * 4. Play: Animate the transforms to zero\n *\n * @example Basic FLIP\n * ```ts\n * // Measure first position\n * const first = measureElement(element)\n *\n * // Make layout change\n * element.classList.toggle('expanded')\n *\n * // Measure last position\n * const last = measureElement(element)\n *\n * // Create and play FLIP animation\n * const flip = createFlip(element, first, last)\n * await flip.play()\n * ```\n *\n * @example With options\n * ```ts\n * const flip = createFlip(element, first, last, {\n *   config: { stiffness: 300, damping: 30 },\n *   position: true,  // Animate position\n *   size: true,      // Animate size\n *   onComplete: () => console.log('Done!'),\n * })\n * ```\n */\nexport function createFlip(\n  element: HTMLElement,\n  first: MeasuredBox,\n  last: MeasuredBox,\n  options: FlipOptions = {}\n): FlipAnimation {\n  const {\n    config = {},\n    position = true,\n    size = true,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Calculate the inversion (how much to transform to get back to \"first\")\n  const deltaX = first.x - last.x\n  const deltaY = first.y - last.y\n  const deltaWidth = first.width / last.width\n  const deltaHeight = first.height / last.height\n\n  let progress = 0\n  let isPlaying = false\n  let cancelled = false\n\n  const spring = createSpringValue(0, config)\n\n  // Store original transform\n  const originalTransform = element.style.transform\n  const originalTransformOrigin = element.style.transformOrigin\n\n  // Set transform origin to top-left for size animations\n  if (size) {\n    element.style.transformOrigin = '0 0'\n  }\n\n  const applyTransform = (t: number) => {\n    progress = t\n    const invertedT = 1 - t\n\n    const transforms: string[] = []\n\n    if (position) {\n      transforms.push(`translate(${deltaX * invertedT}px, ${deltaY * invertedT}px)`)\n    }\n\n    if (size && (deltaWidth !== 1 || deltaHeight !== 1)) {\n      const scaleX = 1 + (deltaWidth - 1) * invertedT\n      const scaleY = 1 + (deltaHeight - 1) * invertedT\n      transforms.push(`scale(${scaleX}, ${scaleY})`)\n    }\n\n    element.style.transform = transforms.length > 0 ? transforms.join(' ') : ''\n    onUpdate?.(t)\n  }\n\n  // Apply initial inversion\n  applyTransform(0)\n\n  const cleanup = () => {\n    // Restore original styles\n    element.style.transform = originalTransform\n    element.style.transformOrigin = originalTransformOrigin\n  }\n\n  return {\n    play: async () => {\n      if (cancelled) return\n\n      isPlaying = true\n\n      return new Promise<void>((resolve) => {\n        const unsubscribe = spring.subscribe((value) => {\n          if (cancelled) {\n            unsubscribe()\n            resolve()\n            return\n          }\n          applyTransform(value)\n        })\n\n        spring.set(1)\n\n        // Wait for animation to complete\n        const checkComplete = () => {\n          if (cancelled) {\n            unsubscribe()\n            cleanup()\n            resolve()\n            return\n          }\n\n          if (!spring.isAnimating()) {\n            isPlaying = false\n            unsubscribe()\n            cleanup()\n            onComplete?.()\n            resolve()\n          } else {\n            requestAnimationFrame(checkComplete)\n          }\n        }\n\n        setTimeout(checkComplete, 16)\n      })\n    },\n\n    getProgress: () => progress,\n\n    cancel: () => {\n      cancelled = true\n      isPlaying = false\n      spring.stop()\n      cleanup()\n    },\n\n    isAnimating: () => isPlaying,\n  }\n}\n\n/**\n * Higher-level helper that handles the full FLIP flow.\n * Automatically measures before/after states.\n *\n * @example\n * ```ts\n * await flip(element, () => {\n *   element.classList.toggle('expanded')\n * }, { config: { stiffness: 200 } })\n * ```\n */\nexport async function flip(\n  element: HTMLElement,\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure initial state\n  const first = measureElement(element)\n\n  // Last: apply mutation and measure final state\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetHeight\n\n  const last = measureElement(element)\n\n  // Invert & Play\n  const animation = createFlip(element, first, last, options)\n  await animation.play()\n}\n\n/**\n * Batch FLIP animations for multiple elements.\n * Useful when multiple elements change position together.\n *\n * @example\n * ```ts\n * await flipBatch(\n *   [card1, card2, card3],\n *   () => container.classList.toggle('grid'),\n *   { config: { stiffness: 150 } }\n * )\n * ```\n */\nexport async function flipBatch(\n  elements: HTMLElement[],\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure all elements\n  const firstStates = elements.map((el) => measureElement(el))\n\n  // Last: apply mutation\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  document.body.offsetHeight\n\n  // Measure all final states and create animations\n  const animations = elements.map((element, i) => {\n    const last = measureElement(element)\n    return createFlip(element, firstStates[i]!, last, options)\n  })\n\n  // Play all animations\n  await Promise.all(animations.map((anim) => anim.play()))\n}\n"]}