{"version":3,"sources":["../src/core/config.ts","../src/core/physics.ts","../src/animation/loop.ts","../src/utils/math.ts","../src/utils/warnings.ts","../src/core/spring.ts","../src/core/spring-value.ts","../src/core/spring-group.ts","../src/core/variants.ts","../src/animation/sequence.ts","../src/animation/trail.ts","../src/animation/decay.ts","../src/animation/keyframes.ts","../src/animation/animate.ts","../src/interpolation/interpolate.ts","../src/interpolation/color.ts","../src/gesture/drag.ts","../src/gesture/scroll.ts","../src/gesture/advanced.ts","../src/utils/color.ts","../src/scroll/scroll-linked.ts","../src/animation/timeline.ts","../src/svg/morph.ts","../src/layout/shared.ts","../src/animation/stagger-patterns.ts","../src/core/MotionValue.ts","../src/svg/path.ts","../src/layout/flip.ts"],"names":["defaultConfig","springPresets","physicsPresets","getPhysicsPreset","name","createFeeling","feeling","adjustSpeed","preset","speed","stiffness","damping","adjustBounce","bounce","configFromDuration","ms","configFromBounce","simulateSpring","position","velocity","target","config","mass","restSpeed","restDelta","displacement","absDisplacement","absVelocity","dt","springForce","dampingForce","acceleration","newVelocity","newPosition","isRest","calculatePeriod","calculateDampingRatio","isUnderdamped","isCriticallyDamped","ratio","isOverdamped","AnimationState","AnimationLoop","id","cb","now","rawDelta","clampedDelta","listener","e","toRemove","ref","animation","i","existingId","callback","count","delta","globalLoop","clamp","value","min","max","actualMin","actualMax","lerp","a","b","t","mapRange","inMin","inMax","outMin","outMax","inputRange","degToRad","degrees","radToDeg","radians","isDev","warnedMessages","warnOnce","message","validateSpringConfig","validateDragConfig","rubberBandFactor","bounds","validateDecayConfig","deceleration","validateAnimationValue","context","clearWarnings","SpringAnimationImpl","from","to","resolve","temp","validTo","_now","result","spring","SpringValueImpl","initial","animationResolver","mergedConfig","originalOnUpdate","originalOnComplete","subscriber","createSpringValue","SpringGroupImpl","initialValues","key","springValue","values","promises","createSpringGroup","resolveVariant","variant","custom","resolved","transition","getVariant","variants","mergeVariants","merged","isTransformProperty","isAnimatable","parseValueWithUnit","match","buildTransformString","transforms","x","y","applyValuesToElement","element","transform","calculateStaggerDelays","options","staggerChildren","staggerDirection","delayChildren","delays","index","createOrchestration","parentAnim","childrenAnims","when","delay","parent","children","anim","variantPresets","createVariantPreset","animate","exit","isVariants","v","isVariant","sequence","animations","createAnimation","parallel","stagger","items","startIndex","indices","used","offset","left","right","getDelay","_i","timeoutIds","delayMs","timeoutId","TrailImpl","followDelay","springConfig","targetValue","delayFrames","targetFrame","_delayFrames","startFrame","framesToWait","s","unsubscribers","unsubscribe","createTrail","DecayAnimationImpl","rawDecel","decay","keyframes","times","onKeyframe","onComplete","onUpdate","normalizedKeyframes","keyframeCount","kf","currentIndex","isPlaying","isPaused","currentValue","destroyed","pendingRafId","pendingTimeoutId","createSpring","animateToNext","targetKf","checkComplete","parseKeyframeArray","isKeyframeArray","transformProperties","pxProperties","buildTransform","parts","z","scale","scaleX","scaleY","rotate","rotateX","rotateY","skewX","skewY","applyStylesToElement","el","transformValues","styleValues","property","prop","val","parseCurrentValue","computed","elementOrSelector","createNoopControls","springs","currentValues","isRunning","resolveFinished","rafIds","delayTimeoutId","finished","_reject","startAnimation","entries","completedCount","totalAnimations","startValue","valuesObj","numValue","checkDone","rafId","initialRafId","cleanup","totalProgress","animateAll","selector","animateOptions","elements","defaultInterpolateOptions","InterpolationImpl","source","input","output","extrapolate","extrapolateLeft","extrapolateRight","mode","denominator","specificMode","fallbackMode","interpolate","ColorInterpolationImpl","colorStrings","c","r","g","color","hexMatch","hex","rgbMatch","rgbaMatch","hslMatch","h","l","gray","hue2rgb","p","q","interpolateColor","colors","defaultDragConfig","DragSpringImpl","safeDt","instantVelocity","smoothingFactor","newX","newY","snapPoint","edge","dragElastic","axis","elasticFactor","snap","gridX","gridY","velocityMagnitude","threshold","nearestPoint","nearestDistance","point","dx","dy","distance","radius","constraints","parentRect","elementRect","padding","constraintRect","offsetX","offsetY","safeX","safeY","velocityX","velocityY","top","bottom","targetX","targetY","rawDecay","decayFactor","momentumX","momentumY","modified","createDragSpring","defaultScrollConfig","ScrollSpringImpl","container","deltaX","deltaY","maxScrollX","maxScrollY","checkEnd","containerRect","createScrollSpring","getDistance","p1","p2","getAngle","getCenter","rubberBand","factor","createPinchGesture","minScale","maxScale","enableRubberBand","onPinch","onPinchStart","onPinchEnd","enabled","active","initialDistance","initialScale","currentScale","lastScale","startTime","lastTime","touches","scaleSpring","createState","event","first","last","touchArray","origin","handleTouchStart","touch","handleTouchMove","currentDistance","newScale","handleTouchEnd","targetScale","createRotateGesture","initialEnabled","onRotate","onRotateStart","onRotateEnd","initialAngle","currentAngle","lastAngle","angleOffset","newAngle","angleDelta","createSwipeGesture","velocityThreshold","distanceThreshold","maxDuration","onSwipe","onSwipeStart","onSwipeEnd","startPoint","lastPoint","pointerId","direction","duration","movement","detectDirection","absX","absY","velX","velY","meetsDistanceX","meetsDistanceY","meetsVelocityX","meetsVelocityY","handlePointerDown","handlePointerMove","handlePointerUp","state","createLongPressGesture","movementTolerance","onLongPress","onPressStart","onPressEnd","triggered","timerId","createGestures","controllers","parseColor","hexToRgb","hslToRgb","rgbToHex","toHex","n","cleanHex","rgbToHsl","lerpColor","colorA","colorB","createScrollProgress","smooth","progress","smoothedProgress","lastScrollY","subscribers","calculateProgress","scrollY","windowHeight","newProgress","isInView","visibleRatio","rect","elementTop","elementHeight","endPoint","scrollStart","scrollEnd","documentHeight","notify","info","onScroll","initialInfo","createParallax","easing","rootMargin","observer","update","elementCenter","viewportCenter","normalizedDistance","entry","createScrollTrigger","start","end","startOffset","endOffset","onEnter","onLeave","onProgress","once","scrub","isActive","hasEntered","getPosition","pos","startPos","endPos","triggerStart","triggerEnd","startProgress","endProgress","rawProgress","wasActive","createScrollLinkedValue","scrollProgress","outputRange","shouldClamp","firstOutput","isColorOutput","firstInput","lastInput","segmentIndex","curr","next","segmentStart","segmentEnd","segmentProgress","endValue","scrollEasings","timelineIdCounter","createTimeline","defaults","autoplay","repeat","yoyo","repeatDelay","onStart","onRepeat","segments","labels","callbacks","pauses","currentTime","totalDuration","isReversed","repeatCount","repeatDelayTimeoutId","lastFrameTime","hasStarted","insertTime","parsePosition","lastSegment","labelMatch","labelName","labelTime","offsetValue","resolveTarget","extractNumericProps","props","applyPropsToElement","cssProps","getCurrentElementValues","current","MAX_DELTA_TIME","tick","timestamp","deltaTime","callbacksAtTime","pauseCallback","segment","shouldBeActive","timeline","endTime","numericProps","originalOnStart","targetValues","fromProps","toProps","fromNumeric","toNumeric","label","time","tween","allTo","targets","tl","parsePath","d","commands","regex","matches","matchItem","typeChar","valuesStr","type","toAbsolute","cmd","absValues","currentY","hasSvgPathSupport","svgNS","svg","path","hasSupport","works","samplePathFallback","samples","points","interpolated","step","frac","samplePath","interpolatePoint","pointsToPath","firstPoint","createMorph","initialPath","currentPath","fromPoints","toPoints","currentPoints","initialCommands","progressSpring","targetCommands","targetPoints","createMorphSequence","paths","firstPath","morph","targetIndex","targetPath","shapes","cx","cy","width","height","rx","sides","angle","outerR","innerR","size","hw","hh","measureElement","styles","applyTransform","compensatedRadius","resetTransform","createLayoutGroup","defaultSpring","onAnimationStart","onAnimationComplete","crossfade","_transition","previousMeasurements","register","existing","measurement","unregister","group","animateElement","previousMeasurement","currentMeasurement","groupIdCounter","createSharedLayoutContext","groups","groupId","createAutoLayout","root","attribute","debounceTime","layoutConfig","resizeObserver","debounceTimer","scanAndRegister","debouncedUpdate","mutations","shouldUpdate","mutation","node","seededRandom","seed","gridDistance","columns","rows","col","row","originCol","originRow","linearStagger","reverseStagger","centerStagger","center","distanceFromCenter","maxDistance","edgeStagger","maxDelay","gridStagger","waveStagger","frequency","amplitude","waveOffset","spiralStagger","startFrom","spiral","visited","idx","originalIndex","spiralPosition","randomStagger","minMultiplier","maxMultiplier","random","multiplier","customStagger","fn","applyStagger","opt","staggerPresets","MotionValue","initialValue","newValue","createMotionValue","transformValue","derived","originalDestroy","inputDelta","normalized","createPathAnimation","autoPlay","totalLength","waitForRest","check","getPathLength","preparePathForAnimation","initialProgress","length","getPointAtProgress","createFlip","deltaWidth","deltaHeight","cancelled","resolvePlay","originalTransform","originalTransformOrigin","invertedT","flip","mutate","flipBatch","firstStates"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\r\n * Spring configuration interface\r\n */\r\nexport interface SpringConfig {\r\n  /** Spring stiffness (default: 100) */\r\n  stiffness?: number\r\n  /** Damping ratio (default: 10) */\r\n  damping?: number\r\n  /** Mass (default: 1) */\r\n  mass?: number\r\n  /** Initial velocity */\r\n  velocity?: number\r\n  /** Speed threshold for considering spring at rest (default: 0.01) */\r\n  restSpeed?: number\r\n  /** Position threshold for considering spring at rest (default: 0.01) */\r\n  restDelta?: number\r\n  /** Clamp value to [from, to] range */\r\n  clamp?: boolean\r\n  /** Callback called on each update */\r\n  onUpdate?: (value: number) => void\r\n  /** Callback called when animation starts */\r\n  onStart?: () => void\r\n  /** Callback called when animation reaches target */\r\n  onComplete?: () => void\r\n  /** Callback called when spring is at rest */\r\n  onRest?: () => void\r\n}\r\n\r\n/**\r\n * Default spring configuration\r\n */\r\nexport const defaultConfig: SpringConfig = {\r\n  stiffness: 100,\r\n  damping: 10,\r\n  mass: 1,\r\n  velocity: 0,\r\n  restSpeed: 0.01,\r\n  restDelta: 0.01,\r\n  clamp: false,\r\n}\r\n\r\n/**\r\n * Spring presets interface\r\n */\r\nexport interface SpringPresets {\r\n  /** Default spring: { stiffness: 100, damping: 10 } */\r\n  default: SpringConfig\r\n  /** Gentle spring: { stiffness: 120, damping: 14 } */\r\n  gentle: SpringConfig\r\n  /** Wobbly spring: { stiffness: 180, damping: 12 } */\r\n  wobbly: SpringConfig\r\n  /** Stiff spring: { stiffness: 210, damping: 20 } */\r\n  stiff: SpringConfig\r\n  /** Slow spring: { stiffness: 280, damping: 60 } */\r\n  slow: SpringConfig\r\n  /** Molasses spring: { stiffness: 280, damping: 120 } */\r\n  molasses: SpringConfig\r\n  /** Bouncy spring: { stiffness: 200, damping: 8 } */\r\n  bounce: SpringConfig\r\n  /** No wobble spring: { stiffness: 170, damping: 26 } */\r\n  noWobble: SpringConfig\r\n}\r\n\r\n/**\r\n * Built-in spring presets\r\n */\r\nexport const springPresets: SpringPresets = {\r\n  default: { stiffness: 100, damping: 10 },\r\n  gentle: { stiffness: 120, damping: 14 },\r\n  wobbly: { stiffness: 180, damping: 12 },\r\n  stiff: { stiffness: 210, damping: 20 },\r\n  slow: { stiffness: 280, damping: 60 },\r\n  molasses: { stiffness: 280, damping: 120 },\r\n  bounce: { stiffness: 200, damping: 8 },\r\n  noWobble: { stiffness: 170, damping: 26 },\r\n}\r\n\r\n// ============ Semantic Physics Presets ============\r\n\r\n/**\r\n * Physics presets with semantic, use-case oriented names\r\n * These presets are designed for specific UI interactions and feel natural\r\n */\r\nexport const physicsPresets = {\r\n  // ---- UI Interactions ----\r\n\r\n  /** Button press/release - snappy response */\r\n  button: { stiffness: 400, damping: 30, mass: 1 },\r\n\r\n  /** Toggle switch - quick but smooth */\r\n  toggle: { stiffness: 500, damping: 35, mass: 0.8 },\r\n\r\n  /** Checkbox/Radio - instant feedback */\r\n  checkbox: { stiffness: 600, damping: 40, mass: 0.5 },\r\n\r\n  /** Hover state - subtle and responsive */\r\n  hover: { stiffness: 300, damping: 25, mass: 0.8 },\r\n\r\n  /** Focus ring - gentle attention */\r\n  focus: { stiffness: 200, damping: 20, mass: 1 },\r\n\r\n  // ---- Layout & Navigation ----\r\n\r\n  /** Page transitions - smooth and professional */\r\n  pageTransition: { stiffness: 100, damping: 20, mass: 1.5 },\r\n\r\n  /** Modal/Dialog entry - dramatic but controlled */\r\n  modalEnter: { stiffness: 300, damping: 25, mass: 1 },\r\n\r\n  /** Modal/Dialog exit - quick departure */\r\n  modalExit: { stiffness: 400, damping: 35, mass: 0.8 },\r\n\r\n  /** Sidebar slide - smooth glide */\r\n  sidebar: { stiffness: 200, damping: 28, mass: 1.2 },\r\n\r\n  /** Dropdown menu - snappy reveal */\r\n  dropdown: { stiffness: 400, damping: 30, mass: 0.8 },\r\n\r\n  /** Toast notification - attention-grabbing */\r\n  toast: { stiffness: 350, damping: 25, mass: 0.9 },\r\n\r\n  /** Tooltip - quick and subtle */\r\n  tooltip: { stiffness: 500, damping: 40, mass: 0.6 },\r\n\r\n  // ---- Gestures & Drag ----\r\n\r\n  /** Drag release - momentum with settle */\r\n  dragRelease: { stiffness: 150, damping: 20, mass: 1 },\r\n\r\n  /** Swipe action - decisive movement */\r\n  swipe: { stiffness: 250, damping: 22, mass: 0.9 },\r\n\r\n  /** Pull to refresh - elastic and responsive */\r\n  pullToRefresh: { stiffness: 180, damping: 18, mass: 1.2 },\r\n\r\n  /** Snap to position - magnetic feel */\r\n  snap: { stiffness: 400, damping: 35, mass: 0.8 },\r\n\r\n  /** Rubber band - iOS-style overscroll */\r\n  rubberBand: { stiffness: 300, damping: 15, mass: 0.8 },\r\n\r\n  // ---- Cards & Items ----\r\n\r\n  /** Card flip - dramatic reveal */\r\n  cardFlip: { stiffness: 150, damping: 18, mass: 1.5 },\r\n\r\n  /** Card hover lift - subtle elevation */\r\n  cardHover: { stiffness: 400, damping: 30, mass: 0.7 },\r\n\r\n  /** List item enter - staggered animation */\r\n  listItem: { stiffness: 300, damping: 28, mass: 0.9 },\r\n\r\n  /** Accordion expand - smooth reveal */\r\n  accordion: { stiffness: 200, damping: 25, mass: 1.1 },\r\n\r\n  // ---- Loading & Progress ----\r\n\r\n  /** Skeleton shimmer - continuous flow */\r\n  skeleton: { stiffness: 80, damping: 15, mass: 2 },\r\n\r\n  /** Progress bar - steady advancement */\r\n  progress: { stiffness: 150, damping: 25, mass: 1 },\r\n\r\n  /** Spinner rotation - smooth continuous */\r\n  spinner: { stiffness: 100, damping: 12, mass: 1.5 },\r\n\r\n  // ---- Emphasis & Attention ----\r\n\r\n  /** Pulse effect - gentle attention */\r\n  pulse: { stiffness: 120, damping: 10, mass: 1.2 },\r\n\r\n  /** Shake effect - error emphasis */\r\n  shake: { stiffness: 500, damping: 15, mass: 0.6 },\r\n\r\n  /** Bounce effect - playful emphasis */\r\n  bounceAttention: { stiffness: 400, damping: 10, mass: 0.7 },\r\n\r\n  /** Pop effect - sudden appearance */\r\n  pop: { stiffness: 500, damping: 20, mass: 0.6 },\r\n\r\n  /** Wiggle effect - playful motion */\r\n  wiggle: { stiffness: 300, damping: 8, mass: 0.8 },\r\n\r\n  // ---- Mobile-Specific ----\r\n\r\n  /** iOS spring - Apple-like feel */\r\n  ios: { stiffness: 300, damping: 20, mass: 1 },\r\n\r\n  /** Android spring - Material Design feel */\r\n  android: { stiffness: 350, damping: 25, mass: 0.9 },\r\n\r\n  /** Haptic feedback - quick micro-interaction */\r\n  haptic: { stiffness: 600, damping: 45, mass: 0.4 },\r\n\r\n  // ---- Natural Physics ----\r\n\r\n  /** Pendulum - gravity-like swing */\r\n  pendulum: { stiffness: 50, damping: 5, mass: 2 },\r\n\r\n  /** Jelly - soft and wobbly */\r\n  jelly: { stiffness: 150, damping: 8, mass: 1.5 },\r\n\r\n  /** Elastic - stretchy rubber */\r\n  elastic: { stiffness: 200, damping: 10, mass: 1.2 },\r\n\r\n  /** Heavy - weighted and deliberate */\r\n  heavy: { stiffness: 150, damping: 30, mass: 3 },\r\n\r\n  /** Light - airy and quick */\r\n  light: { stiffness: 400, damping: 25, mass: 0.5 },\r\n\r\n  /** Liquid - fluid motion */\r\n  liquid: { stiffness: 100, damping: 20, mass: 2 },\r\n\r\n} as const\r\n\r\nexport type PhysicsPresetName = keyof typeof physicsPresets\r\n\r\n/**\r\n * Get a physics preset by name\r\n */\r\nexport function getPhysicsPreset(name: PhysicsPresetName): SpringConfig {\r\n  return { ...physicsPresets[name] }\r\n}\r\n\r\n/**\r\n * Create a custom preset based on a semantic description\r\n * @param feeling - How the animation should feel\r\n */\r\nexport function createFeeling(feeling: 'snappy' | 'smooth' | 'bouncy' | 'heavy' | 'light' | 'elastic'): SpringConfig {\r\n  switch (feeling) {\r\n    case 'snappy':\r\n      return { stiffness: 400, damping: 30, mass: 0.8 }\r\n    case 'smooth':\r\n      return { stiffness: 150, damping: 25, mass: 1.2 }\r\n    case 'bouncy':\r\n      return { stiffness: 300, damping: 12, mass: 1 }\r\n    case 'heavy':\r\n      return { stiffness: 100, damping: 30, mass: 2.5 }\r\n    case 'light':\r\n      return { stiffness: 400, damping: 25, mass: 0.5 }\r\n    case 'elastic':\r\n      return { stiffness: 200, damping: 10, mass: 1.2 }\r\n    default:\r\n      return { stiffness: 100, damping: 10, mass: 1 }\r\n  }\r\n}\r\n\r\n/**\r\n * Adjust a preset for speed\r\n * @param preset - Base preset config\r\n * @param speed - Speed multiplier (0.5 = half speed, 2 = double speed)\r\n */\r\nexport function adjustSpeed(preset: SpringConfig, speed: number): SpringConfig {\r\n  const stiffness = (preset.stiffness ?? 100) * speed\r\n  const damping = (preset.damping ?? 10) * Math.sqrt(speed)\r\n  return { ...preset, stiffness, damping }\r\n}\r\n\r\n/**\r\n * Adjust a preset for bounciness\r\n * @param preset - Base preset config\r\n * @param bounce - Bounce factor (0 = no bounce, 1 = very bouncy)\r\n */\r\nexport function adjustBounce(preset: SpringConfig, bounce: number): SpringConfig {\r\n  const minDamping = 5\r\n  const maxDamping = 40\r\n  const damping = maxDamping - (bounce * (maxDamping - minDamping))\r\n  return { ...preset, damping: Math.max(minDamping, Math.min(maxDamping, damping)) }\r\n}\r\n\r\n/**\r\n * Create a spring config that settles in approximately the given duration\r\n * @param ms - Approximate settling time in milliseconds\r\n * @returns Spring config\r\n */\r\nexport function configFromDuration(ms: number): SpringConfig {\r\n  if (ms < 300) {\r\n    return { stiffness: 170, damping: 26 }\r\n  }\r\n  if (ms < 500) {\r\n    return { stiffness: 100, damping: 20 }\r\n  }\r\n  return { stiffness: 80, damping: 15 }\r\n}\r\n\r\n/**\r\n * Create a spring config with specific bounce amount\r\n * @param bounce - Bounce factor (0 = no bounce, 0.5 = 50% overshoot)\r\n * @returns Spring config\r\n */\r\nexport function configFromBounce(bounce: number): SpringConfig {\r\n  if (bounce <= 0) {\r\n    return { stiffness: 170, damping: 26 }\r\n  }\r\n  if (bounce <= 0.25) {\r\n    return { stiffness: 200, damping: 12 }\r\n  }\r\n  return { stiffness: 200, damping: 8 }\r\n}\r\n","import type { SpringConfig } from './config.js'\n\n/**\n * Result of a spring physics simulation step\n */\nexport interface SimulationResult {\n  /** New position */\n  position: number\n  /** New velocity */\n  velocity: number\n  /** Whether the spring is at rest */\n  isRest: boolean\n}\n\n/**\n * Simulate one step of spring physics using semi-implicit Euler integration\n *\n * The spring follows the damped harmonic oscillator equation:\n * F = -k * x - c * v\n * a = F / m\n *\n * Where:\n * - k = stiffness (spring constant)\n * - c = damping coefficient\n * - m = mass\n * - x = displacement from rest (target - position)\n * - v = velocity\n * - a = acceleration\n * - dt = time step (1/60 for 60fps animation)\n *\n * @param position - Current position\n * @param velocity - Current velocity\n * @param target - Target position (rest position)\n * @param config - Spring configuration\n * @returns Simulation result with new position, velocity, and rest state\n */\nexport function simulateSpring(\n  position: number,\n  velocity: number,\n  target: number,\n  config: SpringConfig\n): SimulationResult {\n  const {\n    stiffness = 100,\n    damping = 10,\n    mass = 1,\n    restSpeed = 0.01,\n    restDelta = 0.01,\n  } = config\n\n  // Calculate displacement from target (cached for reuse)\n  const displacement = target - position\n  const absDisplacement = Math.abs(displacement)\n  const absVelocity = Math.abs(velocity)\n\n  // Early exit optimization: if already at rest, skip expensive calculations\n  // This significantly improves performance for springs that have settled\n  if (absDisplacement <= restDelta && absVelocity <= restSpeed) {\n    return {\n      position: target, // Snap to exact target\n      velocity: 0,\n      isRest: true,\n    }\n  }\n\n  // Time step for 60fps animation\n  // This ensures the spring simulation is stable with typical stiffness values\n  const dt = 1 / 60\n\n  // Calculate spring force (Hooke's law: F = -k * x)\n  const springForce = stiffness * displacement\n\n  // Calculate damping force (opposes velocity: F = -c * v)\n  // Optimization: skip multiplication if velocity is negligible\n  const dampingForce = absVelocity > 0.0001 ? damping * velocity : 0\n\n  // Calculate total force and acceleration (Newton's second law: a = F/m)\n  const acceleration = (springForce - dampingForce) / mass\n\n  // Semi-implicit Euler integration\n  // Update velocity first, then use new velocity to update position\n  // This provides better energy conservation than standard Euler\n  const newVelocity = velocity + acceleration * dt\n  const newPosition = position + newVelocity * dt\n\n  // Check if spring is at rest\n  // Spring is at rest when:\n  // 1. Close to target position (new displacement < restDelta)\n  // 2. Moving slowly (new velocity < restSpeed)\n  // Use NEW position to calculate displacement for accurate rest detection\n  const newDisplacement = Math.abs(target - newPosition)\n  const isRest =\n    newDisplacement <= restDelta &&\n    Math.abs(newVelocity) <= restSpeed\n\n  return {\n    position: newPosition,\n    velocity: newVelocity,\n    isRest,\n  }\n}\n\n/**\n * Calculate the period of oscillation for a spring\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Period in seconds\n */\nexport function calculatePeriod(stiffness: number, mass: number): number {\n  return 2 * Math.PI * Math.sqrt(mass / stiffness)\n}\n\n/**\n * Calculate the damping ratio for a spring\n * @param damping - Damping coefficient\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Damping ratio\n */\nexport function calculateDampingRatio(\n  damping: number,\n  stiffness: number,\n  mass: number\n): number {\n  return damping / (2 * Math.sqrt(stiffness * mass))\n}\n\n/**\n * Check if a spring is underdamped (will oscillate)\n * @param config - Spring configuration\n * @returns True if underdamped\n */\nexport function isUnderdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio < 1\n}\n\n/**\n * Check if a spring is critically damped (fastest return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if critically damped\n */\nexport function isCriticallyDamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return Math.abs(ratio - 1) < 0.001\n}\n\n/**\n * Check if a spring is overdamped (slow return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if overdamped\n */\nexport function isOverdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio > 1\n}\n","/**\n * Animation state enum\n */\nexport enum AnimationState {\n  Idle = 'idle',\n  Running = 'running',\n  Paused = 'paused',\n  Complete = 'complete',\n}\n\n/**\n * Interface for objects that can be animated\n */\nexport interface Animatable {\n  /**\n   * Update the animation\n   * @param now - Current timestamp from performance.now()\n   */\n  update(now: number): void\n\n  /**\n   * Check if the animation is complete\n   */\n  isComplete(): boolean\n}\n\n/**\n * Callback type for cleanup notifications\n */\nexport type CleanupCallback = (id: number) => void\n\n/**\n * Maximum allowed delta time (ms) to prevent physics explosions after tab suspension\n * If more time has passed, we clamp to this value for stable simulation\n */\nconst MAX_DELTA_TIME = 64 // ~15fps minimum, prevents huge jumps\n\n/**\n * Global animation loop manager\n * Uses requestAnimationFrame to drive all animations\n * Features:\n * - WeakRef-based animation tracking for memory safety\n * - FinalizationRegistry for cleanup callbacks\n * - Frame-drop resilience with delta time clamping\n * - Single-pass update + cleanup for O(n) performance\n * - Frame event listeners for external monitoring\n */\nclass AnimationLoop {\n  private animations = new Set<WeakRef<Animatable>>()\n  private animationMap = new WeakMap<Animatable, WeakRef<Animatable>>()\n  private rafId: number | null = null\n  private isRunning = false\n  private lastTime: number = 0\n  private nextId = 1\n  private idMap = new WeakMap<Animatable, number>()\n  private frameListeners = new Set<(deltaTime: number) => void>()\n\n  // FinalizationRegistry for automatic cleanup notifications\n  private registry = new FinalizationRegistry<number>((id) => {\n    this.cleanupCallbacks.forEach((cb) => cb(id))\n  })\n  private cleanupCallbacks = new Set<CleanupCallback>()\n\n  /**\n   * Add an animation to the loop\n   * Uses WeakRef to prevent memory leaks if animation is garbage collected\n   * @returns Unique ID for this animation\n   */\n  add(animation: Animatable): number {\n    // Check if already added\n    const existingId = this.idMap.get(animation)\n    if (existingId !== undefined) return existingId\n\n    const id = this.nextId++\n    const ref = new WeakRef(animation)\n    this.animations.add(ref)\n    this.animationMap.set(animation, ref)\n    this.idMap.set(animation, id)\n\n    // Register for finalization callback\n    this.registry.register(animation, id)\n\n    this.start()\n    return id\n  }\n\n  /**\n   * Remove an animation from the loop\n   */\n  remove(animation: Animatable): void {\n    const ref = this.animationMap.get(animation)\n    if (ref) {\n      this.animations.delete(ref)\n      this.animationMap.delete(animation)\n      this.idMap.delete(animation)\n      // Note: unregister not strictly needed as registry uses weak refs\n    }\n    if (this.animations.size === 0) {\n      this.stop()\n    }\n  }\n\n  /**\n   * Register a callback for when animations are garbage collected\n   * Useful for debugging memory leaks\n   */\n  onCleanup(callback: CleanupCallback): () => void {\n    this.cleanupCallbacks.add(callback)\n    return () => this.cleanupCallbacks.delete(callback)\n  }\n\n  /**\n   * Register a callback for each frame\n   * Receives delta time in milliseconds\n   */\n  onFrame(callback: (deltaTime: number) => void): () => void {\n    this.frameListeners.add(callback)\n    return () => this.frameListeners.delete(callback)\n  }\n\n  /**\n   * Start the animation loop\n   */\n  private start(): void {\n    if (this.isRunning) return\n    this.isRunning = true\n    this.lastTime = performance.now()\n    this.tick()\n  }\n\n  /**\n   * Stop the animation loop\n   */\n  private stop(): void {\n    this.isRunning = false\n    if (this.rafId !== null) {\n      cancelAnimationFrame(this.rafId)\n      this.rafId = null\n    }\n  }\n\n  /**\n   * Single animation frame - optimized single-pass update + cleanup\n   * Features:\n   * - WeakRef dereferencing with automatic cleanup of dead refs\n   * - Delta time clamping for frame-drop resilience\n   * - O(n) single-pass performance\n   * - Frame listener notifications\n   */\n  private tick = (): void => {\n    const now = performance.now()\n\n    // Calculate and clamp delta time to prevent physics explosions\n    // This handles tab suspension, debugger pauses, etc.\n    const rawDelta = now - this.lastTime\n    const clampedDelta = Math.min(rawDelta, MAX_DELTA_TIME)\n    this.lastTime = now\n\n    // Notify frame listeners (with error isolation)\n    for (const listener of this.frameListeners) {\n      try {\n        listener(clampedDelta)\n      } catch (e) {\n        console.error('[SpringKit] Frame listener error:', e)\n      }\n    }\n\n    // Single pass: update all animations and collect refs to remove\n    const toRemove: WeakRef<Animatable>[] = []\n\n    for (const ref of this.animations) {\n      const animation = ref.deref()\n\n      // If WeakRef is dead (animation was garbage collected), mark for removal\n      if (!animation) {\n        toRemove.push(ref)\n        continue\n      }\n\n      animation.update(now)\n\n      if (animation.isComplete()) {\n        toRemove.push(ref)\n        this.animationMap.delete(animation)\n        this.idMap.delete(animation)\n      }\n    }\n\n    // Remove dead/completed refs\n    for (let i = 0; i < toRemove.length; i++) {\n      this.animations.delete(toRemove[i]!)\n    }\n\n    // Continue or stop loop\n    if (this.animations.size > 0) {\n      this.rafId = requestAnimationFrame(this.tick)\n    } else {\n      this.stop()\n    }\n  }\n\n  /**\n   * Get the number of active animations (including potentially dead refs)\n   */\n  get size(): number {\n    return this.animations.size\n  }\n\n  /**\n   * Get count of actually alive animations (for debugging/testing)\n   */\n  getAliveCount(): number {\n    let count = 0\n    for (const ref of this.animations) {\n      if (ref.deref()) count++\n    }\n    return count\n  }\n\n  /**\n   * Get current frame rate (based on last delta)\n   */\n  getFPS(): number {\n    const delta = performance.now() - this.lastTime\n    return delta > 0 ? Math.round(1000 / delta) : 60\n  }\n}\n\n/**\n * Global animation loop instance\n */\nexport const globalLoop = new AnimationLoop()\n","/**\r\n * Clamp a value between a minimum and maximum\r\n * @param value - The value to clamp\r\n * @param min - The minimum allowed value\r\n * @param max - The maximum allowed value\r\n * @returns The clamped value\r\n */\r\nexport function clamp(value: number, min: number, max: number): number {\r\n  // Handle inverted min/max (swap them)\r\n  const actualMin = Math.min(min, max)\r\n  const actualMax = Math.max(min, max)\r\n  return Math.max(actualMin, Math.min(actualMax, value))\r\n}\r\n\r\n/**\r\n * Linear interpolation between two values\r\n * @param a - The start value\r\n * @param b - The end value\r\n * @param t - The interpolation factor (0-1)\r\n * @returns The interpolated value\r\n */\r\nexport function lerp(a: number, b: number, t: number): number {\r\n  return a + (b - a) * t\r\n}\r\n\r\n/**\r\n * Map a value from one range to another\r\n * @param value - The value to map\r\n * @param inMin - The minimum of the input range\r\n * @param inMax - The maximum of the input range\r\n * @param outMin - The minimum of the output range\r\n * @param outMax - The maximum of the output range\r\n * @returns The mapped value\r\n */\r\nexport function mapRange(\r\n  value: number,\r\n  inMin: number,\r\n  inMax: number,\r\n  outMin: number,\r\n  outMax: number\r\n): number {\r\n  // Guard against division by zero - return outMin when input range is zero\r\n  const inputRange = inMax - inMin\r\n  if (inputRange === 0) {\r\n    return outMin\r\n  }\r\n  return ((value - inMin) * (outMax - outMin)) / inputRange + outMin\r\n}\r\n\r\n/**\r\n * Convert degrees to radians\r\n * @param degrees - The angle in degrees\r\n * @returns The angle in radians\r\n */\r\nexport function degToRad(degrees: number): number {\r\n  return (degrees * Math.PI) / 180\r\n}\r\n\r\n/**\r\n * Convert radians to degrees\r\n * @param radians - The angle in radians\r\n * @returns The angle in degrees\r\n */\r\nexport function radToDeg(radians: number): number {\r\n  return (radians * 180) / Math.PI\r\n}\r\n","/**\n * Development mode warnings for SpringKit\n * These warnings help developers avoid common configuration mistakes\n */\n\nconst isDev = typeof process !== 'undefined' && process.env?.NODE_ENV !== 'production'\nconst warnedMessages = new Set<string>()\n\n/**\n * Log a warning message once (won't repeat the same message)\n */\nfunction warnOnce(message: string): void {\n  if (!isDev || warnedMessages.has(message)) return\n  warnedMessages.add(message)\n  console.warn(`[SpringKit] ${message}`)\n}\n\n/**\n * Validate spring configuration and warn about potential issues\n */\nexport function validateSpringConfig(config: {\n  stiffness?: number\n  damping?: number\n  mass?: number\n}): void {\n  if (!isDev) return\n\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n\n  // Check for extreme stiffness with low damping (unstable oscillation)\n  if (stiffness > 400 && damping < 10) {\n    warnOnce(\n      `High stiffness (${stiffness}) with low damping (${damping}) may cause excessive oscillation. ` +\n      `Consider increasing damping to at least ${Math.round(stiffness / 20)} for smoother animation.`\n    )\n  }\n\n  // Check for very low stiffness (sluggish animation)\n  if (stiffness < 20) {\n    warnOnce(\n      `Very low stiffness (${stiffness}) will result in sluggish animation. ` +\n      `Consider using stiffness >= 50 for more responsive feel.`\n    )\n  }\n\n  // Check for very high damping (overdamped, no spring feel)\n  if (damping > stiffness) {\n    warnOnce(\n      `Damping (${damping}) is higher than stiffness (${stiffness}), ` +\n      `which removes the \"springy\" feel. Consider reducing damping for bouncier animation.`\n    )\n  }\n\n  // Check for zero or negative mass\n  if (mass <= 0) {\n    warnOnce(\n      `Mass must be positive. Got ${mass}. Using default mass of 1.`\n    )\n  }\n\n  // Check for very high mass (slow animation)\n  if (mass > 10) {\n    warnOnce(\n      `High mass (${mass}) will make the animation very slow. ` +\n      `Consider mass between 0.5 and 5 for typical use cases.`\n    )\n  }\n}\n\n/**\n * Validate drag configuration\n */\nexport function validateDragConfig(config: {\n  rubberBandFactor?: number\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n}): void {\n  if (!isDev) return\n\n  const { rubberBandFactor, bounds } = config\n\n  // Check rubber band factor range\n  if (rubberBandFactor !== undefined && (rubberBandFactor < 0 || rubberBandFactor > 1)) {\n    warnOnce(\n      `rubberBandFactor should be between 0 and 1. Got ${rubberBandFactor}. ` +\n      `Values outside this range may cause unexpected behavior.`\n    )\n  }\n\n  // Check for inverted bounds\n  if (bounds) {\n    if (bounds.left !== undefined && bounds.right !== undefined && bounds.left > bounds.right) {\n      warnOnce(\n        `Drag bounds are inverted: left (${bounds.left}) > right (${bounds.right}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n    if (bounds.top !== undefined && bounds.bottom !== undefined && bounds.top > bounds.bottom) {\n      warnOnce(\n        `Drag bounds are inverted: top (${bounds.top}) > bottom (${bounds.bottom}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n  }\n}\n\n/**\n * Validate decay configuration\n */\nexport function validateDecayConfig(config: {\n  velocity: number\n  deceleration?: number\n}): void {\n  if (!isDev) return\n\n  const { velocity, deceleration = 0.998 } = config\n\n  // Check for zero velocity\n  if (velocity === 0) {\n    warnOnce(\n      `Decay animation started with zero velocity. ` +\n      `The animation will complete immediately.`\n    )\n  }\n\n  // Check deceleration range\n  if (deceleration <= 0 || deceleration >= 1) {\n    warnOnce(\n      `Deceleration should be between 0 and 1 (exclusive). Got ${deceleration}. ` +\n      `Typical values are 0.99-0.999.`\n    )\n  }\n}\n\n/**\n * Validate a numeric value, checking for NaN and Infinity\n * Returns a safe default value if invalid\n */\nexport function validateNumber(\n  value: number,\n  name: string,\n  defaultValue: number = 0\n): number {\n  if (typeof value !== 'number' || Number.isNaN(value)) {\n    if (isDev) {\n      warnOnce(`${name} received NaN, using ${defaultValue} instead.`)\n    }\n    return defaultValue\n  }\n\n  if (!Number.isFinite(value)) {\n    if (isDev) {\n      warnOnce(`${name} received Infinity, using ${defaultValue} instead.`)\n    }\n    return defaultValue\n  }\n\n  return value\n}\n\n/**\n * Validate animation target value\n * Throws in development, returns safe value in production\n */\nexport function validateAnimationValue(value: number, context: string): number {\n  if (typeof value !== 'number' || Number.isNaN(value)) {\n    const message = `Invalid animation value in ${context}: expected number, got ${value}`\n    if (isDev) {\n      console.error(`[SpringKit] ${message}`)\n    }\n    return 0\n  }\n\n  if (!Number.isFinite(value)) {\n    const message = `Invalid animation value in ${context}: Infinity is not supported`\n    if (isDev) {\n      console.error(`[SpringKit] ${message}`)\n    }\n    return 0\n  }\n\n  return value\n}\n\n/**\n * Clear warned messages (useful for testing)\n */\nexport function clearWarnings(): void {\n  warnedMessages.clear()\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { simulateSpring } from './physics.js'\nimport { globalLoop, type Animatable, AnimationState } from '../animation/loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateSpringConfig, validateAnimationValue } from '../utils/warnings.js'\n\n/**\n * Spring animation control interface\n */\nexport interface SpringAnimation {\n  /** Start the animation */\n  start(): SpringAnimation\n  /** Stop the animation immediately */\n  stop(): void\n  /** Pause the animation */\n  pause(): void\n  /** Resume the animation */\n  resume(): void\n  /** Reverse the animation direction */\n  reverse(): void\n  /** Update the target value */\n  set(to: number): void\n  /** Update target while preserving current velocity (for smooth interruptions) */\n  setWithVelocity(to: number, velocity?: number): void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Check if paused */\n  isPaused(): boolean\n  /** Check if complete */\n  isComplete(): boolean\n  /** Get current value */\n  getValue(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring animation implementation\n */\nclass SpringAnimationImpl implements SpringAnimation, Animatable {\n  private position: number\n  private velocity: number\n  private target: number\n  private config: SpringConfig & Required<Pick<SpringConfig, 'stiffness' | 'damping' | 'mass' | 'restSpeed' | 'restDelta'>>\n  private state: AnimationState = AnimationState.Idle\n  private resolveComplete: (() => void) | null = null\n  private from: number\n  private to: number\n  private clampedFrom: number\n  private clampedTo: number\n\n  finished: Promise<void>\n\n  constructor(\n    from: number,\n    to: number,\n    config: SpringConfig = {}\n  ) {\n    // Validate config in development mode\n    validateSpringConfig(config)\n\n    // Validate input values\n    this.from = validateAnimationValue(from, 'spring.from')\n    this.to = validateAnimationValue(to, 'spring.to')\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.position = this.from\n    this.velocity = config.velocity ?? 0\n    this.target = this.to\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      stiffness: config.stiffness ?? defaultConfig.stiffness!,\n      damping: config.damping ?? defaultConfig.damping!,\n      mass: config.mass ?? defaultConfig.mass!,\n      restSpeed: config.restSpeed ?? defaultConfig.restSpeed!,\n      restDelta: config.restDelta ?? defaultConfig.restDelta!,\n    }\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): SpringAnimation {\n    if (this.state === AnimationState.Running) return this\n\n    this.state = AnimationState.Running\n    this.config.onStart?.()\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  pause(): void {\n    if (this.state === AnimationState.Running) {\n      this.state = AnimationState.Paused\n      globalLoop.remove(this)\n    }\n  }\n\n  resume(): void {\n    if (this.state === AnimationState.Paused) {\n      this.state = AnimationState.Running\n      globalLoop.add(this)\n    }\n  }\n\n  reverse(): void {\n    // Swap from and to\n    const temp = this.from\n    this.from = this.to\n    this.to = temp\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.target = this.to\n\n    // Negate velocity for proper direction reversal during animation\n    if (this.state === AnimationState.Running) {\n      this.velocity = -this.velocity\n    }\n    // Position stays at current value - the animation will move toward the new target\n    // This allows smooth reversal mid-animation and correct behavior when not running\n  }\n\n  set(to: number): void {\n    const validTo = validateAnimationValue(to, 'spring.set')\n    this.to = validTo\n    this.clampedTo = validTo\n    this.target = validTo\n  }\n\n  setWithVelocity(to: number, velocity?: number): void {\n    const validTo = validateAnimationValue(to, 'spring.setWithVelocity')\n\n    // Update from to current position for smooth continuation\n    this.from = this.position\n    this.clampedFrom = this.position\n    this.to = validTo\n    this.clampedTo = validTo\n    this.target = validTo\n\n    // Use provided velocity or preserve current velocity\n    if (velocity !== undefined) {\n      this.velocity = validateAnimationValue(velocity, 'spring.setWithVelocity.velocity')\n    }\n    // If not running, start the animation\n    if (this.state !== AnimationState.Running) {\n      this.start()\n    }\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    const result = simulateSpring(\n      this.position,\n      this.velocity,\n      this.target,\n      this.config\n    )\n\n    this.position = result.position\n    this.velocity = result.velocity\n\n    // Handle clamping\n    if (this.config.clamp) {\n      const min = Math.min(this.clampedFrom, this.clampedTo)\n      const max = Math.max(this.clampedFrom, this.clampedTo)\n      this.position = clamp(this.position, min, max)\n    }\n\n    // Emit update\n    this.config.onUpdate?.(this.position)\n\n    // Check rest state\n    if (result.isRest) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.position = this.target // Ensure we end exactly at target\n      this.config.onUpdate?.(this.position)\n      this.config.onComplete?.()\n      this.config.onRest?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.state === AnimationState.Running\n  }\n\n  isPaused(): boolean {\n    return this.state === AnimationState.Paused\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  getValue(): number {\n    return this.position\n  }\n\n  getVelocity(): number {\n    return this.velocity\n  }\n\n  destroy(): void {\n    this.stop()\n    // Resolve the promise to prevent memory leaks from pending .finished handlers\n    this.resolveComplete?.()\n    this.resolveComplete = null\n    this.config.onUpdate = undefined\n    this.config.onStart = undefined\n    this.config.onComplete = undefined\n    this.config.onRest = undefined\n  }\n}\n\n/**\n * Create a spring animation\n *\n * @param from - Starting value\n * @param to - Target value\n * @param config - Spring configuration\n * @returns Spring animation controller\n *\n * @example\n * ```ts\n * const anim = spring(0, 100, {\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function spring(\n  from: number,\n  to: number,\n  config?: SpringConfig\n): SpringAnimation {\n  return new SpringAnimationImpl(from, to, config)\n}\n","import type { SpringConfig } from './config.js'\r\nimport { defaultConfig } from './config.js'\r\nimport { spring, type SpringAnimation } from './spring.js'\r\nimport { validateAnimationValue } from '../utils/warnings.js'\r\n\r\n/**\r\n * Spring value interface\r\n */\r\nexport interface SpringValue {\r\n  /** Get current value */\r\n  get(): number\r\n  /** Get current velocity */\r\n  getVelocity(): number\r\n  /** Animate to a new value */\r\n  set(to: number, config?: Partial<SpringConfig>): void\r\n  /** Set value immediately without animation */\r\n  jump(to: number): void\r\n  /** Stop current animation at current position */\r\n  stop(): void\r\n  /** Update spring configuration */\r\n  setConfig(config: Partial<SpringConfig>): void\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (value: number) => void): () => void\r\n  /** Check if currently animating */\r\n  isAnimating(): boolean\r\n  /** Promise that resolves when current animation completes */\r\n  finished: Promise<void>\r\n  /** Clean up resources */\r\n  destroy(): void\r\n  /** Check if destroyed */\r\n  isDestroyed(): boolean\r\n}\r\n\r\n/**\r\n * Spring value implementation\r\n */\r\nclass SpringValueImpl implements SpringValue {\r\n  private value: number\r\n  private config: SpringConfig\r\n  private currentAnimation: SpringAnimation | null = null\r\n  private subscribers = new Set<(value: number) => void>()\r\n  private resolveComplete: (() => void) | null = null\r\n  private finishedPromise: Promise<void>\r\n  private destroyed: boolean = false\r\n\r\n  constructor(initial: number, config: SpringConfig = {}) {\r\n    // Validate initial value\r\n    this.value = validateAnimationValue(initial, 'createSpringValue.initial')\r\n    this.config = { ...defaultConfig, ...config }\r\n\r\n    this.finishedPromise = new Promise((resolve) => {\r\n      this.resolveComplete = resolve\r\n    })\r\n  }\r\n\r\n  get(): number {\r\n    return this.value\r\n  }\r\n\r\n  getVelocity(): number {\r\n    return this.currentAnimation?.getVelocity() ?? 0\r\n  }\r\n\r\n  set(to: number, config: Partial<SpringConfig> = {}): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    // Validate target value\r\n    const validTo = validateAnimationValue(to, 'SpringValue.set')\r\n\r\n    // Cancel existing animation\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.destroy()\r\n      this.currentAnimation = null\r\n    }\r\n\r\n    // Capture resolver in local scope to prevent race condition\r\n    // Each animation gets its own resolver that won't be overwritten\r\n    let animationResolver: (() => void) | null = null\r\n\r\n    // Create new promise for this animation\r\n    this.finishedPromise = new Promise((resolve) => {\r\n      animationResolver = resolve\r\n      this.resolveComplete = resolve\r\n    })\r\n\r\n    // Create new animation\r\n    const mergedConfig = { ...this.config, ...config }\r\n    const originalOnUpdate = mergedConfig.onUpdate\r\n    const originalOnComplete = mergedConfig.onComplete\r\n\r\n    this.currentAnimation = spring(this.value, validTo, {\r\n      ...mergedConfig,\r\n      onUpdate: (value) => {\r\n        if (this.destroyed) return\r\n        this.value = value\r\n        this.notify()\r\n        // Also call original onUpdate if provided\r\n        originalOnUpdate?.(value)\r\n      },\r\n      onComplete: () => {\r\n        originalOnComplete?.()\r\n        // Use captured resolver to prevent race condition\r\n        animationResolver?.()\r\n      },\r\n    })\r\n\r\n    this.currentAnimation.start()\r\n  }\r\n\r\n  jump(to: number): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    // Validate target value\r\n    const validTo = validateAnimationValue(to, 'SpringValue.jump')\r\n\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.destroy()\r\n      this.currentAnimation = null\r\n    }\r\n    this.value = validTo\r\n    this.notify()\r\n  }\r\n\r\n  stop(): void {\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.destroy()\r\n      this.currentAnimation = null\r\n    }\r\n    if (this.resolveComplete) {\r\n      this.resolveComplete()\r\n    }\r\n  }\r\n\r\n  setConfig(config: Partial<SpringConfig>): void {\r\n    this.config = { ...this.config, ...config }\r\n  }\r\n\r\n  subscribe(callback: (value: number) => void): () => void {\r\n    this.subscribers.add(callback)\r\n\r\n    // Immediately call with current value (with error isolation)\r\n    try {\r\n      callback(this.value)\r\n    } catch (e) {\r\n      console.error('[SpringKit] Subscriber error:', e)\r\n    }\r\n\r\n    return () => {\r\n      this.subscribers.delete(callback)\r\n    }\r\n  }\r\n\r\n  isAnimating(): boolean {\r\n    return this.currentAnimation?.isAnimating() ?? false\r\n  }\r\n\r\n  get finished(): Promise<void> {\r\n    return this.finishedPromise\r\n  }\r\n\r\n  private notify(): void {\r\n    for (const subscriber of this.subscribers) {\r\n      try {\r\n        subscriber(this.value)\r\n      } catch (e) {\r\n        console.error('[SpringKit] Subscriber error:', e)\r\n      }\r\n    }\r\n  }\r\n\r\n  isDestroyed(): boolean {\r\n    return this.destroyed\r\n  }\r\n\r\n  destroy(): void {\r\n    if (this.destroyed) return\r\n    this.destroyed = true\r\n\r\n    this.currentAnimation?.destroy()\r\n    this.currentAnimation = null\r\n    // Resolve pending promise to prevent memory leaks\r\n    this.resolveComplete?.()\r\n    this.resolveComplete = null\r\n    this.subscribers.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a spring value\r\n *\r\n * @param initial - Initial value\r\n * @param config - Spring configuration\r\n * @returns Spring value controller\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createSpringValue(0, { stiffness: 100, damping: 10 })\r\n *\r\n * x.subscribe((value) => {\r\n *   element.style.transform = `translateX(${value}px)`\r\n * })\r\n *\r\n * x.set(100) // Animates to 100\r\n * x.jump(0)  // Jumps to 0 immediately\r\n * ```\r\n */\r\nexport function createSpringValue(\r\n  initial: number,\r\n  config?: SpringConfig\r\n): SpringValue {\r\n  return new SpringValueImpl(initial, config)\r\n}\r\n\r\n// Re-export for type usage\r\nexport { SpringValueImpl as SpringValueClass }\r\n","import type { SpringConfig } from './config.js'\r\nimport { defaultConfig } from './config.js'\r\nimport { createSpringValue, type SpringValue } from './spring-value.js'\r\n\r\n/**\r\n * Spring group interface\r\n */\r\nexport interface SpringGroup<T extends Record<string, number>> {\r\n  /** Get all current values */\r\n  get(): T\r\n  /** Get a single value by key */\r\n  getValue(key: keyof T): number\r\n  /** Animate to new values (partial update) */\r\n  set(values: Partial<T>, config?: Partial<SpringConfig>): void\r\n  /** Set values immediately without animation */\r\n  jump(values: Partial<T>): void\r\n  /** Stop all animations at current position */\r\n  stop(): void\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (values: T) => void): () => void\r\n  /** Check if any spring is animating */\r\n  isAnimating(): boolean\r\n  /** Promise that resolves when all animations complete */\r\n  finished: Promise<void>\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Spring group implementation\r\n */\r\nclass SpringGroupImpl<T extends Record<string, number>> implements SpringGroup<T> {\r\n  private values: Map<keyof T, SpringValue>\r\n  private config: SpringConfig\r\n  private subscribers = new Set<(values: T) => void>()\r\n  private resolveComplete: (() => void) | null = null\r\n  private finishedPromise: Promise<void>\r\n  private notifyRafId: number | null = null\r\n  private destroyed = false\r\n\r\n  constructor(initialValues: T, config: SpringConfig = {}) {\r\n    this.config = { ...defaultConfig, ...config }\r\n\r\n    // Create SpringValue for each key\r\n    this.values = new Map()\r\n    for (const [key, value] of Object.entries(initialValues)) {\r\n      const springValue = createSpringValue(value, this.config)\r\n      springValue.subscribe(() => this.scheduleNotify())\r\n      this.values.set(key as keyof T, springValue)\r\n    }\r\n\r\n    this.finishedPromise = Promise.resolve()\r\n\r\n    // Initialize promise handler\r\n    this.resetPromise()\r\n  }\r\n\r\n  private resetPromise(): void {\r\n    this.finishedPromise = new Promise((resolve) => {\r\n      this.resolveComplete = resolve\r\n    })\r\n  }\r\n\r\n  get(): T {\r\n    const result = {} as T\r\n    for (const [key, springValue] of this.values) {\r\n      (result as Record<string, number>)[key as string] = springValue.get()\r\n    }\r\n    return result\r\n  }\r\n\r\n  getValue(key: keyof T): number {\r\n    return this.values.get(key)?.get() ?? 0\r\n  }\r\n\r\n  set(values: Partial<T>, config: Partial<SpringConfig> = {}): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    // Reset promise for new batch of animations\r\n    this.resetPromise()\r\n\r\n    const promises: Promise<void>[] = []\r\n\r\n    for (const [key, value] of Object.entries(values)) {\r\n      const springValue = this.values.get(key as keyof T)\r\n      if (springValue && typeof value === 'number') {\r\n        springValue.set(value, config)\r\n        promises.push(springValue.finished)\r\n      }\r\n    }\r\n\r\n    // Resolve when all animations complete\r\n    Promise.all(promises).then(() => {\r\n      if (this.resolveComplete && !this.destroyed) {\r\n        this.resolveComplete()\r\n      }\r\n    })\r\n  }\r\n\r\n  jump(values: Partial<T>): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    for (const [key, value] of Object.entries(values)) {\r\n      const springValue = this.values.get(key as keyof T)\r\n      if (springValue && typeof value === 'number') {\r\n        springValue.jump(value)\r\n      }\r\n    }\r\n    // Note: notify() is already called by the spring subscriptions, so we don't call it again\r\n  }\r\n\r\n  stop(): void {\r\n    for (const springValue of this.values.values()) {\r\n      springValue.stop()\r\n    }\r\n    // Resolve the promise since animations are stopped\r\n    this.resolveComplete?.()\r\n  }\r\n\r\n  subscribe(callback: (values: T) => void): () => void {\r\n    this.subscribers.add(callback)\r\n    // Immediately call with current values (with error isolation)\r\n    try {\r\n      callback(this.get())\r\n    } catch (e) {\r\n      console.error('[SpringKit] SpringGroup subscriber error:', e)\r\n    }\r\n    return () => this.subscribers.delete(callback)\r\n  }\r\n\r\n  isAnimating(): boolean {\r\n    for (const springValue of this.values.values()) {\r\n      if (springValue.isAnimating()) return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  get finished(): Promise<void> {\r\n    return this.finishedPromise\r\n  }\r\n\r\n  /**\r\n   * Schedule notification for next animation frame to prevent excessive updates.\r\n   * When animating multiple properties, this debounces notifications to once per frame\r\n   * instead of once per property update.\r\n   */\r\n  private scheduleNotify(): void {\r\n    // Skip if destroyed or already scheduled\r\n    if (this.destroyed || this.notifyRafId !== null) return\r\n\r\n    this.notifyRafId = requestAnimationFrame(() => {\r\n      this.notifyRafId = null\r\n      // Double-check destroyed state after RAF\r\n      if (!this.destroyed) {\r\n        this.notify()\r\n      }\r\n    })\r\n  }\r\n\r\n  private notify(): void {\r\n    const values = this.get()\r\n    for (const subscriber of this.subscribers) {\r\n      try {\r\n        subscriber(values)\r\n      } catch (e) {\r\n        console.error('[SpringKit] SpringGroup subscriber error:', e)\r\n      }\r\n    }\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Cancel pending RAF to prevent memory leak\r\n    if (this.notifyRafId !== null) {\r\n      cancelAnimationFrame(this.notifyRafId)\r\n      this.notifyRafId = null\r\n    }\r\n\r\n    for (const springValue of this.values.values()) {\r\n      springValue.destroy()\r\n    }\r\n\r\n    // Resolve pending promise to prevent memory leaks\r\n    this.resolveComplete?.()\r\n    this.resolveComplete = null\r\n\r\n    this.subscribers.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a spring group for animating multiple values together\r\n *\r\n * @param initialValues - Initial values object\r\n * @param config - Spring configuration\r\n * @returns Spring group controller\r\n *\r\n * @example\r\n * ```ts\r\n * const group = createSpringGroup(\r\n *   { x: 0, y: 0, scale: 1 },\r\n *   { stiffness: 100, damping: 10 }\r\n * )\r\n *\r\n * group.subscribe((values) => {\r\n *   element.style.transform = `\r\n *     translate(${values.x}px, ${values.y}px)\r\n *     scale(${values.scale})\r\n *   `\r\n * })\r\n *\r\n * group.set({ x: 100, scale: 1.5 })\r\n * ```\r\n */\r\nexport function createSpringGroup<T extends Record<string, number>>(\r\n  initialValues: T,\r\n  config?: SpringConfig\r\n): SpringGroup<T> {\r\n  return new SpringGroupImpl(initialValues, config)\r\n}\r\n\r\n// Re-export for type usage\r\nexport { SpringGroupImpl as SpringGroupClass }\r\n","/**\n * Variants System - Named animation states with cascading support\n *\n * Provides a declarative way to define and orchestrate animations\n * across component hierarchies.\n */\n\nimport type { SpringConfig } from './config.js'\n\n// ============ Types ============\n\n/**\n * Animation values that can be animated\n */\nexport interface AnimationValues {\n  x?: number | string\n  y?: number | string\n  scale?: number\n  scaleX?: number\n  scaleY?: number\n  rotate?: number\n  rotateX?: number\n  rotateY?: number\n  rotateZ?: number\n  skewX?: number\n  skewY?: number\n  opacity?: number\n  width?: number | string\n  height?: number | string\n  backgroundColor?: string\n  borderRadius?: number | string\n  borderColor?: string\n  boxShadow?: string\n  color?: string\n  [key: string]: number | string | VariantTransition | undefined\n}\n\n/**\n * Transition configuration for a variant\n */\nexport interface VariantTransition {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Stagger children by this amount (ms) */\n  staggerChildren?: number\n  /** Delay children by this amount (ms) */\n  delayChildren?: number\n  /** Animate children before or after parent */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Custom stagger direction */\n  staggerDirection?: 1 | -1\n  /** Duration override for non-spring animations */\n  duration?: number\n  /** Easing function */\n  ease?: (t: number) => number\n}\n\n/**\n * A single variant definition\n */\nexport interface Variant extends AnimationValues {\n  transition?: VariantTransition\n}\n\n/**\n * Map of variant names to their definitions\n */\nexport interface Variants {\n  [key: string]: Variant | ((custom?: unknown) => Variant)\n}\n\n/**\n * Orchestration options for variant animations\n */\nexport interface OrchestrationOptions {\n  /** Delay before starting */\n  delay?: number\n  /** Animate children before or after */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Stagger children animations */\n  staggerChildren?: number\n  /** Delay before children start */\n  delayChildren?: number\n  /** Direction of stagger (-1 for reverse) */\n  staggerDirection?: 1 | -1\n}\n\n/**\n * Resolved variant with all values computed\n */\nexport interface ResolvedVariant {\n  values: AnimationValues\n  transition: VariantTransition\n}\n\n// ============ Variant Resolution ============\n\n/**\n * Resolve a variant definition to concrete values\n */\nexport function resolveVariant(\n  variant: Variant | ((custom?: unknown) => Variant) | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variant) {\n    return { values: {}, transition: {} }\n  }\n\n  // Handle function variants\n  const resolved = typeof variant === 'function' ? variant(custom) : variant\n\n  // Extract transition from values\n  const { transition = {}, ...values } = resolved\n\n  return { values, transition }\n}\n\n/**\n * Get variant from variants object by name\n */\nexport function getVariant(\n  variants: Variants | undefined,\n  name: string | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variants || !name) {\n    return { values: {}, transition: {} }\n  }\n\n  return resolveVariant(variants[name], custom)\n}\n\n/**\n * Merge multiple variants together\n */\nexport function mergeVariants(...variants: (Variant | undefined)[]): Variant {\n  const merged: Variant = {}\n\n  for (const variant of variants) {\n    if (variant) {\n      Object.assign(merged, variant)\n      // Merge transitions\n      if (variant.transition) {\n        merged.transition = { ...merged.transition, ...variant.transition }\n      }\n    }\n  }\n\n  return merged\n}\n\n// ============ Animation Value Helpers ============\n\n/**\n * Check if a value is a transform property\n */\nexport function isTransformProperty(key: string): boolean {\n  return [\n    'x', 'y', 'z',\n    'scale', 'scaleX', 'scaleY', 'scaleZ',\n    'rotate', 'rotateX', 'rotateY', 'rotateZ',\n    'skew', 'skewX', 'skewY',\n    'perspective',\n    'transformOrigin',\n  ].includes(key)\n}\n\n/**\n * Check if a value is animatable\n */\nexport function isAnimatable(value: unknown): value is number | string {\n  return typeof value === 'number' || typeof value === 'string'\n}\n\n/**\n * Parse a value with unit (e.g., \"100px\" -> { value: 100, unit: \"px\" })\n */\nexport function parseValueWithUnit(value: string | number): { value: number; unit: string } {\n  if (typeof value === 'number') {\n    return { value, unit: '' }\n  }\n\n  const match = value.match(/^(-?[\\d.]+)(.*)$/)\n  if (match && match[1]) {\n    return { value: parseFloat(match[1]), unit: match[2] || '' }\n  }\n\n  return { value: 0, unit: '' }\n}\n\n/**\n * Build transform string from values\n */\nexport function buildTransformString(values: AnimationValues): string {\n  const transforms: string[] = []\n\n  if (values.x !== undefined || values.y !== undefined) {\n    const x = values.x ?? 0\n    const y = values.y ?? 0\n    transforms.push(`translate(${x}px, ${y}px)`)\n  }\n\n  if (values.scale !== undefined) {\n    transforms.push(`scale(${values.scale})`)\n  } else {\n    if (values.scaleX !== undefined) {\n      transforms.push(`scaleX(${values.scaleX})`)\n    }\n    if (values.scaleY !== undefined) {\n      transforms.push(`scaleY(${values.scaleY})`)\n    }\n  }\n\n  if (values.rotate !== undefined) {\n    transforms.push(`rotate(${values.rotate}deg)`)\n  }\n  if (values.rotateX !== undefined) {\n    transforms.push(`rotateX(${values.rotateX}deg)`)\n  }\n  if (values.rotateY !== undefined) {\n    transforms.push(`rotateY(${values.rotateY}deg)`)\n  }\n  if (values.rotateZ !== undefined) {\n    transforms.push(`rotateZ(${values.rotateZ}deg)`)\n  }\n\n  if (values.skewX !== undefined) {\n    transforms.push(`skewX(${values.skewX}deg)`)\n  }\n  if (values.skewY !== undefined) {\n    transforms.push(`skewY(${values.skewY}deg)`)\n  }\n\n  return transforms.join(' ')\n}\n\n/**\n * Apply animation values to an element's style\n */\nexport function applyValuesToElement(element: HTMLElement, values: AnimationValues): void {\n  const transform = buildTransformString(values)\n  if (transform) {\n    element.style.transform = transform\n  }\n\n  // Apply non-transform properties\n  if (values.opacity !== undefined) {\n    element.style.opacity = String(values.opacity)\n  }\n  if (values.backgroundColor !== undefined) {\n    element.style.backgroundColor = values.backgroundColor\n  }\n  if (values.borderRadius !== undefined) {\n    element.style.borderRadius =\n      typeof values.borderRadius === 'number' ? `${values.borderRadius}px` : values.borderRadius\n  }\n  if (values.borderColor !== undefined) {\n    element.style.borderColor = values.borderColor\n  }\n  if (values.boxShadow !== undefined) {\n    element.style.boxShadow = values.boxShadow\n  }\n  if (values.color !== undefined) {\n    element.style.color = values.color\n  }\n  if (values.width !== undefined) {\n    element.style.width =\n      typeof values.width === 'number' ? `${values.width}px` : values.width\n  }\n  if (values.height !== undefined) {\n    element.style.height =\n      typeof values.height === 'number' ? `${values.height}px` : values.height\n  }\n}\n\n// ============ Orchestration ============\n\n/**\n * Calculate stagger delays for children\n */\nexport function calculateStaggerDelays(\n  count: number,\n  options: OrchestrationOptions\n): number[] {\n  const { staggerChildren = 0, staggerDirection = 1, delayChildren = 0 } = options\n\n  const delays: number[] = []\n  for (let i = 0; i < count; i++) {\n    const index = staggerDirection === -1 ? count - 1 - i : i\n    delays.push(delayChildren + index * staggerChildren)\n  }\n\n  return delays\n}\n\n/**\n * Create an orchestrated animation sequence\n */\nexport interface OrchestrationSequence {\n  /** Execute parent animation */\n  parent: () => Promise<void>\n  /** Execute children animations */\n  children: () => Promise<void>\n  /** Execute all with proper ordering */\n  execute: () => Promise<void>\n}\n\nexport function createOrchestration(\n  parentAnim: () => Promise<void>,\n  childrenAnims: (() => Promise<void>)[],\n  options: OrchestrationOptions = {}\n): OrchestrationSequence {\n  const { when = false, delay = 0 } = options\n  const delays = calculateStaggerDelays(childrenAnims.length, options)\n\n  const parent = async () => {\n    if (delay > 0) {\n      await new Promise((resolve) => setTimeout(resolve, delay))\n    }\n    await parentAnim()\n  }\n\n  const children = async () => {\n    await Promise.all(\n      childrenAnims.map((anim, i) =>\n        new Promise<void>((resolve) => {\n          setTimeout(async () => {\n            await anim()\n            resolve()\n          }, delays[i])\n        })\n      )\n    )\n  }\n\n  const execute = async () => {\n    switch (when) {\n      case 'beforeChildren':\n        await parent()\n        await children()\n        break\n      case 'afterChildren':\n        await children()\n        await parent()\n        break\n      default:\n        // Run in parallel\n        await Promise.all([parent(), children()])\n    }\n  }\n\n  return { parent, children, execute }\n}\n\n// ============ Variant Presets ============\n\n/**\n * Common animation presets\n */\nexport const variantPresets: Record<string, { initial: Variant; animate: Variant; exit: Variant }> = {\n  /** Fade in from invisible */\n  fadeIn: {\n    initial: { opacity: 0 },\n    animate: { opacity: 1 },\n    exit: { opacity: 0 },\n  },\n\n  /** Fade in and slide up */\n  fadeInUp: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n\n  /** Fade in and slide down */\n  fadeInDown: {\n    initial: { opacity: 0, y: -20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: 20 },\n  },\n\n  /** Fade in and slide from left */\n  fadeInLeft: {\n    initial: { opacity: 0, x: -20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: 20 },\n  },\n\n  /** Fade in and slide from right */\n  fadeInRight: {\n    initial: { opacity: 0, x: 20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: -20 },\n  },\n\n  /** Scale up from small */\n  scaleIn: {\n    initial: { opacity: 0, scale: 0.8 },\n    animate: { opacity: 1, scale: 1 },\n    exit: { opacity: 0, scale: 0.8 },\n  },\n\n  /** Pop in with overshoot */\n  popIn: {\n    initial: { opacity: 0, scale: 0.5 },\n    animate: {\n      opacity: 1,\n      scale: 1,\n      transition: { spring: { stiffness: 400, damping: 15 } },\n    },\n    exit: { opacity: 0, scale: 0.5 },\n  },\n\n  /** Slide in from bottom (percentage-based) */\n  slideUp: {\n    initial: { y: 100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: 100, opacity: 0 },\n  },\n\n  /** Slide in from top */\n  slideDown: {\n    initial: { y: -100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: -100, opacity: 0 },\n  },\n\n  /** Slide in from left */\n  slideLeft: {\n    initial: { x: -100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: -100, opacity: 0 },\n  },\n\n  /** Slide in from right */\n  slideRight: {\n    initial: { x: 100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: 100, opacity: 0 },\n  },\n\n  /** Container with staggered children */\n  staggerContainer: {\n    initial: {},\n    animate: {\n      transition: {\n        staggerChildren: 0.1,\n        delayChildren: 0.1,\n      },\n    },\n    exit: {\n      transition: {\n        staggerChildren: 0.05,\n        staggerDirection: -1,\n      },\n    },\n  },\n\n  /** Item for staggered lists */\n  staggerItem: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n}\n\n/**\n * Create a custom variant preset\n */\nexport function createVariantPreset(\n  initial: Variant,\n  animate: Variant,\n  exit?: Variant\n): { initial: Variant; animate: Variant; exit: Variant } {\n  return {\n    initial,\n    animate,\n    exit: exit || initial,\n  }\n}\n\n// ============ Type Guards ============\n\n/**\n * Check if a value is a Variants object\n */\nexport function isVariants(value: unknown): value is Variants {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    !Array.isArray(value) &&\n    Object.values(value).every(\n      (v) => typeof v === 'object' || typeof v === 'function'\n    )\n  )\n}\n\n/**\n * Check if a value is a Variant\n */\nexport function isVariant(value: unknown): value is Variant {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n}\n","import type { SpringAnimation } from '../core/spring.js'\n\n/**\n * Stagger options interface\n */\nexport interface StaggerOptions {\n  /** Delay between animations (ms) or function returning delay */\n  delay?: number | ((index: number) => number)\n  /** Where to start staggering from */\n  from?: 'first' | 'last' | 'center' | number\n}\n\n/**\n * Run animations one after another (sequentially)\n *\n * @param animations - Array of functions that create animations\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * await sequence([\n *   () => spring(0, 100, { onUpdate: updateOpacity }).start(),\n *   () => spring(0, 200, { onUpdate: updateX }).start(),\n *   () => spring(0, 50, { onUpdate: updateY }).start(),\n * ])\n *\n * console.log('All animations complete!')\n * ```\n */\nexport async function sequence(\n  animations: Array<() => SpringAnimation>\n): Promise<void> {\n  for (const createAnimation of animations) {\n    const anim = createAnimation()\n    await anim.finished\n  }\n}\n\n/**\n * Run animations simultaneously (in parallel)\n *\n * @param animations - Array of functions that create animations\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * await parallel([\n *   () => spring(0, 100, { onUpdate: updateOpacity }).start(),\n *   () => spring(0, 200, { onUpdate: updateX }).start(),\n *   () => spring(1, 2, { onUpdate: updateScale }).start(),\n * ])\n *\n * console.log('All animations complete!')\n * ```\n */\nexport async function parallel(\n  animations: Array<() => SpringAnimation>\n): Promise<void> {\n  const promises = animations.map((createAnimation) => {\n    const anim = createAnimation()\n    return anim.finished\n  })\n  await Promise.all(promises)\n}\n\n/**\n * Run animations with staggered delays\n *\n * @param items - Array of items to animate\n * @param animate - Function that creates an animation for each item\n * @param options - Stagger options\n * @returns Promise that resolves when all animations complete\n *\n * @example\n * ```ts\n * const elements = document.querySelectorAll('.item')\n *\n * await stagger(\n *   elements,\n *   (element, index) => {\n *     return spring(0, 1, {\n *       onUpdate: (value) => {\n *         element.style.opacity = String(value)\n *       },\n *     }).start()\n *   },\n *   { delay: 50 }\n * )\n * ```\n */\nexport async function stagger<T>(\n  items: T[],\n  animate: (item: T, index: number) => SpringAnimation,\n  options: StaggerOptions = {}\n): Promise<void> {\n  const { delay = 0, from = 'first' } = options\n\n  // Calculate start index based on 'from' option\n  let startIndex = 0\n  if (from === 'last') startIndex = items.length - 1\n  else if (from === 'center') startIndex = Math.floor(items.length / 2)\n  else if (typeof from === 'number') startIndex = from\n\n  // Build index order from start point outward\n  const indices: number[] = []\n  const used = new Set<number>()\n\n  indices.push(startIndex)\n  used.add(startIndex)\n\n  for (let offset = 1; offset < items.length; offset++) {\n    const left = startIndex - offset\n    const right = startIndex + offset\n\n    // Add right first if it exists\n    if (right < items.length && !used.has(right)) {\n      indices.push(right)\n      used.add(right)\n    }\n\n    // Then add left if it exists\n    if (left >= 0 && !used.has(left)) {\n      indices.push(left)\n      used.add(left)\n    }\n  }\n\n  // All indices are already added by the main loop above\n  // No need for defensive fallback as the logic is complete\n\n  // Start animations with delay\n  const getDelay = typeof delay === 'function' ? delay : (_i: number) => delay\n  const animations: SpringAnimation[] = []\n  const timeoutIds: ReturnType<typeof setTimeout>[] = []\n\n  for (let i = 0; i < indices.length; i++) {\n    const index = indices[i]!\n    const anim = animate(items[index]!, index)\n    animations.push(anim)\n\n    const delayMs = getDelay(i)\n\n    if (delayMs > 0) {\n      const timeoutId = setTimeout(() => {\n        anim.start()\n      }, delayMs)\n      timeoutIds.push(timeoutId)\n    } else {\n      anim.start()\n    }\n  }\n\n  try {\n    await Promise.all(animations.map((a) => a.finished))\n  } finally {\n    // Clear any remaining timeouts on completion or error\n    timeoutIds.forEach(clearTimeout)\n  }\n}\n","import type { SpringConfig } from '../core/config.js'\r\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\r\n\r\n/**\r\n * Trail configuration interface\r\n */\r\nexport interface TrailConfig extends SpringConfig {\r\n  /** Frames delay between items following each other */\r\n  followDelay?: number\r\n}\r\n\r\n/**\r\n * Trail interface\r\n */\r\nexport interface Trail {\r\n  /** Set the leader value (followers will follow with delay) */\r\n  set(value: number): void\r\n  /** Set all values immediately without animation */\r\n  jump(value: number): void\r\n  /** Get all current values */\r\n  getValues(): number[]\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (values: number[]) => void): () => void\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Trail implementation\r\n * Creates a chain of springs where each spring follows the previous one\r\n */\r\nclass TrailImpl implements Trail {\r\n  private springs: SpringValue[]\r\n  private leader: SpringValue\r\n  private followDelay: number\r\n  private subscribers = new Set<(values: number[]) => void>()\r\n  private frameCount: number = 0\r\n  private pendingUpdates: Map<number, number> = new Map()\r\n  // Track timeout IDs for cleanup to prevent memory leaks\r\n  private pendingTimeouts: Set<ReturnType<typeof setTimeout>> = new Set()\r\n  private destroyed = false\r\n\r\n  constructor(count: number, config: TrailConfig = {}) {\r\n    const { followDelay = 2, ...springConfig } = config\r\n\r\n    this.followDelay = followDelay\r\n\r\n    // Create leader spring\r\n    this.leader = createSpringValue(0, springConfig)\r\n\r\n    // Create follower springs\r\n    this.springs = []\r\n    for (let i = 0; i < count; i++) {\r\n      const spring = createSpringValue(0, springConfig)\r\n      this.springs.push(spring)\r\n    }\r\n\r\n    // Connect leader to followers with delay\r\n    this.leader.subscribe(() => {\r\n      this.frameCount++\r\n      this.scheduleFollowerUpdates()\r\n    })\r\n  }\r\n\r\n  private scheduleFollowerUpdates(): void {\r\n    const targetValue = this.leader.get()\r\n\r\n    for (let i = 0; i < this.springs.length; i++) {\r\n      const delayFrames = (i + 1) * this.followDelay\r\n      const targetFrame = this.frameCount + delayFrames\r\n\r\n      // Store the pending update\r\n      this.pendingUpdates.set(i, targetFrame)\r\n\r\n      // Schedule the update\r\n      this.scheduleFollowerUpdate(i, targetValue, targetFrame, delayFrames)\r\n    }\r\n  }\r\n\r\n  private scheduleFollowerUpdate(\r\n    index: number,\r\n    targetValue: number,\r\n    targetFrame: number,\r\n    _delayFrames: number\r\n  ): void {\r\n    const startFrame = this.frameCount\r\n    const framesToWait = targetFrame - startFrame\r\n\r\n    if (framesToWait <= 0) {\r\n      // Update immediately if delay has passed\r\n      this.springs[index]!.set(targetValue)\r\n    } else {\r\n      // Use setTimeout for delay (approximately 16ms per frame at 60fps)\r\n      const delayMs = Math.max(framesToWait * 16, 0)\r\n\r\n      const timeoutId = setTimeout(() => {\r\n        // Remove from pending set\r\n        this.pendingTimeouts.delete(timeoutId)\r\n\r\n        // Skip if destroyed or not the current pending update\r\n        if (this.destroyed) return\r\n        const currentTarget = this.pendingUpdates.get(index)\r\n        if (currentTarget === targetFrame) {\r\n          this.springs[index]!.set(targetValue)\r\n        }\r\n      }, delayMs)\r\n\r\n      // Track timeout for cleanup\r\n      this.pendingTimeouts.add(timeoutId)\r\n    }\r\n  }\r\n\r\n  set(value: number): void {\r\n    this.leader.set(value)\r\n  }\r\n\r\n  jump(value: number): void {\r\n    this.leader.jump(value)\r\n    for (const spring of this.springs) {\r\n      spring.jump(value)\r\n    }\r\n  }\r\n\r\n  getValues(): number[] {\r\n    return this.springs.map((s) => s.get())\r\n  }\r\n\r\n  subscribe(callback: (values: number[]) => void): () => void {\r\n    this.subscribers.add(callback)\r\n\r\n    // Subscribe to each follower spring\r\n    const unsubscribers: (() => void)[] = []\r\n    for (const spring of this.springs) {\r\n      unsubscribers.push(\r\n        spring.subscribe(() => {\r\n          this.notify()\r\n        })\r\n      )\r\n    }\r\n\r\n    // Immediately call with current values\r\n    callback(this.getValues())\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      this.subscribers.delete(callback)\r\n      for (const unsubscribe of unsubscribers) {\r\n        unsubscribe()\r\n      }\r\n    }\r\n  }\r\n\r\n  private notify(): void {\r\n    const values = this.getValues()\r\n    for (const subscriber of this.subscribers) {\r\n      subscriber(values)\r\n    }\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Clear all pending timeouts to prevent memory leaks\r\n    for (const timeoutId of this.pendingTimeouts) {\r\n      clearTimeout(timeoutId)\r\n    }\r\n    this.pendingTimeouts.clear()\r\n\r\n    this.leader.destroy()\r\n    for (const spring of this.springs) {\r\n      spring.destroy()\r\n    }\r\n    this.subscribers.clear()\r\n    this.pendingUpdates.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a trail animation\r\n *\r\n * @param count - Number of items in the trail\r\n * @param config - Trail configuration\r\n * @returns Trail controller\r\n *\r\n * @example\r\n * ```ts\r\n * const trail = createTrail(5, {\r\n *   stiffness: 200,\r\n *   damping: 25,\r\n *   followDelay: 3,\r\n * })\r\n *\r\n * trail.subscribe((values) => {\r\n *   elements.forEach((el, i) => {\r\n *     el.style.transform = `translateX(${values[i]}px)`\r\n *   })\r\n * })\r\n *\r\n * trail.set(100) // First item moves immediately, others follow\r\n * ```\r\n */\r\nexport function createTrail(count: number, config?: TrailConfig): Trail {\r\n  return new TrailImpl(count, config)\r\n}\r\n","import { globalLoop, type Animatable, AnimationState } from './loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateDecayConfig, validateAnimationValue } from '../utils/warnings.js'\n\n/**\n * Decay animation configuration interface\n */\nexport interface DecayConfig {\n  /** Initial velocity */\n  velocity: number\n  /** Deceleration factor (0-1, higher = slower decay) */\n  deceleration?: number\n  /** Optional clamp range [min, max] */\n  clamp?: [number, number]\n  /** Callback called on each update */\n  onUpdate?: (value: number) => void\n  /** Callback called when complete */\n  onComplete?: () => void\n}\n\n/**\n * Decay animation interface\n */\nexport interface DecayAnimation {\n  /** Start the decay animation */\n  start(): DecayAnimation\n  /** Stop the decay animation */\n  stop(): void\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n}\n\n/**\n * Decay animation implementation\n * Simulates natural momentum/deceleration\n */\nclass DecayAnimationImpl implements DecayAnimation, Animatable {\n  private value: number\n  private velocity: number\n  private deceleration: number\n  private clampRange: [number, number] | undefined\n  private state: AnimationState = AnimationState.Idle\n  private rafId: number | null = null\n  private resolveComplete: (() => void) | null = null\n  private config: DecayConfig\n\n  finished: Promise<void>\n\n  constructor(config: DecayConfig) {\n    // Validate config in development mode\n    validateDecayConfig(config)\n\n    this.value = 0\n    // Validate velocity for NaN/Infinity\n    this.velocity = validateAnimationValue(config.velocity, 'decay.velocity')\n    // Validate and clamp deceleration to valid range\n    const rawDecel = config.deceleration ?? 0.998\n    this.deceleration = validateAnimationValue(rawDecel, 'decay.deceleration')\n    // Clamp deceleration to (0, 1) range to prevent infinite loops or instant stops\n    if (this.deceleration <= 0 || this.deceleration >= 1) {\n      this.deceleration = 0.998\n    }\n    this.clampRange = config.clamp\n    this.state = AnimationState.Idle\n    this.config = config\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): DecayAnimation {\n    if (this.state === AnimationState.Running) return this\n    this.state = AnimationState.Running\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    // Apply deceleration\n    this.velocity *= this.deceleration\n    this.value += this.velocity\n\n    // Apply clamp\n    if (this.clampRange) {\n      const [min, max] = this.clampRange\n      this.value = clamp(this.value, min, max)\n\n      // Stop if we hit a boundary with velocity in that direction\n      if ((this.value <= min && this.velocity < 0) || (this.value >= max && this.velocity > 0)) {\n        this.velocity = 0\n      }\n    }\n\n    this.config.onUpdate?.(this.value)\n\n    // Check if stopped\n    if (Math.abs(this.velocity) < 0.01) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.config.onComplete?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  destroy(): void {\n    this.stop()\n    // Resolve promise to prevent memory leaks\n    this.resolveComplete?.()\n    this.resolveComplete = null\n    this.config.onUpdate = undefined\n    this.config.onComplete = undefined\n  }\n}\n\n/**\n * Create a decay animation\n *\n * @param config - Decay configuration\n * @returns Decay animation controller\n *\n * @example\n * ```ts\n * const anim = decay({\n *   velocity: 1000,\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function decay(config: DecayConfig): DecayAnimation {\n  return new DecayAnimationImpl(config)\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Keyframe definition with optional per-keyframe config\n */\nexport interface Keyframe<T = number> {\n  /** Target value at this keyframe */\n  value: T\n  /** Time position (0-1) for this keyframe. If not provided, evenly distributed */\n  at?: number\n  /** Spring config override for transition TO this keyframe */\n  config?: SpringConfig\n}\n\n/**\n * Options for keyframe animation\n */\nexport interface KeyframesOptions {\n  /** Default spring configuration */\n  config?: SpringConfig\n  /** Time positions for keyframes (0-1). Length must match values array */\n  times?: number[]\n  /** Callback for each keyframe transition start */\n  onKeyframe?: (index: number) => void\n  /** Callback when all keyframes complete */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (value: number) => void\n}\n\n/**\n * Keyframes animation controller\n */\nexport interface KeyframesAnimation {\n  /** Start the animation */\n  play: () => Promise<void>\n  /** Pause the animation */\n  pause: () => void\n  /** Resume a paused animation */\n  resume: () => void\n  /** Stop and reset to initial value */\n  stop: () => void\n  /** Get current value */\n  get: () => number\n  /** Get current keyframe index */\n  getCurrentKeyframe: () => number\n  /** Check if animation is playing */\n  isPlaying: () => boolean\n  /** Jump to specific keyframe */\n  jumpTo: (index: number) => void\n  /** Destroy and cleanup */\n  destroy: () => void\n}\n\n/**\n * Create a keyframe-based spring animation.\n * Animates through a sequence of values using spring physics.\n *\n * @example Basic keyframes\n * ```ts\n * const anim = keyframes([0, 100, 50, 100], {\n *   config: { stiffness: 200, damping: 20 },\n *   onUpdate: (value) => element.style.opacity = value / 100,\n * })\n * await anim.play()\n * ```\n *\n * @example With time positions\n * ```ts\n * const anim = keyframes([0, 100, 0], {\n *   times: [0, 0.3, 1], // 100 at 30%, back to 0 at 100%\n *   onUpdate: (value) => console.log(value),\n * })\n * ```\n *\n * @example With per-keyframe configs\n * ```ts\n * const anim = keyframes([\n *   { value: 0 },\n *   { value: 100, config: { stiffness: 500 } }, // Quick to 100\n *   { value: 50, config: { stiffness: 100 } },  // Slow to 50\n * ])\n * ```\n */\nexport function keyframes(\n  values: (number | Keyframe<number>)[],\n  options: KeyframesOptions = {}\n): KeyframesAnimation {\n  const {\n    config = {},\n    times,\n    onKeyframe,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Normalize keyframes\n  const normalizedKeyframes = values.map((v, i): Keyframe<number> => {\n    if (typeof v === 'number') {\n      return {\n        value: v,\n        at: times?.[i],\n      }\n    }\n    return { ...v, at: v.at ?? times?.[i] }\n  })\n\n  // Fill in missing time positions (evenly distributed)\n  const keyframeCount = normalizedKeyframes.length\n  normalizedKeyframes.forEach((kf, i) => {\n    if (kf.at === undefined) {\n      kf.at = keyframeCount > 1 ? i / (keyframeCount - 1) : 0\n    }\n  })\n\n  // Sort by time position\n  normalizedKeyframes.sort((a, b) => (a.at ?? 0) - (b.at ?? 0))\n\n  // State\n  let currentIndex = 0\n  let isPlaying = false\n  let isPaused = false\n  let spring: ReturnType<typeof createSpringValue> | null = null\n  let currentValue = normalizedKeyframes[0]?.value ?? 0\n  let destroyed = false\n  // Track pending RAF and timeout IDs for cleanup\n  let pendingRafId: number | null = null\n  let pendingTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  const createSpring = () => {\n    if (spring) {\n      spring.destroy()\n    }\n\n    const currentKf = normalizedKeyframes[currentIndex]\n    const springConfig = currentKf?.config ?? config\n\n    spring = createSpringValue(currentValue, springConfig)\n    spring.subscribe((value) => {\n      currentValue = value\n      onUpdate?.(value)\n    })\n  }\n\n  const animateToNext = async (): Promise<boolean> => {\n    if (destroyed || isPaused) return false\n    if (currentIndex >= normalizedKeyframes.length - 1) return false\n\n    currentIndex++\n    const targetKf = normalizedKeyframes[currentIndex]\n    if (!targetKf) return false\n\n    // Create new spring with keyframe-specific config if needed\n    if (targetKf.config) {\n      createSpring()\n    }\n\n    onKeyframe?.(currentIndex)\n\n    if (spring) {\n      spring.set(targetKf.value)\n\n      // Wait for spring to settle\n      await new Promise<void>((resolve) => {\n        const checkComplete = () => {\n          pendingRafId = null\n\n          if (destroyed || isPaused) {\n            resolve()\n            return\n          }\n\n          if (spring && !spring.isAnimating()) {\n            resolve()\n          } else {\n            pendingRafId = requestAnimationFrame(checkComplete)\n          }\n        }\n        // Give spring time to start\n        pendingTimeoutId = setTimeout(() => {\n          pendingTimeoutId = null\n          if (!destroyed) {\n            checkComplete()\n          } else {\n            resolve()\n          }\n        }, 16)\n      })\n    }\n\n    return true\n  }\n\n  const animation: KeyframesAnimation = {\n    play: async () => {\n      if (destroyed) return\n      if (isPlaying) return\n\n      isPlaying = true\n      isPaused = false\n\n      // Reset if at end\n      if (currentIndex >= normalizedKeyframes.length - 1) {\n        currentIndex = 0\n        currentValue = normalizedKeyframes[0]?.value ?? 0\n      }\n\n      createSpring()\n      onKeyframe?.(0)\n\n      // Animate through all keyframes\n      while (await animateToNext()) {\n        // Continue to next keyframe\n      }\n\n      if (!isPaused && !destroyed) {\n        isPlaying = false\n        onComplete?.()\n      }\n    },\n\n    pause: () => {\n      isPaused = true\n      isPlaying = false\n      if (spring) {\n        spring.stop()\n      }\n    },\n\n    resume: () => {\n      if (!isPaused || destroyed) return\n      isPaused = false\n      isPlaying = true\n\n      // Continue from current position\n      const continueAnimation = async () => {\n        while (await animateToNext()) {\n          // Continue to next keyframe\n        }\n\n        if (!isPaused && !destroyed) {\n          isPlaying = false\n          onComplete?.()\n        }\n      }\n\n      continueAnimation()\n    },\n\n    stop: () => {\n      isPaused = false\n      isPlaying = false\n      currentIndex = 0\n      currentValue = normalizedKeyframes[0]?.value ?? 0\n\n      if (spring) {\n        spring.jump(currentValue)\n      }\n    },\n\n    get: () => currentValue,\n\n    getCurrentKeyframe: () => currentIndex,\n\n    isPlaying: () => isPlaying,\n\n    jumpTo: (index: number) => {\n      if (index < 0 || index >= normalizedKeyframes.length) return\n\n      currentIndex = index\n      const targetValue = normalizedKeyframes[index]?.value ?? 0\n      currentValue = targetValue\n\n      if (spring) {\n        spring.jump(targetValue)\n      }\n\n      onUpdate?.(targetValue)\n      onKeyframe?.(index)\n    },\n\n    destroy: () => {\n      destroyed = true\n      isPlaying = false\n      isPaused = false\n\n      // Cancel pending RAF and timeout to prevent memory leaks\n      if (pendingRafId !== null) {\n        cancelAnimationFrame(pendingRafId)\n        pendingRafId = null\n      }\n      if (pendingTimeoutId !== null) {\n        clearTimeout(pendingTimeoutId)\n        pendingTimeoutId = null\n      }\n\n      if (spring) {\n        spring.destroy()\n        spring = null\n      }\n    },\n  }\n\n  return animation\n}\n\n/**\n * Helper to create a keyframe sequence from an array shorthand\n *\n * @example\n * ```ts\n * // Equivalent to: keyframes([0, 100, 50])\n * const values = parseKeyframeArray([0, 100, 50])\n * ```\n */\nexport function parseKeyframeArray(\n  values: number[],\n  times?: number[]\n): Keyframe<number>[] {\n  return values.map((value, index) => ({\n    value,\n    at: times?.[index],\n  }))\n}\n\n/**\n * Check if a value is a keyframe array (for animate prop detection)\n */\nexport function isKeyframeArray(value: unknown): value is number[] {\n  return Array.isArray(value) && value.every((v) => typeof v === 'number')\n}\n","/**\n * Imperative animate function for direct element animation\n *\n * Similar to Framer Motion's animate() function - allows animating elements\n * without React hooks.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\nexport interface AnimateTarget {\n  [property: string]: number | string | number[] | string[]\n}\n\nexport interface AnimateOptions {\n  /** Spring stiffness */\n  stiffness?: number\n  /** Spring damping */\n  damping?: number\n  /** Spring mass */\n  mass?: number\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Duration hint for non-spring animations */\n  duration?: number\n  /** Ease function for non-spring animations */\n  ease?: (t: number) => number\n  /** Called on each frame with current values */\n  onUpdate?: (values: Record<string, number>) => void\n  /** Called when animation completes */\n  onComplete?: () => void\n}\n\nexport interface AnimateControls {\n  /** Stop the animation */\n  stop: () => void\n  /** Pause the animation */\n  pause: () => void\n  /** Resume a paused animation */\n  resume: () => void\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Check if animation is running */\n  isAnimating: () => boolean\n  /** Promise that resolves when animation completes */\n  finished: Promise<void>\n}\n\n// Transform properties that should be combined\nconst transformProperties = new Set([\n  'x', 'y', 'z',\n  'scale', 'scaleX', 'scaleY', 'scaleZ',\n  'rotate', 'rotateX', 'rotateY', 'rotateZ',\n  'skew', 'skewX', 'skewY',\n])\n\n// Properties that need 'px' suffix\nconst pxProperties = new Set([\n  'x', 'y', 'z',\n  'width', 'height',\n  'top', 'right', 'bottom', 'left',\n  'padding', 'paddingTop', 'paddingRight', 'paddingBottom', 'paddingLeft',\n  'margin', 'marginTop', 'marginRight', 'marginBottom', 'marginLeft',\n  'borderWidth', 'borderRadius',\n  'fontSize', 'letterSpacing', 'lineHeight',\n])\n\nfunction buildTransform(values: Map<string, number>): string {\n  const parts: string[] = []\n\n  const x = values.get('x')\n  const y = values.get('y')\n  const z = values.get('z')\n\n  if (x !== undefined || y !== undefined || z !== undefined) {\n    parts.push(`translate3d(${x ?? 0}px, ${y ?? 0}px, ${z ?? 0}px)`)\n  }\n\n  const scale = values.get('scale')\n  const scaleX = values.get('scaleX')\n  const scaleY = values.get('scaleY')\n\n  if (scale !== undefined) {\n    parts.push(`scale(${scale})`)\n  } else if (scaleX !== undefined || scaleY !== undefined) {\n    parts.push(`scale(${scaleX ?? 1}, ${scaleY ?? 1})`)\n  }\n\n  const rotate = values.get('rotate') ?? values.get('rotateZ')\n  const rotateX = values.get('rotateX')\n  const rotateY = values.get('rotateY')\n\n  if (rotateX !== undefined) parts.push(`rotateX(${rotateX}deg)`)\n  if (rotateY !== undefined) parts.push(`rotateY(${rotateY}deg)`)\n  if (rotate !== undefined) parts.push(`rotate(${rotate}deg)`)\n\n  const skewX = values.get('skewX')\n  const skewY = values.get('skewY')\n  if (skewX !== undefined || skewY !== undefined) {\n    parts.push(`skew(${skewX ?? 0}deg, ${skewY ?? 0}deg)`)\n  }\n\n  return parts.join(' ')\n}\n\nfunction applyStylesToElement(element: Element, values: Map<string, number>): void {\n  const el = element as HTMLElement\n  const transformValues = new Map<string, number>()\n  const styleValues: Record<string, string> = {}\n\n  values.forEach((value, property) => {\n    if (transformProperties.has(property)) {\n      transformValues.set(property, value)\n    } else if (property === 'opacity') {\n      styleValues.opacity = String(value)\n    } else if (pxProperties.has(property)) {\n      styleValues[property] = `${value}px`\n    } else {\n      styleValues[property] = String(value)\n    }\n  })\n\n  if (transformValues.size > 0) {\n    el.style.transform = buildTransform(transformValues)\n  }\n\n  Object.entries(styleValues).forEach(([prop, val]) => {\n    el.style.setProperty(prop, val)\n  })\n}\n\nfunction parseCurrentValue(element: Element, property: string): number {\n  const el = element as HTMLElement\n  const computed = getComputedStyle(el)\n\n  if (property === 'opacity') {\n    return parseFloat(computed.opacity) || 1\n  }\n\n  if (transformProperties.has(property)) {\n    // Parse from transform matrix - simplified, return 0 as default\n    const transform = computed.transform\n    if (transform === 'none') {\n      if (property === 'scale' || property === 'scaleX' || property === 'scaleY') {\n        return 1\n      }\n      return 0\n    }\n    // For complex parsing, return sensible defaults\n    if (property === 'scale' || property === 'scaleX' || property === 'scaleY') {\n      return 1\n    }\n    return 0\n  }\n\n  const value = computed.getPropertyValue(property)\n  return parseFloat(value) || 0\n}\n\n/**\n * Animate an element or selector with spring physics\n *\n * @example Basic usage\n * ```ts\n * import { animate } from '@oxog/springkit'\n *\n * // Animate a single element\n * const controls = animate(element, { x: 100, opacity: 0.5 })\n *\n * // Wait for completion\n * await controls.finished\n * ```\n *\n * @example With selector\n * ```ts\n * animate('.box', { scale: 1.2, rotate: 45 }, {\n *   stiffness: 300,\n *   damping: 20,\n *   onComplete: () => console.log('Done!')\n * })\n * ```\n *\n * @example Keyframes\n * ```ts\n * animate(element, { opacity: [0, 1, 0.5, 1] })\n * ```\n *\n * @example Control animation\n * ```ts\n * const controls = animate(element, { x: 200 })\n * controls.pause()\n * controls.resume()\n * controls.stop()\n * ```\n */\nexport function animate(\n  elementOrSelector: Element | string,\n  target: AnimateTarget,\n  options: AnimateOptions = {}\n): AnimateControls {\n  const { delay = 0, onUpdate, onComplete, ...springConfig } = options\n\n  // Resolve element\n  const element = typeof elementOrSelector === 'string'\n    ? document.querySelector(elementOrSelector)\n    : elementOrSelector\n\n  if (!element) {\n    console.warn('animate: Element not found')\n    return createNoopControls()\n  }\n\n  const springs = new Map<string, SpringValue>()\n  const currentValues = new Map<string, number>()\n  let isRunning = true\n  let isPaused = false\n  let resolveFinished: () => void\n  // Track RAF IDs and timeout IDs separately for proper cleanup\n  const rafIds = new Set<number>()\n  const timeoutIds = new Set<ReturnType<typeof setTimeout>>()\n  let delayTimeoutId: ReturnType<typeof setTimeout> | null = null\n\n  const finished = new Promise<void>((resolve, _reject) => {\n    resolveFinished = resolve\n  })\n\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const checkAllComplete = () => {\n    let allComplete = true\n    springs.forEach((spring) => {\n      if (spring.isAnimating()) {\n        allComplete = false\n      }\n    })\n    return allComplete\n  }\n\n  const startAnimation = () => {\n    const entries = Object.entries(target)\n    let completedCount = 0\n    const totalAnimations = entries.length\n\n    entries.forEach(([property, value]) => {\n      const values = Array.isArray(value) ? value : [value]\n      const startValue = parseCurrentValue(element, property)\n\n      // Create spring for this property\n      const spring = createSpringValue(startValue, {\n        stiffness: springConfig.stiffness ?? 100,\n        damping: springConfig.damping ?? 10,\n        mass: springConfig.mass ?? 1,\n      })\n\n      springs.set(property, spring)\n      currentValues.set(property, startValue)\n\n      // Subscribe to updates\n      spring.subscribe((v) => {\n        if (!isRunning || isPaused) return\n        currentValues.set(property, v)\n        applyStylesToElement(element, currentValues)\n\n        if (onUpdate) {\n          const valuesObj: Record<string, number> = {}\n          currentValues.forEach((val, key) => {\n            valuesObj[key] = val\n          })\n          onUpdate(valuesObj)\n        }\n      })\n\n      // Animate through keyframes sequentially\n      const animateKeyframes = async () => {\n        for (const targetValue of values) {\n          // Early exit if stopped\n          if (!isRunning) break\n\n          const numValue = typeof targetValue === 'string'\n            ? parseFloat(targetValue) || 0\n            : targetValue\n\n          await new Promise<void>((resolve) => {\n            spring.set(numValue)\n\n            const checkDone = () => {\n              // If stopped or animation complete, resolve and cleanup\n              if (!isRunning || !spring.isAnimating()) {\n                resolve()\n              } else if (!isPaused) {\n                const rafId = requestAnimationFrame(checkDone)\n                rafIds.add(rafId)\n              } else {\n                // If paused, schedule check later instead of RAF loop\n                const timeoutId = setTimeout(() => {\n                  timeoutIds.delete(timeoutId)\n                  checkDone()\n                }, 100)\n                timeoutIds.add(timeoutId)\n              }\n            }\n            // Initial check after one frame\n            const initialRafId = requestAnimationFrame(checkDone)\n            rafIds.add(initialRafId)\n          })\n        }\n\n        completedCount++\n        if (completedCount === totalAnimations && isRunning) {\n          isRunning = false\n          try {\n            onComplete?.()\n          } catch {\n            // Ignore callback errors\n          }\n          resolveFinished()\n        }\n      }\n\n      animateKeyframes()\n    })\n  }\n\n  // Start with delay\n  if (delay > 0) {\n    delayTimeoutId = setTimeout(startAnimation, delay)\n  } else {\n    startAnimation()\n  }\n\n  // Cleanup function to cancel all pending RAF and timeouts\n  const cleanup = () => {\n    rafIds.forEach((id) => {\n      cancelAnimationFrame(id)\n    })\n    rafIds.clear()\n    timeoutIds.forEach((id) => {\n      clearTimeout(id)\n    })\n    timeoutIds.clear()\n    if (delayTimeoutId !== null) {\n      clearTimeout(delayTimeoutId)\n      delayTimeoutId = null\n    }\n  }\n\n  return {\n    stop: () => {\n      isRunning = false\n      cleanup()\n      springs.forEach((spring) => spring.stop())\n      resolveFinished()\n    },\n    pause: () => {\n      isPaused = true\n      // Note: SpringValue doesn't have pause, we just set flag to skip updates\n    },\n    resume: () => {\n      isPaused = false\n      // Resume by allowing updates to continue\n    },\n    getProgress: () => {\n      // Simplified progress calculation\n      let totalProgress = 0\n      let count = 0\n      springs.forEach((spring) => {\n        totalProgress += spring.isAnimating() ? 0.5 : 1\n        count++\n      })\n      return count > 0 ? totalProgress / count : 1\n    },\n    isAnimating: () => isRunning && !isPaused,\n    finished,\n  }\n}\n\nfunction createNoopControls(): AnimateControls {\n  return {\n    stop: () => {},\n    pause: () => {},\n    resume: () => {},\n    getProgress: () => 1,\n    isAnimating: () => false,\n    finished: Promise.resolve(),\n  }\n}\n\n/**\n * Animate multiple elements with staggered timing\n *\n * @example\n * ```ts\n * import { animateAll } from '@oxog/springkit'\n *\n * animateAll('.item', { opacity: 1, y: 0 }, {\n *   stagger: 50,\n *   stiffness: 200,\n * })\n * ```\n */\nexport function animateAll(\n  selector: string,\n  target: AnimateTarget,\n  options: AnimateOptions & { stagger?: number } = {}\n): AnimateControls[] {\n  const { stagger = 0, ...animateOptions } = options\n  const elements = document.querySelectorAll(selector)\n\n  return Array.from(elements).map((element, index) => {\n    return animate(element, target, {\n      ...animateOptions,\n      delay: (animateOptions.delay ?? 0) + (stagger * index),\n    })\n  })\n}\n","import type { SpringValue } from '../core/spring-value.js'\n\n/**\n * Interpolation options interface\n */\nexport interface InterpolateOptions {\n  /** Clamp output to output range */\n  clamp?: boolean\n  /** Default extrapolation mode */\n  extrapolate?: 'extend' | 'clamp' | 'identity'\n  /** Extrapolation mode for left side */\n  extrapolateLeft?: 'extend' | 'clamp' | 'identity'\n  /** Extrapolation mode for right side */\n  extrapolateRight?: 'extend' | 'clamp' | 'identity'\n}\n\n/**\n * Interpolation interface\n */\nexport interface Interpolation {\n  /** Get current interpolated value */\n  get(): number\n}\n\n/**\n * Default interpolation options\n * Note: extrapolate is handled inline to allow proper branch coverage\n */\nconst defaultInterpolateOptions: Required<Pick<InterpolateOptions, 'clamp'>> = {\n  clamp: false,\n}\n\n/**\n * Value interpolation implementation\n */\nclass InterpolationImpl implements Interpolation {\n  private source: SpringValue | (() => number)\n  private input: number[]\n  private output: number[]\n  private options: InterpolateOptions\n\n  constructor(\n    source: SpringValue | (() => number),\n    input: number[],\n    output: number[],\n    options: InterpolateOptions = {}\n  ) {\n    this.source = source\n    this.input = input\n    this.output = output\n    this.options = { ...defaultInterpolateOptions, ...options }\n  }\n\n  get(): number {\n    const value = typeof this.source === 'function' ? this.source() : this.source.get()\n    // Guard against NaN/Infinity from source\n    if (!Number.isFinite(value)) {\n      return this.output[0] ?? 0\n    }\n    return this.interpolate(value)\n  }\n\n  private interpolate(value: number): number {\n    const { input, output } = this\n    const { extrapolate, extrapolateLeft, extrapolateRight, clamp } = this.options\n\n    // Handle single point case - just return the output value\n    if (input.length === 1) {\n      return output[0]!\n    }\n\n    // Handle extrapolation\n    if (value < input[0]!) {\n      // Pass extrapolate as-is (may be undefined to test default branch)\n      const mode = this.getExtrapolationMode(extrapolateLeft, extrapolate)\n      if (mode === 'clamp') {\n        value = input[0]!\n      } else if (mode === 'identity') {\n        return value\n      }\n    } else if (value > input[input.length - 1]!) {\n      // Pass extrapolate as-is (may be undefined to test default branch)\n      const mode = this.getExtrapolationMode(extrapolateRight, extrapolate)\n      if (mode === 'clamp') {\n        value = input[input.length - 1]!\n      } else if (mode === 'identity') {\n        return value\n      }\n    }\n\n    // Find the segment\n    let i = 1\n    while (i < input.length - 1 && value > input[i]!) {\n      i++\n    }\n\n    // Linear interpolation within segment\n    const denominator = input[i]! - input[i - 1]!\n    // Guard against division by zero (same input values)\n    const ratio = denominator === 0 ? 0 : (value - input[i - 1]!) / denominator\n    const result = output[i - 1]! + ratio * (output[i]! - output[i - 1]!)\n\n    if (clamp) {\n      const min = Math.min(...output)\n      const max = Math.max(...output)\n      return Math.max(min, Math.min(max, result))\n    }\n\n    return result\n  }\n\n  private getExtrapolationMode(\n    specificMode: 'extend' | 'clamp' | 'identity' | undefined,\n    fallbackMode: 'extend' | 'clamp' | 'identity' | undefined\n  ): 'extend' | 'clamp' | 'identity' {\n    if (specificMode !== undefined) {\n      return specificMode\n    }\n    if (fallbackMode !== undefined) {\n      return fallbackMode\n    }\n    return 'extend'\n  }\n}\n\n/**\n * Create a value interpolation\n *\n * @param value - Spring value or function that returns a number\n * @param input - Input range (array of numbers)\n * @param output - Output range (array of numbers)\n * @param options - Interpolation options\n * @returns Interpolation controller\n *\n * @example\n * ```ts\n * const x = createSpringValue(0)\n *\n * // Map 0-100 to 0-1 (opacity)\n * const opacity = interpolate(x, [0, 100], [0, 1])\n *\n * x.subscribe(() => {\n *   element.style.opacity = String(opacity.get())\n * })\n *\n * x.set(100) // opacity animates to 1\n * ```\n */\nexport function interpolate(\n  value: SpringValue | (() => number),\n  input: number[],\n  output: number[],\n  options?: InterpolateOptions\n): Interpolation {\n  return new InterpolationImpl(value, input, output, options)\n}\n","import type { SpringValue } from '../core/spring-value.js'\nimport type { InterpolateOptions } from './interpolate.js'\n\n/**\n * Color interpolation interface\n */\nexport interface ColorInterpolation {\n  /** Get current interpolated color */\n  get(): string\n}\n\n/**\n * Color interpolation implementation\n */\nclass ColorInterpolationImpl implements ColorInterpolation {\n  private source: SpringValue | (() => number)\n  private input: number[]\n  private colors: [number, number, number][]\n  private options: InterpolateOptions\n\n  constructor(\n    source: SpringValue | (() => number),\n    input: number[],\n    colorStrings: string[],\n    options: InterpolateOptions = {}\n  ) {\n    this.source = source\n    this.input = input\n    this.colors = colorStrings.map((c) => this.parseColor(c))\n    this.options = options\n  }\n\n  get(): string {\n    let value = typeof this.source === 'function' ? this.source() : this.source.get()\n    const { extrapolate, extrapolateLeft, extrapolateRight } = this.options\n\n    // Handle single color case\n    if (this.input.length === 1) {\n      const [r, g, b] = this.colors[0]!\n      return `rgb(${r}, ${g}, ${b})`\n    }\n\n    // Handle extrapolation\n    if (value < this.input[0]!) {\n      const mode = extrapolateLeft ?? extrapolate ?? 'extend'\n      if (mode === 'clamp') {\n        value = this.input[0]!\n      } else if (mode === 'identity') {\n        // For color, we can't return identity, so we clamp\n        value = this.input[0]!\n      }\n    } else if (value > this.input[this.input.length - 1]!) {\n      const mode = extrapolateRight ?? extrapolate ?? 'extend'\n      if (mode === 'clamp') {\n        value = this.input[this.input.length - 1]!\n      } else if (mode === 'identity') {\n        // For color, we can't return identity, so we clamp\n        value = this.input[this.input.length - 1]!\n      }\n    }\n\n    // Find the segment\n    let i = 1\n    while (i < this.input.length - 1 && value > this.input[i]!) {\n      i++\n    }\n\n    // Calculate interpolation ratio\n    const ratio = (value - this.input[i - 1]!) / (this.input[i]! - this.input[i - 1]!)\n\n    // Interpolate each color channel\n    const r = this.lerp(this.colors[i - 1]![0], this.colors[i]![0], ratio)\n    const g = this.lerp(this.colors[i - 1]![1], this.colors[i]![1], ratio)\n    const b = this.lerp(this.colors[i - 1]![2], this.colors[i]![2], ratio)\n\n    return `rgb(${Math.round(r)}, ${Math.round(g)}, ${Math.round(b)})`\n  }\n\n  private parseColor(color: string): [number, number, number] {\n    // Try to parse hex\n    const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\n    if (hexMatch) {\n      const hex = hexMatch[1]!\n      if (hex.length === 3) {\n        return [\n          parseInt(hex.charAt(0) + hex.charAt(0), 16),\n          parseInt(hex.charAt(1) + hex.charAt(1), 16),\n          parseInt(hex.charAt(2) + hex.charAt(2), 16),\n        ]\n      }\n      return [\n        parseInt(hex.slice(0, 2), 16),\n        parseInt(hex.slice(2, 4), 16),\n        parseInt(hex.slice(4, 6), 16),\n      ]\n    }\n\n    // Try to parse rgb()\n    const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\n    if (rgbMatch) {\n      return [\n        parseInt(rgbMatch[1]!, 10),\n        parseInt(rgbMatch[2]!, 10),\n        parseInt(rgbMatch[3]!, 10),\n      ]\n    }\n\n    // Try to parse rgba()\n    const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\n    if (rgbaMatch) {\n      return [\n        parseInt(rgbaMatch[1]!, 10),\n        parseInt(rgbaMatch[2]!, 10),\n        parseInt(rgbaMatch[3]!, 10),\n      ]\n    }\n\n    // Try to parse hsl()\n    const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\n    if (hslMatch) {\n      return this.hslToRgb(\n        parseInt(hslMatch[1]!, 10),\n        parseInt(hslMatch[2]!, 10),\n        parseInt(hslMatch[3]!, 10)\n      )\n    }\n\n    // Default to black\n    return [0, 0, 0]\n  }\n\n  private hslToRgb(h: number, s: number, l: number): [number, number, number] {\n    h = ((h % 360) + 360) % 360\n    s = Math.max(0, Math.min(100, s)) / 100\n    l = Math.max(0, Math.min(100, l)) / 100\n\n    if (s === 0) {\n      const gray = Math.round(l * 255)\n      return [gray, gray, gray]\n    }\n\n    const hue2rgb = (p: number, q: number, t: number): number => {\n      if (t < 0) t += 1\n      if (t > 1) t -= 1\n      if (t < 1 / 6) return p + (q - p) * 6 * t\n      if (t < 1 / 2) return q\n      if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n      return p\n    }\n\n    const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n    const p = 2 * l - q\n\n    return [\n      Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\n      Math.round(hue2rgb(p, q, h / 360) * 255),\n      Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\n    ]\n  }\n\n  private lerp(a: number, b: number, t: number): number {\n    return a + (b - a) * t\n  }\n}\n\n/**\n * Create a color interpolation\n *\n * @param value - Spring value or function that returns a number\n * @param input - Input range (array of numbers)\n * @param colors - Array of color strings (hex, rgb, hsl)\n * @param options - Interpolation options\n * @returns Color interpolation controller\n *\n * @example\n * ```ts\n * const progress = createSpringValue(0)\n *\n * // Interpolate through colors\n * const color = interpolateColor(\n *   progress,\n *   [0, 50, 100],\n *   ['#ff0000', '#00ff00', '#0000ff']\n * )\n *\n * progress.subscribe(() => {\n *   element.style.backgroundColor = color.get()\n * })\n *\n * progress.set(50) // color is '#00ff00'\n * ```\n */\nexport function interpolateColor(\n  value: SpringValue | (() => number),\n  input: number[],\n  colors: string[],\n  options?: InterpolateOptions\n): ColorInterpolation {\n  return new ColorInterpolationImpl(value, input, colors, options)\n}\n","import { createSpringValue, type SpringValue } from '../core/spring-value.js'\r\nimport { clamp } from '../utils/math.js'\r\n\r\n/**\r\n * Snap point configuration\r\n */\r\nexport interface SnapPoint {\r\n  x: number\r\n  y: number\r\n  /** Attraction radius (pixels) */\r\n  radius?: number\r\n}\r\n\r\n/**\r\n * Snap configuration\r\n */\r\nexport interface SnapConfig {\r\n  /** Array of snap points */\r\n  points?: SnapPoint[]\r\n  /** Snap to grid with given cell size */\r\n  grid?: { x: number; y: number }\r\n  /** Velocity threshold to snap (lower = snap more easily) */\r\n  velocityThreshold?: number\r\n  /** Whether to snap only on release */\r\n  snapOnRelease?: boolean\r\n}\r\n\r\n/**\r\n * Constraint configuration - supports multiple constraint types\r\n */\r\nexport interface DragConstraints {\r\n  /** Simple box bounds */\r\n  bounds?: {\r\n    left?: number\r\n    right?: number\r\n    top?: number\r\n    bottom?: number\r\n  }\r\n  /** Constrain to parent element */\r\n  constrainToParent?: boolean\r\n  /** Constrain to specific element */\r\n  constrainToElement?: HTMLElement\r\n  /** Padding when constrained to element */\r\n  constraintPadding?: number | { top?: number; right?: number; bottom?: number; left?: number }\r\n  /** Lock to specific axis */\r\n  lockAxis?: 'x' | 'y' | null\r\n  /** Lock to 45-degree diagonal lines */\r\n  lockToDiagonal?: boolean\r\n}\r\n\r\n/**\r\n * Drag spring configuration interface\r\n */\r\nexport interface DragSpringConfig {\r\n  /** Spring stiffness (default: 100) */\r\n  stiffness?: number\r\n  /** Damping ratio (default: 10) */\r\n  damping?: number\r\n  /** Mass (default: 1) */\r\n  mass?: number\r\n  /** Initial velocity */\r\n  velocity?: number\r\n  /** Speed threshold for considering spring at rest (default: 0.01) */\r\n  restSpeed?: number\r\n  /** Position threshold for considering spring at rest (default: 0.01) */\r\n  restDelta?: number\r\n  /** Clamp value to [from, to] range */\r\n  clamp?: boolean\r\n  /** Axis constraint (deprecated, use constraints.lockAxis) */\r\n  axis?: 'x' | 'y' | 'both'\r\n  /** Boundary constraints (deprecated, use constraints.bounds) */\r\n  bounds?: {\r\n    left?: number\r\n    right?: number\r\n    top?: number\r\n    bottom?: number\r\n  }\r\n  /** Enhanced constraint configuration */\r\n  constraints?: DragConstraints\r\n  /** Snap configuration */\r\n  snap?: SnapConfig\r\n  /** Enable rubber band effect at bounds */\r\n  rubberBand?: boolean\r\n  /** Rubber band stretch factor (0-1, default: 0.5) */\r\n  rubberBandFactor?: number\r\n  /** Elastic bounce power (0-1, default: 0.3) */\r\n  elasticBounce?: number\r\n  /** Momentum after release (true = continue with velocity) */\r\n  momentum?: boolean\r\n  /** Deceleration rate for momentum (0-1, default: 0.95) */\r\n  momentumDecay?: number\r\n  /** Elastic factor (0-1) - how much element can be dragged outside bounds */\r\n  dragElastic?: number | boolean | { top?: number; right?: number; bottom?: number; left?: number }\r\n  /** Modify the target position during inertia (useful for snap-to-grid) */\r\n  modifyTarget?: (target: { x: number; y: number }) => { x: number; y: number }\r\n  /** Callback called when drag starts */\r\n  onDragStart?: (event: PointerEvent) => void\r\n  /** Callback called during drag */\r\n  onDrag?: (x: number, y: number, event: PointerEvent) => void\r\n  /** Callback called when drag ends */\r\n  onDragEnd?: (x: number, y: number, velocity: { x: number; y: number }) => void\r\n  /** Callback called on position update */\r\n  onUpdate?: (x: number, y: number) => void\r\n  /** Callback when snapping to a point */\r\n  onSnapStart?: (point: SnapPoint) => void\r\n  /** Callback when snap animation completes */\r\n  onSnapComplete?: (point: SnapPoint) => void\r\n  /** Callback when hitting bounds */\r\n  onBoundsHit?: (edge: 'left' | 'right' | 'top' | 'bottom') => void\r\n}\r\n\r\n/**\r\n * Drag spring interface\r\n */\r\nexport interface DragSpring {\r\n  /** Enable drag interaction */\r\n  enable(): void\r\n  /** Disable drag interaction */\r\n  disable(): void\r\n  /** Check if currently enabled */\r\n  isEnabled(): boolean\r\n  /** Check if currently dragging */\r\n  isDragging(): boolean\r\n  /** Reset to initial position */\r\n  reset(): void\r\n  /** Get current position */\r\n  getPosition(): { x: number; y: number }\r\n  /** Get current velocity */\r\n  getVelocity(): { x: number; y: number }\r\n  /** Set position instantly */\r\n  setPosition(x: number, y: number): void\r\n  /** Jump to position (instant, alias for setPosition) */\r\n  jumpTo(x: number, y: number): void\r\n  /** Animate to position with spring physics */\r\n  animateTo(x: number, y: number): void\r\n  /** Release with velocity */\r\n  release(velocityX: number, velocityY: number): void\r\n  /** Snap to nearest point */\r\n  snapToNearest(): void\r\n  /** Snap to specific point */\r\n  snapTo(point: SnapPoint): void\r\n  /** Update constraints dynamically */\r\n  setConstraints(constraints: DragConstraints): void\r\n  /** Update snap configuration dynamically */\r\n  setSnap(snap: SnapConfig): void\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Default drag spring configuration\r\n */\r\nconst defaultDragConfig = {\r\n  axis: 'both' as const,\r\n  rubberBand: false,\r\n  rubberBandFactor: 0.5,\r\n  elasticBounce: 0.3,\r\n  momentum: true,\r\n  momentumDecay: 0.95,\r\n  stiffness: 200,\r\n  damping: 20,\r\n  mass: 1,\r\n  restSpeed: 0.01,\r\n  restDelta: 0.01,\r\n  clamp: false,\r\n}\r\n\r\n/**\r\n * Drag spring implementation\r\n */\r\nclass DragSpringImpl implements DragSpring {\r\n  private element: HTMLElement\r\n  private config: DragSpringConfig\r\n  private enabled = true\r\n  private position = { x: 0, y: 0 }\r\n  private _isDragging = false\r\n  private startPosition = { x: 0, y: 0 }\r\n  private pointerStart = { x: 0, y: 0 }\r\n  private lastPosition = { x: 0, y: 0 }\r\n  private lastTime = 0\r\n  private velocity = { x: 0, y: 0 }\r\n  private currentSnap: SnapPoint | null = null\r\n  private snapTimeoutId: ReturnType<typeof setTimeout> | null = null\r\n  private destroyed = false\r\n\r\n  // Springs for each axis\r\n  private springX: SpringValue\r\n  private springY: SpringValue\r\n\r\n  constructor(element: HTMLElement, config: DragSpringConfig = {}) {\r\n    this.element = element\r\n    this.config = { ...defaultDragConfig, ...config }\r\n\r\n    // Extract only spring physics config for createSpringValue\r\n    const springConfig = {\r\n      stiffness: this.config.stiffness,\r\n      damping: this.config.damping,\r\n      mass: this.config.mass,\r\n      restSpeed: this.config.restSpeed,\r\n      restDelta: this.config.restDelta,\r\n      clamp: this.config.clamp,\r\n    }\r\n\r\n    this.springX = createSpringValue(0, springConfig)\r\n    this.springY = createSpringValue(0, springConfig)\r\n\r\n    // Subscribe to spring updates\r\n    this.springX.subscribe(() => {\r\n      if (!this._isDragging) {\r\n        this.position.x = this.springX.get()\r\n        if (this.config.onUpdate) {\r\n          this.config.onUpdate(this.position.x, this.position.y)\r\n        }\r\n      }\r\n    })\r\n\r\n    this.springY.subscribe(() => {\r\n      if (!this._isDragging) {\r\n        this.position.y = this.springY.get()\r\n        if (this.config.onUpdate) {\r\n          this.config.onUpdate(this.position.x, this.position.y)\r\n        }\r\n      }\r\n    })\r\n\r\n    this.setupPointerEvents()\r\n  }\r\n\r\n  private setupPointerEvents(): void {\r\n    this.element.addEventListener('pointerdown', this.onPointerDown)\r\n  }\r\n\r\n  private onPointerDown = (e: PointerEvent): void => {\r\n    if (!this.enabled || e.button !== 0) return\r\n\r\n    this._isDragging = true\r\n    this.startPosition = { ...this.position }\r\n    this.pointerStart = { x: e.clientX, y: e.clientY }\r\n    this.lastPosition = { x: e.clientX, y: e.clientY }\r\n    this.lastTime = performance.now()\r\n    this.velocity = { x: 0, y: 0 }\r\n\r\n    this.element.setPointerCapture(e.pointerId)\r\n    this.element.addEventListener('pointermove', this.onPointerMove)\r\n    this.element.addEventListener('pointerup', this.onPointerUp)\r\n    this.element.addEventListener('pointercancel', this.onPointerUp)\r\n\r\n    // Explicit if for better branch coverage\r\n    if (this.config.onDragStart) {\r\n      this.config.onDragStart(e)\r\n    }\r\n  }\r\n\r\n  private onPointerMove = (e: PointerEvent): void => {\r\n    const now = performance.now()\r\n    const dt = now - this.lastTime\r\n\r\n    // Calculate instant velocity with minimum dt to prevent spikes\r\n    // Use at least 16ms (one frame) to avoid unrealistic velocity on first move\r\n    const safeDt = Math.max(dt, 16)\r\n    const instantVelocity = {\r\n      x: (e.clientX - this.lastPosition.x) / safeDt,\r\n      y: (e.clientY - this.lastPosition.y) / safeDt,\r\n    }\r\n\r\n    // Smooth velocity using exponential moving average to prevent jarring animations\r\n    // This prevents velocity spikes on quick movements or first move events\r\n    const smoothingFactor = 0.2\r\n    this.velocity = {\r\n      x: this.velocity.x * (1 - smoothingFactor) + instantVelocity.x * smoothingFactor,\r\n      y: this.velocity.y * (1 - smoothingFactor) + instantVelocity.y * smoothingFactor,\r\n    }\r\n\r\n    this.lastPosition = { x: e.clientX, y: e.clientY }\r\n    this.lastTime = now\r\n\r\n    // Calculate new position\r\n    let newX = this.startPosition.x + (e.clientX - this.pointerStart.x)\r\n    let newY = this.startPosition.y + (e.clientY - this.pointerStart.y)\r\n\r\n    // Apply bounds with elastic effect\r\n    if (this.config.bounds) {\r\n      newX = this.applyBounds(\r\n        newX,\r\n        this.config.bounds.left ?? -Infinity,\r\n        this.config.bounds.right ?? Infinity,\r\n        'x'\r\n      )\r\n      newY = this.applyBounds(\r\n        newY,\r\n        this.config.bounds.top ?? -Infinity,\r\n        this.config.bounds.bottom ?? Infinity,\r\n        'y'\r\n      )\r\n    }\r\n\r\n    // Apply axis constraint\r\n    if (this.config.axis === 'x') {\r\n      newY = 0\r\n    } else if (this.config.axis === 'y') {\r\n      newX = 0\r\n    }\r\n\r\n    this.position = { x: newX, y: newY }\r\n    if (this.config.onDrag) {\r\n      this.config.onDrag(newX, newY, e)\r\n    }\r\n    if (this.config.onUpdate) {\r\n      this.config.onUpdate(newX, newY)\r\n    }\r\n  }\r\n\r\n  private getElasticFactor(edge: 'left' | 'right' | 'top' | 'bottom'): number {\r\n    const dragElastic = this.config.dragElastic\r\n\r\n    // If not specified, use rubberBand settings\r\n    if (dragElastic === undefined) {\r\n      if (this.config.rubberBand) {\r\n        return this.config.rubberBandFactor ?? 0.5\r\n      }\r\n      return 0 // No elasticity\r\n    }\r\n\r\n    // Boolean: true = 0.5, false = 0\r\n    if (typeof dragElastic === 'boolean') {\r\n      return dragElastic ? 0.5 : 0\r\n    }\r\n\r\n    // Number: use directly\r\n    if (typeof dragElastic === 'number') {\r\n      return clamp(dragElastic, 0, 1)\r\n    }\r\n\r\n    // Object: per-edge configuration\r\n    return clamp(dragElastic[edge] ?? 0.5, 0, 1)\r\n  }\r\n\r\n  private applyBounds(value: number, min: number, max: number, axis: 'x' | 'y' = 'x'): number {\r\n    if (!isFinite(min) && !isFinite(max)) return value\r\n\r\n    const actualMin = isFinite(min) ? min : -Infinity\r\n    const actualMax = isFinite(max) ? max : Infinity\r\n\r\n    // Determine elastic factor based on which edge\r\n    const hasElastic = this.config.dragElastic !== undefined || this.config.rubberBand\r\n\r\n    if (hasElastic) {\r\n      if (value < actualMin) {\r\n        const elasticFactor = this.getElasticFactor(axis === 'x' ? 'left' : 'top')\r\n        return actualMin - (actualMin - value) * elasticFactor\r\n      }\r\n      if (value > actualMax) {\r\n        const elasticFactor = this.getElasticFactor(axis === 'x' ? 'right' : 'bottom')\r\n        return actualMax + (value - actualMax) * elasticFactor\r\n      }\r\n    }\r\n\r\n    return clamp(value, actualMin, actualMax)\r\n  }\r\n\r\n  private onPointerUp = (e: PointerEvent): void => {\r\n    this._isDragging = false\r\n\r\n    // Safety check: element might be removed from DOM during drag\r\n    if (this.element && document.contains(this.element)) {\r\n      try {\r\n        this.element.releasePointerCapture(e.pointerId)\r\n      } catch {\r\n        // Ignore errors if pointer capture was already released\r\n      }\r\n      this.element.removeEventListener('pointermove', this.onPointerMove)\r\n      this.element.removeEventListener('pointerup', this.onPointerUp)\r\n      this.element.removeEventListener('pointercancel', this.onPointerUp)\r\n    }\r\n\r\n    // Check for snap points first\r\n    if (this.config.snap?.snapOnRelease !== false) {\r\n      const snapPoint = this.findNearestSnapPoint()\r\n      if (snapPoint) {\r\n        this.snapTo(snapPoint)\r\n        if (this.config.onDragEnd) {\r\n          this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\r\n        }\r\n        return\r\n      }\r\n    }\r\n\r\n    // Scale velocity for spring (convert from pixels/ms to more reasonable units)\r\n    this.release(this.velocity.x * 16, this.velocity.y * 16)\r\n\r\n    if (this.config.onDragEnd) {\r\n      this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\r\n    }\r\n  }\r\n\r\n  private findNearestSnapPoint(): SnapPoint | null {\r\n    const snap = this.config.snap\r\n    if (!snap) return null\r\n\r\n    // Check grid snapping first\r\n    if (snap.grid) {\r\n      const gridX = Math.round(this.position.x / snap.grid.x) * snap.grid.x\r\n      const gridY = Math.round(this.position.y / snap.grid.y) * snap.grid.y\r\n      return { x: gridX, y: gridY }\r\n    }\r\n\r\n    // Check snap points\r\n    if (snap.points && snap.points.length > 0) {\r\n      const velocityMagnitude = Math.sqrt(this.velocity.x ** 2 + this.velocity.y ** 2)\r\n      const threshold = snap.velocityThreshold ?? 0.5\r\n\r\n      // Don't snap if moving too fast\r\n      if (velocityMagnitude > threshold) return null\r\n\r\n      let nearestPoint: SnapPoint | null = null\r\n      let nearestDistance = Infinity\r\n\r\n      for (const point of snap.points) {\r\n        const dx = this.position.x - point.x\r\n        const dy = this.position.y - point.y\r\n        const distance = Math.sqrt(dx * dx + dy * dy)\r\n        const radius = point.radius ?? 50\r\n\r\n        if (distance < radius && distance < nearestDistance) {\r\n          nearestDistance = distance\r\n          nearestPoint = point\r\n        }\r\n      }\r\n\r\n      return nearestPoint\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  private getEffectiveBounds(): { left: number; right: number; top: number; bottom: number } {\r\n    // Start with explicit bounds\r\n    const bounds = {\r\n      left: this.config.bounds?.left ?? this.config.constraints?.bounds?.left ?? -Infinity,\r\n      right: this.config.bounds?.right ?? this.config.constraints?.bounds?.right ?? Infinity,\r\n      top: this.config.bounds?.top ?? this.config.constraints?.bounds?.top ?? -Infinity,\r\n      bottom: this.config.bounds?.bottom ?? this.config.constraints?.bounds?.bottom ?? Infinity,\r\n    }\r\n\r\n    const constraints = this.config.constraints\r\n\r\n    // Handle constrainToParent\r\n    if (constraints?.constrainToParent && this.element.parentElement) {\r\n      const parent = this.element.parentElement\r\n      const parentRect = parent.getBoundingClientRect()\r\n      const elementRect = this.element.getBoundingClientRect()\r\n\r\n      const padding = this.normalizePadding(constraints.constraintPadding)\r\n\r\n      bounds.left = Math.max(bounds.left, padding.left)\r\n      bounds.right = Math.min(bounds.right, parentRect.width - elementRect.width - padding.right)\r\n      bounds.top = Math.max(bounds.top, padding.top)\r\n      bounds.bottom = Math.min(bounds.bottom, parentRect.height - elementRect.height - padding.bottom)\r\n    }\r\n\r\n    // Handle constrainToElement\r\n    if (constraints?.constrainToElement) {\r\n      const constraintRect = constraints.constrainToElement.getBoundingClientRect()\r\n      const elementRect = this.element.getBoundingClientRect()\r\n      const parentRect = this.element.parentElement?.getBoundingClientRect() ?? { left: 0, top: 0 }\r\n\r\n      const padding = this.normalizePadding(constraints.constraintPadding)\r\n\r\n      const offsetX = constraintRect.left - parentRect.left\r\n      const offsetY = constraintRect.top - parentRect.top\r\n\r\n      bounds.left = Math.max(bounds.left, offsetX + padding.left)\r\n      bounds.right = Math.min(bounds.right, offsetX + constraintRect.width - elementRect.width - padding.right)\r\n      bounds.top = Math.max(bounds.top, offsetY + padding.top)\r\n      bounds.bottom = Math.min(bounds.bottom, offsetY + constraintRect.height - elementRect.height - padding.bottom)\r\n    }\r\n\r\n    return bounds\r\n  }\r\n\r\n  private normalizePadding(padding: number | { top?: number; right?: number; bottom?: number; left?: number } | undefined): { top: number; right: number; bottom: number; left: number } {\r\n    if (typeof padding === 'number') {\r\n      return { top: padding, right: padding, bottom: padding, left: padding }\r\n    }\r\n    return {\r\n      top: padding?.top ?? 0,\r\n      right: padding?.right ?? 0,\r\n      bottom: padding?.bottom ?? 0,\r\n      left: padding?.left ?? 0,\r\n    }\r\n  }\r\n\r\n  enable(): void {\r\n    this.enabled = true\r\n  }\r\n\r\n  disable(): void {\r\n    this.enabled = false\r\n    if (this._isDragging) {\r\n      this._isDragging = false\r\n    }\r\n  }\r\n\r\n  isEnabled(): boolean {\r\n    return this.enabled\r\n  }\r\n\r\n  isDragging(): boolean {\r\n    return this._isDragging\r\n  }\r\n\r\n  reset(): void {\r\n    this.springX.jump(0)\r\n    this.springY.jump(0)\r\n    this.position = { x: 0, y: 0 }\r\n    this.velocity = { x: 0, y: 0 }\r\n    this.currentSnap = null\r\n    // Explicit if for better branch coverage\r\n    if (this.config.onUpdate) {\r\n      this.config.onUpdate(0, 0)\r\n    }\r\n  }\r\n\r\n  getPosition(): { x: number; y: number } {\r\n    return { ...this.position }\r\n  }\r\n\r\n  getVelocity(): { x: number; y: number } {\r\n    return { ...this.velocity }\r\n  }\r\n\r\n  setPosition(x: number, y: number): void {\r\n    // Guard against destroyed state and invalid values\r\n    if (this.destroyed) return\r\n    const safeX = Number.isFinite(x) ? x : this.position.x\r\n    const safeY = Number.isFinite(y) ? y : this.position.y\r\n\r\n    // Instant position change (same as jumpTo for backwards compatibility)\r\n    this.position = { x: safeX, y: safeY }\r\n    this.springX.jump(safeX)\r\n    this.springY.jump(safeY)\r\n  }\r\n\r\n  jumpTo(x: number, y: number): void {\r\n    // Guard against destroyed state and invalid values\r\n    if (this.destroyed) return\r\n    const safeX = Number.isFinite(x) ? x : this.position.x\r\n    const safeY = Number.isFinite(y) ? y : this.position.y\r\n\r\n    // Update position immediately for synchronous access\r\n    this.position = { x: safeX, y: safeY }\r\n    this.springX.jump(safeX)\r\n    this.springY.jump(safeY)\r\n    if (this.config.onUpdate) {\r\n      this.config.onUpdate(safeX, safeY)\r\n    }\r\n  }\r\n\r\n  animateTo(x: number, y: number): void {\r\n    // Guard against destroyed state and invalid values\r\n    if (this.destroyed) return\r\n    const safeX = Number.isFinite(x) ? x : this.position.x\r\n    const safeY = Number.isFinite(y) ? y : this.position.y\r\n\r\n    // Animate to the position with spring physics\r\n    this.springX.set(safeX)\r\n    this.springY.set(safeY)\r\n  }\r\n\r\n  release(velocityX: number, velocityY: number): void {\r\n    const bounds = this.getEffectiveBounds()\r\n    const { left, right, top, bottom } = bounds\r\n\r\n    let targetX = this.position.x\r\n    let targetY = this.position.y\r\n\r\n    // Apply momentum if enabled\r\n    if (this.config.momentum) {\r\n      // Clamp decay to valid range [0, 0.99] to prevent division by zero\r\n      const rawDecay = this.config.momentumDecay ?? 0.95\r\n      const decay = Math.max(0, Math.min(0.99, rawDecay))\r\n      const decayFactor = decay < 1 ? (1 / (1 - decay)) : 100 // Fallback for edge case\r\n      const momentumX = velocityX * decayFactor * 0.1\r\n      const momentumY = velocityY * decayFactor * 0.1\r\n      targetX += momentumX\r\n      targetY += momentumY\r\n    }\r\n\r\n    // Apply modifyTarget for snap-to-grid or custom modifications\r\n    if (this.config.modifyTarget) {\r\n      const modified = this.config.modifyTarget({ x: targetX, y: targetY })\r\n      targetX = modified.x\r\n      targetY = modified.y\r\n    }\r\n\r\n    // Clamp to bounds\r\n    targetX = clamp(targetX, left, right)\r\n    targetY = clamp(targetY, top, bottom)\r\n\r\n    // Notify bounds hit\r\n    if (this.config.onBoundsHit) {\r\n      if (this.position.x < left) this.config.onBoundsHit('left')\r\n      if (this.position.x > right) this.config.onBoundsHit('right')\r\n      if (this.position.y < top) this.config.onBoundsHit('top')\r\n      if (this.position.y > bottom) this.config.onBoundsHit('bottom')\r\n    }\r\n\r\n    // Animate to target with elastic bounce\r\n    if (targetX !== this.position.x || this.position.x < left || this.position.x > right) {\r\n      this.springX.set(targetX, { velocity: velocityX })\r\n    }\r\n    if (targetY !== this.position.y || this.position.y < top || this.position.y > bottom) {\r\n      this.springY.set(targetY, { velocity: velocityY })\r\n    }\r\n  }\r\n\r\n  snapToNearest(): void {\r\n    const snapPoint = this.findNearestSnapPoint()\r\n    if (snapPoint) {\r\n      this.snapTo(snapPoint)\r\n    }\r\n  }\r\n\r\n  snapTo(point: SnapPoint): void {\r\n    this.currentSnap = point\r\n    if (this.config.onSnapStart) {\r\n      this.config.onSnapStart(point)\r\n    }\r\n\r\n    this.springX.set(point.x)\r\n    this.springY.set(point.y)\r\n\r\n    // Cancel previous snap timeout to prevent memory leak\r\n    if (this.snapTimeoutId !== null) {\r\n      clearTimeout(this.snapTimeoutId)\r\n    }\r\n\r\n    // Simple completion detection with tracked timeout\r\n    this.snapTimeoutId = setTimeout(() => {\r\n      this.snapTimeoutId = null\r\n      if (!this.destroyed && this.currentSnap === point && this.config.onSnapComplete) {\r\n        this.config.onSnapComplete(point)\r\n      }\r\n    }, 500)\r\n  }\r\n\r\n  setConstraints(constraints: DragConstraints): void {\r\n    this.config.constraints = constraints\r\n  }\r\n\r\n  setSnap(snap: SnapConfig): void {\r\n    this.config.snap = snap\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Cancel any pending snap timeout\r\n    if (this.snapTimeoutId !== null) {\r\n      clearTimeout(this.snapTimeoutId)\r\n      this.snapTimeoutId = null\r\n    }\r\n\r\n    this.element.removeEventListener('pointerdown', this.onPointerDown)\r\n    this.springX.destroy()\r\n    this.springY.destroy()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a drag spring\r\n *\r\n * @param element - HTML element to make draggable\r\n * @param config - Drag spring configuration\r\n * @returns Drag spring controller\r\n *\r\n * @example\r\n * ```ts\r\n * const drag = createDragSpring(element, {\r\n *   onUpdate: (x, y) => {\r\n *     element.style.transform = `translate(${x}px, ${y}px)`\r\n *   },\r\n * })\r\n * ```\r\n */\r\nexport function createDragSpring(\r\n  element: HTMLElement,\r\n  config?: DragSpringConfig\r\n): DragSpring {\r\n  return new DragSpringImpl(element, config)\r\n}\r\n","import { createSpringValue, type SpringValue } from '../core/spring-value.js'\r\n\r\n/**\r\n * Scroll spring configuration interface\r\n */\r\nexport interface ScrollSpringConfig {\r\n  /** Spring stiffness (default: 100) */\r\n  stiffness?: number\r\n  /** Damping ratio (default: 10) */\r\n  damping?: number\r\n  /** Mass (default: 1) */\r\n  mass?: number\r\n  /** Speed threshold for considering spring at rest (default: 0.01) */\r\n  restSpeed?: number\r\n  /** Position threshold for considering spring at rest (default: 0.01) */\r\n  restDelta?: number\r\n  /** Clamp value to [from, to] range */\r\n  clamp?: boolean\r\n  /** Scroll direction */\r\n  direction?: 'horizontal' | 'vertical' | 'both'\r\n  /** Enable momentum/inertia */\r\n  momentum?: boolean\r\n  /** Momentum decay factor (0-1) */\r\n  momentumDecay?: number\r\n  /** Enable bounce at edges */\r\n  bounce?: boolean\r\n  /** Bounce spring stiffness */\r\n  bounceStiffness?: number\r\n  /** Bounce spring damping */\r\n  bounceDamping?: number\r\n  /** Callback called on scroll */\r\n  onScroll?: (scrollX: number, scrollY: number) => void\r\n  /** Callback called when scroll starts */\r\n  onScrollStart?: () => void\r\n  /** Callback called when scroll ends */\r\n  onScrollEnd?: () => void\r\n}\r\n\r\n/**\r\n * Scroll spring interface\r\n */\r\nexport interface ScrollSpring {\r\n  /** Get current scroll position */\r\n  getScroll(): { x: number; y: number }\r\n  /** Scroll to position */\r\n  scrollTo(x: number, y: number): void\r\n  /** Scroll to element */\r\n  scrollToElement(element: HTMLElement, offset?: number): void\r\n  /** Enable scroll handling */\r\n  enable(): void\r\n  /** Disable scroll handling */\r\n  disable(): void\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Default scroll spring configuration\r\n */\r\nconst defaultScrollConfig: Required<\r\n  Omit<\r\n    ScrollSpringConfig,\r\n    | 'onScroll'\r\n    | 'onScrollStart'\r\n    | 'onScrollEnd'\r\n    | 'bounceStiffness'\r\n    | 'bounceDamping'\r\n    | 'velocity'\r\n  >\r\n> = {\r\n  direction: 'vertical',\r\n  momentum: false,\r\n  momentumDecay: 0.95,\r\n  bounce: false,\r\n  stiffness: 100,\r\n  damping: 10,\r\n  mass: 1,\r\n  restSpeed: 0.01,\r\n  restDelta: 0.01,\r\n  clamp: false,\r\n}\r\n\r\n/**\r\n * Scroll spring implementation\r\n */\r\nclass ScrollSpringImpl implements ScrollSpring {\r\n  private container: HTMLElement\r\n  private config: ScrollSpringConfig\r\n  private scroll = { x: 0, y: 0 }\r\n  private target = { x: 0, y: 0 }\r\n  private isScrolling = false\r\n  private isEnabled = true\r\n  private pendingRafId: number | null = null\r\n  private destroyed = false\r\n\r\n  private springX: SpringValue\r\n  private springY: SpringValue\r\n\r\n  constructor(container: HTMLElement, config: ScrollSpringConfig = {}) {\r\n    this.container = container\r\n    this.config = { ...defaultScrollConfig, ...config }\r\n\r\n    // Extract only spring physics config for createSpringValue\r\n    const springConfig = {\r\n      stiffness: this.config.stiffness,\r\n      damping: this.config.damping,\r\n      mass: this.config.mass,\r\n      restSpeed: this.config.restSpeed,\r\n      restDelta: this.config.restDelta,\r\n      clamp: this.config.clamp,\r\n    }\r\n\r\n    this.springX = createSpringValue(0, springConfig)\r\n    this.springY = createSpringValue(0, springConfig)\r\n\r\n    // Subscribe to spring updates\r\n    this.springX.subscribe(() => {\r\n      this.scroll.x = this.springX.get()\r\n      this.config.onScroll?.(this.scroll.x, this.scroll.y)\r\n    })\r\n\r\n    this.springY.subscribe(() => {\r\n      this.scroll.y = this.springY.get()\r\n      this.config.onScroll?.(this.scroll.x, this.scroll.y)\r\n    })\r\n\r\n    this.setupScrollEvents()\r\n  }\r\n\r\n  private setupScrollEvents(): void {\r\n    this.container.addEventListener('wheel', this.onWheel, { passive: false })\r\n  }\r\n\r\n  private onWheel = (e: WheelEvent): void => {\r\n    if (!this.isEnabled) return\r\n\r\n    if (!this.isScrolling) {\r\n      this.isScrolling = true\r\n      this.config.onScrollStart?.()\r\n    }\r\n\r\n    // Apply direction filter\r\n    let deltaX = e.deltaX\r\n    let deltaY = e.deltaY\r\n\r\n    if (this.config.direction === 'horizontal') {\r\n      deltaY = 0\r\n    } else if (this.config.direction === 'vertical') {\r\n      deltaX = 0\r\n    }\r\n\r\n    // Apply bounce at edges\r\n    if (this.config.bounce) {\r\n      const maxScrollX = this.container.scrollWidth - this.container.clientWidth\r\n      const maxScrollY = this.container.scrollHeight - this.container.clientHeight\r\n\r\n      this.target.x += deltaX\r\n      this.target.y += deltaY\r\n\r\n      // Apply rubber band at edges with safe Math.sqrt (use Math.abs to prevent NaN)\r\n      if (this.target.x < 0) {\r\n        this.target.x = -Math.sqrt(Math.abs(this.target.x)) * 10\r\n      } else if (this.target.x > maxScrollX) {\r\n        this.target.x = maxScrollX + Math.sqrt(Math.abs(this.target.x - maxScrollX)) * 10\r\n      }\r\n\r\n      if (this.target.y < 0) {\r\n        this.target.y = -Math.sqrt(Math.abs(this.target.y)) * 10\r\n      } else if (this.target.y > maxScrollY) {\r\n        this.target.y = maxScrollY + Math.sqrt(Math.abs(this.target.y - maxScrollY)) * 10\r\n      }\r\n\r\n      // Prevent default to handle scroll ourselves\r\n      e.preventDefault()\r\n    } else {\r\n      this.target.x += deltaX\r\n      this.target.y += deltaY\r\n\r\n      // Clamp to bounds\r\n      const maxScrollX = this.container.scrollWidth - this.container.clientWidth\r\n      const maxScrollY = this.container.scrollHeight - this.container.clientHeight\r\n\r\n      this.target.x = Math.max(0, Math.min(this.target.x, maxScrollX))\r\n      this.target.y = Math.max(0, Math.min(this.target.y, maxScrollY))\r\n    }\r\n\r\n    this.startScrollLoop()\r\n  }\r\n\r\n  private startScrollLoop(): void {\r\n    // Update springs towards target\r\n    this.springX.set(this.target.x)\r\n    this.springY.set(this.target.y)\r\n\r\n    // Check for scroll end\r\n    const checkEnd = () => {\r\n      this.pendingRafId = null\r\n\r\n      if (this.destroyed) return\r\n\r\n      const settled =\r\n        Math.abs(this.scroll.x - this.target.x) < 0.1 &&\r\n        Math.abs(this.scroll.y - this.target.y) < 0.1 &&\r\n        !this.springX.isAnimating() &&\r\n        !this.springY.isAnimating()\r\n\r\n      if (settled && this.isScrolling) {\r\n        this.isScrolling = false\r\n        this.config.onScrollEnd?.()\r\n      } else if (this.isScrolling) {\r\n        this.pendingRafId = requestAnimationFrame(checkEnd)\r\n      }\r\n    }\r\n\r\n    checkEnd()\r\n  }\r\n\r\n  getScroll(): { x: number; y: number } {\r\n    return { ...this.scroll }\r\n  }\r\n\r\n  scrollTo(x: number, y: number): void {\r\n    this.target = { x, y }\r\n    this.springX.set(x)\r\n    this.springY.set(y)\r\n  }\r\n\r\n  scrollToElement(element: HTMLElement, offset = 0): void {\r\n    const containerRect = this.container.getBoundingClientRect()\r\n    const elementRect = element.getBoundingClientRect()\r\n\r\n    const x = elementRect.left - containerRect.left + this.scroll.x + offset\r\n    const y = elementRect.top - containerRect.top + this.scroll.y + offset\r\n\r\n    this.scrollTo(x, y)\r\n  }\r\n\r\n  enable(): void {\r\n    this.isEnabled = true\r\n  }\r\n\r\n  disable(): void {\r\n    this.isEnabled = false\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Cancel any pending RAF to prevent memory leak\r\n    if (this.pendingRafId !== null) {\r\n      cancelAnimationFrame(this.pendingRafId)\r\n      this.pendingRafId = null\r\n    }\r\n\r\n    this.container.removeEventListener('wheel', this.onWheel)\r\n    this.springX.destroy()\r\n    this.springY.destroy()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a scroll spring\r\n *\r\n * @param container - Scrollable container element\r\n * @param config - Scroll spring configuration\r\n * @returns Scroll spring controller\r\n *\r\n * @example\r\n * ```ts\r\n * const scroll = createScrollSpring(container, {\r\n *   onScroll: (x, y) => {\r\n *     content.style.transform = `translate(${-x}px, ${-y}px)`\r\n *   },\r\n * })\r\n * ```\r\n */\r\nexport function createScrollSpring(\r\n  container: HTMLElement,\r\n  config?: ScrollSpringConfig\r\n): ScrollSpring {\r\n  return new ScrollSpringImpl(container, config)\r\n}\r\n","/**\n * Advanced Gesture System - Multi-touch gestures with spring physics\n *\n * Provides pinch, rotate, swipe, and long-press detection with\n * velocity tracking and spring-based animations.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Point in 2D space\n */\nexport interface Point {\n  x: number\n  y: number\n}\n\n/**\n * Gesture state shared across all gesture types\n */\nexport interface GestureState {\n  /** Whether gesture is active */\n  active: boolean\n  /** First touch/pointer position */\n  first: boolean\n  /** Last event in gesture */\n  last: boolean\n  /** Event that triggered the gesture */\n  event: PointerEvent | TouchEvent\n  /** Time since gesture started (ms) */\n  elapsedTime: number\n  /** Gesture was cancelled */\n  cancelled: boolean\n}\n\n/**\n * Pinch gesture state\n */\nexport interface PinchState extends GestureState {\n  /** Current scale (1 = original) */\n  scale: number\n  /** Scale velocity */\n  velocity: number\n  /** Distance between fingers */\n  distance: number\n  /** Initial distance between fingers */\n  initialDistance: number\n  /** Center point between fingers */\n  origin: Point\n  /** Movement delta */\n  movement: number\n  /** Scale offset from initial */\n  offset: number\n}\n\n/**\n * Rotate gesture state\n */\nexport interface RotateState extends GestureState {\n  /** Current rotation in degrees */\n  angle: number\n  /** Angular velocity (degrees/second) */\n  velocity: number\n  /** Initial angle */\n  initialAngle: number\n  /** Center point of rotation */\n  origin: Point\n  /** Rotation movement */\n  movement: number\n  /** Rotation offset from initial */\n  offset: number\n}\n\n/**\n * Swipe gesture state\n */\nexport interface SwipeState extends GestureState {\n  /** Swipe direction */\n  direction: 'up' | 'down' | 'left' | 'right' | null\n  /** Swipe velocity */\n  velocity: Point\n  /** Distance swiped */\n  distance: Point\n  /** Movement from start */\n  movement: Point\n  /** Swipe duration in ms */\n  duration: number\n}\n\n/**\n * Long press gesture state\n */\nexport interface LongPressState extends GestureState {\n  /** Press position */\n  position: Point\n  /** Press duration in ms */\n  duration: number\n  /** Whether threshold was reached */\n  triggered: boolean\n}\n\n/**\n * Pinch gesture configuration\n */\nexport interface PinchConfig {\n  /** Minimum scale (default: 0.1) */\n  minScale?: number\n  /** Maximum scale (default: 10) */\n  maxScale?: number\n  /** Enable rubber band at limits */\n  rubberBand?: boolean\n  /** Rubber band factor (0-1) */\n  rubberBandFactor?: number\n  /** Spring config for release animation */\n  spring?: {\n    stiffness?: number\n    damping?: number\n  }\n  /** Callback on pinch */\n  onPinch?: (state: PinchState) => void\n  /** Callback when pinch starts */\n  onPinchStart?: (state: PinchState) => void\n  /** Callback when pinch ends */\n  onPinchEnd?: (state: PinchState) => void\n}\n\n/**\n * Rotate gesture configuration\n */\nexport interface RotateConfig {\n  /** Enable rotation (default: true) */\n  enabled?: boolean\n  /** Minimum rotation threshold in degrees */\n  threshold?: number\n  /** Callback on rotate */\n  onRotate?: (state: RotateState) => void\n  /** Callback when rotation starts */\n  onRotateStart?: (state: RotateState) => void\n  /** Callback when rotation ends */\n  onRotateEnd?: (state: RotateState) => void\n}\n\n/**\n * Swipe gesture configuration\n */\nexport interface SwipeConfig {\n  /** Minimum velocity to trigger swipe (pixels/ms) */\n  velocityThreshold?: number\n  /** Minimum distance to trigger swipe (pixels) */\n  distanceThreshold?: number\n  /** Maximum duration for swipe (ms) */\n  maxDuration?: number\n  /** Axis constraint */\n  axis?: 'x' | 'y' | 'both'\n  /** Callback on swipe */\n  onSwipe?: (state: SwipeState) => void\n  /** Callback when swipe starts */\n  onSwipeStart?: (state: SwipeState) => void\n  /** Callback when swipe ends */\n  onSwipeEnd?: (state: SwipeState) => void\n}\n\n/**\n * Long press gesture configuration\n */\nexport interface LongPressConfig {\n  /** Duration to trigger long press (ms, default: 500) */\n  threshold?: number\n  /** Movement tolerance (pixels) */\n  movementTolerance?: number\n  /** Callback when long press triggers */\n  onLongPress?: (state: LongPressState) => void\n  /** Callback on press start */\n  onPressStart?: (state: LongPressState) => void\n  /** Callback on press end */\n  onPressEnd?: (state: LongPressState) => void\n}\n\n/**\n * Combined gesture configuration\n */\nexport interface GestureConfig {\n  pinch?: PinchConfig\n  rotate?: RotateConfig\n  swipe?: SwipeConfig\n  longPress?: LongPressConfig\n}\n\n/**\n * Gesture controller interface\n */\nexport interface GestureController {\n  /** Enable gestures */\n  enable(): void\n  /** Disable gestures */\n  disable(): void\n  /** Check if enabled */\n  isEnabled(): boolean\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Utility Functions ============\n\n/**\n * Calculate distance between two points\n */\nfunction getDistance(p1: Point, p2: Point): number {\n  const dx = p2.x - p1.x\n  const dy = p2.y - p1.y\n  return Math.sqrt(dx * dx + dy * dy)\n}\n\n/**\n * Calculate angle between two points in degrees\n */\nfunction getAngle(p1: Point, p2: Point): number {\n  return (Math.atan2(p2.y - p1.y, p2.x - p1.x) * 180) / Math.PI\n}\n\n/**\n * Get center point between two points\n */\nfunction getCenter(p1: Point, p2: Point): Point {\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2,\n  }\n}\n\n/**\n * Apply rubber band effect\n */\nfunction rubberBand(value: number, min: number, max: number, factor: number): number {\n  if (value < min) {\n    return min - Math.pow(min - value, factor)\n  }\n  if (value > max) {\n    return max + Math.pow(value - max, factor)\n  }\n  return value\n}\n\n// ============ Pinch Gesture ============\n\n/**\n * Create pinch gesture handler\n *\n * @example\n * ```ts\n * const pinch = createPinchGesture(element, {\n *   onPinch: (state) => {\n *     element.style.transform = `scale(${state.scale})`\n *   },\n * })\n * ```\n */\nexport function createPinchGesture(\n  element: HTMLElement,\n  config: PinchConfig = {}\n): GestureController {\n  const {\n    minScale = 0.1,\n    maxScale = 10,\n    rubberBand: enableRubberBand = true,\n    rubberBandFactor = 0.5,\n    spring = { stiffness: 200, damping: 20 },\n    onPinch,\n    onPinchStart,\n    onPinchEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let initialDistance = 0\n  let initialScale = 1\n  let currentScale = 1\n  let lastScale = 1\n  let velocity = 0\n  let startTime = 0\n  let lastTime = 0\n\n  const touches = new Map<number, Point>()\n  let scaleSpring: SpringValue | null = null\n\n  const createState = (event: TouchEvent, first = false, last = false): PinchState => {\n    const touchArray = Array.from(touches.values())\n    const p1 = touchArray[0] ?? { x: 0, y: 0 }\n    const p2 = touchArray[1] ?? { x: 0, y: 0 }\n    const origin = touchArray.length >= 2 ? getCenter(p1, p2) : { x: 0, y: 0 }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: performance.now() - startTime,\n      cancelled: false,\n      scale: currentScale,\n      velocity,\n      distance: touchArray.length >= 2 ? getDistance(p1, p2) : 0,\n      initialDistance,\n      origin,\n      movement: currentScale - initialScale,\n      offset: currentScale - 1,\n    }\n  }\n\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!enabled) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n    }\n\n    if (touches.size === 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      initialDistance = getDistance(p1, p2)\n      initialScale = currentScale\n      startTime = performance.now()\n      lastTime = startTime\n      active = true\n\n      // Cancel any spring animation\n      scaleSpring?.destroy()\n      scaleSpring = null\n\n      onPinchStart?.(createState(e, true, false))\n    }\n  }\n\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!enabled || !active) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      if (touches.has(touch.identifier)) {\n        touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n      }\n    }\n\n    if (touches.size >= 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      const currentDistance = getDistance(p1, p2)\n      const now = performance.now()\n      const dt = now - lastTime\n\n      // Calculate new scale\n      let newScale = initialScale * (currentDistance / initialDistance)\n\n      // Apply rubber band at limits\n      if (enableRubberBand) {\n        newScale = rubberBand(newScale, minScale, maxScale, rubberBandFactor)\n      } else {\n        newScale = clamp(newScale, minScale, maxScale)\n      }\n\n      // Calculate velocity\n      velocity = dt > 0 ? ((newScale - lastScale) / dt) * 1000 : 0\n      lastScale = currentScale\n      currentScale = newScale\n      lastTime = now\n\n      onPinch?.(createState(e, false, false))\n      e.preventDefault()\n    }\n  }\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.delete(touch.identifier)\n    }\n\n    if (active && touches.size < 2) {\n      active = false\n\n      // Spring back to limits if out of bounds\n      if (currentScale < minScale || currentScale > maxScale) {\n        const targetScale = clamp(currentScale, minScale, maxScale)\n        scaleSpring = createSpringValue(currentScale, {\n          stiffness: spring.stiffness,\n          damping: spring.damping,\n        })\n\n        scaleSpring.subscribe(() => {\n          currentScale = scaleSpring!.get()\n          onPinch?.(createState(e, false, false))\n        })\n\n        scaleSpring.set(targetScale)\n      }\n\n      onPinchEnd?.(createState(e, false, true))\n    }\n  }\n\n  element.addEventListener('touchstart', handleTouchStart, { passive: false })\n  element.addEventListener('touchmove', handleTouchMove, { passive: false })\n  element.addEventListener('touchend', handleTouchEnd)\n  element.addEventListener('touchcancel', handleTouchEnd)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('touchstart', handleTouchStart)\n      element.removeEventListener('touchmove', handleTouchMove)\n      element.removeEventListener('touchend', handleTouchEnd)\n      element.removeEventListener('touchcancel', handleTouchEnd)\n      scaleSpring?.destroy()\n    },\n  }\n}\n\n// ============ Rotate Gesture ============\n\n/**\n * Create rotate gesture handler\n *\n * @example\n * ```ts\n * const rotate = createRotateGesture(element, {\n *   onRotate: (state) => {\n *     element.style.transform = `rotate(${state.angle}deg)`\n *   },\n * })\n * ```\n */\nexport function createRotateGesture(\n  element: HTMLElement,\n  config: RotateConfig = {}\n): GestureController {\n  const {\n    enabled: initialEnabled = true,\n    threshold = 0,\n    onRotate,\n    onRotateStart,\n    onRotateEnd,\n  } = config\n\n  let enabled = initialEnabled\n  let active = false\n  let initialAngle = 0\n  let currentAngle = 0\n  let lastAngle = 0\n  let velocity = 0\n  let startTime = 0\n  let lastTime = 0\n  let angleOffset = 0\n\n  const touches = new Map<number, Point>()\n\n  const createState = (event: TouchEvent, first = false, last = false): RotateState => {\n    const touchArray = Array.from(touches.values())\n    const p1 = touchArray[0] ?? { x: 0, y: 0 }\n    const p2 = touchArray[1] ?? { x: 0, y: 0 }\n    const origin = touchArray.length >= 2 ? getCenter(p1, p2) : { x: 0, y: 0 }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: performance.now() - startTime,\n      cancelled: false,\n      angle: currentAngle,\n      velocity,\n      initialAngle,\n      origin,\n      movement: currentAngle - initialAngle,\n      offset: angleOffset,\n    }\n  }\n\n  const handleTouchStart = (e: TouchEvent) => {\n    if (!enabled) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n    }\n\n    if (touches.size === 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      initialAngle = getAngle(p1, p2)\n      startTime = performance.now()\n      lastTime = startTime\n      lastAngle = currentAngle\n      active = true\n\n      onRotateStart?.(createState(e, true, false))\n    }\n  }\n\n  const handleTouchMove = (e: TouchEvent) => {\n    if (!enabled || !active) return\n\n    for (const touch of Array.from(e.changedTouches)) {\n      if (touches.has(touch.identifier)) {\n        touches.set(touch.identifier, { x: touch.clientX, y: touch.clientY })\n      }\n    }\n\n    if (touches.size >= 2) {\n      const touchArray = Array.from(touches.values())\n      const p1 = touchArray[0]!\n      const p2 = touchArray[1]!\n      const newAngle = getAngle(p1, p2)\n      const now = performance.now()\n      const dt = now - lastTime\n\n      // Calculate angle delta (handle wrap-around)\n      let angleDelta = newAngle - initialAngle\n      if (angleDelta > 180) angleDelta -= 360\n      if (angleDelta < -180) angleDelta += 360\n\n      // Apply threshold\n      if (Math.abs(angleDelta) >= threshold) {\n        currentAngle = angleOffset + angleDelta\n\n        // Calculate velocity\n        velocity = dt > 0 ? ((currentAngle - lastAngle) / dt) * 1000 : 0\n        lastAngle = currentAngle\n        lastTime = now\n\n        onRotate?.(createState(e, false, false))\n      }\n\n      e.preventDefault()\n    }\n  }\n\n  const handleTouchEnd = (e: TouchEvent) => {\n    for (const touch of Array.from(e.changedTouches)) {\n      touches.delete(touch.identifier)\n    }\n\n    if (active && touches.size < 2) {\n      active = false\n      angleOffset = currentAngle\n      onRotateEnd?.(createState(e, false, true))\n    }\n  }\n\n  element.addEventListener('touchstart', handleTouchStart, { passive: false })\n  element.addEventListener('touchmove', handleTouchMove, { passive: false })\n  element.addEventListener('touchend', handleTouchEnd)\n  element.addEventListener('touchcancel', handleTouchEnd)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('touchstart', handleTouchStart)\n      element.removeEventListener('touchmove', handleTouchMove)\n      element.removeEventListener('touchend', handleTouchEnd)\n      element.removeEventListener('touchcancel', handleTouchEnd)\n    },\n  }\n}\n\n// ============ Swipe Gesture ============\n\n/**\n * Create swipe gesture handler\n *\n * @example\n * ```ts\n * const swipe = createSwipeGesture(element, {\n *   onSwipe: (state) => {\n *     if (state.direction === 'left') {\n *       goToNextSlide()\n *     }\n *   },\n * })\n * ```\n */\nexport function createSwipeGesture(\n  element: HTMLElement,\n  config: SwipeConfig = {}\n): GestureController {\n  const {\n    velocityThreshold = 0.5,\n    distanceThreshold = 50,\n    maxDuration = 300,\n    axis = 'both',\n    onSwipe,\n    onSwipeStart,\n    onSwipeEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let startPoint: Point = { x: 0, y: 0 }\n  let lastPoint: Point = { x: 0, y: 0 }\n  let startTime = 0\n  let lastTime = 0\n  let pointerId: number | null = null\n\n  const createState = (\n    event: PointerEvent,\n    first = false,\n    last = false,\n    direction: SwipeState['direction'] = null\n  ): SwipeState => {\n    const now = performance.now()\n    const duration = now - startTime\n    const dt = now - lastTime\n\n    const movement = {\n      x: event.clientX - startPoint.x,\n      y: event.clientY - startPoint.y,\n    }\n\n    const velocity = {\n      x: dt > 0 ? (event.clientX - lastPoint.x) / dt : 0,\n      y: dt > 0 ? (event.clientY - lastPoint.y) / dt : 0,\n    }\n\n    return {\n      active,\n      first,\n      last,\n      event,\n      elapsedTime: duration,\n      cancelled: false,\n      direction,\n      velocity,\n      distance: movement,\n      movement,\n      duration,\n    }\n  }\n\n  const detectDirection = (movement: Point, velocity: Point): SwipeState['direction'] => {\n    const absX = Math.abs(movement.x)\n    const absY = Math.abs(movement.y)\n    const velX = Math.abs(velocity.x)\n    const velY = Math.abs(velocity.y)\n\n    // Check if meets thresholds\n    const meetsDistanceX = absX >= distanceThreshold\n    const meetsDistanceY = absY >= distanceThreshold\n    const meetsVelocityX = velX >= velocityThreshold\n    const meetsVelocityY = velY >= velocityThreshold\n\n    // Determine primary direction based on axis constraint\n    if (axis === 'x' || (axis === 'both' && absX > absY)) {\n      if ((meetsDistanceX || meetsVelocityX)) {\n        return movement.x > 0 ? 'right' : 'left'\n      }\n    }\n\n    if (axis === 'y' || (axis === 'both' && absY > absX)) {\n      if ((meetsDistanceY || meetsVelocityY)) {\n        return movement.y > 0 ? 'down' : 'up'\n      }\n    }\n\n    return null\n  }\n\n  const handlePointerDown = (e: PointerEvent) => {\n    if (!enabled || pointerId !== null) return\n\n    pointerId = e.pointerId\n    startPoint = { x: e.clientX, y: e.clientY }\n    lastPoint = { ...startPoint }\n    startTime = performance.now()\n    lastTime = startTime\n    active = true\n\n    element.setPointerCapture(e.pointerId)\n    onSwipeStart?.(createState(e, true, false))\n  }\n\n  const handlePointerMove = (e: PointerEvent) => {\n    if (!enabled || !active || e.pointerId !== pointerId) return\n\n    const now = performance.now()\n    lastPoint = { x: e.clientX, y: e.clientY }\n    lastTime = now\n  }\n\n  const handlePointerUp = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    active = false\n    pointerId = null\n\n    const duration = performance.now() - startTime\n\n    // Only detect swipe if within max duration\n    if (duration <= maxDuration) {\n      const movement = {\n        x: e.clientX - startPoint.x,\n        y: e.clientY - startPoint.y,\n      }\n      const dt = performance.now() - lastTime\n      const velocity = {\n        x: dt > 0 ? (e.clientX - lastPoint.x) / dt : 0,\n        y: dt > 0 ? (e.clientY - lastPoint.y) / dt : 0,\n      }\n\n      const direction = detectDirection(movement, velocity)\n      const state = createState(e, false, true, direction)\n\n      if (direction) {\n        onSwipe?.(state)\n      }\n      onSwipeEnd?.(state)\n    } else {\n      onSwipeEnd?.(createState(e, false, true, null))\n    }\n\n    // Safety check: element might be removed from DOM\n    try {\n      element.releasePointerCapture(e.pointerId)\n    } catch {\n      // Ignore errors if pointer capture was already released\n    }\n  }\n\n  element.addEventListener('pointerdown', handlePointerDown)\n  element.addEventListener('pointermove', handlePointerMove)\n  element.addEventListener('pointerup', handlePointerUp)\n  element.addEventListener('pointercancel', handlePointerUp)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      element.removeEventListener('pointerdown', handlePointerDown)\n      element.removeEventListener('pointermove', handlePointerMove)\n      element.removeEventListener('pointerup', handlePointerUp)\n      element.removeEventListener('pointercancel', handlePointerUp)\n    },\n  }\n}\n\n// ============ Long Press Gesture ============\n\n/**\n * Create long press gesture handler\n *\n * @example\n * ```ts\n * const longPress = createLongPressGesture(element, {\n *   threshold: 500,\n *   onLongPress: (state) => {\n *     showContextMenu(state.position)\n *   },\n * })\n * ```\n */\nexport function createLongPressGesture(\n  element: HTMLElement,\n  config: LongPressConfig = {}\n): GestureController {\n  const {\n    threshold = 500,\n    movementTolerance = 10,\n    onLongPress,\n    onPressStart,\n    onPressEnd,\n  } = config\n\n  let enabled = true\n  let active = false\n  let triggered = false\n  let startPoint: Point = { x: 0, y: 0 }\n  let startTime = 0\n  let timerId: ReturnType<typeof setTimeout> | null = null\n  let pointerId: number | null = null\n\n  const createState = (event: PointerEvent, first = false, last = false): LongPressState => ({\n    active,\n    first,\n    last,\n    event,\n    elapsedTime: performance.now() - startTime,\n    cancelled: false,\n    position: startPoint,\n    duration: performance.now() - startTime,\n    triggered,\n  })\n\n  const handlePointerDown = (e: PointerEvent) => {\n    if (!enabled || pointerId !== null) return\n\n    pointerId = e.pointerId\n    startPoint = { x: e.clientX, y: e.clientY }\n    startTime = performance.now()\n    active = true\n    triggered = false\n\n    element.setPointerCapture(e.pointerId)\n    onPressStart?.(createState(e, true, false))\n\n    // Start timer for long press\n    timerId = setTimeout(() => {\n      if (active && !triggered) {\n        triggered = true\n        onLongPress?.(createState(e, false, false))\n      }\n    }, threshold)\n  }\n\n  const handlePointerMove = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    // Check if moved beyond tolerance\n    const dx = e.clientX - startPoint.x\n    const dy = e.clientY - startPoint.y\n    const distance = Math.sqrt(dx * dx + dy * dy)\n\n    if (distance > movementTolerance) {\n      // Cancel long press\n      if (timerId) {\n        clearTimeout(timerId)\n        timerId = null\n      }\n    }\n  }\n\n  const handlePointerUp = (e: PointerEvent) => {\n    if (!active || e.pointerId !== pointerId) return\n\n    active = false\n    pointerId = null\n\n    if (timerId) {\n      clearTimeout(timerId)\n      timerId = null\n    }\n\n    onPressEnd?.(createState(e, false, true))\n\n    // Safety check: element might be removed from DOM\n    try {\n      element.releasePointerCapture(e.pointerId)\n    } catch {\n      // Ignore errors if pointer capture was already released\n    }\n  }\n\n  element.addEventListener('pointerdown', handlePointerDown)\n  element.addEventListener('pointermove', handlePointerMove)\n  element.addEventListener('pointerup', handlePointerUp)\n  element.addEventListener('pointercancel', handlePointerUp)\n\n  return {\n    enable: () => { enabled = true },\n    disable: () => { enabled = false },\n    isEnabled: () => enabled,\n    destroy: () => {\n      if (timerId) clearTimeout(timerId)\n      element.removeEventListener('pointerdown', handlePointerDown)\n      element.removeEventListener('pointermove', handlePointerMove)\n      element.removeEventListener('pointerup', handlePointerUp)\n      element.removeEventListener('pointercancel', handlePointerUp)\n    },\n  }\n}\n\n// ============ Combined Gesture Handler ============\n\n/**\n * Create combined gesture handler for multiple gesture types\n *\n * @example\n * ```ts\n * const gestures = createGestures(element, {\n *   pinch: {\n *     onPinch: (state) => console.log('Scale:', state.scale),\n *   },\n *   rotate: {\n *     onRotate: (state) => console.log('Angle:', state.angle),\n *   },\n *   swipe: {\n *     onSwipe: (state) => console.log('Direction:', state.direction),\n *   },\n * })\n * ```\n */\nexport function createGestures(\n  element: HTMLElement,\n  config: GestureConfig\n): GestureController {\n  const controllers: GestureController[] = []\n\n  if (config.pinch) {\n    controllers.push(createPinchGesture(element, config.pinch))\n  }\n  if (config.rotate) {\n    controllers.push(createRotateGesture(element, config.rotate))\n  }\n  if (config.swipe) {\n    controllers.push(createSwipeGesture(element, config.swipe))\n  }\n  if (config.longPress) {\n    controllers.push(createLongPressGesture(element, config.longPress))\n  }\n\n  return {\n    enable: () => controllers.forEach(c => c.enable()),\n    disable: () => controllers.forEach(c => c.disable()),\n    isEnabled: () => controllers.every(c => c.isEnabled()),\n    destroy: () => controllers.forEach(c => c.destroy()),\n  }\n}\n","\r\n/**\r\n * RGB color representation\r\n */\r\nexport interface RGB {\r\n  r: number\r\n  g: number\r\n  b: number\r\n}\r\n\r\n/**\r\n * HSL color representation\r\n */\r\nexport interface HSL {\r\n  h: number\r\n  s: number\r\n  l: number\r\n}\r\n\r\n/**\r\n * Parse a color string to RGB\r\n * Supports hex (#rgb, #rrggbb), rgb(), and named colors\r\n * @param color - The color string to parse\r\n * @returns The RGB representation\r\n */\r\nexport function parseColor(color: string): RGB {\r\n  // Try hex format first\r\n  const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\r\n  if (hexMatch) {\r\n    return hexToRgb(color)\r\n  }\r\n\r\n  // Try rgb() format\r\n  const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\r\n  if (rgbMatch) {\r\n    return {\r\n      r: parseInt(rgbMatch[1]!, 10),\r\n      g: parseInt(rgbMatch[2]!, 10),\r\n      b: parseInt(rgbMatch[3]!, 10),\r\n    }\r\n  }\r\n\r\n  // Try rgba() format\r\n  const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\r\n  if (rgbaMatch) {\r\n    return {\r\n      r: parseInt(rgbaMatch[1]!, 10),\r\n      g: parseInt(rgbaMatch[2]!, 10),\r\n      b: parseInt(rgbaMatch[3]!, 10),\r\n    }\r\n  }\r\n\r\n  // Try hsl() format\r\n  const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\r\n  if (hslMatch) {\r\n    return hslToRgb(\r\n      parseInt(hslMatch[1]!, 10),\r\n      parseInt(hslMatch[2]!, 10),\r\n      parseInt(hslMatch[3]!, 10)\r\n    )\r\n  }\r\n\r\n  // Default to black for unknown formats\r\n  return { r: 0, g: 0, b: 0 }\r\n}\r\n\r\n/**\r\n * Convert RGB to hex color string\r\n * @param r - Red component (0-255)\r\n * @param g - Green component (0-255)\r\n * @param b - Blue component (0-255)\r\n * @returns Hex color string\r\n */\r\nexport function rgbToHex(r: number, g: number, b: number): string {\r\n  const toHex = (n: number): string => {\r\n    const clamped = Math.round(Math.max(0, Math.min(255, n)))\r\n    return clamped.toString(16).padStart(2, '0')\r\n  }\r\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}`\r\n}\r\n\r\n/**\r\n * Convert hex color string to RGB\r\n * @param hex - Hex color string (with or without #)\r\n * @returns RGB representation\r\n */\r\nexport function hexToRgb(hex: string): RGB {\r\n  const cleanHex = hex.replace('#', '')\r\n\r\n  if (cleanHex.length === 3) {\r\n    return {\r\n      r: parseInt(cleanHex.charAt(0) + cleanHex.charAt(0), 16),\r\n      g: parseInt(cleanHex.charAt(1) + cleanHex.charAt(1), 16),\r\n      b: parseInt(cleanHex.charAt(2) + cleanHex.charAt(2), 16),\r\n    }\r\n  }\r\n\r\n  return {\r\n    r: parseInt(cleanHex.slice(0, 2), 16),\r\n    g: parseInt(cleanHex.slice(2, 4), 16),\r\n    b: parseInt(cleanHex.slice(4, 6), 16),\r\n  }\r\n}\r\n\r\n/**\r\n * Convert HSL to RGB\r\n * @param h - Hue (0-360)\r\n * @param s - Saturation (0-100)\r\n * @param l - Lightness (0-100)\r\n * @returns RGB representation\r\n */\r\nexport function hslToRgb(h: number, s: number, l: number): RGB {\r\n  h = ((h % 360) + 360) % 360\r\n  s = Math.max(0, Math.min(100, s)) / 100\r\n  l = Math.max(0, Math.min(100, l)) / 100\r\n\r\n  if (s === 0) {\r\n    const gray = Math.round(l * 255)\r\n    return { r: gray, g: gray, b: gray }\r\n  }\r\n\r\n  const hue2rgb = (p: number, q: number, t: number): number => {\r\n    if (t < 0) t += 1\r\n    if (t > 1) t -= 1\r\n    if (t < 1 / 6) return p + (q - p) * 6 * t\r\n    if (t < 1 / 2) return q\r\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\r\n    return p\r\n  }\r\n\r\n  const q = l < 0.5 ? l * (1 + s) : l + s - l * s\r\n  const p = 2 * l - q\r\n\r\n  return {\r\n    r: Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\r\n    g: Math.round(hue2rgb(p, q, h / 360) * 255),\r\n    b: Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\r\n  }\r\n}\r\n\r\n/**\r\n * Convert RGB to HSL\r\n * @param r - Red component (0-255)\r\n * @param g - Green component (0-255)\r\n * @param b - Blue component (0-255)\r\n * @returns HSL representation\r\n */\r\nexport function rgbToHsl(r: number, g: number, b: number): HSL {\r\n  r = Math.max(0, Math.min(255, r)) / 255\r\n  g = Math.max(0, Math.min(255, g)) / 255\r\n  b = Math.max(0, Math.min(255, b)) / 255\r\n\r\n  const max = Math.max(r, g, b)\r\n  const min = Math.min(r, g, b)\r\n  const delta = max - min\r\n\r\n  let h = 0\r\n  let s = 0\r\n\r\n  if (delta !== 0) {\r\n    s = (max + min) / 2 > 0.5\r\n      ? delta / (2 - max - min)\r\n      : delta / (max + min)\r\n\r\n    if (max === r) {\r\n      h = ((g - b) / delta + (g < b ? 6 : 0)) / 6\r\n    } else if (max === g) {\r\n      h = ((b - r) / delta + 2) / 6\r\n    } else {\r\n      h = ((r - g) / delta + 4) / 6\r\n    }\r\n  }\r\n\r\n  return {\r\n    h: Math.round(h * 360),\r\n    s: Math.round(s * 100),\r\n    l: Math.round(((max + min) / 2) * 100),\r\n  }\r\n}\r\n","/**\r\n * Scroll-linked animations - Bind animations directly to scroll position\r\n *\r\n * Unlike spring-based scroll animations, these animations are directly\r\n * tied to scroll progress (0-1) for precise control.\r\n */\r\n\r\nimport { clamp, lerp } from '../utils/math.js'\r\nimport { parseColor, rgbToHex } from '../utils/color.js'\r\n\r\n/**\r\n * Simple color lerp for scroll-linked animations\r\n */\r\nfunction lerpColor(colorA: string, colorB: string, t: number): string {\r\n  const a = parseColor(colorA)\r\n  const b = parseColor(colorB)\r\n  return rgbToHex(\r\n    Math.round(lerp(a.r, b.r, t)),\r\n    Math.round(lerp(a.g, b.g, t)),\r\n    Math.round(lerp(a.b, b.b, t))\r\n  )\r\n}\r\n\r\n/**\r\n * Scroll progress info passed to callbacks\r\n */\r\nexport interface ScrollInfo {\r\n  /** Progress from 0 to 1 */\r\n  progress: number\r\n  /** Absolute scroll position in pixels */\r\n  scrollY: number\r\n  /** Scroll velocity in pixels per second */\r\n  velocity: number\r\n  /** Scroll direction: 1 = down, -1 = up, 0 = stationary */\r\n  direction: -1 | 0 | 1\r\n  /** Whether element is in viewport */\r\n  isInView: boolean\r\n  /** How much of the element is visible (0-1) */\r\n  visibleRatio: number\r\n}\r\n\r\n/**\r\n * Scroll trigger configuration\r\n */\r\nexport interface ScrollTriggerConfig {\r\n  /** Start trigger position: 'top', 'center', 'bottom', or pixel value */\r\n  start?: 'top' | 'center' | 'bottom' | number\r\n  /** End trigger position: 'top', 'center', 'bottom', or pixel value */\r\n  end?: 'top' | 'center' | 'bottom' | number\r\n  /** Offset from start position in pixels */\r\n  startOffset?: number\r\n  /** Offset from end position in pixels */\r\n  endOffset?: number\r\n  /** Callback when entering viewport */\r\n  onEnter?: (info: ScrollInfo) => void\r\n  /** Callback when leaving viewport */\r\n  onLeave?: (info: ScrollInfo) => void\r\n  /** Callback on progress update */\r\n  onProgress?: (info: ScrollInfo) => void\r\n  /** Only trigger once */\r\n  once?: boolean\r\n  /** Scrub animation to scroll (true = instant, number = smoothing factor) */\r\n  scrub?: boolean | number\r\n}\r\n\r\n/**\r\n * Parallax configuration\r\n */\r\nexport interface ParallaxConfig {\r\n  /** Speed multiplier (negative = opposite direction) */\r\n  speed?: number\r\n  /** Direction of parallax effect */\r\n  direction?: 'vertical' | 'horizontal'\r\n  /** Easing function */\r\n  easing?: (t: number) => number\r\n  /** Root margin for intersection observer */\r\n  rootMargin?: string\r\n}\r\n\r\n/**\r\n * Scroll-linked value configuration\r\n */\r\nexport interface ScrollLinkedConfig {\r\n  /** Input range (scroll positions or progress values) */\r\n  inputRange: number[]\r\n  /** Output range (values to interpolate between) */\r\n  outputRange: (number | string)[]\r\n  /** Clamp output to range */\r\n  clamp?: boolean\r\n  /** Use smooth interpolation */\r\n  smooth?: number\r\n  /** Easing function */\r\n  easing?: (t: number) => number\r\n}\r\n\r\n/**\r\n * Scroll progress tracker\r\n */\r\nexport interface ScrollProgress {\r\n  /** Get current progress (0-1) */\r\n  get(): number\r\n  /** Get current scroll info */\r\n  getInfo(): ScrollInfo\r\n  /** Subscribe to progress changes */\r\n  subscribe(callback: (info: ScrollInfo) => void): () => void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Parallax controller\r\n */\r\nexport interface Parallax {\r\n  /** Get current offset */\r\n  getOffset(): number\r\n  /** Update parallax (call on scroll) */\r\n  update(): void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Scroll trigger controller\r\n */\r\nexport interface ScrollTrigger {\r\n  /** Check if currently active */\r\n  isActive(): boolean\r\n  /** Get current progress within trigger range */\r\n  getProgress(): number\r\n  /** Refresh trigger calculations */\r\n  refresh(): void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Scroll-linked value controller\r\n */\r\nexport interface ScrollLinkedValue {\r\n  /** Get current interpolated value */\r\n  get(): number | string\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (value: number | string) => void): () => void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n// ============ Implementation ============\r\n\r\n/**\r\n * Create scroll progress tracker for an element\r\n */\r\nexport function createScrollProgress(\r\n  element?: HTMLElement | null,\r\n  options: {\r\n    offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\r\n    smooth?: number\r\n  } = {}\r\n): ScrollProgress {\r\n  const { offset = ['start', 'end'], smooth = 0 } = options\r\n\r\n  let progress = 0\r\n  let smoothedProgress = 0\r\n  let lastScrollY = 0\r\n  let lastTime = performance.now()\r\n  let velocity = 0\r\n  let direction: -1 | 0 | 1 = 0\r\n  let rafId: number | null = null\r\n  const subscribers = new Set<(info: ScrollInfo) => void>()\r\n\r\n  const calculateProgress = (): ScrollInfo => {\r\n    const scrollY = window.scrollY\r\n    const windowHeight = window.innerHeight\r\n    const now = performance.now()\r\n    const dt = Math.max(now - lastTime, 1)\r\n\r\n    // Calculate velocity and direction\r\n    velocity = ((scrollY - lastScrollY) / dt) * 1000\r\n    direction = scrollY > lastScrollY ? 1 : scrollY < lastScrollY ? -1 : 0\r\n    lastScrollY = scrollY\r\n    lastTime = now\r\n\r\n    let newProgress: number\r\n    let isInView = true\r\n    let visibleRatio = 1\r\n\r\n    if (element) {\r\n      const rect = element.getBoundingClientRect()\r\n      const elementTop = rect.top + scrollY\r\n      const elementHeight = rect.height\r\n\r\n      // Calculate start and end points based on offset\r\n      const startPoint = offset[0] === 'start' ? elementTop :\r\n                        offset[0] === 'center' ? elementTop + elementHeight / 2 :\r\n                        elementTop + elementHeight\r\n\r\n      const endPoint = offset[1] === 'start' ? windowHeight :\r\n                      offset[1] === 'center' ? windowHeight / 2 :\r\n                      0\r\n\r\n      const scrollStart = startPoint - windowHeight\r\n      const scrollEnd = startPoint - endPoint\r\n\r\n      newProgress = clamp((scrollY - scrollStart) / (scrollEnd - scrollStart), 0, 1)\r\n\r\n      // Check if in view\r\n      isInView = rect.top < windowHeight && rect.bottom > 0\r\n      visibleRatio = isInView ?\r\n        clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0\r\n    } else {\r\n      // Track overall page scroll\r\n      const documentHeight = document.documentElement.scrollHeight - windowHeight\r\n      newProgress = documentHeight > 0 ? clamp(scrollY / documentHeight, 0, 1) : 0\r\n    }\r\n\r\n    // Apply smoothing\r\n    if (smooth > 0) {\r\n      smoothedProgress = lerp(smoothedProgress, newProgress, 1 - smooth)\r\n      progress = smoothedProgress\r\n    } else {\r\n      progress = newProgress\r\n    }\r\n\r\n    return {\r\n      progress,\r\n      scrollY,\r\n      velocity,\r\n      direction,\r\n      isInView,\r\n      visibleRatio,\r\n    }\r\n  }\r\n\r\n  const notify = (info: ScrollInfo) => {\r\n    subscribers.forEach(cb => cb(info))\r\n  }\r\n\r\n  const onScroll = () => {\r\n    if (rafId) return\r\n    rafId = requestAnimationFrame(() => {\r\n      rafId = null\r\n      const info = calculateProgress()\r\n      notify(info)\r\n    })\r\n  }\r\n\r\n  // Initial calculation\r\n  const initialInfo = calculateProgress()\r\n\r\n  window.addEventListener('scroll', onScroll, { passive: true })\r\n  window.addEventListener('resize', onScroll, { passive: true })\r\n\r\n  return {\r\n    get: () => progress,\r\n    getInfo: () => calculateProgress(),\r\n    subscribe: (callback) => {\r\n      subscribers.add(callback)\r\n      callback(initialInfo)\r\n      return () => subscribers.delete(callback)\r\n    },\r\n    destroy: () => {\r\n      if (rafId) cancelAnimationFrame(rafId)\r\n      window.removeEventListener('scroll', onScroll)\r\n      window.removeEventListener('resize', onScroll)\r\n      subscribers.clear()\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create parallax effect for an element\r\n *\r\n * @example\r\n * ```ts\r\n * const parallax = createParallax(element, { speed: 0.5 })\r\n * // Element moves at 50% scroll speed\r\n * ```\r\n */\r\nexport function createParallax(\r\n  element: HTMLElement,\r\n  config: ParallaxConfig = {}\r\n): Parallax {\r\n  const {\r\n    speed = 0.5,\r\n    direction = 'vertical',\r\n    easing = (t: number) => t,\r\n    rootMargin = '0px',\r\n  } = config\r\n\r\n  let offset = 0\r\n  let isInView = false\r\n  let observer: IntersectionObserver | null = null\r\n  let pendingRafId: number | null = null\r\n  let destroyed = false\r\n\r\n  const update = () => {\r\n    if (!isInView) return\r\n\r\n    const rect = element.getBoundingClientRect()\r\n    const windowHeight = window.innerHeight\r\n\r\n    // Calculate how far through the viewport the element is\r\n    const elementCenter = rect.top + rect.height / 2\r\n    const viewportCenter = windowHeight / 2\r\n    const distanceFromCenter = elementCenter - viewportCenter\r\n\r\n    // Apply speed and easing\r\n    const normalizedDistance = distanceFromCenter / windowHeight\r\n    const easedDistance = easing(Math.abs(normalizedDistance)) * Math.sign(normalizedDistance)\r\n    offset = easedDistance * speed * 100\r\n\r\n    // Apply transform\r\n    if (direction === 'vertical') {\r\n      element.style.transform = `translate3d(0, ${offset}px, 0)`\r\n    } else {\r\n      element.style.transform = `translate3d(${offset}px, 0, 0)`\r\n    }\r\n  }\r\n\r\n  // Use IntersectionObserver for performance\r\n  observer = new IntersectionObserver(\r\n    (entries) => {\r\n      const entry = entries[0]\r\n      if (entry) {\r\n        isInView = entry.isIntersecting\r\n        if (isInView) update()\r\n      }\r\n    },\r\n    { rootMargin }\r\n  )\r\n  observer.observe(element)\r\n\r\n  const onScroll = () => {\r\n    if (destroyed) return\r\n\r\n    if (isInView && pendingRafId === null) {\r\n      pendingRafId = requestAnimationFrame(() => {\r\n        pendingRafId = null\r\n        if (!destroyed) update()\r\n      })\r\n    }\r\n  }\r\n\r\n  window.addEventListener('scroll', onScroll, { passive: true })\r\n\r\n  return {\r\n    getOffset: () => offset,\r\n    update,\r\n    destroy: () => {\r\n      destroyed = true\r\n\r\n      // Cancel pending RAF to prevent memory leak\r\n      if (pendingRafId !== null) {\r\n        cancelAnimationFrame(pendingRafId)\r\n        pendingRafId = null\r\n      }\r\n\r\n      observer?.disconnect()\r\n      window.removeEventListener('scroll', onScroll)\r\n      element.style.transform = ''\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create scroll trigger for precise scroll-based animations\r\n *\r\n * @example\r\n * ```ts\r\n * const trigger = createScrollTrigger(element, {\r\n *   start: 'top',\r\n *   end: 'bottom',\r\n *   onProgress: (info) => {\r\n *     element.style.opacity = String(info.progress)\r\n *   },\r\n * })\r\n * ```\r\n */\r\nexport function createScrollTrigger(\r\n  element: HTMLElement,\r\n  config: ScrollTriggerConfig = {}\r\n): ScrollTrigger {\r\n  const {\r\n    start = 'top',\r\n    end = 'bottom',\r\n    startOffset = 0,\r\n    endOffset = 0,\r\n    onEnter,\r\n    onLeave,\r\n    onProgress,\r\n    once = false,\r\n    scrub = false,\r\n  } = config\r\n\r\n  let isActive = false\r\n  let progress = 0\r\n  let hasEntered = false\r\n  let smoothedProgress = 0\r\n  let rafId: number | null = null\r\n\r\n  const getPosition = (pos: 'top' | 'center' | 'bottom' | number, rect: DOMRect): number => {\r\n    if (typeof pos === 'number') return pos\r\n    switch (pos) {\r\n      case 'top': return rect.top\r\n      case 'center': return rect.top + rect.height / 2\r\n      case 'bottom': return rect.bottom\r\n    }\r\n  }\r\n\r\n  const calculateProgress = (): ScrollInfo => {\r\n    const rect = element.getBoundingClientRect()\r\n    const windowHeight = window.innerHeight\r\n\r\n    const startPos = getPosition(start, rect) + startOffset\r\n    const endPos = getPosition(end, rect) + endOffset\r\n\r\n    // Calculate progress based on viewport position\r\n    const triggerStart = windowHeight\r\n    const triggerEnd = 0\r\n\r\n    const startProgress = (triggerStart - startPos) / (triggerStart - triggerEnd)\r\n    const endProgress = (triggerStart - endPos) / (triggerStart - triggerEnd)\r\n\r\n    const rawProgress = clamp(startProgress / (endProgress || 1), 0, 1)\r\n\r\n    // Apply scrub smoothing\r\n    if (typeof scrub === 'number' && scrub > 0) {\r\n      smoothedProgress = lerp(smoothedProgress, rawProgress, 1 - scrub)\r\n      progress = smoothedProgress\r\n    } else {\r\n      progress = rawProgress\r\n    }\r\n\r\n    const isInView = rect.top < windowHeight && rect.bottom > 0\r\n\r\n    return {\r\n      progress,\r\n      scrollY: window.scrollY,\r\n      velocity: 0,\r\n      direction: 0,\r\n      isInView,\r\n      visibleRatio: isInView ? clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0,\r\n    }\r\n  }\r\n\r\n  const onScroll = () => {\r\n    if (rafId) return\r\n    rafId = requestAnimationFrame(() => {\r\n      rafId = null\r\n      const info = calculateProgress()\r\n\r\n      // Check for enter/leave\r\n      const wasActive = isActive\r\n      isActive = info.progress > 0 && info.progress < 1\r\n\r\n      if (!wasActive && isActive && (!once || !hasEntered)) {\r\n        hasEntered = true\r\n        onEnter?.(info)\r\n      }\r\n\r\n      if (wasActive && !isActive) {\r\n        onLeave?.(info)\r\n      }\r\n\r\n      if (isActive || scrub) {\r\n        onProgress?.(info)\r\n      }\r\n    })\r\n  }\r\n\r\n  window.addEventListener('scroll', onScroll, { passive: true })\r\n  window.addEventListener('resize', onScroll, { passive: true })\r\n\r\n  // Initial check\r\n  onScroll()\r\n\r\n  return {\r\n    isActive: () => isActive,\r\n    getProgress: () => progress,\r\n    refresh: () => {\r\n      calculateProgress()\r\n    },\r\n    destroy: () => {\r\n      if (rafId) cancelAnimationFrame(rafId)\r\n      window.removeEventListener('scroll', onScroll)\r\n      window.removeEventListener('resize', onScroll)\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create a scroll-linked interpolated value\r\n *\r\n * @example\r\n * ```ts\r\n * const opacity = createScrollLinkedValue(scrollProgress, {\r\n *   inputRange: [0, 0.5, 1],\r\n *   outputRange: [0, 1, 0],\r\n * })\r\n *\r\n * opacity.subscribe((value) => {\r\n *   element.style.opacity = String(value)\r\n * })\r\n * ```\r\n */\r\nexport function createScrollLinkedValue(\r\n  scrollProgress: ScrollProgress,\r\n  config: ScrollLinkedConfig\r\n): ScrollLinkedValue {\r\n  const { inputRange, outputRange, clamp: shouldClamp = true, easing } = config\r\n\r\n  if (inputRange.length !== outputRange.length) {\r\n    throw new Error('inputRange and outputRange must have the same length')\r\n  }\r\n\r\n  const firstOutput = outputRange[0]\r\n  const isColorOutput = typeof firstOutput === 'string' &&\r\n    (firstOutput.startsWith('#') || firstOutput.startsWith('rgb') || firstOutput.startsWith('hsl'))\r\n\r\n  let currentValue: number | string = firstOutput ?? 0\r\n  const subscribers = new Set<(value: number | string) => void>()\r\n\r\n  const interpolate = (progress: number): number | string => {\r\n    let p = progress\r\n    if (easing) p = easing(p)\r\n    const firstInput = inputRange[0] ?? 0\r\n    const lastInput = inputRange[inputRange.length - 1] ?? 1\r\n    if (shouldClamp) p = clamp(p, firstInput, lastInput)\r\n\r\n    // Find the segment\r\n    let segmentIndex = 0\r\n    for (let i = 0; i < inputRange.length - 1; i++) {\r\n      const curr = inputRange[i] ?? 0\r\n      const next = inputRange[i + 1] ?? 1\r\n      if (p >= curr && p <= next) {\r\n        segmentIndex = i\r\n        break\r\n      }\r\n      if (p > next) {\r\n        segmentIndex = i + 1\r\n      }\r\n    }\r\n\r\n    const segmentStart = inputRange[segmentIndex] ?? 0\r\n    const segmentEnd = inputRange[segmentIndex + 1] ?? segmentStart\r\n    const segmentProgress = segmentEnd !== segmentStart\r\n      ? (p - segmentStart) / (segmentEnd - segmentStart)\r\n      : 0\r\n\r\n    const startValue = outputRange[segmentIndex] ?? 0\r\n    const endValue = outputRange[segmentIndex + 1] ?? startValue\r\n\r\n    if (isColorOutput && typeof startValue === 'string' && typeof endValue === 'string') {\r\n      return lerpColor(startValue, endValue, segmentProgress)\r\n    }\r\n\r\n    return lerp(startValue as number, endValue as number, segmentProgress)\r\n  }\r\n\r\n  const unsubscribe = scrollProgress.subscribe((info) => {\r\n    currentValue = interpolate(info.progress)\r\n    subscribers.forEach(cb => cb(currentValue))\r\n  })\r\n\r\n  return {\r\n    get: () => currentValue,\r\n    subscribe: (callback) => {\r\n      subscribers.add(callback)\r\n      callback(currentValue)\r\n      return () => subscribers.delete(callback)\r\n    },\r\n    destroy: () => {\r\n      unsubscribe()\r\n      subscribers.clear()\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Easing functions for scroll-linked animations\r\n */\r\nexport const scrollEasings = {\r\n  linear: (t: number) => t,\r\n  easeIn: (t: number) => t * t,\r\n  easeOut: (t: number) => t * (2 - t),\r\n  easeInOut: (t: number) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\r\n  easeInCubic: (t: number) => t * t * t,\r\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\r\n  easeInOutCubic: (t: number) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\r\n  easeInQuart: (t: number) => t * t * t * t,\r\n  easeOutQuart: (t: number) => 1 - (--t) * t * t * t,\r\n  easeInOutQuart: (t: number) => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t,\r\n}\r\n","/**\r\n * Timeline API - GSAP-inspired animation sequencing with spring physics\r\n *\r\n * Create complex, coordinated animations with precise control over\r\n * timing, sequencing, and playback.\r\n */\r\n\r\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\r\nimport type { SpringConfig } from '../core/config.js'\r\nimport { clamp } from '../utils/math.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * Animation target - can be element, selector, or values object\r\n */\r\nexport type TimelineTarget = HTMLElement | string | Record<string, number>\r\n\r\n/**\r\n * Animation values (numeric properties to animate)\r\n */\r\nexport interface TimelineValues {\r\n  [key: string]: number | undefined\r\n}\r\n\r\n/**\r\n * Timeline animation options\r\n */\r\nexport interface TimelineOptions {\r\n  /** Animation duration override (not used with springs, but for timing) */\r\n  duration?: number\r\n  /** Delay before animation starts */\r\n  delay?: number\r\n  /** Spring configuration */\r\n  spring?: SpringConfig\r\n  /** Easing function (for non-spring animations) */\r\n  ease?: (t: number) => number\r\n  /** Callback when animation starts */\r\n  onStart?: () => void\r\n  /** Callback on each update */\r\n  onUpdate?: (progress: number) => void\r\n  /** Callback when animation completes */\r\n  onComplete?: () => void\r\n}\r\n\r\n/**\r\n * Animation properties - combines values with options\r\n */\r\nexport type TimelineProps = TimelineValues & TimelineOptions\r\n\r\n/**\r\n * Position in timeline - can be absolute, relative, or label\r\n */\r\nexport type TimelinePosition = number | string | `+=${number}` | `-=${number}` | `<` | `>`\r\n\r\n/**\r\n * Timeline segment representing a single animation\r\n */\r\ninterface TimelineSegment {\r\n  id: string\r\n  target: TimelineTarget\r\n  props: TimelineProps\r\n  startTime: number\r\n  endTime: number\r\n  spring: SpringGroup<Record<string, number>> | null\r\n  isActive: boolean\r\n  isComplete: boolean\r\n}\r\n\r\n/**\r\n * Timeline configuration\r\n */\r\nexport interface TimelineConfig {\r\n  /** Default spring configuration for all animations */\r\n  defaults?: SpringConfig\r\n  /** Whether to autoplay on creation */\r\n  autoplay?: boolean\r\n  /** Repeat count (-1 = infinite) */\r\n  repeat?: number\r\n  /** Yoyo (reverse on repeat) */\r\n  yoyo?: boolean\r\n  /** Delay between repeats */\r\n  repeatDelay?: number\r\n  /** Callback when timeline starts */\r\n  onStart?: () => void\r\n  /** Callback on each frame */\r\n  onUpdate?: (progress: number) => void\r\n  /** Callback when timeline completes */\r\n  onComplete?: () => void\r\n  /** Callback on repeat */\r\n  onRepeat?: (iteration: number) => void\r\n}\r\n\r\n/**\r\n * Timeline controller interface\r\n */\r\nexport interface Timeline {\r\n  /** Add animation to end of timeline */\r\n  to(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add animation from initial values */\r\n  from(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add animation from/to values */\r\n  fromTo(target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add a label at current position */\r\n  addLabel(label: string, position?: TimelinePosition): Timeline\r\n  /** Add a callback at position */\r\n  call(callback: () => void, position?: TimelinePosition): Timeline\r\n  /** Set properties instantly (no animation) */\r\n  set(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add pause at position */\r\n  addPause(position?: TimelinePosition, callback?: () => void): Timeline\r\n\r\n  /** Play timeline */\r\n  play(): Timeline\r\n  /** Pause timeline */\r\n  pause(): Timeline\r\n  /** Resume from pause */\r\n  resume(): Timeline\r\n  /** Reverse timeline */\r\n  reverse(): Timeline\r\n  /** Restart timeline */\r\n  restart(): Timeline\r\n  /** Seek to position */\r\n  seek(position: number | string): Timeline\r\n  /** Kill timeline and cleanup */\r\n  kill(): void\r\n\r\n  /** Get current time */\r\n  time(): number\r\n  /** Get total duration */\r\n  duration(): number\r\n  /** Get current progress (0-1) */\r\n  progress(): number\r\n  /** Check if playing */\r\n  isPlaying(): boolean\r\n  /** Check if reversed */\r\n  isReversed(): boolean\r\n\r\n  /** Get timeline by ID */\r\n  getById(id: string): TimelineSegment | undefined\r\n}\r\n\r\n// ============ Implementation ============\r\n\r\nlet timelineIdCounter = 0\r\n\r\n/**\r\n * Create a new timeline\r\n *\r\n * @example\r\n * ```ts\r\n * const tl = createTimeline()\r\n *   .to(element, { x: 100, opacity: 1 })\r\n *   .to(element, { y: 50 }, '+=0.2')\r\n *   .to(element, { scale: 1.2 }, '<')\r\n *\r\n * tl.play()\r\n * ```\r\n */\r\nexport function createTimeline(config: TimelineConfig = {}): Timeline {\r\n  const {\r\n    defaults = {},\r\n    autoplay = false,\r\n    repeat = 0,\r\n    yoyo = false,\r\n    repeatDelay = 0,\r\n    onStart,\r\n    onUpdate,\r\n    onComplete,\r\n    onRepeat,\r\n  } = config\r\n\r\n  const segments: TimelineSegment[] = []\r\n  const labels = new Map<string, number>()\r\n  const callbacks = new Map<number, (() => void)[]>()\r\n  const pauses = new Map<number, (() => void) | undefined>()\r\n\r\n  let currentTime = 0\r\n  let totalDuration = 0\r\n  let isPlaying = false\r\n  let isReversed = false\r\n  let isPaused = false\r\n  let repeatCount = 0\r\n  let rafId: number | null = null\r\n  let repeatDelayTimeoutId: ReturnType<typeof setTimeout> | null = null\r\n  let lastFrameTime = 0\r\n  let hasStarted = false\r\n  let insertTime = 0\r\n\r\n  // ============ Utility Functions ============\r\n\r\n  const parsePosition = (position?: TimelinePosition): number => {\r\n    if (position === undefined) {\r\n      return insertTime\r\n    }\r\n\r\n    if (typeof position === 'number') {\r\n      return position\r\n    }\r\n\r\n    // Relative to previous animation\r\n    if (position === '<') {\r\n      const lastSegment = segments[segments.length - 1]\r\n      return lastSegment ? lastSegment.startTime : 0\r\n    }\r\n\r\n    if (position === '>') {\r\n      return insertTime\r\n    }\r\n\r\n    // Relative offset\r\n    if (position.startsWith('+=')) {\r\n      return insertTime + parseFloat(position.slice(2))\r\n    }\r\n\r\n    if (position.startsWith('-=')) {\r\n      return insertTime - parseFloat(position.slice(2))\r\n    }\r\n\r\n    // Label reference\r\n    if (labels.has(position)) {\r\n      return labels.get(position)!\r\n    }\r\n\r\n    // Label with offset\r\n    const labelMatch = position.match(/^([a-zA-Z_]\\w*)([+-]=?\\d*\\.?\\d+)?$/)\r\n    if (labelMatch) {\r\n      const labelName = labelMatch[1]\r\n      const offset = labelMatch[2]\r\n      const labelTime = labelName ? (labels.get(labelName) ?? 0) : 0\r\n      if (offset) {\r\n        const offsetValue = parseFloat(offset.replace('=', ''))\r\n        return labelTime + offsetValue\r\n      }\r\n      return labelTime\r\n    }\r\n\r\n    return insertTime\r\n  }\r\n\r\n  const resolveTarget = (target: TimelineTarget): HTMLElement | null => {\r\n    if (typeof target === 'string') {\r\n      return document.querySelector(target)\r\n    }\r\n    if (target instanceof HTMLElement) {\r\n      return target\r\n    }\r\n    return null\r\n  }\r\n\r\n  const extractNumericProps = (props: TimelineProps): Record<string, number> => {\r\n    const result: Record<string, number> = {}\r\n    for (const [key, value] of Object.entries(props)) {\r\n      if (typeof value === 'number' && !['duration', 'delay'].includes(key)) {\r\n        result[key] = value\r\n      }\r\n    }\r\n    return result\r\n  }\r\n\r\n  const applyPropsToElement = (element: HTMLElement, props: Record<string, number>) => {\r\n    const transforms: string[] = []\r\n    const cssProps: Record<string, string> = {}\r\n\r\n    for (const [key, value] of Object.entries(props)) {\r\n      switch (key) {\r\n        case 'x':\r\n          transforms.push(`translateX(${value}px)`)\r\n          break\r\n        case 'y':\r\n          transforms.push(`translateY(${value}px)`)\r\n          break\r\n        case 'z':\r\n          transforms.push(`translateZ(${value}px)`)\r\n          break\r\n        case 'scale':\r\n          transforms.push(`scale(${value})`)\r\n          break\r\n        case 'scaleX':\r\n          transforms.push(`scaleX(${value})`)\r\n          break\r\n        case 'scaleY':\r\n          transforms.push(`scaleY(${value})`)\r\n          break\r\n        case 'rotate':\r\n        case 'rotation':\r\n          transforms.push(`rotate(${value}deg)`)\r\n          break\r\n        case 'rotateX':\r\n          transforms.push(`rotateX(${value}deg)`)\r\n          break\r\n        case 'rotateY':\r\n          transforms.push(`rotateY(${value}deg)`)\r\n          break\r\n        case 'rotateZ':\r\n          transforms.push(`rotateZ(${value}deg)`)\r\n          break\r\n        case 'skewX':\r\n          transforms.push(`skewX(${value}deg)`)\r\n          break\r\n        case 'skewY':\r\n          transforms.push(`skewY(${value}deg)`)\r\n          break\r\n        case 'opacity':\r\n          cssProps.opacity = String(value)\r\n          break\r\n        default:\r\n          // Assume pixels for numeric values\r\n          cssProps[key] = typeof value === 'number' ? `${value}px` : String(value)\r\n      }\r\n    }\r\n\r\n    if (transforms.length > 0) {\r\n      element.style.transform = transforms.join(' ')\r\n    }\r\n\r\n    for (const [prop, val] of Object.entries(cssProps)) {\r\n      ;(element.style as unknown as Record<string, string>)[prop] = val\r\n    }\r\n  }\r\n\r\n  const getCurrentElementValues = (element: HTMLElement, props: Record<string, number>): Record<string, number> => {\r\n    const current: Record<string, number> = {}\r\n    const computed = getComputedStyle(element)\r\n\r\n    for (const key of Object.keys(props)) {\r\n      switch (key) {\r\n        case 'opacity':\r\n          current[key] = parseFloat(computed.opacity) || 1\r\n          break\r\n        case 'x':\r\n        case 'y':\r\n        case 'z':\r\n        case 'scale':\r\n        case 'scaleX':\r\n        case 'scaleY':\r\n        case 'rotate':\r\n        case 'rotation':\r\n        case 'rotateX':\r\n        case 'rotateY':\r\n        case 'rotateZ':\r\n        case 'skewX':\r\n        case 'skewY':\r\n          // Parse from transform matrix - simplified, defaults to 0 or 1\r\n          current[key] = key.startsWith('scale') ? 1 : 0\r\n          break\r\n        default:\r\n          current[key] = parseFloat(computed.getPropertyValue(key)) || 0\r\n      }\r\n    }\r\n\r\n    return current\r\n  }\r\n\r\n  // ============ Animation Loop ============\r\n\r\n  // Maximum delta time to prevent jumps after tab suspension (64ms = ~15fps minimum)\r\n  const MAX_DELTA_TIME = 64\r\n\r\n  const tick = (timestamp: number) => {\r\n    if (!isPlaying || isPaused) return\r\n\r\n    // Clamp delta time to prevent jumps after tab suspension or debugger pauses\r\n    const rawDelta = lastFrameTime ? (timestamp - lastFrameTime) : 0\r\n    const deltaTime = Math.min(rawDelta, MAX_DELTA_TIME) / 1000\r\n    lastFrameTime = timestamp\r\n\r\n    // Update time\r\n    currentTime += isReversed ? -deltaTime : deltaTime\r\n    currentTime = clamp(currentTime, 0, totalDuration)\r\n\r\n    // Check for callbacks\r\n    const callbacksAtTime = callbacks.get(Math.floor(currentTime * 1000))\r\n    if (callbacksAtTime) {\r\n      callbacksAtTime.forEach(cb => {\r\n        try {\r\n          cb()\r\n        } catch (e) {\r\n          console.error('[SpringKit] Timeline callback error:', e)\r\n        }\r\n      })\r\n    }\r\n\r\n    // Check for pauses\r\n    const pauseCallback = pauses.get(Math.floor(currentTime * 1000))\r\n    if (pauseCallback !== undefined) {\r\n      isPaused = true\r\n      try {\r\n        pauseCallback?.()\r\n      } catch (e) {\r\n        console.error('[SpringKit] Timeline pause callback error:', e)\r\n      }\r\n      return\r\n    }\r\n\r\n    // Update segments\r\n    for (const segment of segments) {\r\n      const segmentProgress = clamp(\r\n        (currentTime - segment.startTime) / (segment.endTime - segment.startTime),\r\n        0,\r\n        1\r\n      )\r\n\r\n      const shouldBeActive = currentTime >= segment.startTime && currentTime <= segment.endTime\r\n\r\n      if (shouldBeActive && !segment.isActive) {\r\n        segment.isActive = true\r\n        segment.props.onStart?.()\r\n      }\r\n\r\n      if (segment.isActive && segment.spring) {\r\n        segment.props.onUpdate?.(segmentProgress)\r\n      }\r\n\r\n      if (shouldBeActive && segmentProgress >= 1 && !segment.isComplete) {\r\n        segment.isComplete = true\r\n        segment.props.onComplete?.()\r\n      }\r\n    }\r\n\r\n    onUpdate?.(currentTime / totalDuration)\r\n\r\n    // Check for completion\r\n    if ((isReversed && currentTime <= 0) || (!isReversed && currentTime >= totalDuration)) {\r\n      if (repeat === -1 || repeatCount < repeat) {\r\n        repeatCount++\r\n        onRepeat?.(repeatCount)\r\n\r\n        if (yoyo) {\r\n          isReversed = !isReversed\r\n        } else {\r\n          currentTime = 0\r\n          segments.forEach(s => {\r\n            s.isActive = false\r\n            s.isComplete = false\r\n          })\r\n        }\r\n\r\n        if (repeatDelay > 0) {\r\n          repeatDelayTimeoutId = setTimeout(() => {\r\n            repeatDelayTimeoutId = null\r\n            rafId = requestAnimationFrame(tick)\r\n          }, repeatDelay * 1000)\r\n          return\r\n        }\r\n      } else {\r\n        isPlaying = false\r\n        onComplete?.()\r\n        return\r\n      }\r\n    }\r\n\r\n    rafId = requestAnimationFrame(tick)\r\n  }\r\n\r\n  // ============ Public API ============\r\n\r\n  const timeline: Timeline = {\r\n    to(target, props, position) {\r\n      const startTime = parsePosition(position) + (props.delay || 0)\r\n      const duration = props.duration || 0.5\r\n      const endTime = startTime + duration\r\n\r\n      const element = resolveTarget(target)\r\n      const numericProps = extractNumericProps(props)\r\n\r\n      const segment: TimelineSegment = {\r\n        id: `segment_${timelineIdCounter++}`,\r\n        target,\r\n        props,\r\n        startTime,\r\n        endTime,\r\n        spring: null,\r\n        isActive: false,\r\n        isComplete: false,\r\n      }\r\n\r\n      if (element && Object.keys(numericProps).length > 0) {\r\n        const currentValues = getCurrentElementValues(element, numericProps)\r\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\r\n\r\n        segment.spring = createSpringGroup(currentValues, springConfig)\r\n\r\n        segment.spring.subscribe((values: Record<string, number>) => {\r\n          applyPropsToElement(element, values)\r\n        })\r\n\r\n        // Set target values when segment becomes active\r\n        const originalOnStart = segment.props.onStart\r\n        segment.props.onStart = () => {\r\n          segment.spring?.set(numericProps)\r\n          originalOnStart?.()\r\n        }\r\n      }\r\n\r\n      segments.push(segment)\r\n      insertTime = endTime\r\n      totalDuration = Math.max(totalDuration, endTime)\r\n\r\n      return timeline\r\n    },\r\n\r\n    from(target, props, position) {\r\n      const startTime = parsePosition(position) + (props.delay || 0)\r\n      const duration = props.duration || 0.5\r\n      const endTime = startTime + duration\r\n\r\n      const element = resolveTarget(target)\r\n      const numericProps = extractNumericProps(props)\r\n\r\n      const segment: TimelineSegment = {\r\n        id: `segment_${timelineIdCounter++}`,\r\n        target,\r\n        props,\r\n        startTime,\r\n        endTime,\r\n        spring: null,\r\n        isActive: false,\r\n        isComplete: false,\r\n      }\r\n\r\n      if (element && Object.keys(numericProps).length > 0) {\r\n        const targetValues = getCurrentElementValues(element, numericProps)\r\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\r\n\r\n        // Start from props, animate to current\r\n        segment.spring = createSpringGroup(numericProps, springConfig)\r\n        applyPropsToElement(element, numericProps)\r\n\r\n        segment.spring.subscribe((values: Record<string, number>) => {\r\n          applyPropsToElement(element, values)\r\n        })\r\n\r\n        const originalOnStart = segment.props.onStart\r\n        segment.props.onStart = () => {\r\n          segment.spring?.set(targetValues)\r\n          originalOnStart?.()\r\n        }\r\n      }\r\n\r\n      segments.push(segment)\r\n      insertTime = endTime\r\n      totalDuration = Math.max(totalDuration, endTime)\r\n\r\n      return timeline\r\n    },\r\n\r\n    fromTo(target, fromProps, toProps, position) {\r\n      const startTime = parsePosition(position) + (toProps.delay || 0)\r\n      const duration = toProps.duration || 0.5\r\n      const endTime = startTime + duration\r\n\r\n      const element = resolveTarget(target)\r\n      const fromNumeric = extractNumericProps(fromProps)\r\n      const toNumeric = extractNumericProps(toProps)\r\n\r\n      const segment: TimelineSegment = {\r\n        id: `segment_${timelineIdCounter++}`,\r\n        target,\r\n        props: toProps,\r\n        startTime,\r\n        endTime,\r\n        spring: null,\r\n        isActive: false,\r\n        isComplete: false,\r\n      }\r\n\r\n      if (element && Object.keys(toNumeric).length > 0) {\r\n        const springConfig: SpringConfig = { ...defaults, ...toProps.spring }\r\n\r\n        segment.spring = createSpringGroup(fromNumeric, springConfig)\r\n        applyPropsToElement(element, fromNumeric)\r\n\r\n        segment.spring.subscribe((values: Record<string, number>) => {\r\n          applyPropsToElement(element, values)\r\n        })\r\n\r\n        const originalOnStart = segment.props.onStart\r\n        segment.props.onStart = () => {\r\n          segment.spring?.set(toNumeric)\r\n          originalOnStart?.()\r\n        }\r\n      }\r\n\r\n      segments.push(segment)\r\n      insertTime = endTime\r\n      totalDuration = Math.max(totalDuration, endTime)\r\n\r\n      return timeline\r\n    },\r\n\r\n    addLabel(label, position) {\r\n      const time = parsePosition(position)\r\n      labels.set(label, time)\r\n      return timeline\r\n    },\r\n\r\n    call(callback, position) {\r\n      const time = Math.floor(parsePosition(position) * 1000)\r\n      if (!callbacks.has(time)) {\r\n        callbacks.set(time, [])\r\n      }\r\n      callbacks.get(time)!.push(callback)\r\n      return timeline\r\n    },\r\n\r\n    set(target, props, position) {\r\n      const element = resolveTarget(target)\r\n      if (element) {\r\n        const time = parsePosition(position)\r\n        this.call(() => {\r\n          applyPropsToElement(element, extractNumericProps(props))\r\n        }, time)\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    addPause(position, callback) {\r\n      const time = Math.floor(parsePosition(position) * 1000)\r\n      pauses.set(time, callback)\r\n      return timeline\r\n    },\r\n\r\n    play() {\r\n      if (!hasStarted) {\r\n        hasStarted = true\r\n        onStart?.()\r\n      }\r\n      isPlaying = true\r\n      isPaused = false\r\n      lastFrameTime = 0\r\n      rafId = requestAnimationFrame(tick)\r\n      return timeline\r\n    },\r\n\r\n    pause() {\r\n      isPaused = true\r\n      if (rafId) {\r\n        cancelAnimationFrame(rafId)\r\n        rafId = null\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    resume() {\r\n      if (isPaused) {\r\n        isPaused = false\r\n        lastFrameTime = 0\r\n        rafId = requestAnimationFrame(tick)\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    reverse() {\r\n      isReversed = !isReversed\r\n      return timeline\r\n    },\r\n\r\n    restart() {\r\n      currentTime = isReversed ? totalDuration : 0\r\n      repeatCount = 0\r\n      hasStarted = false\r\n      segments.forEach(s => {\r\n        s.isActive = false\r\n        s.isComplete = false\r\n      })\r\n      return this.play()\r\n    },\r\n\r\n    seek(position) {\r\n      if (typeof position === 'string') {\r\n        currentTime = labels.get(position) ?? 0\r\n      } else {\r\n        currentTime = clamp(position, 0, totalDuration)\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    kill() {\r\n      isPlaying = false\r\n      if (rafId) {\r\n        cancelAnimationFrame(rafId)\r\n        rafId = null\r\n      }\r\n      // Clear repeat delay timeout to prevent memory leak\r\n      if (repeatDelayTimeoutId) {\r\n        clearTimeout(repeatDelayTimeoutId)\r\n        repeatDelayTimeoutId = null\r\n      }\r\n      segments.forEach(s => s.spring?.destroy())\r\n      segments.length = 0\r\n      labels.clear()\r\n      callbacks.clear()\r\n      pauses.clear()\r\n    },\r\n\r\n    time: () => currentTime,\r\n    duration: () => totalDuration,\r\n    progress: () => totalDuration > 0 ? currentTime / totalDuration : 0,\r\n    isPlaying: () => isPlaying && !isPaused,\r\n    isReversed: () => isReversed,\r\n\r\n    getById(id) {\r\n      return segments.find(s => s.id === id)\r\n    },\r\n  }\r\n\r\n  if (autoplay) {\r\n    timeline.play()\r\n  }\r\n\r\n  return timeline\r\n}\r\n\r\n/**\r\n * Create a simple tween (single animation)\r\n */\r\nexport function tween(\r\n  target: TimelineTarget,\r\n  props: TimelineProps\r\n): Timeline {\r\n  return createTimeline().to(target, props).play()\r\n}\r\n\r\n/**\r\n * Create a timeline that animates all targets simultaneously\r\n */\r\nexport function allTo(\r\n  targets: TimelineTarget[],\r\n  props: TimelineProps\r\n): Timeline {\r\n  const tl = createTimeline()\r\n  targets.forEach((target, i) => {\r\n    tl.to(target, props, i === 0 ? 0 : '<')\r\n  })\r\n  return tl.play()\r\n}\r\n","/**\r\n * SVG Morphing - Smooth path shape interpolation with spring physics\r\n *\r\n * Enables morphing between SVG paths with automatic path normalization\r\n * and spring-based animation.\r\n */\r\n\r\nimport { createSpringValue } from '../core/spring-value.js'\r\nimport type { SpringConfig } from '../core/config.js'\r\nimport { lerp, clamp } from '../utils/math.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * SVG path command types\r\n */\r\ntype CommandType = 'M' | 'L' | 'C' | 'Q' | 'A' | 'Z' | 'H' | 'V' | 'S' | 'T'\r\n\r\n/**\r\n * Parsed path command\r\n */\r\ninterface PathCommand {\r\n  type: CommandType\r\n  values: number[]\r\n}\r\n\r\n/**\r\n * Normalized point with control points\r\n */\r\ninterface NormalizedPoint {\r\n  x: number\r\n  y: number\r\n  cp1x?: number\r\n  cp1y?: number\r\n  cp2x?: number\r\n  cp2y?: number\r\n}\r\n\r\n/**\r\n * Morph configuration\r\n */\r\nexport interface MorphConfig {\r\n  /** Spring configuration */\r\n  spring?: SpringConfig\r\n  /** Number of samples for path normalization (higher = smoother) */\r\n  samples?: number\r\n  /** Callback on progress update */\r\n  onProgress?: (progress: number) => void\r\n  /** Callback when morph completes */\r\n  onComplete?: () => void\r\n}\r\n\r\n/**\r\n * Morph controller interface\r\n */\r\nexport interface MorphController {\r\n  /** Get current morphed path */\r\n  getPath(): string\r\n  /** Get current progress (0-1) */\r\n  getProgress(): number\r\n  /** Morph to a new path */\r\n  morphTo(path: string): void\r\n  /** Set progress directly (0-1) */\r\n  setProgress(progress: number): void\r\n  /** Subscribe to path changes */\r\n  subscribe(callback: (path: string) => void): () => void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n// ============ Path Parsing ============\r\n\r\n/**\r\n * Parse SVG path string into commands\r\n */\r\nfunction parsePath(d: string): PathCommand[] {\r\n  const commands: PathCommand[] = []\r\n  const regex = /([MLCQAZHVST])([^MLCQAZHVST]*)/gi\r\n\r\n  // Use matchAll instead of regex.exec for safer iteration\r\n  const matches = d.matchAll(regex)\r\n\r\n  for (const matchItem of matches) {\r\n    const typeChar = matchItem[1]\r\n    const valuesStr = matchItem[2]\r\n    if (!typeChar || valuesStr === undefined) continue\r\n\r\n    const type = typeChar.toUpperCase() as CommandType\r\n    const values = valuesStr\r\n      .trim()\r\n      .split(/[\\s,]+/)\r\n      .filter(v => v !== '')\r\n      .map(parseFloat)\r\n      .filter(v => !isNaN(v))\r\n\r\n    commands.push({ type, values })\r\n  }\r\n\r\n  return commands\r\n}\r\n\r\n/**\r\n * Convert path commands to absolute coordinates\r\n */\r\nfunction toAbsolute(commands: PathCommand[]): PathCommand[] {\r\n  let currentX = 0\r\n  let currentY = 0\r\n  let startX = 0\r\n  let startY = 0\r\n\r\n  return commands.map(cmd => {\r\n    const { type, values } = cmd\r\n    const absValues = [...values]\r\n\r\n    switch (type) {\r\n      case 'M':\r\n        currentX = values[0] ?? 0\r\n        currentY = values[1] ?? 0\r\n        startX = currentX\r\n        startY = currentY\r\n        break\r\n\r\n      case 'L':\r\n        currentX = values[0] ?? 0\r\n        currentY = values[1] ?? 0\r\n        break\r\n\r\n      case 'H':\r\n        absValues[0] = values[0] ?? 0\r\n        currentX = values[0] ?? 0\r\n        break\r\n\r\n      case 'V':\r\n        absValues[0] = values[0] ?? 0\r\n        currentY = values[0] ?? 0\r\n        break\r\n\r\n      case 'C':\r\n        currentX = values[4] ?? 0\r\n        currentY = values[5] ?? 0\r\n        break\r\n\r\n      case 'Q':\r\n        currentX = values[2] ?? 0\r\n        currentY = values[3] ?? 0\r\n        break\r\n\r\n      case 'A':\r\n        currentX = values[5] ?? 0\r\n        currentY = values[6] ?? 0\r\n        break\r\n\r\n      case 'Z':\r\n        currentX = startX\r\n        currentY = startY\r\n        break\r\n    }\r\n\r\n    return { type, values: absValues }\r\n  })\r\n}\r\n\r\n/**\r\n * Check if SVG path methods are available (real browser, not JSDOM)\r\n */\r\nfunction hasSvgPathSupport(): boolean {\r\n  if (typeof document === 'undefined') return false\r\n  try {\r\n    const svgNS = 'http://www.w3.org/2000/svg'\r\n    const svg = document.createElementNS(svgNS, 'svg')\r\n    const path = document.createElementNS(svgNS, 'path')\r\n    path.setAttribute('d', 'M0,0 L10,10')\r\n    svg.appendChild(path)\r\n    document.body.appendChild(svg)\r\n    const hasSupport = typeof path.getTotalLength === 'function'\r\n    let works = false\r\n    if (hasSupport) {\r\n      try {\r\n        path.getTotalLength()\r\n        works = true\r\n      } catch {\r\n        works = false\r\n      }\r\n    }\r\n    document.body.removeChild(svg)\r\n    return works\r\n  } catch {\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Simple linear sampling fallback for non-browser environments\r\n */\r\nfunction samplePathFallback(commands: PathCommand[], samples: number): NormalizedPoint[] {\r\n  const points: NormalizedPoint[] = []\r\n\r\n  for (const cmd of commands) {\r\n    if (cmd.type === 'M' || cmd.type === 'L') {\r\n      points.push({ x: cmd.values[0] ?? 0, y: cmd.values[1] ?? 0 })\r\n    } else if (cmd.type === 'C') {\r\n      points.push({\r\n        x: cmd.values[4] ?? 0,\r\n        y: cmd.values[5] ?? 0,\r\n        cp1x: cmd.values[0] ?? 0,\r\n        cp1y: cmd.values[1] ?? 0,\r\n        cp2x: cmd.values[2] ?? 0,\r\n        cp2y: cmd.values[3] ?? 0,\r\n      })\r\n    } else if (cmd.type === 'Q') {\r\n      points.push({\r\n        x: cmd.values[2] ?? 0,\r\n        y: cmd.values[3] ?? 0,\r\n        cp1x: cmd.values[0] ?? 0,\r\n        cp1y: cmd.values[1] ?? 0,\r\n      })\r\n    } else if (cmd.type === 'A') {\r\n      points.push({ x: cmd.values[5] ?? 0, y: cmd.values[6] ?? 0 })\r\n    } else if (cmd.type === 'H') {\r\n      const lastPoint = points[points.length - 1]\r\n      points.push({ x: cmd.values[0] ?? 0, y: lastPoint?.y ?? 0 })\r\n    } else if (cmd.type === 'V') {\r\n      const lastPoint = points[points.length - 1]\r\n      points.push({ x: lastPoint?.x ?? 0, y: cmd.values[0] ?? 0 })\r\n    }\r\n  }\r\n\r\n  // Interpolate to reach desired sample count\r\n  if (points.length > 0 && points.length < samples) {\r\n    const interpolated: NormalizedPoint[] = []\r\n    const step = (points.length - 1) / (samples - 1)\r\n\r\n    for (let i = 0; i < samples; i++) {\r\n      const t = i * step\r\n      const index = Math.floor(t)\r\n      const frac = t - index\r\n\r\n      if (index >= points.length - 1) {\r\n        interpolated.push(points[points.length - 1]!)\r\n      } else {\r\n        const p1 = points[index]!\r\n        const p2 = points[index + 1]!\r\n        interpolated.push({\r\n          x: lerp(p1.x, p2.x, frac),\r\n          y: lerp(p1.y, p2.y, frac),\r\n        })\r\n      }\r\n    }\r\n    return interpolated\r\n  }\r\n\r\n  return points\r\n}\r\n\r\n/**\r\n * Sample points along a path at regular intervals\r\n */\r\nfunction samplePath(commands: PathCommand[], samples: number): NormalizedPoint[] {\r\n  // Use fallback for non-browser or JSDOM environments\r\n  if (!hasSvgPathSupport()) {\r\n    return samplePathFallback(commands, samples)\r\n  }\r\n\r\n  const points: NormalizedPoint[] = []\r\n  const svgNS = 'http://www.w3.org/2000/svg'\r\n  const svg = document.createElementNS(svgNS, 'svg')\r\n  const path = document.createElementNS(svgNS, 'path')\r\n\r\n  // Build path string\r\n  let d = ''\r\n  for (const cmd of commands) {\r\n    d += cmd.type + cmd.values.join(' ')\r\n  }\r\n  path.setAttribute('d', d)\r\n  svg.appendChild(path)\r\n  document.body.appendChild(svg)\r\n\r\n  try {\r\n    const totalLength = path.getTotalLength()\r\n    const step = totalLength / (samples - 1)\r\n\r\n    for (let i = 0; i < samples; i++) {\r\n      const point = path.getPointAtLength(i * step)\r\n      points.push({ x: point.x, y: point.y })\r\n    }\r\n  } finally {\r\n    document.body.removeChild(svg)\r\n  }\r\n\r\n  return points\r\n}\r\n\r\n/**\r\n * Interpolate between two points\r\n */\r\nfunction interpolatePoint(p1: NormalizedPoint, p2: NormalizedPoint, t: number): NormalizedPoint {\r\n  return {\r\n    x: lerp(p1.x, p2.x, t),\r\n    y: lerp(p1.y, p2.y, t),\r\n  }\r\n}\r\n\r\n/**\r\n * Convert normalized points back to path string\r\n */\r\nfunction pointsToPath(points: NormalizedPoint[]): string {\r\n  if (points.length === 0) return ''\r\n\r\n  const firstPoint = points[0]!\r\n  let d = `M ${firstPoint.x} ${firstPoint.y}`\r\n\r\n  for (let i = 1; i < points.length; i++) {\r\n    const point = points[i]!\r\n    d += ` L ${point.x} ${point.y}`\r\n  }\r\n\r\n  return d\r\n}\r\n\r\n// ============ Morph Implementation ============\r\n\r\n/**\r\n * Create SVG path morph controller\r\n *\r\n * @example\r\n * ```ts\r\n * const morph = createMorph(circlePath, {\r\n *   spring: { stiffness: 120, damping: 14 },\r\n *   onProgress: (p) => console.log('Progress:', p),\r\n * })\r\n *\r\n * morph.subscribe((path) => {\r\n *   element.setAttribute('d', path)\r\n * })\r\n *\r\n * morph.morphTo(starPath)\r\n * ```\r\n */\r\nexport function createMorph(\r\n  initialPath: string,\r\n  config: MorphConfig = {}\r\n): MorphController {\r\n  const {\r\n    spring: springConfig = { stiffness: 120, damping: 14 },\r\n    samples = 100,\r\n    onProgress,\r\n    onComplete,\r\n  } = config\r\n\r\n  let currentPath = initialPath\r\n  let fromPoints: NormalizedPoint[] = []\r\n  let toPoints: NormalizedPoint[] = []\r\n  let currentPoints: NormalizedPoint[] = []\r\n\r\n  const subscribers = new Set<(path: string) => void>()\r\n\r\n  // Parse initial path\r\n  const initialCommands = parsePath(initialPath)\r\n  fromPoints = samplePath(toAbsolute(initialCommands), samples)\r\n  currentPoints = [...fromPoints]\r\n  toPoints = [...fromPoints]\r\n\r\n  // Create spring for progress\r\n  const progressSpring = createSpringValue(0, springConfig)\r\n\r\n  progressSpring.subscribe(() => {\r\n    const progress = progressSpring.get()\r\n    onProgress?.(progress)\r\n\r\n    // Interpolate points\r\n    currentPoints = fromPoints.map((from, i) =>\r\n      interpolatePoint(from, toPoints[i] ?? from, progress)\r\n    )\r\n\r\n    currentPath = pointsToPath(currentPoints)\r\n    subscribers.forEach(cb => {\r\n      try {\r\n        cb(currentPath)\r\n      } catch (e) {\r\n        console.error('[SpringKit] Morph subscriber error:', e)\r\n      }\r\n    })\r\n\r\n    if (progress >= 0.999) {\r\n      onComplete?.()\r\n    }\r\n  })\r\n\r\n  return {\r\n    getPath: () => currentPath,\r\n    getProgress: () => progressSpring.get(),\r\n\r\n    morphTo(path: string) {\r\n      // Normalize paths\r\n      const targetCommands = parsePath(path)\r\n      const targetPoints = samplePath(toAbsolute(targetCommands), samples)\r\n\r\n      fromPoints = [...currentPoints]\r\n      toPoints = targetPoints\r\n\r\n      // Ensure same number of points\r\n      while (fromPoints.length < toPoints.length) {\r\n        fromPoints.push(fromPoints[fromPoints.length - 1] || { x: 0, y: 0 })\r\n      }\r\n      while (toPoints.length < fromPoints.length) {\r\n        toPoints.push(toPoints[toPoints.length - 1] || { x: 0, y: 0 })\r\n      }\r\n\r\n      // Reset and animate\r\n      progressSpring.jump(0)\r\n      progressSpring.set(1)\r\n    },\r\n\r\n    setProgress(progress: number) {\r\n      const p = clamp(progress, 0, 1)\r\n      progressSpring.jump(p)\r\n\r\n      currentPoints = fromPoints.map((from, i) =>\r\n        interpolatePoint(from, toPoints[i] ?? from, p)\r\n      )\r\n\r\n      currentPath = pointsToPath(currentPoints)\r\n      subscribers.forEach(cb => {\r\n        try {\r\n          cb(currentPath)\r\n        } catch (e) {\r\n          console.error('[SpringKit] Morph subscriber error:', e)\r\n        }\r\n      })\r\n    },\r\n\r\n    subscribe(callback) {\r\n      subscribers.add(callback)\r\n      try {\r\n        callback(currentPath)\r\n      } catch (e) {\r\n        console.error('[SpringKit] Morph subscriber error:', e)\r\n      }\r\n      return () => subscribers.delete(callback)\r\n    },\r\n\r\n    destroy() {\r\n      progressSpring.destroy()\r\n      subscribers.clear()\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create a morph between multiple paths (morphing sequence)\r\n *\r\n * @example\r\n * ```ts\r\n * const sequence = createMorphSequence([\r\n *   circlePath,\r\n *   squarePath,\r\n *   starPath,\r\n * ])\r\n *\r\n * sequence.subscribe((path) => {\r\n *   element.setAttribute('d', path)\r\n * })\r\n *\r\n * sequence.morphToIndex(2) // Morph to star\r\n * ```\r\n */\r\nexport function createMorphSequence(\r\n  paths: string[],\r\n  config: MorphConfig = {}\r\n): {\r\n  getPath(): string\r\n  getCurrentIndex(): number\r\n  morphToIndex(index: number): void\r\n  morphToNext(): void\r\n  morphToPrevious(): void\r\n  subscribe(callback: (path: string) => void): () => void\r\n  destroy(): void\r\n} {\r\n  if (paths.length === 0) {\r\n    throw new Error('At least one path is required')\r\n  }\r\n\r\n  let currentIndex = 0\r\n  const firstPath = paths[0]!\r\n  const morph = createMorph(firstPath, config)\r\n\r\n  return {\r\n    getPath: () => morph.getPath(),\r\n    getCurrentIndex: () => currentIndex,\r\n\r\n    morphToIndex(index: number) {\r\n      const targetIndex = clamp(index, 0, paths.length - 1)\r\n      if (targetIndex !== currentIndex) {\r\n        currentIndex = targetIndex\r\n        const targetPath = paths[targetIndex]!\r\n        morph.morphTo(targetPath)\r\n      }\r\n    },\r\n\r\n    morphToNext() {\r\n      this.morphToIndex((currentIndex + 1) % paths.length)\r\n    },\r\n\r\n    morphToPrevious() {\r\n      this.morphToIndex((currentIndex - 1 + paths.length) % paths.length)\r\n    },\r\n\r\n    subscribe: (callback) => morph.subscribe(callback),\r\n    destroy: () => morph.destroy(),\r\n  }\r\n}\r\n\r\n// ============ Preset Shapes ============\r\n\r\n/**\r\n * Generate common SVG shape paths\r\n */\r\nexport const shapes = {\r\n  /**\r\n   * Generate circle path\r\n   */\r\n  circle(cx: number, cy: number, r: number): string {\r\n    return `M ${cx - r} ${cy}\r\n            A ${r} ${r} 0 1 1 ${cx + r} ${cy}\r\n            A ${r} ${r} 0 1 1 ${cx - r} ${cy}`\r\n  },\r\n\r\n  /**\r\n   * Generate rectangle path\r\n   */\r\n  rect(x: number, y: number, width: number, height: number, rx = 0): string {\r\n    if (rx === 0) {\r\n      return `M ${x} ${y}\r\n              L ${x + width} ${y}\r\n              L ${x + width} ${y + height}\r\n              L ${x} ${y + height}\r\n              Z`\r\n    }\r\n\r\n    return `M ${x + rx} ${y}\r\n            L ${x + width - rx} ${y}\r\n            Q ${x + width} ${y} ${x + width} ${y + rx}\r\n            L ${x + width} ${y + height - rx}\r\n            Q ${x + width} ${y + height} ${x + width - rx} ${y + height}\r\n            L ${x + rx} ${y + height}\r\n            Q ${x} ${y + height} ${x} ${y + height - rx}\r\n            L ${x} ${y + rx}\r\n            Q ${x} ${y} ${x + rx} ${y}\r\n            Z`\r\n  },\r\n\r\n  /**\r\n   * Generate polygon path\r\n   */\r\n  polygon(cx: number, cy: number, r: number, sides: number): string {\r\n    const points: string[] = []\r\n\r\n    for (let i = 0; i < sides; i++) {\r\n      const angle = (i / sides) * Math.PI * 2 - Math.PI / 2\r\n      const x = cx + r * Math.cos(angle)\r\n      const y = cy + r * Math.sin(angle)\r\n      points.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\r\n    }\r\n\r\n    return points.join(' ') + ' Z'\r\n  },\r\n\r\n  /**\r\n   * Generate star path\r\n   */\r\n  star(cx: number, cy: number, outerR: number, innerR: number, points: number): string {\r\n    const path: string[] = []\r\n    const step = Math.PI / points\r\n\r\n    for (let i = 0; i < points * 2; i++) {\r\n      const r = i % 2 === 0 ? outerR : innerR\r\n      const angle = i * step - Math.PI / 2\r\n      const x = cx + r * Math.cos(angle)\r\n      const y = cy + r * Math.sin(angle)\r\n      path.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\r\n    }\r\n\r\n    return path.join(' ') + ' Z'\r\n  },\r\n\r\n  /**\r\n   * Generate heart path\r\n   */\r\n  heart(cx: number, cy: number, size: number): string {\r\n    const d = size / 4\r\n    return `M ${cx} ${cy + d}\r\n            C ${cx} ${cy} ${cx - 2 * d} ${cy} ${cx - 2 * d} ${cy - d}\r\n            C ${cx - 2 * d} ${cy - 2 * d} ${cx} ${cy - 2 * d} ${cx} ${cy - d}\r\n            C ${cx} ${cy - 2 * d} ${cx + 2 * d} ${cy - 2 * d} ${cx + 2 * d} ${cy - d}\r\n            C ${cx + 2 * d} ${cy} ${cx} ${cy} ${cx} ${cy + d}\r\n            Z`\r\n  },\r\n\r\n  /**\r\n   * Generate arrow path\r\n   */\r\n  arrow(x: number, y: number, width: number, height: number, direction: 'up' | 'down' | 'left' | 'right' = 'right'): string {\r\n    const hw = width / 2\r\n    const hh = height / 2\r\n\r\n    switch (direction) {\r\n      case 'right':\r\n        return `M ${x} ${y - hh} L ${x + width} ${y} L ${x} ${y + hh} Z`\r\n      case 'left':\r\n        return `M ${x + width} ${y - hh} L ${x} ${y} L ${x + width} ${y + hh} Z`\r\n      case 'up':\r\n        return `M ${x - hw} ${y + height} L ${x} ${y} L ${x + hw} ${y + height} Z`\r\n      case 'down':\r\n        return `M ${x - hw} ${y} L ${x} ${y + height} L ${x + hw} ${y} Z`\r\n    }\r\n  },\r\n}\r\n","/**\r\n * Shared Layout Animations - Cross-component FLIP animations with layoutId\r\n *\r\n * Enables smooth transitions between components that share the same layoutId,\r\n * similar to Framer Motion's layout animations.\r\n */\r\n\r\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\r\nimport type { SpringConfig } from '../core/config.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * Element measurement for FLIP\r\n */\r\nexport interface LayoutMeasurement {\r\n  x: number\r\n  y: number\r\n  width: number\r\n  height: number\r\n  opacity?: number\r\n  borderRadius?: number\r\n  scaleX?: number\r\n  scaleY?: number\r\n}\r\n\r\n/**\r\n * Shared layout element info\r\n */\r\ninterface SharedLayoutElement {\r\n  id: string\r\n  element: HTMLElement\r\n  measurement: LayoutMeasurement\r\n  spring: SpringGroup<Record<string, number>> | null\r\n  isAnimating: boolean\r\n  pendingRafId: number | null\r\n}\r\n\r\n/**\r\n * Layout animation configuration\r\n */\r\nexport interface LayoutAnimationConfig {\r\n  /** Spring configuration */\r\n  spring?: SpringConfig\r\n  /** Duration hint for spring (optional) */\r\n  duration?: number\r\n  /** Callback when animation starts */\r\n  onAnimationStart?: (id: string) => void\r\n  /** Callback when animation completes */\r\n  onAnimationComplete?: (id: string) => void\r\n  /** Enable crossfade during transition */\r\n  crossfade?: boolean\r\n  /** Custom transition properties */\r\n  transition?: {\r\n    x?: SpringConfig\r\n    y?: SpringConfig\r\n    width?: SpringConfig\r\n    height?: SpringConfig\r\n    opacity?: SpringConfig\r\n    borderRadius?: SpringConfig\r\n  }\r\n}\r\n\r\n/**\r\n * Layout group for managing shared elements\r\n */\r\nexport interface LayoutGroup {\r\n  /** Register element with layoutId */\r\n  register(id: string, element: HTMLElement): void\r\n  /** Unregister element */\r\n  unregister(id: string, element: HTMLElement): void\r\n  /** Update layout (call after DOM changes) */\r\n  update(): void\r\n  /** Force re-measure all elements */\r\n  forceUpdate(): void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Shared layout context for cross-component animations\r\n */\r\nexport interface SharedLayoutContext {\r\n  /** Register a layout group */\r\n  createGroup(id?: string): LayoutGroup\r\n  /** Get group by id */\r\n  getGroup(id: string): LayoutGroup | undefined\r\n  /** Update all groups */\r\n  updateAll(): void\r\n  /** Destroy all groups */\r\n  destroy(): void\r\n}\r\n\r\n// ============ Measurement Utilities ============\r\n\r\n/**\r\n * Measure element position and size\r\n */\r\nfunction measureElement(element: HTMLElement): LayoutMeasurement {\r\n  const rect = element.getBoundingClientRect()\r\n  const styles = getComputedStyle(element)\r\n\r\n  return {\r\n    x: rect.left + window.scrollX,\r\n    y: rect.top + window.scrollY,\r\n    width: rect.width,\r\n    height: rect.height,\r\n    opacity: parseFloat(styles.opacity) || 1,\r\n    borderRadius: parseFloat(styles.borderRadius) || 0,\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n  }\r\n}\r\n\r\n/**\r\n * Apply FLIP transform to element\r\n */\r\nfunction applyTransform(\r\n  element: HTMLElement,\r\n  from: LayoutMeasurement,\r\n  to: LayoutMeasurement,\r\n  current: Record<string, number>\r\n): void {\r\n  // Calculate deltas\r\n  const dx = current.x !== undefined ? from.x - to.x + (current.x - from.x) : 0\r\n  const dy = current.y !== undefined ? from.y - to.y + (current.y - from.y) : 0\r\n  const scaleX = current.width !== undefined ? current.width / to.width : 1\r\n  const scaleY = current.height !== undefined ? current.height / to.height : 1\r\n\r\n  // Apply transform\r\n  element.style.transform = `translate(${dx}px, ${dy}px) scale(${scaleX}, ${scaleY})`\r\n  element.style.transformOrigin = 'top left'\r\n\r\n  // Apply opacity if transitioning\r\n  if (current.opacity !== undefined) {\r\n    element.style.opacity = String(current.opacity)\r\n  }\r\n\r\n  // Apply border radius (scale-compensated)\r\n  if (current.borderRadius !== undefined) {\r\n    const compensatedRadius = current.borderRadius / Math.max(scaleX, scaleY)\r\n    element.style.borderRadius = `${compensatedRadius}px`\r\n  }\r\n}\r\n\r\n/**\r\n * Reset element transform\r\n */\r\nfunction resetTransform(element: HTMLElement): void {\r\n  element.style.transform = ''\r\n  element.style.transformOrigin = ''\r\n  element.style.opacity = ''\r\n  element.style.borderRadius = ''\r\n}\r\n\r\n// ============ Layout Group Implementation ============\r\n\r\n/**\r\n * Create a layout group for managing shared layout elements\r\n *\r\n * @example\r\n * ```ts\r\n * const group = createLayoutGroup({\r\n *   spring: { stiffness: 300, damping: 30 },\r\n * })\r\n *\r\n * // Register elements with same layoutId\r\n * group.register('card-1', cardElement)\r\n *\r\n * // After DOM changes\r\n * group.update()\r\n * ```\r\n */\r\nexport function createLayoutGroup(config: LayoutAnimationConfig = {}): LayoutGroup {\r\n  const {\r\n    spring: defaultSpring = { stiffness: 300, damping: 30 },\r\n    onAnimationStart,\r\n    onAnimationComplete,\r\n    crossfade = false,\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    transition: _transition = {},\r\n  } = config\r\n\r\n  const elements = new Map<string, SharedLayoutElement[]>()\r\n  const previousMeasurements = new Map<string, LayoutMeasurement>()\r\n\r\n  const register = (id: string, element: HTMLElement): void => {\r\n    if (!elements.has(id)) {\r\n      elements.set(id, [])\r\n    }\r\n\r\n    const existing = elements.get(id)!\r\n    const alreadyRegistered = existing.some(e => e.element === element)\r\n\r\n    if (!alreadyRegistered) {\r\n      const measurement = measureElement(element)\r\n      existing.push({\r\n        id,\r\n        element,\r\n        measurement,\r\n        spring: null,\r\n        isAnimating: false,\r\n        pendingRafId: null,\r\n      })\r\n\r\n      // Store measurement for future animations\r\n      if (!previousMeasurements.has(id)) {\r\n        previousMeasurements.set(id, measurement)\r\n      }\r\n    }\r\n  }\r\n\r\n  const unregister = (id: string, element: HTMLElement): void => {\r\n    const group = elements.get(id)\r\n    if (!group) return\r\n\r\n    const index = group.findIndex(e => e.element === element)\r\n    if (index !== -1) {\r\n      const entry = group[index]!\r\n\r\n      // Store final measurement before removal\r\n      previousMeasurements.set(id, measureElement(element))\r\n\r\n      // Cancel pending RAF to prevent memory leak\r\n      if (entry.pendingRafId !== null) {\r\n        cancelAnimationFrame(entry.pendingRafId)\r\n        entry.pendingRafId = null\r\n      }\r\n\r\n      // Cleanup spring\r\n      entry.spring?.destroy()\r\n      group.splice(index, 1)\r\n\r\n      if (group.length === 0) {\r\n        elements.delete(id)\r\n      }\r\n    }\r\n  }\r\n\r\n  const animateElement = (\r\n    entry: SharedLayoutElement,\r\n    from: LayoutMeasurement,\r\n    to: LayoutMeasurement\r\n  ): void => {\r\n    // Cleanup previous animation\r\n    entry.spring?.destroy()\r\n\r\n    // Create spring with initial values\r\n    const initialValues: Record<string, number> = {\r\n      x: from.x,\r\n      y: from.y,\r\n      width: from.width,\r\n      height: from.height,\r\n    }\r\n\r\n    if (crossfade) {\r\n      initialValues.opacity = from.opacity ?? 1\r\n    }\r\n\r\n    if (from.borderRadius !== undefined) {\r\n      initialValues.borderRadius = from.borderRadius\r\n    }\r\n\r\n    entry.spring = createSpringGroup(initialValues, defaultSpring)\r\n    entry.isAnimating = true\r\n\r\n    onAnimationStart?.(entry.id)\r\n\r\n    entry.spring.subscribe((values: Record<string, number>) => {\r\n      applyTransform(entry.element, from, to, values)\r\n    })\r\n\r\n    // Set target values\r\n    const targetValues: Record<string, number> = {\r\n      x: to.x,\r\n      y: to.y,\r\n      width: to.width,\r\n      height: to.height,\r\n    }\r\n\r\n    if (crossfade) {\r\n      targetValues.opacity = to.opacity ?? 1\r\n    }\r\n\r\n    if (to.borderRadius !== undefined) {\r\n      targetValues.borderRadius = to.borderRadius\r\n    }\r\n\r\n    entry.spring.set(targetValues)\r\n\r\n    // Check for animation completion\r\n    const checkComplete = () => {\r\n      entry.pendingRafId = null\r\n\r\n      if (entry.spring && !entry.spring.isAnimating()) {\r\n        entry.isAnimating = false\r\n        resetTransform(entry.element)\r\n        onAnimationComplete?.(entry.id)\r\n      } else if (entry.isAnimating) {\r\n        entry.pendingRafId = requestAnimationFrame(checkComplete)\r\n      }\r\n    }\r\n\r\n    entry.pendingRafId = requestAnimationFrame(checkComplete)\r\n  }\r\n\r\n  const update = (): void => {\r\n    for (const [id, group] of elements) {\r\n      for (const entry of group) {\r\n        const previousMeasurement = previousMeasurements.get(id)\r\n        const currentMeasurement = measureElement(entry.element)\r\n\r\n        // Check if position/size changed\r\n        if (previousMeasurement) {\r\n          const hasChanged =\r\n            previousMeasurement.x !== currentMeasurement.x ||\r\n            previousMeasurement.y !== currentMeasurement.y ||\r\n            previousMeasurement.width !== currentMeasurement.width ||\r\n            previousMeasurement.height !== currentMeasurement.height\r\n\r\n          if (hasChanged) {\r\n            animateElement(entry, previousMeasurement, currentMeasurement)\r\n          }\r\n        }\r\n\r\n        // Update stored measurement\r\n        entry.measurement = currentMeasurement\r\n        previousMeasurements.set(id, currentMeasurement)\r\n      }\r\n    }\r\n  }\r\n\r\n  const forceUpdate = (): void => {\r\n    // Re-measure all elements\r\n    for (const [id, group] of elements) {\r\n      for (const entry of group) {\r\n        entry.measurement = measureElement(entry.element)\r\n        previousMeasurements.set(id, entry.measurement)\r\n      }\r\n    }\r\n  }\r\n\r\n  const destroy = (): void => {\r\n    for (const group of elements.values()) {\r\n      for (const entry of group) {\r\n        // Cancel pending RAF to prevent memory leak\r\n        if (entry.pendingRafId !== null) {\r\n          cancelAnimationFrame(entry.pendingRafId)\r\n          entry.pendingRafId = null\r\n        }\r\n        entry.spring?.destroy()\r\n        resetTransform(entry.element)\r\n      }\r\n    }\r\n    elements.clear()\r\n    previousMeasurements.clear()\r\n  }\r\n\r\n  return {\r\n    register,\r\n    unregister,\r\n    update,\r\n    forceUpdate,\r\n    destroy,\r\n  }\r\n}\r\n\r\n// ============ Shared Layout Context ============\r\n\r\nlet groupIdCounter = 0\r\n\r\n/**\r\n * Create a shared layout context for managing multiple layout groups\r\n *\r\n * @example\r\n * ```ts\r\n * const context = createSharedLayoutContext()\r\n *\r\n * // Create groups for different animation contexts\r\n * const listGroup = context.createGroup('list')\r\n * const cardGroup = context.createGroup('cards')\r\n *\r\n * // Register elements\r\n * listGroup.register('item-1', element1)\r\n * cardGroup.register('card-1', element2)\r\n *\r\n * // After route change or DOM update\r\n * context.updateAll()\r\n * ```\r\n */\r\nexport function createSharedLayoutContext(): SharedLayoutContext {\r\n  const groups = new Map<string, LayoutGroup>()\r\n\r\n  return {\r\n    createGroup(id?: string) {\r\n      const groupId = id ?? `layout-group-${groupIdCounter++}`\r\n      const group = createLayoutGroup()\r\n      groups.set(groupId, group)\r\n      return group\r\n    },\r\n\r\n    getGroup(id: string) {\r\n      return groups.get(id)\r\n    },\r\n\r\n    updateAll() {\r\n      for (const group of groups.values()) {\r\n        group.update()\r\n      }\r\n    },\r\n\r\n    destroy() {\r\n      for (const group of groups.values()) {\r\n        group.destroy()\r\n      }\r\n      groups.clear()\r\n    },\r\n  }\r\n}\r\n\r\n// ============ Auto Layout Observer ============\r\n\r\n/**\r\n * Configuration for auto layout observer\r\n */\r\nexport interface AutoLayoutConfig extends LayoutAnimationConfig {\r\n  /** Root element to observe (default: document.body) */\r\n  root?: HTMLElement\r\n  /** Attribute name for layout ID (default: 'data-layout-id') */\r\n  attribute?: string\r\n  /** Debounce time for mutations (ms) */\r\n  debounce?: number\r\n}\r\n\r\n/**\r\n * Create auto layout observer that automatically animates\r\n * elements with layoutId attribute\r\n *\r\n * @example\r\n * ```html\r\n * <div data-layout-id=\"card-1\">Content</div>\r\n * ```\r\n *\r\n * ```ts\r\n * const observer = createAutoLayout({\r\n *   spring: { stiffness: 200, damping: 20 },\r\n * })\r\n *\r\n * // Elements with data-layout-id will automatically animate\r\n * // when their position changes\r\n *\r\n * observer.destroy() // Cleanup when done\r\n * ```\r\n */\r\nexport function createAutoLayout(config: AutoLayoutConfig = {}): {\r\n  update(): void\r\n  forceUpdate(): void\r\n  destroy(): void\r\n} {\r\n  const {\r\n    root = typeof document !== 'undefined' ? document.body : null,\r\n    attribute = 'data-layout-id',\r\n    debounce: debounceTime = 0,\r\n    ...layoutConfig\r\n  } = config\r\n\r\n  if (!root) {\r\n    return {\r\n      update: () => {},\r\n      forceUpdate: () => {},\r\n      destroy: () => {},\r\n    }\r\n  }\r\n\r\n  const group = createLayoutGroup(layoutConfig)\r\n  let observer: MutationObserver | null = null\r\n  let resizeObserver: ResizeObserver | null = null\r\n  let debounceTimer: ReturnType<typeof setTimeout> | null = null\r\n\r\n  const scanAndRegister = () => {\r\n    const elements = root.querySelectorAll(`[${attribute}]`)\r\n    elements.forEach((el) => {\r\n      const id = el.getAttribute(attribute)\r\n      if (id && el instanceof HTMLElement) {\r\n        group.register(id, el)\r\n      }\r\n    })\r\n  }\r\n\r\n  const debouncedUpdate = () => {\r\n    if (debounceTimer) {\r\n      clearTimeout(debounceTimer)\r\n    }\r\n\r\n    if (debounceTime > 0) {\r\n      debounceTimer = setTimeout(() => {\r\n        scanAndRegister()\r\n        group.update()\r\n      }, debounceTime)\r\n    } else {\r\n      scanAndRegister()\r\n      group.update()\r\n    }\r\n  }\r\n\r\n  // Initial scan\r\n  scanAndRegister()\r\n\r\n  // Observe DOM changes\r\n  observer = new MutationObserver((mutations) => {\r\n    let shouldUpdate = false\r\n\r\n    for (const mutation of mutations) {\r\n      if (mutation.type === 'childList') {\r\n        // Check added nodes\r\n        mutation.addedNodes.forEach((node) => {\r\n          if (node instanceof HTMLElement) {\r\n            if (node.hasAttribute(attribute)) {\r\n              shouldUpdate = true\r\n            }\r\n            // Check descendants\r\n            if (node.querySelector(`[${attribute}]`)) {\r\n              shouldUpdate = true\r\n            }\r\n          }\r\n        })\r\n\r\n        // Check removed nodes\r\n        mutation.removedNodes.forEach((node) => {\r\n          if (node instanceof HTMLElement) {\r\n            const id = node.getAttribute(attribute)\r\n            if (id) {\r\n              group.unregister(id, node)\r\n            }\r\n          }\r\n        })\r\n      }\r\n\r\n      if (mutation.type === 'attributes' && mutation.attributeName === attribute) {\r\n        shouldUpdate = true\r\n      }\r\n    }\r\n\r\n    if (shouldUpdate) {\r\n      debouncedUpdate()\r\n    }\r\n  })\r\n\r\n  observer.observe(root, {\r\n    childList: true,\r\n    subtree: true,\r\n    attributes: true,\r\n    attributeFilter: [attribute],\r\n  })\r\n\r\n  // Observe resize changes\r\n  resizeObserver = new ResizeObserver(() => {\r\n    debouncedUpdate()\r\n  })\r\n\r\n  resizeObserver.observe(root)\r\n\r\n  return {\r\n    update: () => {\r\n      scanAndRegister()\r\n      group.update()\r\n    },\r\n\r\n    forceUpdate: () => {\r\n      scanAndRegister()\r\n      group.forceUpdate()\r\n    },\r\n\r\n    destroy: () => {\r\n      if (debounceTimer) {\r\n        clearTimeout(debounceTimer)\r\n      }\r\n      observer?.disconnect()\r\n      resizeObserver?.disconnect()\r\n      group.destroy()\r\n    },\r\n  }\r\n}\r\n","/**\r\n * Enhanced Stagger Patterns - Advanced staggering for complex animations\r\n *\r\n * Provides grid, spiral, wave, and custom stagger patterns for\r\n * sophisticated animation orchestration.\r\n */\r\n\r\nimport { clamp } from '../utils/math.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * Stagger pattern configuration\r\n */\r\nexport interface StaggerPatternConfig {\r\n  /** Total number of items */\r\n  count: number\r\n  /** Base delay between items (seconds) */\r\n  delay?: number\r\n  /** Easing function for delay distribution */\r\n  easing?: (t: number) => number\r\n}\r\n\r\n/**\r\n * Grid stagger configuration\r\n */\r\nexport interface GridStaggerConfig extends StaggerPatternConfig {\r\n  /** Number of columns */\r\n  columns: number\r\n  /** Grid origin for stagger direction */\r\n  origin?: 'top-left' | 'top-right' | 'bottom-left' | 'bottom-right' | 'center'\r\n  /** Direction of stagger flow */\r\n  direction?: 'row' | 'column' | 'diagonal' | 'radial'\r\n}\r\n\r\n/**\r\n * Wave stagger configuration\r\n */\r\nexport interface WaveStaggerConfig extends StaggerPatternConfig {\r\n  /** Wave direction */\r\n  direction?: 'horizontal' | 'vertical' | 'diagonal'\r\n  /** Wave frequency (number of waves) */\r\n  frequency?: number\r\n  /** Wave amplitude (affects delay variation) */\r\n  amplitude?: number\r\n}\r\n\r\n/**\r\n * Spiral stagger configuration\r\n */\r\nexport interface SpiralStaggerConfig extends StaggerPatternConfig {\r\n  /** Number of columns for grid layout */\r\n  columns: number\r\n  /** Spiral direction */\r\n  direction?: 'clockwise' | 'counter-clockwise'\r\n  /** Start from center or edge */\r\n  startFrom?: 'center' | 'edge'\r\n}\r\n\r\n/**\r\n * Random stagger configuration\r\n */\r\nexport interface RandomStaggerConfig extends StaggerPatternConfig {\r\n  /** Seed for reproducible randomness */\r\n  seed?: number\r\n  /** Minimum delay multiplier */\r\n  minMultiplier?: number\r\n  /** Maximum delay multiplier */\r\n  maxMultiplier?: number\r\n}\r\n\r\n/**\r\n * Custom stagger function\r\n */\r\nexport type CustomStaggerFn = (index: number, total: number) => number\r\n\r\n// ============ Utility Functions ============\r\n\r\n/**\r\n * Seeded random number generator for reproducible results\r\n */\r\nfunction seededRandom(seed: number): () => number {\r\n  let state = seed\r\n  return () => {\r\n    state = (state * 1103515245 + 12345) & 0x7fffffff\r\n    return state / 0x7fffffff\r\n  }\r\n}\r\n\r\n/**\r\n * Calculate distance from origin in a grid\r\n */\r\nfunction gridDistance(\r\n  index: number,\r\n  columns: number,\r\n  rows: number,\r\n  origin: GridStaggerConfig['origin']\r\n): number {\r\n  const col = index % columns\r\n  const row = Math.floor(index / columns)\r\n\r\n  let originCol: number\r\n  let originRow: number\r\n\r\n  switch (origin) {\r\n    case 'top-left':\r\n      originCol = 0\r\n      originRow = 0\r\n      break\r\n    case 'top-right':\r\n      originCol = columns - 1\r\n      originRow = 0\r\n      break\r\n    case 'bottom-left':\r\n      originCol = 0\r\n      originRow = rows - 1\r\n      break\r\n    case 'bottom-right':\r\n      originCol = columns - 1\r\n      originRow = rows - 1\r\n      break\r\n    case 'center':\r\n    default:\r\n      originCol = (columns - 1) / 2\r\n      originRow = (rows - 1) / 2\r\n      break\r\n  }\r\n\r\n  const dx = col - originCol\r\n  const dy = row - originRow\r\n  return Math.sqrt(dx * dx + dy * dy)\r\n}\r\n\r\n// ============ Stagger Pattern Functions ============\r\n\r\n/**\r\n * Create linear stagger delays\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = linearStagger({ count: 10, delay: 0.1 })\r\n * // [0, 0.1, 0.2, 0.3, ...]\r\n * ```\r\n */\r\nexport function linearStagger(config: StaggerPatternConfig): number[] {\r\n  const { count, delay = 0.1, easing = (t) => t } = config\r\n  const delays: number[] = []\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const t = count > 1 ? i / (count - 1) : 0\r\n    delays.push(easing(t) * delay * (count - 1))\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create reverse stagger delays (last to first)\r\n */\r\nexport function reverseStagger(config: StaggerPatternConfig): number[] {\r\n  return linearStagger(config).reverse()\r\n}\r\n\r\n/**\r\n * Create center-out stagger delays\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = centerStagger({ count: 5, delay: 0.1 })\r\n * // Center items animate first, edges last\r\n * ```\r\n */\r\nexport function centerStagger(config: StaggerPatternConfig): number[] {\r\n  const { count, delay = 0.1, easing = (t) => t } = config\r\n  const delays: number[] = []\r\n  const center = (count - 1) / 2\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const distanceFromCenter = Math.abs(i - center)\r\n    const maxDistance = center\r\n    const t = maxDistance > 0 ? distanceFromCenter / maxDistance : 0\r\n    delays.push(easing(t) * delay * maxDistance)\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create edge-in stagger delays (edges first, center last)\r\n */\r\nexport function edgeStagger(config: StaggerPatternConfig): number[] {\r\n  const { count, delay = 0.1, easing = (t) => t } = config\r\n  const delays: number[] = []\r\n  const center = (count - 1) / 2\r\n  const maxDelay = delay * center\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const distanceFromCenter = Math.abs(i - center)\r\n    const maxDistance = center\r\n    const t = maxDistance > 0 ? 1 - distanceFromCenter / maxDistance : 0\r\n    delays.push(easing(t) * maxDelay)\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create grid-based stagger delays\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = gridStagger({\r\n *   count: 12,\r\n *   columns: 4,\r\n *   origin: 'center',\r\n *   direction: 'radial',\r\n *   delay: 0.05,\r\n * })\r\n * ```\r\n */\r\nexport function gridStagger(config: GridStaggerConfig): number[] {\r\n  const {\r\n    count,\r\n    columns,\r\n    origin = 'top-left',\r\n    direction = 'diagonal',\r\n    delay = 0.1,\r\n    easing = (t) => t,\r\n  } = config\r\n\r\n  const rows = Math.ceil(count / columns)\r\n  const delays: number[] = []\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const col = i % columns\r\n    const row = Math.floor(i / columns)\r\n\r\n    let t: number\r\n\r\n    switch (direction) {\r\n      case 'row':\r\n        // Row by row\r\n        t = row / Math.max(rows - 1, 1)\r\n        break\r\n\r\n      case 'column':\r\n        // Column by column\r\n        t = col / Math.max(columns - 1, 1)\r\n        break\r\n\r\n      case 'diagonal':\r\n        // Diagonal wave\r\n        t = (col + row) / (columns + rows - 2)\r\n        break\r\n\r\n      case 'radial':\r\n      default: {\r\n        // Distance from origin\r\n        const maxDistance = gridDistance(\r\n          origin === 'center' ? 0 : count - 1,\r\n          columns,\r\n          rows,\r\n          origin === 'center' ? 'top-left' : origin\r\n        )\r\n        const distance = gridDistance(i, columns, rows, origin)\r\n        t = maxDistance > 0 ? distance / maxDistance : 0\r\n        break\r\n      }\r\n    }\r\n\r\n    delays.push(easing(clamp(t, 0, 1)) * delay * Math.max(columns, rows))\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create wave-based stagger delays\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = waveStagger({\r\n *   count: 20,\r\n *   direction: 'horizontal',\r\n *   frequency: 2,\r\n *   amplitude: 0.5,\r\n *   delay: 0.1,\r\n * })\r\n * ```\r\n */\r\nexport function waveStagger(config: WaveStaggerConfig): number[] {\r\n  const {\r\n    count,\r\n    direction = 'horizontal',\r\n    frequency = 1,\r\n    amplitude = 0.5,\r\n    delay = 0.1,\r\n    easing = (t) => t,\r\n  } = config\r\n\r\n  const delays: number[] = []\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const t = count > 1 ? i / (count - 1) : 0\r\n\r\n    // Base linear delay\r\n    let d = t\r\n\r\n    // Add wave modulation\r\n    const waveOffset = Math.sin(t * Math.PI * 2 * frequency) * amplitude\r\n\r\n    // Apply wave based on direction\r\n    switch (direction) {\r\n      case 'horizontal':\r\n        d = t + waveOffset * 0.5\r\n        break\r\n      case 'vertical':\r\n        d = t + Math.abs(waveOffset)\r\n        break\r\n      case 'diagonal':\r\n        d = t + waveOffset\r\n        break\r\n    }\r\n\r\n    delays.push(easing(clamp(d, 0, 1.5)) * delay * (count - 1))\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create spiral stagger delays for grid layouts\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = spiralStagger({\r\n *   count: 16,\r\n *   columns: 4,\r\n *   direction: 'clockwise',\r\n *   startFrom: 'edge',\r\n *   delay: 0.1,\r\n * })\r\n * ```\r\n */\r\nexport function spiralStagger(config: SpiralStaggerConfig): number[] {\r\n  const {\r\n    count,\r\n    columns,\r\n    direction = 'clockwise',\r\n    startFrom = 'edge',\r\n    delay = 0.1,\r\n    easing = (t) => t,\r\n  } = config\r\n\r\n  const rows = Math.ceil(count / columns)\r\n  const spiral: number[] = []\r\n  const visited = new Set<string>()\r\n\r\n  let top = 0\r\n  let bottom = rows - 1\r\n  let left = 0\r\n  let right = columns - 1\r\n\r\n  // Generate spiral order\r\n  while (top <= bottom && left <= right) {\r\n    // Top row\r\n    for (let col = left; col <= right; col++) {\r\n      const idx = top * columns + col\r\n      if (idx < count && !visited.has(`${top},${col}`)) {\r\n        spiral.push(idx)\r\n        visited.add(`${top},${col}`)\r\n      }\r\n    }\r\n    top++\r\n\r\n    // Right column\r\n    for (let row = top; row <= bottom; row++) {\r\n      const idx = row * columns + right\r\n      if (idx < count && !visited.has(`${row},${right}`)) {\r\n        spiral.push(idx)\r\n        visited.add(`${row},${right}`)\r\n      }\r\n    }\r\n    right--\r\n\r\n    // Bottom row\r\n    if (top <= bottom) {\r\n      for (let col = right; col >= left; col--) {\r\n        const idx = bottom * columns + col\r\n        if (idx < count && !visited.has(`${bottom},${col}`)) {\r\n          spiral.push(idx)\r\n          visited.add(`${bottom},${col}`)\r\n        }\r\n      }\r\n      bottom--\r\n    }\r\n\r\n    // Left column\r\n    if (left <= right) {\r\n      for (let row = bottom; row >= top; row--) {\r\n        const idx = row * columns + left\r\n        if (idx < count && !visited.has(`${row},${left}`)) {\r\n          spiral.push(idx)\r\n          visited.add(`${row},${left}`)\r\n        }\r\n      }\r\n      left++\r\n    }\r\n  }\r\n\r\n  // Reverse for center start or counter-clockwise\r\n  if (startFrom === 'center') {\r\n    spiral.reverse()\r\n  }\r\n  if (direction === 'counter-clockwise') {\r\n    spiral.reverse()\r\n  }\r\n\r\n  // Create delay array\r\n  const delays = new Array(count).fill(0)\r\n  const maxDelay = delay * (spiral.length - 1)\r\n\r\n  spiral.forEach((originalIndex, spiralPosition) => {\r\n    const t = spiral.length > 1 ? spiralPosition / (spiral.length - 1) : 0\r\n    delays[originalIndex] = easing(t) * maxDelay\r\n  })\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create random stagger delays\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = randomStagger({\r\n *   count: 10,\r\n *   seed: 12345, // Reproducible\r\n *   delay: 0.1,\r\n *   minMultiplier: 0,\r\n *   maxMultiplier: 1,\r\n * })\r\n * ```\r\n */\r\nexport function randomStagger(config: RandomStaggerConfig): number[] {\r\n  const {\r\n    count,\r\n    seed = Date.now(),\r\n    delay = 0.1,\r\n    minMultiplier = 0,\r\n    maxMultiplier = 1,\r\n    easing = (t) => t,\r\n  } = config\r\n\r\n  const random = seededRandom(seed)\r\n  const delays: number[] = []\r\n  const maxDelay = delay * (count - 1)\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const r = random()\r\n    const multiplier = minMultiplier + r * (maxMultiplier - minMultiplier)\r\n    delays.push(easing(multiplier) * maxDelay)\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n/**\r\n * Create custom stagger delays using a function\r\n *\r\n * @example\r\n * ```ts\r\n * const delays = customStagger({\r\n *   count: 10,\r\n *   delay: 0.1,\r\n * }, (index, total) => {\r\n *   // Custom pattern: faster in middle\r\n *   const center = (total - 1) / 2\r\n *   return 1 - Math.abs(index - center) / center\r\n * })\r\n * ```\r\n */\r\nexport function customStagger(\r\n  config: StaggerPatternConfig,\r\n  fn: CustomStaggerFn\r\n): number[] {\r\n  const { count, delay = 0.1 } = config\r\n  const delays: number[] = []\r\n  const maxDelay = delay * (count - 1)\r\n\r\n  for (let i = 0; i < count; i++) {\r\n    const t = fn(i, count)\r\n    delays.push(clamp(t, 0, 1) * maxDelay)\r\n  }\r\n\r\n  return delays\r\n}\r\n\r\n// ============ Stagger Utilities ============\r\n\r\n/**\r\n * Apply stagger delays to animation options\r\n *\r\n * @example\r\n * ```ts\r\n * const items = document.querySelectorAll('.item')\r\n * const delays = gridStagger({ count: items.length, columns: 4 })\r\n *\r\n * items.forEach((item, i) => {\r\n *   spring(item, { opacity: 1 }, { delay: delays[i] })\r\n * })\r\n * ```\r\n */\r\nexport function applyStagger<T extends { delay?: number }>(\r\n  options: T[],\r\n  delays: number[]\r\n): T[] {\r\n  return options.map((opt, i) => ({\r\n    ...opt,\r\n    delay: (opt.delay ?? 0) + (delays[i] ?? 0),\r\n  }))\r\n}\r\n\r\n/**\r\n * Stagger pattern presets\r\n */\r\nexport const staggerPresets = {\r\n  /** Quick cascade from first to last */\r\n  cascade: (count: number) => linearStagger({ count, delay: 0.05 }),\r\n\r\n  /** Slow reveal from first to last */\r\n  reveal: (count: number) => linearStagger({ count, delay: 0.15 }),\r\n\r\n  /** Pop from center outward */\r\n  pop: (count: number) => centerStagger({ count, delay: 0.08 }),\r\n\r\n  /** Ripple from edges to center */\r\n  ripple: (count: number) => edgeStagger({ count, delay: 0.08 }),\r\n\r\n  /** Random scatter effect */\r\n  scatter: (count: number) => randomStagger({ count, delay: 0.1, seed: 42 }),\r\n\r\n  /** Grid diagonal wave */\r\n  gridWave: (count: number, columns: number) =>\r\n    gridStagger({ count, columns, direction: 'diagonal', delay: 0.05 }),\r\n\r\n  /** Grid radial from center */\r\n  gridRadial: (count: number, columns: number) =>\r\n    gridStagger({ count, columns, origin: 'center', direction: 'radial', delay: 0.05 }),\r\n\r\n  /** Spiral inward */\r\n  spiralIn: (count: number, columns: number) =>\r\n    spiralStagger({ count, columns, startFrom: 'edge', delay: 0.05 }),\r\n\r\n  /** Spiral outward */\r\n  spiralOut: (count: number, columns: number) =>\r\n    spiralStagger({ count, columns, startFrom: 'center', delay: 0.05 }),\r\n}\r\n","/**\r\n * MotionValue - High-performance animated value without React re-renders\r\n *\r\n * Unlike React state, MotionValue updates don't trigger component re-renders.\r\n * This makes it ideal for high-frequency animations like drag, scroll, and gestures.\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n *\r\n * // Subscribe to changes (no React re-render)\r\n * x.on('change', (value) => {\r\n *   element.style.transform = `translateX(${value}px)`\r\n * })\r\n *\r\n * // Update value\r\n * x.set(100)  // Triggers spring animation\r\n * x.jump(100) // Instant update, no animation\r\n * ```\r\n */\r\n\r\nimport { createSpringValue } from './spring-value.js'\r\nimport type { SpringConfig } from '../types.js'\r\n\r\nexport type MotionValueSubscriber<T> = (value: T) => void\r\nexport type MotionValueEvent = 'change' | 'animationStart' | 'animationEnd' | 'animationComplete' | 'animationCancel'\r\n\r\nexport interface MotionValueOptions {\r\n  /** Spring configuration for animated transitions */\r\n  spring?: SpringConfig\r\n}\r\n\r\n/**\r\n * MotionValue class - Performant animated values\r\n *\r\n * Key advantages over React state:\r\n * - No re-renders on value change\r\n * - Direct DOM manipulation for 60fps animations\r\n * - Chainable with useTransform\r\n * - Memory efficient with automatic cleanup\r\n */\r\nexport class MotionValue<T = number> {\r\n  private _value: T\r\n  private _velocity: number = 0\r\n  private _subscribers: Set<MotionValueSubscriber<T>> = new Set()\r\n  private _eventListeners: Map<MotionValueEvent, Set<() => void>> = new Map()\r\n  private _springValue: ReturnType<typeof createSpringValue> | null = null\r\n  private _springConfig: SpringConfig\r\n  private _isAnimating: boolean = false\r\n  private _destroyed: boolean = false\r\n  private _checkEndRafId: number | null = null\r\n\r\n  constructor(initialValue: T, options: MotionValueOptions = {}) {\r\n    this._value = initialValue\r\n    this._springConfig = options.spring ?? { stiffness: 100, damping: 15 }\r\n\r\n    // Initialize spring for numeric values\r\n    if (typeof initialValue === 'number') {\r\n      this._springValue = createSpringValue(initialValue as number, {\r\n        ...this._springConfig,\r\n        onUpdate: (v: number) => {\r\n          if (this._destroyed) return\r\n          this._value = v as T\r\n          this._velocity = this._springValue?.getVelocity() ?? 0\r\n          this._notify()\r\n        },\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current value synchronously\r\n   */\r\n  get(): T {\r\n    return this._value\r\n  }\r\n\r\n  /**\r\n   * Get current velocity (for numeric values)\r\n   */\r\n  getVelocity(): number {\r\n    return this._velocity\r\n  }\r\n\r\n  /**\r\n   * Check if currently animating\r\n   */\r\n  isAnimating(): boolean {\r\n    return this._isAnimating\r\n  }\r\n\r\n  /**\r\n   * Check if this MotionValue has been destroyed\r\n   */\r\n  isDestroyed(): boolean {\r\n    return this._destroyed\r\n  }\r\n\r\n  /**\r\n   * Set value with spring animation\r\n   */\r\n  set(newValue: T, animate: boolean = true): void {\r\n    if (this._destroyed) return\r\n\r\n    // Cancel any pending animation end check to prevent memory leak\r\n    if (this._checkEndRafId !== null) {\r\n      cancelAnimationFrame(this._checkEndRafId)\r\n      this._checkEndRafId = null\r\n    }\r\n\r\n    if (typeof newValue === 'number' && this._springValue && animate) {\r\n      this._isAnimating = true\r\n      this._emit('animationStart')\r\n\r\n      this._springValue.set(newValue as number)\r\n\r\n      // Check for animation end with proper cleanup\r\n      const checkEnd = () => {\r\n        // Bail out if destroyed during animation\r\n        if (this._destroyed) {\r\n          this._checkEndRafId = null\r\n          return\r\n        }\r\n\r\n        if (this._springValue && Math.abs(this._springValue.getVelocity()) < 0.01) {\r\n          this._isAnimating = false\r\n          this._checkEndRafId = null\r\n          this._emit('animationEnd')\r\n        } else if (this._isAnimating) {\r\n          this._checkEndRafId = requestAnimationFrame(checkEnd)\r\n        } else {\r\n          this._checkEndRafId = null\r\n        }\r\n      }\r\n      this._checkEndRafId = requestAnimationFrame(checkEnd)\r\n    } else {\r\n      this._value = newValue\r\n      this._velocity = 0\r\n      this._notify()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Instantly set value without animation\r\n   */\r\n  jump(newValue: T): void {\r\n    if (this._destroyed) return\r\n\r\n    this._value = newValue\r\n    this._velocity = 0\r\n\r\n    if (typeof newValue === 'number' && this._springValue) {\r\n      this._springValue.jump(newValue as number)\r\n    }\r\n\r\n    this._isAnimating = false\r\n    this._notify()\r\n  }\r\n\r\n  /**\r\n   * Stop any running animation at current position\r\n   */\r\n  stop(): void {\r\n    // Cancel pending RAF callback\r\n    if (this._checkEndRafId !== null) {\r\n      cancelAnimationFrame(this._checkEndRafId)\r\n      this._checkEndRafId = null\r\n    }\r\n\r\n    // Use stop() which halts at current position and resolves promise\r\n    if (this._springValue) {\r\n      this._springValue.stop()\r\n    }\r\n    this._isAnimating = false\r\n    this._emit('animationEnd')\r\n  }\r\n\r\n  /**\r\n   * Subscribe to value changes\r\n   * Returns unsubscribe function\r\n   */\r\n  subscribe(callback: MotionValueSubscriber<T>): () => void {\r\n    this._subscribers.add(callback)\r\n\r\n    // Immediately call with current value\r\n    callback(this._value)\r\n\r\n    return () => {\r\n      this._subscribers.delete(callback)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add event listener\r\n   */\r\n  on(event: MotionValueEvent, callback: () => void): () => void {\r\n    if (!this._eventListeners.has(event)) {\r\n      this._eventListeners.set(event, new Set())\r\n    }\r\n    this._eventListeners.get(event)!.add(callback)\r\n\r\n    return () => {\r\n      this._eventListeners.get(event)?.delete(callback)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update spring configuration\r\n   * Takes effect immediately on ongoing animations\r\n   */\r\n  setConfig(config: Partial<SpringConfig>): void {\r\n    this._springConfig = { ...this._springConfig, ...config }\r\n    // Update existing spring if present\r\n    if (this._springValue) {\r\n      this._springValue.setConfig(config)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroy and cleanup\r\n   */\r\n  destroy(): void {\r\n    this._destroyed = true\r\n\r\n    // Cancel pending RAF callback to prevent memory leak\r\n    if (this._checkEndRafId !== null) {\r\n      cancelAnimationFrame(this._checkEndRafId)\r\n      this._checkEndRafId = null\r\n    }\r\n\r\n    this._subscribers.clear()\r\n    this._eventListeners.clear()\r\n\r\n    if (this._springValue) {\r\n      this._springValue.destroy()\r\n      this._springValue = null\r\n    }\r\n  }\r\n\r\n  private _notify(): void {\r\n    this._subscribers.forEach((callback) => {\r\n      try {\r\n        callback(this._value)\r\n      } catch (e) {\r\n        console.error('MotionValue subscriber error:', e)\r\n      }\r\n    })\r\n    this._emit('change')\r\n  }\r\n\r\n  private _emit(event: MotionValueEvent): void {\r\n    this._eventListeners.get(event)?.forEach((callback) => {\r\n      try {\r\n        callback()\r\n      } catch (e) {\r\n        console.error(`MotionValue ${event} listener error:`, e)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Create a new MotionValue\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n * const opacity = createMotionValue(1)\r\n * const scale = createMotionValue(1, { spring: { stiffness: 300, damping: 30 } })\r\n * ```\r\n */\r\nexport function createMotionValue<T = number>(\r\n  initialValue: T,\r\n  options?: MotionValueOptions\r\n): MotionValue<T> {\r\n  return new MotionValue(initialValue, options)\r\n}\r\n\r\n/**\r\n * Transform a MotionValue using a mapping function\r\n *\r\n * Creates a derived MotionValue that automatically updates\r\n * when the source value changes.\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n * const opacity = transformValue(x, (v) => 1 - v / 100)\r\n * const inverted = transformValue(x, (v) => -v)\r\n * ```\r\n */\r\nexport function transformValue<T, U>(\r\n  source: MotionValue<T>,\r\n  transform: (value: T) => U\r\n): MotionValue<U> {\r\n  const derived = new MotionValue<U>(transform(source.get()))\r\n\r\n  // Store unsubscribe function for cleanup\r\n  const unsubscribe = source.subscribe((value) => {\r\n    derived.jump(transform(value))\r\n  })\r\n\r\n  // Override destroy to clean up subscription (prevents memory leak)\r\n  const originalDestroy = derived.destroy.bind(derived)\r\n  derived.destroy = () => {\r\n    unsubscribe()\r\n    originalDestroy()\r\n  }\r\n\r\n  return derived\r\n}\r\n\r\n/**\r\n * Map a MotionValue from one range to another\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n * // Map 0-100 to 0-1\r\n * const progress = mapRange(x, [0, 100], [0, 1])\r\n * // Map with extrapolation clamped\r\n * const clamped = mapRange(x, [0, 100], [0, 1], { clamp: true })\r\n * ```\r\n */\r\nexport function mapRange(\r\n  source: MotionValue<number>,\r\n  inputRange: [number, number],\r\n  outputRange: [number, number],\r\n  options: { clamp?: boolean } = {}\r\n): MotionValue<number> {\r\n  const [inMin, inMax] = inputRange\r\n  const [outMin, outMax] = outputRange\r\n  const inputDelta = inMax - inMin\r\n\r\n  return transformValue(source, (value) => {\r\n    // Guard against division by zero\r\n    if (inputDelta === 0) {\r\n      return outMin\r\n    }\r\n\r\n    let normalized = (value - inMin) / inputDelta\r\n\r\n    if (options.clamp) {\r\n      normalized = Math.max(0, Math.min(1, normalized))\r\n    }\r\n\r\n    return outMin + normalized * (outMax - outMin)\r\n  })\r\n}\r\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Options for path animation\n */\nexport interface PathAnimationOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to auto-play on creation */\n  autoPlay?: boolean\n  /** Callback for value updates */\n  onUpdate?: (value: number) => void\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Path animation controller\n */\nexport interface PathAnimation {\n  /** Start the animation from 0 to target */\n  play: (target?: number) => Promise<void>\n  /** Reverse the animation */\n  reverse: () => Promise<void>\n  /** Set path length directly (0-1) */\n  set: (value: number, animate?: boolean) => void\n  /** Get current path length */\n  get: () => number\n  /** Pause the animation */\n  pause: () => void\n  /** Resume the animation */\n  resume: () => void\n  /** Stop and reset */\n  reset: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n  /** Destroy and cleanup */\n  destroy: () => void\n}\n\n/**\n * Create a path length animation for SVG stroke drawing effects.\n * Animates stroke-dashoffset to reveal/hide a path.\n *\n * @example Basic path drawing\n * ```ts\n * const pathAnim = createPathAnimation(pathElement, {\n *   config: { stiffness: 100, damping: 15 },\n * })\n *\n * // Draw the path\n * await pathAnim.play()\n *\n * // Erase the path\n * await pathAnim.reverse()\n * ```\n *\n * @example With offset control\n * ```ts\n * const anim = createPathAnimation(path)\n *\n * // Draw 50% of the path\n * anim.set(0.5)\n *\n * // Draw full path with animation\n * anim.set(1, true)\n * ```\n */\nexport function createPathAnimation(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement,\n  options: PathAnimationOptions = {}\n): PathAnimation {\n  const {\n    config = {},\n    autoPlay = false,\n    onUpdate,\n    onComplete,\n  } = options\n\n  // Get total path length\n  const totalLength = element.getTotalLength?.() ?? 0\n\n  // Set initial stroke properties\n  element.style.strokeDasharray = String(totalLength)\n  element.style.strokeDashoffset = String(totalLength)\n\n  let currentValue = 0\n  let destroyed = false\n  let pendingRafId: number | null = null\n  let pendingTimeoutId: ReturnType<typeof setTimeout> | null = null\n  const spring = createSpringValue(0, config)\n\n  // Subscribe to updates\n  const unsubscribe = spring.subscribe((value) => {\n    if (destroyed) return\n\n    currentValue = value\n    // Convert 0-1 to offset (1 = hidden, 0 = visible)\n    const offset = totalLength * (1 - value)\n    element.style.strokeDashoffset = String(offset)\n    onUpdate?.(value)\n  })\n\n  const waitForRest = (): Promise<void> => {\n    return new Promise((resolve) => {\n      const check = () => {\n        pendingRafId = null\n\n        if (destroyed || !spring.isAnimating()) {\n          resolve()\n        } else {\n          pendingRafId = requestAnimationFrame(check)\n        }\n      }\n      pendingTimeoutId = setTimeout(() => {\n        pendingTimeoutId = null\n        check()\n      }, 16)\n    })\n  }\n\n  const animation: PathAnimation = {\n    play: async (target = 1) => {\n      if (destroyed) return\n      spring.set(target)\n      await waitForRest()\n      onComplete?.()\n    },\n\n    reverse: async () => {\n      if (destroyed) return\n      spring.set(0)\n      await waitForRest()\n      onComplete?.()\n    },\n\n    set: (value: number, animate = false) => {\n      if (destroyed) return\n\n      if (animate) {\n        spring.set(value)\n      } else {\n        spring.jump(value)\n        currentValue = value\n        const offset = totalLength * (1 - value)\n        element.style.strokeDashoffset = String(offset)\n      }\n    },\n\n    get: () => currentValue,\n\n    pause: () => {\n      if (destroyed) return\n      spring.stop()\n    },\n\n    resume: () => {\n      if (destroyed) return\n      // Resume by re-setting target\n      spring.set(currentValue)\n    },\n\n    reset: () => {\n      if (destroyed) return\n      spring.jump(0)\n      currentValue = 0\n      element.style.strokeDashoffset = String(totalLength)\n    },\n\n    isAnimating: () => spring.isAnimating(),\n\n    destroy: () => {\n      destroyed = true\n      // Cancel pending RAF and timeout to prevent memory leaks\n      if (pendingRafId !== null) {\n        cancelAnimationFrame(pendingRafId)\n        pendingRafId = null\n      }\n      if (pendingTimeoutId !== null) {\n        clearTimeout(pendingTimeoutId)\n        pendingTimeoutId = null\n      }\n      unsubscribe()\n      spring.destroy()\n    },\n  }\n\n  if (autoPlay) {\n    animation.play()\n  }\n\n  return animation\n}\n\n/**\n * Get the total length of an SVG path element\n */\nexport function getPathLength(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement\n): number {\n  return element.getTotalLength?.() ?? 0\n}\n\n/**\n * Set up an element for path animation (sets dasharray and dashoffset)\n */\nexport function preparePathForAnimation(\n  element: SVGPathElement | SVGCircleElement | SVGRectElement | SVGLineElement | SVGPolylineElement | SVGPolygonElement | SVGEllipseElement,\n  initialProgress = 0\n): void {\n  const length = element.getTotalLength?.() ?? 0\n  element.style.strokeDasharray = String(length)\n  element.style.strokeDashoffset = String(length * (1 - initialProgress))\n}\n\n/**\n * Calculate the point on a path at a given percentage\n */\nexport function getPointAtProgress(\n  path: SVGPathElement,\n  progress: number\n): DOMPoint | null {\n  try {\n    const length = path.getTotalLength()\n    return path.getPointAtLength(length * Math.max(0, Math.min(1, progress)))\n  } catch {\n    return null\n  }\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Measured box dimensions\n */\nexport interface MeasuredBox {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n/**\n * FLIP animation options\n */\nexport interface FlipOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to animate position */\n  position?: boolean\n  /** Whether to animate size */\n  size?: boolean\n  /** Callback when animation completes */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (progress: number) => void\n}\n\n/**\n * FLIP animation controller\n */\nexport interface FlipAnimation {\n  /** Play the FLIP animation */\n  play: () => Promise<void>\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Cancel the animation */\n  cancel: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n}\n\n/**\n * Measure the bounding box of an element\n */\nexport function measureElement(element: HTMLElement): MeasuredBox {\n  const rect = element.getBoundingClientRect()\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n  }\n}\n\n/**\n * Create a FLIP (First, Last, Invert, Play) animation.\n *\n * FLIP is a technique for animating layout changes performantly:\n * 1. First: Measure the element's initial position\n * 2. Last: Apply the change and measure final position\n * 3. Invert: Apply transforms to make it look like it's still in the first position\n * 4. Play: Animate the transforms to zero\n *\n * @example Basic FLIP\n * ```ts\n * // Measure first position\n * const first = measureElement(element)\n *\n * // Make layout change\n * element.classList.toggle('expanded')\n *\n * // Measure last position\n * const last = measureElement(element)\n *\n * // Create and play FLIP animation\n * const flip = createFlip(element, first, last)\n * await flip.play()\n * ```\n *\n * @example With options\n * ```ts\n * const flip = createFlip(element, first, last, {\n *   config: { stiffness: 300, damping: 30 },\n *   position: true,  // Animate position\n *   size: true,      // Animate size\n *   onComplete: () => console.log('Done!'),\n * })\n * ```\n */\nexport function createFlip(\n  element: HTMLElement,\n  first: MeasuredBox,\n  last: MeasuredBox,\n  options: FlipOptions = {}\n): FlipAnimation {\n  const {\n    config = {},\n    position = true,\n    size = true,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Calculate the inversion (how much to transform to get back to \"first\")\n  const deltaX = first.x - last.x\n  const deltaY = first.y - last.y\n  // Guard against division by zero (zero-sized elements)\n  const deltaWidth = last.width === 0 ? 1 : first.width / last.width\n  const deltaHeight = last.height === 0 ? 1 : first.height / last.height\n\n  let progress = 0\n  let isPlaying = false\n  let cancelled = false\n  let pendingRafId: number | null = null\n  let pendingTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let resolvePlay: (() => void) | null = null\n\n  const spring = createSpringValue(0, config)\n\n  // Store original transform\n  const originalTransform = element.style.transform\n  const originalTransformOrigin = element.style.transformOrigin\n\n  // Set transform origin to top-left for size animations\n  if (size) {\n    element.style.transformOrigin = '0 0'\n  }\n\n  const applyTransform = (t: number) => {\n    progress = t\n    const invertedT = 1 - t\n\n    const transforms: string[] = []\n\n    if (position) {\n      transforms.push(`translate(${deltaX * invertedT}px, ${deltaY * invertedT}px)`)\n    }\n\n    if (size && (deltaWidth !== 1 || deltaHeight !== 1)) {\n      const scaleX = 1 + (deltaWidth - 1) * invertedT\n      const scaleY = 1 + (deltaHeight - 1) * invertedT\n      transforms.push(`scale(${scaleX}, ${scaleY})`)\n    }\n\n    element.style.transform = transforms.length > 0 ? transforms.join(' ') : ''\n    try {\n      onUpdate?.(t)\n    } catch (e) {\n      console.error('[SpringKit] FLIP onUpdate error:', e)\n    }\n  }\n\n  // Apply initial inversion\n  applyTransform(0)\n\n  const cleanup = () => {\n    // Restore original styles\n    element.style.transform = originalTransform\n    element.style.transformOrigin = originalTransformOrigin\n  }\n\n  return {\n    play: async () => {\n      if (cancelled) return\n\n      isPlaying = true\n\n      return new Promise<void>((resolve) => {\n        resolvePlay = resolve\n\n        const unsubscribe = spring.subscribe((value) => {\n          if (cancelled) {\n            unsubscribe()\n            resolvePlay = null\n            resolve()\n            return\n          }\n          applyTransform(value)\n        })\n\n        spring.set(1)\n\n        // Wait for animation to complete\n        const checkComplete = () => {\n          pendingRafId = null\n\n          if (cancelled) {\n            unsubscribe()\n            cleanup()\n            resolvePlay = null\n            resolve()\n            return\n          }\n\n          if (!spring.isAnimating()) {\n            isPlaying = false\n            unsubscribe()\n            cleanup()\n            try {\n              onComplete?.()\n            } catch (e) {\n              console.error('[SpringKit] FLIP onComplete error:', e)\n            }\n            resolvePlay = null\n            resolve()\n          } else {\n            pendingRafId = requestAnimationFrame(checkComplete)\n          }\n        }\n\n        pendingTimeoutId = setTimeout(() => {\n          pendingTimeoutId = null\n          checkComplete()\n        }, 16)\n      })\n    },\n\n    getProgress: () => progress,\n\n    cancel: () => {\n      cancelled = true\n      isPlaying = false\n\n      // Cancel pending RAF and timeout to prevent memory leak\n      if (pendingRafId !== null) {\n        cancelAnimationFrame(pendingRafId)\n        pendingRafId = null\n      }\n      if (pendingTimeoutId !== null) {\n        clearTimeout(pendingTimeoutId)\n        pendingTimeoutId = null\n      }\n\n      spring.stop()\n      cleanup()\n\n      // Resolve the play promise if it's pending\n      if (resolvePlay) {\n        resolvePlay()\n        resolvePlay = null\n      }\n    },\n\n    isAnimating: () => isPlaying,\n  }\n}\n\n/**\n * Higher-level helper that handles the full FLIP flow.\n * Automatically measures before/after states.\n *\n * @example\n * ```ts\n * await flip(element, () => {\n *   element.classList.toggle('expanded')\n * }, { config: { stiffness: 200 } })\n * ```\n */\nexport async function flip(\n  element: HTMLElement,\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure initial state\n  const first = measureElement(element)\n\n  // Last: apply mutation and measure final state\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetHeight\n\n  const last = measureElement(element)\n\n  // Invert & Play\n  const animation = createFlip(element, first, last, options)\n  await animation.play()\n}\n\n/**\n * Batch FLIP animations for multiple elements.\n * Useful when multiple elements change position together.\n *\n * @example\n * ```ts\n * await flipBatch(\n *   [card1, card2, card3],\n *   () => container.classList.toggle('grid'),\n *   { config: { stiffness: 150 } }\n * )\n * ```\n */\nexport async function flipBatch(\n  elements: HTMLElement[],\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure all elements\n  const firstStates = elements.map((el) => measureElement(el))\n\n  // Last: apply mutation\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  document.body.offsetHeight\n\n  // Measure all final states and create animations\n  const animations = elements.map((element, i) => {\n    const last = measureElement(element)\n    return createFlip(element, firstStates[i]!, last, options)\n  })\n\n  // Play all animations\n  await Promise.all(animations.map((anim) => anim.play()))\n}\n"]}