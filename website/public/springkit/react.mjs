import H,{useRef,useState,useEffect}from'react';import {jsx,Fragment}from'react/jsx-runtime';var b={stiffness:100,damping:10,mass:1,velocity:0,restSpeed:.01,restDelta:.01,clamp:false};function G(o,e,t,i){let{stiffness:r=100,damping:n=10,mass:s=1,restSpeed:m=.01,restDelta:a=.01}=i,g=1/60,l=t-o,p=r*l,u=n*e,d=(p-u)/s,f=e+d*g,y=o+f*g,C=Math.abs(l)<=a&&Math.abs(f)<=m;return {position:y,velocity:f,isRest:C}}var T=class{constructor(){this.animations=new Set;this.rafId=null;this.isRunning=false;this.tick=()=>{let e=performance.now();for(let i of this.animations)i.update(e);let t=[];for(let i of this.animations)i.isComplete()&&t.push(i);for(let i of t)this.animations.delete(i);this.animations.size>0?this.rafId=requestAnimationFrame(this.tick):this.stop();};}add(e){this.animations.add(e),this.start();}remove(e){this.animations.delete(e),this.animations.size===0&&this.stop();}start(){this.isRunning||(this.isRunning=true,this.tick());}stop(){this.isRunning=false,this.rafId!==null&&(cancelAnimationFrame(this.rafId),this.rafId=null);}get size(){return this.animations.size}},S=new T;function x(o,e,t){let i=Math.min(e,t),r=Math.max(e,t);return Math.max(i,Math.min(r,o))}var R=class{constructor(e,t,i={}){this.state="idle";this.resolveComplete=null;this.from=e,this.to=t,this.clampedFrom=e,this.clampedTo=t,this.position=e,this.velocity=i.velocity??0,this.target=t,this.config={...b,...i,stiffness:i.stiffness??b.stiffness,damping:i.damping??b.damping,mass:i.mass??b.mass,restSpeed:i.restSpeed??b.restSpeed,restDelta:i.restDelta??b.restDelta},this.finished=new Promise(r=>{this.resolveComplete=r;});}start(){return this.state==="running"?this:(this.state="running",this.config.onStart?.(),S.add(this),this)}stop(){this.state="idle",S.remove(this);}pause(){this.state==="running"&&(this.state="paused",S.remove(this));}resume(){this.state==="paused"&&(this.state="running",S.add(this));}reverse(){let e=this.from;this.from=this.to,this.to=e,this.clampedFrom=this.from,this.clampedTo=this.to,this.target=this.to;}set(e){this.to=e,this.clampedTo=e,this.target=e;}update(e){if(this.state!=="running")return;let t=G(this.position,this.velocity,this.target,this.config);if(this.position=t.position,this.velocity=t.velocity,this.config.clamp){let i=Math.min(this.clampedFrom,this.clampedTo),r=Math.max(this.clampedFrom,this.clampedTo);this.position=x(this.position,i,r);}this.config.onUpdate?.(this.position),t.isRest&&(this.state="complete",S.remove(this),this.position=this.target,this.config.onUpdate?.(this.position),this.config.onComplete?.(),this.config.onRest?.(),this.resolveComplete?.());}isAnimating(){return this.state==="running"}isPaused(){return this.state==="paused"}isComplete(){return this.state==="complete"}getValue(){return this.position}getVelocity(){return this.velocity}destroy(){this.stop(),this.config.onUpdate=void 0,this.config.onStart=void 0,this.config.onComplete=void 0,this.config.onRest=void 0;}};function I(o,e,t){return new R(o,e,t)}var D=class{constructor(e,t={}){this.currentAnimation=null;this.subscribers=new Set;this.resolveComplete=null;this.value=e,this.config={...b,...t},this.finishedPromise=new Promise(i=>{this.resolveComplete=i;});}get(){return this.value}getVelocity(){return this.currentAnimation?.getVelocity()??0}set(e,t={}){this.currentAnimation&&(this.currentAnimation.destroy(),this.currentAnimation=null),this.finishedPromise=new Promise(s=>{this.resolveComplete=s;});let i={...this.config,...t},r=i.onUpdate,n=i.onComplete;this.currentAnimation=I(this.value,e,{...i,onUpdate:s=>{this.value=s,this.notify(),r?.(s);},onComplete:()=>{n?.(),this.resolveComplete&&this.resolveComplete();}}),this.currentAnimation.start();}jump(e){this.currentAnimation&&(this.currentAnimation.destroy(),this.currentAnimation=null),this.value=e,this.notify();}subscribe(e){return this.subscribers.add(e),e(this.value),()=>{this.subscribers.delete(e);}}isAnimating(){return this.currentAnimation?.isAnimating()??false}get finished(){return this.finishedPromise}notify(){for(let e of this.subscribers)e(this.value);}destroy(){this.currentAnimation?.destroy(),this.currentAnimation=null,this.subscribers.clear();}};function h(o,e){return new D(o,e)}var V=class{constructor(e,t={}){this.subscribers=new Set;this.resolveComplete=null;this.config={...b,...t},this.values=new Map;for(let[i,r]of Object.entries(e)){let n=h(r,this.config);n.subscribe(()=>this.notify()),this.values.set(i,n);}this.finishedPromise=Promise.resolve(),this.resetPromise();}resetPromise(){this.finishedPromise=new Promise(e=>{this.resolveComplete=e;});}get(){let e={};for(let[t,i]of this.values)e[t]=i.get();return e}getValue(e){return this.values.get(e)?.get()??0}set(e,t={}){this.resetPromise();let i=[];for(let[r,n]of Object.entries(e)){let s=this.values.get(r);s&&(s.set(n,t),i.push(s.finished));}Promise.all(i).then(()=>{this.resolveComplete&&this.resolveComplete();});}jump(e){for(let[t,i]of Object.entries(e)){let r=this.values.get(t);r&&r.jump(i);}}subscribe(e){return this.subscribers.add(e),e(this.get()),()=>this.subscribers.delete(e)}isAnimating(){for(let e of this.values.values())if(e.isAnimating())return  true;return  false}get finished(){return this.finishedPromise}notify(){let e=this.get();for(let t of this.subscribers)t(e);}destroy(){for(let e of this.values.values())e.destroy();this.subscribers.clear();}};function v(o,e){return new V(o,e)}var E=class{constructor(e,t={}){this.subscribers=new Set;this.frameCount=0;this.pendingUpdates=new Map;let{followDelay:i=2,...r}=t;this.followDelay=i,this.leader=h(0,r),this.springs=[];for(let n=0;n<e;n++){let s=h(0,r);this.springs.push(s);}this.leader.subscribe(()=>{this.frameCount++,this.scheduleFollowerUpdates();});}scheduleFollowerUpdates(){let e=this.leader.get();for(let t=0;t<this.springs.length;t++){let i=(t+1)*this.followDelay,r=this.frameCount+i;this.pendingUpdates.set(t,r),this.scheduleFollowerUpdate(t,e,r,i);}}scheduleFollowerUpdate(e,t,i,r){let n=this.frameCount,s=i-n;if(s<=0)this.springs[e].set(t);else {let m=Math.max(s*16,0);setTimeout(()=>{this.pendingUpdates.get(e)===i&&this.springs[e].set(t);},m);}}set(e){this.leader.set(e);}jump(e){this.leader.jump(e);for(let t of this.springs)t.jump(e);}getValues(){return this.springs.map(e=>e.get())}subscribe(e){this.subscribers.add(e);let t=[];for(let i of this.springs)t.push(i.subscribe(()=>{this.notify();}));return e(this.getValues()),()=>{this.subscribers.delete(e);for(let i of t)i();}}notify(){let e=this.getValues();for(let t of this.subscribers)t(e);}destroy(){this.leader.destroy();for(let e of this.springs)e.destroy();this.subscribers.clear(),this.pendingUpdates.clear();}};function w(o,e){return new E(o,e)}var z={axis:"both",rubberBand:false,rubberBandFactor:.5,stiffness:200,damping:20,mass:1,restSpeed:.01,restDelta:.01,clamp:false},A=class{constructor(e,t={}){this.enabled=true;this.position={x:0,y:0};this.isDragging=false;this.startPosition={x:0,y:0};this.pointerStart={x:0,y:0};this.lastPosition={x:0,y:0};this.lastTime=0;this.velocity={x:0,y:0};this.onPointerDown=e=>{!this.enabled||e.button!==0||(this.isDragging=true,this.startPosition={...this.position},this.pointerStart={x:e.clientX,y:e.clientY},this.lastPosition={x:e.clientX,y:e.clientY},this.lastTime=performance.now(),this.velocity={x:0,y:0},this.element.setPointerCapture(e.pointerId),this.element.addEventListener("pointermove",this.onPointerMove),this.element.addEventListener("pointerup",this.onPointerUp),this.element.addEventListener("pointercancel",this.onPointerUp),this.config.onDragStart&&this.config.onDragStart(e));};this.onPointerMove=e=>{let t=performance.now(),i=t-this.lastTime;this.velocity={x:(e.clientX-this.lastPosition.x)/Math.max(i,1),y:(e.clientY-this.lastPosition.y)/Math.max(i,1)},this.lastPosition={x:e.clientX,y:e.clientY},this.lastTime=t;let r=this.startPosition.x+(e.clientX-this.pointerStart.x),n=this.startPosition.y+(e.clientY-this.pointerStart.y);this.config.bounds&&(r=this.applyBounds(r,this.config.bounds.left??-1/0,this.config.bounds.right??1/0),n=this.applyBounds(n,this.config.bounds.top??-1/0,this.config.bounds.bottom??1/0)),this.config.axis==="x"?n=0:this.config.axis==="y"&&(r=0),this.position={x:r,y:n},this.config.onDrag&&this.config.onDrag(r,n,e),this.config.onUpdate&&this.config.onUpdate(r,n);};this.onPointerUp=e=>{this.isDragging=false,this.element.releasePointerCapture(e.pointerId),this.element.removeEventListener("pointermove",this.onPointerMove),this.element.removeEventListener("pointerup",this.onPointerUp),this.element.removeEventListener("pointercancel",this.onPointerUp),this.release(this.velocity.x*16,this.velocity.y*16),this.config.onDragEnd&&this.config.onDragEnd(this.position.x,this.position.y,this.velocity);};this.element=e,this.config={...z,...t};let i={stiffness:this.config.stiffness,damping:this.config.damping,mass:this.config.mass,restSpeed:this.config.restSpeed,restDelta:this.config.restDelta,clamp:this.config.clamp};this.springX=h(0,i),this.springY=h(0,i),this.springX.subscribe(()=>{this.isDragging||(this.position.x=this.springX.get(),this.config.onUpdate&&this.config.onUpdate(this.position.x,this.position.y));}),this.springY.subscribe(()=>{this.isDragging||(this.position.y=this.springY.get(),this.config.onUpdate&&this.config.onUpdate(this.position.x,this.position.y));}),this.setupPointerEvents();}setupPointerEvents(){this.element.addEventListener("pointerdown",this.onPointerDown);}applyBounds(e,t,i){if(!isFinite(t)&&!isFinite(i))return e;let r=isFinite(t)?t:-1/0,n=isFinite(i)?i:1/0;if(this.config.rubberBand){let s=this.config.rubberBandFactor||.5;if(e<r)return r-(r-e)*s;if(e>n)return n+(e-n)*s}return x(e,r,n)}enable(){this.enabled=true;}disable(){this.enabled=false,this.isDragging&&(this.isDragging=false);}isEnabled(){return this.enabled}reset(){this.springX.jump(0),this.springY.jump(0),this.position={x:0,y:0},this.config.onUpdate&&this.config.onUpdate(0,0);}getPosition(){return {...this.position}}setPosition(e,t){this.position={x:e,y:t},this.springX.jump(e),this.springY.jump(t);}release(e,t){if(this.config.bounds){let{left:i=-1/0,right:r=1/0,top:n=-1/0,bottom:s=1/0}=this.config.bounds,m=x(this.position.x,i,r),a=x(this.position.y,n,s);m!==this.position.x&&this.springX.set(m,{velocity:e}),a!==this.position.y&&this.springY.set(a,{velocity:t});}}destroy(){this.element.removeEventListener("pointerdown",this.onPointerDown),this.springX.destroy(),this.springY.destroy();}};function M(o,e){return new A(o,e)}function _(o,e={}){let t=useRef(null),[,i]=useState({}),r=useRef(true),n=useRef(JSON.stringify(o));return t.current||(t.current=v(o,e),t.current.subscribe(()=>i({}))),useEffect(()=>{if(r.current){r.current=false;return}let s=JSON.stringify(o);s!==n.current&&(t.current?.set(o,e),n.current=s);},[JSON.stringify(o)]),useEffect(()=>()=>t.current?.destroy(),[]),t.current.get()}function $(o,e={}){let t=useRef(null);return t.current||(t.current=h(o,e)),useEffect(()=>()=>t.current?.destroy(),[]),t.current}function re(o,e,t={}){let i=useRef([]),[,r]=useState({});return useEffect(()=>{i.current.forEach(n=>n?.destroy()),i.current=[];for(let n=0;n<o;n++){let s=e(n),m=s.from??s.values,a=v(m,{...t,...s.config});a.subscribe(()=>r({})),i.current.push(a),setTimeout(()=>{a.set(s.values);},s.delay??0);}return ()=>{i.current.forEach(n=>n?.destroy());}},[o,t]),i.current.map(n=>n?.get()??{})}function se(o,e,t={}){let i=useRef(null),[r,n]=useState(()=>Array.from({length:o},()=>({...e}))),s=useRef(true),m=useRef(JSON.stringify(e));return useEffect(()=>{let a=Object.keys(e),g=new Map;a.forEach(p=>{let u=[],d=e[p];for(let f=0;f<o;f++){let y=h(d,t);u.push(y);}g.set(p,u);}),i.current=g;let l=[];return g.forEach((p,u)=>{p.forEach((d,f)=>{let y=d.subscribe(()=>{n(C=>{let P=[...C];P[f]||(P[f]={...e});let Y={...P[f]};return g.forEach((J,W)=>{Y[W]=J[f].get();}),P[f]=Y,P});});l.push(y);});}),()=>{l.forEach(p=>p()),g.forEach(p=>{p.forEach(u=>u.destroy());}),i.current=null;}},[o]),useEffect(()=>{if(!i.current)return;let a=JSON.stringify(e);if(s.current){s.current=false,m.current=a;return}if(a===m.current)return;m.current=a;let g=Object.keys(e),l=50;g.forEach(p=>{let u=i.current?.get(p);if(!u)return;let d=e[p];u.forEach((f,y)=>{setTimeout(()=>{f.set(d,t);},y*l);});});},[JSON.stringify(e),t.stiffness,t.damping]),r}function ae(o={}){let e=useRef(null),t=useRef({x:0,y:0}),[i,r]=useState(null),[n,s]=useState(false),[,m]=useState({}),a=useRef(o);a.current=o;let g=u=>{r(u);};useEffect(()=>(e.current&&(e.current.destroy(),e.current=null),i&&(e.current=M(i,{...a.current,onDragStart:u=>{s(true),a.current.onDragStart?.(u);},onDragEnd:(u,d,f)=>{s(false),a.current.onDragEnd?.(u,d,f);},onUpdate:(u,d)=>{t.current={x:u,y:d},m({}),a.current.onUpdate?.(u,d);}})),()=>{e.current?.destroy(),e.current=null;}),[i]);let l=u=>{let d=u.x??t.current.x,f=u.y??t.current.y;e.current?.setPosition(d,f);},p=()=>{e.current?.reset(),t.current={x:0,y:0},m({});};return [t.current,{ref:g,set:l,reset:p,isDragging:n}]}function pe(o){let e=useRef({isDragging:false,startX:0,startY:0,currentX:0,currentY:0});return {onPointerDown:s=>{e.current={isDragging:true,startX:s.clientX,startY:s.clientY,currentX:s.clientX,currentY:s.clientY};},onPointerMove:s=>{if(!e.current.isDragging)return;let m=s.clientX-e.current.startX,a=s.clientY-e.current.startY;o.onDrag?.({x:m,y:a}),e.current.currentX=s.clientX,e.current.currentY=s.clientY;},onPointerUp:()=>{e.current.isDragging=false;},onPointerCancel:()=>{e.current.isDragging=false;}}}var le=({from:o,to:e,config:t={},onRest:i,children:r})=>{let n=useRef(null),[s,m]=useState(o);return useEffect(()=>{let a=v(o,t);return a.subscribe(m),n.current=a,requestAnimationFrame(()=>{a.set(e,{...t,onRest:i});}),()=>a.destroy()},[]),useEffect(()=>{n.current?.set(e,{...t,onRest:i});},[e,t,i]),jsx(Fragment,{children:r(s)})};function c(o){return H.forwardRef(({children:e,style:t={},config:i={},...r},n)=>{let s=useRef(null),[m,a]=useState({}),g=Object.fromEntries(Object.entries(t).filter(p=>typeof p[1]=="number"));useEffect(()=>{let p=v(Object.fromEntries(Object.keys(g).map(u=>[u,0])),i);return p.subscribe(u=>{a(u);}),s.current=p,()=>p.destroy()},[i.stiffness,i.damping]),useEffect(()=>{s.current?.set(g);},[g]);let l=Object.fromEntries(Object.entries(t).filter(([p,u])=>typeof u!="number"));return H.createElement(o,{...r,ref:n,style:{...l,...m}},e)})}var be={div:c("div"),span:c("span"),button:c("button"),a:c("a"),p:c("p"),h1:c("h1"),h2:c("h2"),h3:c("h3"),h4:c("h4"),h5:c("h5"),h6:c("h6"),ul:c("ul"),ol:c("ol"),li:c("li"),section:c("section"),article:c("article"),header:c("header"),footer:c("footer"),nav:c("nav"),main:c("main"),aside:c("aside"),img:c("img")};var xe=({items:o,keys:e,from:t,to:i,config:r={},reverse:n=false,children:s})=>{let m=useRef(null),[a,g]=useState(()=>o.map(()=>({...t})));return useEffect(()=>{let l=w(o.length,r),p=l.subscribe(d=>{g(d.map(f=>({...i,x:f})));});m.current=l;let u=Object.values(i)[0];return l.set(u),()=>{p(),l.destroy();}},[o.length,r.stiffness,r.damping]),useEffect(()=>{let l=Object.values(i)[0];m.current?.set(l);},[i]),jsx(Fragment,{children:o.map((l,p)=>jsx(H.Fragment,{children:s(a[p],l,n?o.length-1-p:p)},e(l,p)))})};export{be as Animated,le as Spring,xe as Trail,ae as useDrag,pe as useGesture,_ as useSpring,$ as useSpringValue,re as useSprings,se as useTrail};//# sourceMappingURL=index.mjs.map
//# sourceMappingURL=index.mjs.map