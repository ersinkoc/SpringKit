{"version":3,"sources":["../../src/core/config.ts","../../src/core/physics.ts","../../src/animation/loop.ts","../../src/utils/math.ts","../../src/utils/warnings.ts","../../src/core/spring.ts","../../src/core/spring-value.ts","../../src/core/spring-group.ts","../../src/core/variants.ts","../../src/animation/trail.ts","../../src/gesture/drag.ts","../../src/utils/color.ts","../../src/scroll/scroll-linked.ts","../../src/animation/timeline.ts","../../src/svg/morph.ts","../../src/layout/shared.ts","../../src/core/MotionValue.ts","../../src/layout/flip.ts","../../src/adapters/react/hooks/useSpring.ts","../../src/adapters/react/hooks/useSpringValue.ts","../../src/adapters/react/hooks/useSprings.ts","../../src/adapters/react/hooks/useTrail.ts","../../src/adapters/react/hooks/useDrag.ts","../../src/adapters/react/hooks/useGesture.ts","../../src/adapters/react/context/PresenceContext.ts","../../src/adapters/react/hooks/usePresence.ts","../../src/adapters/react/hooks/useAnimate.ts","../../src/adapters/react/hooks/useMotionValue.ts","../../src/adapters/react/hooks/useTransform.ts","../../src/adapters/react/hooks/useDragControls.ts","../../src/adapters/react/hooks/useInstantTransition.ts","../../src/adapters/react/utils/ssr.ts","../../src/adapters/react/hooks/useInView.ts","../../src/adapters/react/hooks/useScroll.ts","../../src/adapters/react/hooks/useGestureState.ts","../../src/adapters/react/hooks/useReducedMotion.ts","../../src/adapters/react/hooks/useScrollLinked.ts","../../src/adapters/react/hooks/useTimeline.ts","../../src/adapters/react/hooks/useMorph.ts","../../src/adapters/react/hooks/useLayoutAnimation.ts","../../src/adapters/react/hooks/useVariants.ts","../../src/adapters/react/hooks/usePhysics.ts","../../src/adapters/react/components/Spring.tsx","../../src/adapters/react/components/Animated.tsx","../../src/adapters/react/components/Trail.tsx","../../src/adapters/react/components/PresenceChild.tsx","../../src/adapters/react/components/AnimatePresence.tsx","../../src/adapters/react/components/MotionConfig.tsx","../../src/adapters/react/components/Reorder.tsx","../../src/adapters/react/components/SpringText.tsx","../../src/adapters/react/components/Magnetic.tsx","../../src/adapters/react/components/Parallax.tsx","../../src/adapters/react/components/LazyMotion.tsx"],"names":["defaultConfig","simulateSpring","position","velocity","target","config","stiffness","damping","mass","restSpeed","restDelta","displacement","absDisplacement","absVelocity","dt","springForce","dampingForce","acceleration","newVelocity","newPosition","isRest","AnimationLoop","id","cb","now","rawDelta","clampedDelta","listener","e","toRemove","ref","animation","i","existingId","callback","count","delta","globalLoop","clamp","value","min","max","actualMin","actualMax","lerp","a","b","isDev","warnedMessages","warnOnce","message","validateSpringConfig","validateAnimationValue","context","SpringAnimationImpl","from","to","resolve","temp","validTo","_now","result","spring","SpringValueImpl","initial","animationResolver","mergedConfig","originalOnUpdate","originalOnComplete","subscriber","createSpringValue","SpringGroupImpl","initialValues","key","springValue","values","promises","createSpringGroup","resolveVariant","variant","custom","resolved","transition","getVariant","variants","name","calculateStaggerDelays","options","staggerChildren","staggerDirection","delayChildren","delays","index","TrailImpl","followDelay","springConfig","targetValue","delayFrames","targetFrame","_delayFrames","startFrame","framesToWait","delayMs","timeoutId","s","unsubscribers","unsubscribe","createTrail","defaultDragConfig","DragSpringImpl","element","safeDt","instantVelocity","smoothingFactor","newX","newY","snapPoint","edge","dragElastic","axis","elasticFactor","snap","gridX","gridY","velocityMagnitude","threshold","nearestPoint","nearestDistance","point","dx","dy","distance","radius","bounds","constraints","parentRect","elementRect","padding","constraintRect","offsetX","offsetY","x","y","safeX","safeY","velocityX","velocityY","left","right","top","bottom","targetX","targetY","rawDecay","decay","decayFactor","momentumX","momentumY","modified","createDragSpring","parseColor","color","hexToRgb","rgbMatch","rgbaMatch","hslMatch","hslToRgb","rgbToHex","r","g","toHex","n","hex","cleanHex","h","l","gray","hue2rgb","p","q","t","lerpColor","colorA","colorB","createScrollProgress","offset","smooth","progress","smoothedProgress","lastScrollY","lastTime","direction","rafId","subscribers","calculateProgress","scrollY","windowHeight","newProgress","isInView","visibleRatio","rect","elementTop","elementHeight","startPoint","endPoint","scrollStart","scrollEnd","documentHeight","notify","info","onScroll","initialInfo","createParallax","speed","easing","rootMargin","observer","pendingRafId","destroyed","update","elementCenter","viewportCenter","normalizedDistance","entries","entry","createScrollTrigger","start","end","startOffset","endOffset","onEnter","onLeave","onProgress","once","scrub","isActive","hasEntered","getPosition","pos","startPos","endPos","triggerStart","triggerEnd","startProgress","endProgress","rawProgress","wasActive","createScrollLinkedValue","scrollProgress","inputRange","outputRange","shouldClamp","firstOutput","isColorOutput","currentValue","interpolate","firstInput","lastInput","segmentIndex","curr","next","segmentStart","segmentEnd","segmentProgress","startValue","endValue","timelineIdCounter","createTimeline","defaults","autoplay","repeat","yoyo","repeatDelay","onStart","onUpdate","onComplete","onRepeat","segments","labels","callbacks","pauses","currentTime","totalDuration","isPlaying","isReversed","isPaused","repeatCount","repeatDelayTimeoutId","lastFrameTime","hasStarted","insertTime","parsePosition","lastSegment","labelMatch","labelName","labelTime","offsetValue","resolveTarget","extractNumericProps","props","applyPropsToElement","transforms","cssProps","prop","val","getCurrentElementValues","current","computed","MAX_DELTA_TIME","tick","timestamp","deltaTime","callbacksAtTime","pauseCallback","segment","shouldBeActive","timeline","startTime","duration","endTime","numericProps","currentValues","originalOnStart","targetValues","fromProps","toProps","fromNumeric","toNumeric","label","time","parsePath","d","commands","regex","matches","matchItem","typeChar","valuesStr","type","v","toAbsolute","cmd","absValues","currentY","hasSvgPathSupport","svgNS","svg","path","hasSupport","works","samplePathFallback","samples","points","lastPoint","interpolated","step","frac","p1","p2","samplePath","interpolatePoint","pointsToPath","firstPoint","createMorph","initialPath","currentPath","fromPoints","toPoints","currentPoints","initialCommands","progressSpring","targetCommands","targetPoints","createMorphSequence","paths","currentIndex","firstPath","morph","targetIndex","targetPath","measureElement","styles","applyTransform","scaleX","scaleY","compensatedRadius","resetTransform","createLayoutGroup","defaultSpring","onAnimationStart","onAnimationComplete","crossfade","_transition","elements","previousMeasurements","register","existing","measurement","unregister","group","animateElement","checkComplete","previousMeasurement","currentMeasurement","groupIdCounter","createSharedLayoutContext","groups","groupId","createAutoLayout","root","attribute","debounceTime","layoutConfig","resizeObserver","debounceTimer","scanAndRegister","el","debouncedUpdate","mutations","shouldUpdate","mutation","node","MotionValue","initialValue","newValue","animate","checkEnd","event","createMotionValue","transformValue","source","transform","derived","originalDestroy","mapRange","inMin","inMax","outMin","outMax","inputDelta","normalized","createFlip","first","last","size","deltaX","deltaY","deltaWidth","deltaHeight","cancelled","pendingTimeoutId","resolvePlay","originalTransform","originalTransformOrigin","invertedT","cleanup","flip","mutate","useSpring","springRef","useRef","setCurrentValues","useState","isFirstRender","isMounted","prevValuesRef","configRef","valuesKey","useMemo","k","useEffect","newValues","prev","useSpringValue","useSprings","items","springsRef","isMountedRef","itemsRef","getInitialValues","useCallback","item","timeoutIds","unsub","useTrail","timeoutsRef","keys","springs","propSprings","_key","newItem","ps","currentValuesString","staggerDelay","useDrag","dragSpringRef","positionRef","setElement","isDragging","setIsDragging","forceUpdate","refCallback","set","rawX","rawY","reset","useGesture","handlers","stateRef","PresenceContext","createContext","usePresence","useContext","useIsPresent","usePresenceCustom","useAnimate","scopeRef","valuesRef","isAnimatingRef","cleanupRef","rafIdsRef","timeoutIdsRef","isDestroyedRef","_property","_value","applyStyles","property","delay","animationPromise","initialRafId","controls","useMotionValue","motionValueRef","useMotionValueState","motionValue","setValue","useMotionValueSync","externalValue","useMotionValues","motionValuesRef","useVelocity","velocityRef","frameRef","lastVelocityRef","useMotionValueEvent","callbackRef","useTransform","inputRangeOrTransform","derivedRef","unsubscribeRef","transformFn","nextVal","inputMin","inputMax","outputMin","outputMax","inCurr","inNext","useCombinedTransform","sources","unsubscribesRef","getCurrentValues","useVelocityTransform","useSpringTransform","outCurr","outNext","useMotionTemplate","strings","templateRef","stringsRef","buildString","str","valuesLength","useTime","timeRef","startTimeRef","elapsed","useAnimationFrame","lastTimeRef","useWillChange","properties","willChangeRef","wasAnimatingRef","sourcesRef","propertiesRef","sourcesLength","checkAnimating","isAnimating","useSum","sum","useProduct","product","useDifference","aVal","bVal","useClamp","useSnap","useSmooth","factor","smoothedRef","currentRef","useDelay","frames","delayedRef","bufferRef","delayed","useDragControls","isDraggingRef","listenerRef","stopRef","pointerEvent","stop","handler","useInstantTransition","isPending","_setIsPending","useTransition","startTransition","useForceUpdate","setTick","useLayoutMeasure","beforeRef","measureBefore","measureAfter","getLayoutDelta","after","before","isBrowser","isServer","useIsomorphicLayoutEffect","useLayoutEffect","shouldSkipAnimation","safeRequestAnimationFrame","safeCancelAnimationFrame","useInView","amount","margin","inView","setInView","setEntry","hasTriggered","observerEntry","isIntersecting","useInViewCallback","useInViewMultiple","elementsRef","inViewMap","setInViewMap","observerRef","useScroll","container","scrollXRef","scrollYRef","scrollXProgressRef","scrollYProgressRef","scrollX","scrollXProgress","scrollYProgress","scrollContainer","isWindow","getScrollPosition","getScrollSize","calculateTargetProgress","targetEl","viewportHeight","parseOffset","range","clampedProgress","handleScroll","scrollTarget","_viewportWidth","_type","parts","elementPart","viewportPart","elementPos","viewportPos","useScrollVelocity","lastScrollRef","currentScroll","deltaScroll","useGestureState","hover","press","focus","drag","state","setState","handleGlobalMouseUp","useHover","isHovered","setIsHovered","useTap","isPressed","setIsPressed","handleUp","useFocus","isFocused","setIsFocused","useInteractionState","useGestureAnimation","states","useReducedMotion","prefersReducedMotion","setPrefersReducedMotion","mediaQuery","handleChange","getReducedMotionPreference","useReducedMotionConfig","configs","useShouldAnimate","useReducedMotionValue","animatedValue","reducedValue","useScrollProgress","setProgress","setInfo","scrollProgressRef","scrollInfo","useParallax","setOffset","parallax","intervalId","useScrollTrigger","setIsActive","setHasEntered","trigger","useScrollLinkedValue","linkedValue","useTimeline","timelineRef","play","pause","resume","reverse","restart","seek","kill","useTimelineState","progressRef","isPlayingRef","isPausedRef","isReversedRef","updateState","currentRafId","useMorph","setPath","setProgressState","morphRef","optionsRef","currentOptions","newPath","morphTo","useMorphSequence","setCurrentIndex","sequenceRef","pathsKey","sequence","morphToIndex","morphToNext","morphToPrevious","useMorphRef","elementRef","pathRef","LayoutGroupContext","SharedLayoutContextReact","useLayoutGroup","layoutGroupRef","layoutGroup","useLayoutId","layoutId","localGroupRef","activeGroup","useFlip","lastMeasurementRef","flipFn","measure","useAutoLayout","autoLayoutRef","containerRef","LayoutGroupProvider","children","React","SharedLayoutProvider","sharedContextRef","VariantContext","useVariantContext","useVariants","inherit","parentContext","currentVariantRef","targetVariant","toNumber","fallback","parsed","computeSpringValues","fallbackValues","hasAnimatedRef","lastAnimatedVariantRef","animatedTargetValues","setAnimatedTargetValues","springValues","capturedVariant","capturedCallback","estimatedDuration","totalDelay","timer","setVariant","VariantProvider","useStaggerChildren","getDelay","getChildProps","createMotionComponent","_element","_options","useSpringState","onChange","useMomentum","friction","minVelocity","onRest","valueRef","isActiveRef","applyBounds","currentVelocity","push","useElastic","elasticity","maxStretch","rawValueRef","applyElasticity","input","sign","absInput","stretch","elasticValue","release","useBounce","dampening","gravity","floor","ceiling","restitution","drop","fromY","initialVelocity","safeFromY","safeVelocity","bounce","useGravity","_mass","bounciness","xRef","yRef","xMotion","yMotion","currentX","launch","setPosition","useChain","steps","currentStep","setCurrentStep","setIsPlaying","timeoutRef","allKeys","runStep","stepIndex","execute","usePointer","hoverOnly","rawXRef","rawYRef","isHovering","setIsHovering","handleMove","handleEnter","handleLeave","smoothLoop","targetElement","useGyroscope","multiplier","tiltXRef","tiltYRef","isSupported","setIsSupported","clampValue","hasOrientation","handleOrientation","handleMouse","centerX","centerY","Spring","setValues","jsx","Fragment","extractNumericValues","style","extractStringValues","createAnimatedComponent","tag","AnimatedComponent","exit","whileHover","whileTap","whileFocus","whileDrag","whileInView","viewport","onHoverStart","onHoverEnd","onTapStart","onTap","onTapCancel","propsOnMouseEnter","propsOnMouseLeave","propsOnPointerDown","propsOnPointerUp","propsOnPointerCancel","propsOnFocus","propsOnBlur","forwardedRef","animatedStyle","setAnimatedStyle","hasCalledSafeToRemove","_setIsDragging","isInViewport","setIsInViewport","hasTriggeredInView","presenceContext","isPresent","safeToRemove","setRef","getTargetStyle","getInitialStyle","initialStyle","numericInitial","numericAnimate","targetStyle","numericTarget","innerTimeout","timeout","handleMouseEnter","handleMouseLeave","handlePointerDown","handlePointerUp","handlePointerCancel","handleFocus","handleBlur","handleGlobalPointerUp","staticStyle","_","gestureStringStyles","eventHandlers","memo","Animated","Trail","trailRef","trail","vals","firstValue","DEFAULT_EXIT_TIMEOUT","PresenceChild","onExitComplete","exitTimeout","presenceIdRef","contextValue","hasExitedRef","hasCalledRemoveRef","getChildKey","child","getChildrenMap","map","Children","isValidElement","AnimatePresence","mode","isInitialMount","exitingChildren","setExitingChildren","prevChildrenRef","pendingExitCount","currentChildren","prevChildren","newExiting","prevChild","handleExitComplete","showEntering","allChildren","exitingChild","cloneElement","shouldAnimate","defaultContext","MotionContext","useMotionConfig","checkReducedMotion","MotionConfig","reducedMotion","isReducedMotion","ReorderContext","useReorderContext","ReorderGroupComponent","onReorder","className","Component","layoutDuration","sizesRef","draggingValue","setDraggingValue","offsets","setOffsets","dragStartIndexRef","currentOrderRef","registerItem","unregisterItem","handleDragStart","handleDrag","sizes","order","newOffsets","accumulatedOffset","itemSize","otherValue","otherSize","handleDragEnd","otherIndex","newOrder","removed","getDraggingValue","getItemOffset","ReorderItemComponent","dragEnabled","onDragStart","onDragEnd","dragStartPos","dragOffset","targetOffset","handlePointerMove","currentPos","transformProp","handleKeyDown","newIndex","isVertical","ReorderGroup","ReorderItem","Reorder","SpringText","stagger","initialOpacity","initialOffset","animateOnMount","setElements","animatedValues","setAnimatedValues","completedRef","getTransform","opacity","SpringNumber","decimals","format","prefix","suffix","displayValue","setDisplayValue","lastValueRef","formattedValue","jsxs","TypeWriter","cursor","cursorChar","loop","pauseAtEnd","deleteSpeed","displayText","setDisplayText","showCursor","setShowCursor","_isDeleting","setIsDeleting","isDeleteMode","blink","SplitText","render","Magnetic","forwardRef","strength","enabled","scaleOnHover","maxOffset","onAttract","onRelease","innerRef","combinedRef","springXRef","springYRef","springScaleRef","setTransform","isAttractedRef","scale","onAttractRef","onReleaseRef","handleMouseMove","distanceX","distanceY","scaleFactor","MagneticGroup","_repel","_repelStrength","MagneticCursor","visible","zIndex","useMagnetic","isAttracted","setIsAttracted","Parallax","setIsInView","windowWidth","yOffset","xOffset","transformStyle","MouseParallax","inverted","resetOnLeave","useWindow","width","height","normalizedX","normalizedY","TiltCard","maxTilt","perspective","glare","glareOpacity","onTilt","springTiltXRef","springTiltYRef","springGlareRef","tilt","setTilt","o","tiltX","tiltY","ParallaxContext","ParallaxContainer","pages","setScrollProgress","scrollTop","maxScroll","ParallaxLayer","horizontal","sticky","pageHeight","stickyRange","_stickyProgress","base","parallaxOffset","useParallaxContext","domAnimation","domMax","domMin","LazyMotionContext","useLazyMotion","useMotionFeature","feature","features","isLoaded","LazyMotion","strict","loadedFeatures","setLoadedFeatures","setIsLoaded","loaded","MotionFeatureGuard","isAvailable","createAsyncFeatures","featureKey","mergeFeatures","bundles","acc","bundle"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\r\n * Spring configuration interface\r\n */\r\nexport interface SpringConfig {\r\n  /** Spring stiffness (default: 100) */\r\n  stiffness?: number\r\n  /** Damping ratio (default: 10) */\r\n  damping?: number\r\n  /** Mass (default: 1) */\r\n  mass?: number\r\n  /** Initial velocity */\r\n  velocity?: number\r\n  /** Speed threshold for considering spring at rest (default: 0.01) */\r\n  restSpeed?: number\r\n  /** Position threshold for considering spring at rest (default: 0.01) */\r\n  restDelta?: number\r\n  /** Clamp value to [from, to] range */\r\n  clamp?: boolean\r\n  /** Callback called on each update */\r\n  onUpdate?: (value: number) => void\r\n  /** Callback called when animation starts */\r\n  onStart?: () => void\r\n  /** Callback called when animation reaches target */\r\n  onComplete?: () => void\r\n  /** Callback called when spring is at rest */\r\n  onRest?: () => void\r\n}\r\n\r\n/**\r\n * Default spring configuration\r\n */\r\nexport const defaultConfig: SpringConfig = {\r\n  stiffness: 100,\r\n  damping: 10,\r\n  mass: 1,\r\n  velocity: 0,\r\n  restSpeed: 0.01,\r\n  restDelta: 0.01,\r\n  clamp: false,\r\n}\r\n\r\n/**\r\n * Spring presets interface\r\n */\r\nexport interface SpringPresets {\r\n  /** Default spring: { stiffness: 100, damping: 10 } */\r\n  default: SpringConfig\r\n  /** Gentle spring: { stiffness: 120, damping: 14 } */\r\n  gentle: SpringConfig\r\n  /** Wobbly spring: { stiffness: 180, damping: 12 } */\r\n  wobbly: SpringConfig\r\n  /** Stiff spring: { stiffness: 210, damping: 20 } */\r\n  stiff: SpringConfig\r\n  /** Slow spring: { stiffness: 280, damping: 60 } */\r\n  slow: SpringConfig\r\n  /** Molasses spring: { stiffness: 280, damping: 120 } */\r\n  molasses: SpringConfig\r\n  /** Bouncy spring: { stiffness: 200, damping: 8 } */\r\n  bounce: SpringConfig\r\n  /** No wobble spring: { stiffness: 170, damping: 26 } */\r\n  noWobble: SpringConfig\r\n}\r\n\r\n/**\r\n * Built-in spring presets\r\n */\r\nexport const springPresets: SpringPresets = {\r\n  default: { stiffness: 100, damping: 10 },\r\n  gentle: { stiffness: 120, damping: 14 },\r\n  wobbly: { stiffness: 180, damping: 12 },\r\n  stiff: { stiffness: 210, damping: 20 },\r\n  slow: { stiffness: 280, damping: 60 },\r\n  molasses: { stiffness: 280, damping: 120 },\r\n  bounce: { stiffness: 200, damping: 8 },\r\n  noWobble: { stiffness: 170, damping: 26 },\r\n}\r\n\r\n// ============ Semantic Physics Presets ============\r\n\r\n/**\r\n * Physics presets with semantic, use-case oriented names\r\n * These presets are designed for specific UI interactions and feel natural\r\n */\r\nexport const physicsPresets = {\r\n  // ---- UI Interactions ----\r\n\r\n  /** Button press/release - snappy response */\r\n  button: { stiffness: 400, damping: 30, mass: 1 },\r\n\r\n  /** Toggle switch - quick but smooth */\r\n  toggle: { stiffness: 500, damping: 35, mass: 0.8 },\r\n\r\n  /** Checkbox/Radio - instant feedback */\r\n  checkbox: { stiffness: 600, damping: 40, mass: 0.5 },\r\n\r\n  /** Hover state - subtle and responsive */\r\n  hover: { stiffness: 300, damping: 25, mass: 0.8 },\r\n\r\n  /** Focus ring - gentle attention */\r\n  focus: { stiffness: 200, damping: 20, mass: 1 },\r\n\r\n  // ---- Layout & Navigation ----\r\n\r\n  /** Page transitions - smooth and professional */\r\n  pageTransition: { stiffness: 100, damping: 20, mass: 1.5 },\r\n\r\n  /** Modal/Dialog entry - dramatic but controlled */\r\n  modalEnter: { stiffness: 300, damping: 25, mass: 1 },\r\n\r\n  /** Modal/Dialog exit - quick departure */\r\n  modalExit: { stiffness: 400, damping: 35, mass: 0.8 },\r\n\r\n  /** Sidebar slide - smooth glide */\r\n  sidebar: { stiffness: 200, damping: 28, mass: 1.2 },\r\n\r\n  /** Dropdown menu - snappy reveal */\r\n  dropdown: { stiffness: 400, damping: 30, mass: 0.8 },\r\n\r\n  /** Toast notification - attention-grabbing */\r\n  toast: { stiffness: 350, damping: 25, mass: 0.9 },\r\n\r\n  /** Tooltip - quick and subtle */\r\n  tooltip: { stiffness: 500, damping: 40, mass: 0.6 },\r\n\r\n  // ---- Gestures & Drag ----\r\n\r\n  /** Drag release - momentum with settle */\r\n  dragRelease: { stiffness: 150, damping: 20, mass: 1 },\r\n\r\n  /** Swipe action - decisive movement */\r\n  swipe: { stiffness: 250, damping: 22, mass: 0.9 },\r\n\r\n  /** Pull to refresh - elastic and responsive */\r\n  pullToRefresh: { stiffness: 180, damping: 18, mass: 1.2 },\r\n\r\n  /** Snap to position - magnetic feel */\r\n  snap: { stiffness: 400, damping: 35, mass: 0.8 },\r\n\r\n  /** Rubber band - iOS-style overscroll */\r\n  rubberBand: { stiffness: 300, damping: 15, mass: 0.8 },\r\n\r\n  // ---- Cards & Items ----\r\n\r\n  /** Card flip - dramatic reveal */\r\n  cardFlip: { stiffness: 150, damping: 18, mass: 1.5 },\r\n\r\n  /** Card hover lift - subtle elevation */\r\n  cardHover: { stiffness: 400, damping: 30, mass: 0.7 },\r\n\r\n  /** List item enter - staggered animation */\r\n  listItem: { stiffness: 300, damping: 28, mass: 0.9 },\r\n\r\n  /** Accordion expand - smooth reveal */\r\n  accordion: { stiffness: 200, damping: 25, mass: 1.1 },\r\n\r\n  // ---- Loading & Progress ----\r\n\r\n  /** Skeleton shimmer - continuous flow */\r\n  skeleton: { stiffness: 80, damping: 15, mass: 2 },\r\n\r\n  /** Progress bar - steady advancement */\r\n  progress: { stiffness: 150, damping: 25, mass: 1 },\r\n\r\n  /** Spinner rotation - smooth continuous */\r\n  spinner: { stiffness: 100, damping: 12, mass: 1.5 },\r\n\r\n  // ---- Emphasis & Attention ----\r\n\r\n  /** Pulse effect - gentle attention */\r\n  pulse: { stiffness: 120, damping: 10, mass: 1.2 },\r\n\r\n  /** Shake effect - error emphasis */\r\n  shake: { stiffness: 500, damping: 15, mass: 0.6 },\r\n\r\n  /** Bounce effect - playful emphasis */\r\n  bounceAttention: { stiffness: 400, damping: 10, mass: 0.7 },\r\n\r\n  /** Pop effect - sudden appearance */\r\n  pop: { stiffness: 500, damping: 20, mass: 0.6 },\r\n\r\n  /** Wiggle effect - playful motion */\r\n  wiggle: { stiffness: 300, damping: 8, mass: 0.8 },\r\n\r\n  // ---- Mobile-Specific ----\r\n\r\n  /** iOS spring - Apple-like feel */\r\n  ios: { stiffness: 300, damping: 20, mass: 1 },\r\n\r\n  /** Android spring - Material Design feel */\r\n  android: { stiffness: 350, damping: 25, mass: 0.9 },\r\n\r\n  /** Haptic feedback - quick micro-interaction */\r\n  haptic: { stiffness: 600, damping: 45, mass: 0.4 },\r\n\r\n  // ---- Natural Physics ----\r\n\r\n  /** Pendulum - gravity-like swing */\r\n  pendulum: { stiffness: 50, damping: 5, mass: 2 },\r\n\r\n  /** Jelly - soft and wobbly */\r\n  jelly: { stiffness: 150, damping: 8, mass: 1.5 },\r\n\r\n  /** Elastic - stretchy rubber */\r\n  elastic: { stiffness: 200, damping: 10, mass: 1.2 },\r\n\r\n  /** Heavy - weighted and deliberate */\r\n  heavy: { stiffness: 150, damping: 30, mass: 3 },\r\n\r\n  /** Light - airy and quick */\r\n  light: { stiffness: 400, damping: 25, mass: 0.5 },\r\n\r\n  /** Liquid - fluid motion */\r\n  liquid: { stiffness: 100, damping: 20, mass: 2 },\r\n\r\n} as const\r\n\r\nexport type PhysicsPresetName = keyof typeof physicsPresets\r\n\r\n/**\r\n * Get a physics preset by name\r\n */\r\nexport function getPhysicsPreset(name: PhysicsPresetName): SpringConfig {\r\n  return { ...physicsPresets[name] }\r\n}\r\n\r\n/**\r\n * Create a custom preset based on a semantic description\r\n * @param feeling - How the animation should feel\r\n */\r\nexport function createFeeling(feeling: 'snappy' | 'smooth' | 'bouncy' | 'heavy' | 'light' | 'elastic'): SpringConfig {\r\n  switch (feeling) {\r\n    case 'snappy':\r\n      return { stiffness: 400, damping: 30, mass: 0.8 }\r\n    case 'smooth':\r\n      return { stiffness: 150, damping: 25, mass: 1.2 }\r\n    case 'bouncy':\r\n      return { stiffness: 300, damping: 12, mass: 1 }\r\n    case 'heavy':\r\n      return { stiffness: 100, damping: 30, mass: 2.5 }\r\n    case 'light':\r\n      return { stiffness: 400, damping: 25, mass: 0.5 }\r\n    case 'elastic':\r\n      return { stiffness: 200, damping: 10, mass: 1.2 }\r\n    default:\r\n      return { stiffness: 100, damping: 10, mass: 1 }\r\n  }\r\n}\r\n\r\n/**\r\n * Adjust a preset for speed\r\n * @param preset - Base preset config\r\n * @param speed - Speed multiplier (0.5 = half speed, 2 = double speed)\r\n */\r\nexport function adjustSpeed(preset: SpringConfig, speed: number): SpringConfig {\r\n  const stiffness = (preset.stiffness ?? 100) * speed\r\n  const damping = (preset.damping ?? 10) * Math.sqrt(speed)\r\n  return { ...preset, stiffness, damping }\r\n}\r\n\r\n/**\r\n * Adjust a preset for bounciness\r\n * @param preset - Base preset config\r\n * @param bounce - Bounce factor (0 = no bounce, 1 = very bouncy)\r\n */\r\nexport function adjustBounce(preset: SpringConfig, bounce: number): SpringConfig {\r\n  const minDamping = 5\r\n  const maxDamping = 40\r\n  const damping = maxDamping - (bounce * (maxDamping - minDamping))\r\n  return { ...preset, damping: Math.max(minDamping, Math.min(maxDamping, damping)) }\r\n}\r\n\r\n/**\r\n * Create a spring config that settles in approximately the given duration\r\n * @param ms - Approximate settling time in milliseconds\r\n * @returns Spring config\r\n */\r\nexport function configFromDuration(ms: number): SpringConfig {\r\n  if (ms < 300) {\r\n    return { stiffness: 170, damping: 26 }\r\n  }\r\n  if (ms < 500) {\r\n    return { stiffness: 100, damping: 20 }\r\n  }\r\n  return { stiffness: 80, damping: 15 }\r\n}\r\n\r\n/**\r\n * Create a spring config with specific bounce amount\r\n * @param bounce - Bounce factor (0 = no bounce, 0.5 = 50% overshoot)\r\n * @returns Spring config\r\n */\r\nexport function configFromBounce(bounce: number): SpringConfig {\r\n  if (bounce <= 0) {\r\n    return { stiffness: 170, damping: 26 }\r\n  }\r\n  if (bounce <= 0.25) {\r\n    return { stiffness: 200, damping: 12 }\r\n  }\r\n  return { stiffness: 200, damping: 8 }\r\n}\r\n","import type { SpringConfig } from './config.js'\n\n/**\n * Result of a spring physics simulation step\n */\nexport interface SimulationResult {\n  /** New position */\n  position: number\n  /** New velocity */\n  velocity: number\n  /** Whether the spring is at rest */\n  isRest: boolean\n}\n\n/**\n * Simulate one step of spring physics using semi-implicit Euler integration\n *\n * The spring follows the damped harmonic oscillator equation:\n * F = -k * x - c * v\n * a = F / m\n *\n * Where:\n * - k = stiffness (spring constant)\n * - c = damping coefficient\n * - m = mass\n * - x = displacement from rest (target - position)\n * - v = velocity\n * - a = acceleration\n * - dt = time step (1/60 for 60fps animation)\n *\n * @param position - Current position\n * @param velocity - Current velocity\n * @param target - Target position (rest position)\n * @param config - Spring configuration\n * @returns Simulation result with new position, velocity, and rest state\n */\nexport function simulateSpring(\n  position: number,\n  velocity: number,\n  target: number,\n  config: SpringConfig\n): SimulationResult {\n  const {\n    stiffness = 100,\n    damping = 10,\n    mass = 1,\n    restSpeed = 0.01,\n    restDelta = 0.01,\n  } = config\n\n  // Calculate displacement from target (cached for reuse)\n  const displacement = target - position\n  const absDisplacement = Math.abs(displacement)\n  const absVelocity = Math.abs(velocity)\n\n  // Early exit optimization: if already at rest, skip expensive calculations\n  // This significantly improves performance for springs that have settled\n  if (absDisplacement <= restDelta && absVelocity <= restSpeed) {\n    return {\n      position: target, // Snap to exact target\n      velocity: 0,\n      isRest: true,\n    }\n  }\n\n  // Time step for 60fps animation\n  // This ensures the spring simulation is stable with typical stiffness values\n  const dt = 1 / 60\n\n  // Calculate spring force (Hooke's law: F = -k * x)\n  const springForce = stiffness * displacement\n\n  // Calculate damping force (opposes velocity: F = -c * v)\n  // Optimization: skip multiplication if velocity is negligible\n  const dampingForce = absVelocity > 0.0001 ? damping * velocity : 0\n\n  // Calculate total force and acceleration (Newton's second law: a = F/m)\n  const acceleration = (springForce - dampingForce) / mass\n\n  // Semi-implicit Euler integration\n  // Update velocity first, then use new velocity to update position\n  // This provides better energy conservation than standard Euler\n  const newVelocity = velocity + acceleration * dt\n  const newPosition = position + newVelocity * dt\n\n  // Check if spring is at rest\n  // Spring is at rest when:\n  // 1. Close to target position (new displacement < restDelta)\n  // 2. Moving slowly (new velocity < restSpeed)\n  // Use NEW position to calculate displacement for accurate rest detection\n  const newDisplacement = Math.abs(target - newPosition)\n  const isRest =\n    newDisplacement <= restDelta &&\n    Math.abs(newVelocity) <= restSpeed\n\n  return {\n    position: newPosition,\n    velocity: newVelocity,\n    isRest,\n  }\n}\n\n/**\n * Calculate the period of oscillation for a spring\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Period in seconds\n */\nexport function calculatePeriod(stiffness: number, mass: number): number {\n  return 2 * Math.PI * Math.sqrt(mass / stiffness)\n}\n\n/**\n * Calculate the damping ratio for a spring\n * @param damping - Damping coefficient\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Damping ratio\n */\nexport function calculateDampingRatio(\n  damping: number,\n  stiffness: number,\n  mass: number\n): number {\n  return damping / (2 * Math.sqrt(stiffness * mass))\n}\n\n/**\n * Check if a spring is underdamped (will oscillate)\n * @param config - Spring configuration\n * @returns True if underdamped\n */\nexport function isUnderdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio < 1\n}\n\n/**\n * Check if a spring is critically damped (fastest return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if critically damped\n */\nexport function isCriticallyDamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return Math.abs(ratio - 1) < 0.001\n}\n\n/**\n * Check if a spring is overdamped (slow return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if overdamped\n */\nexport function isOverdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio > 1\n}\n","/**\n * Animation state enum\n */\nexport enum AnimationState {\n  Idle = 'idle',\n  Running = 'running',\n  Paused = 'paused',\n  Complete = 'complete',\n}\n\n/**\n * Interface for objects that can be animated\n */\nexport interface Animatable {\n  /**\n   * Update the animation\n   * @param now - Current timestamp from performance.now()\n   */\n  update(now: number): void\n\n  /**\n   * Check if the animation is complete\n   */\n  isComplete(): boolean\n}\n\n/**\n * Callback type for cleanup notifications\n */\nexport type CleanupCallback = (id: number) => void\n\n/**\n * Maximum allowed delta time (ms) to prevent physics explosions after tab suspension\n * If more time has passed, we clamp to this value for stable simulation\n */\nconst MAX_DELTA_TIME = 64 // ~15fps minimum, prevents huge jumps\n\n/**\n * Global animation loop manager\n * Uses requestAnimationFrame to drive all animations\n * Features:\n * - WeakRef-based animation tracking for memory safety\n * - FinalizationRegistry for cleanup callbacks\n * - Frame-drop resilience with delta time clamping\n * - Single-pass update + cleanup for O(n) performance\n * - Frame event listeners for external monitoring\n */\nclass AnimationLoop {\n  private animations = new Set<WeakRef<Animatable>>()\n  private animationMap = new WeakMap<Animatable, WeakRef<Animatable>>()\n  private rafId: number | null = null\n  private isRunning = false\n  private lastTime: number = 0\n  private nextId = 1\n  private idMap = new WeakMap<Animatable, number>()\n  private frameListeners = new Set<(deltaTime: number) => void>()\n\n  // FinalizationRegistry for automatic cleanup notifications\n  private registry = new FinalizationRegistry<number>((id) => {\n    this.cleanupCallbacks.forEach((cb) => cb(id))\n  })\n  private cleanupCallbacks = new Set<CleanupCallback>()\n\n  /**\n   * Add an animation to the loop\n   * Uses WeakRef to prevent memory leaks if animation is garbage collected\n   * @returns Unique ID for this animation\n   */\n  add(animation: Animatable): number {\n    // Check if already added\n    const existingId = this.idMap.get(animation)\n    if (existingId !== undefined) return existingId\n\n    const id = this.nextId++\n    const ref = new WeakRef(animation)\n    this.animations.add(ref)\n    this.animationMap.set(animation, ref)\n    this.idMap.set(animation, id)\n\n    // Register for finalization callback\n    this.registry.register(animation, id)\n\n    this.start()\n    return id\n  }\n\n  /**\n   * Remove an animation from the loop\n   */\n  remove(animation: Animatable): void {\n    const ref = this.animationMap.get(animation)\n    if (ref) {\n      this.animations.delete(ref)\n      this.animationMap.delete(animation)\n      this.idMap.delete(animation)\n      // Note: unregister not strictly needed as registry uses weak refs\n    }\n    if (this.animations.size === 0) {\n      this.stop()\n    }\n  }\n\n  /**\n   * Register a callback for when animations are garbage collected\n   * Useful for debugging memory leaks\n   */\n  onCleanup(callback: CleanupCallback): () => void {\n    this.cleanupCallbacks.add(callback)\n    return () => this.cleanupCallbacks.delete(callback)\n  }\n\n  /**\n   * Register a callback for each frame\n   * Receives delta time in milliseconds\n   */\n  onFrame(callback: (deltaTime: number) => void): () => void {\n    this.frameListeners.add(callback)\n    return () => this.frameListeners.delete(callback)\n  }\n\n  /**\n   * Start the animation loop\n   */\n  private start(): void {\n    if (this.isRunning) return\n    this.isRunning = true\n    this.lastTime = performance.now()\n    this.tick()\n  }\n\n  /**\n   * Stop the animation loop\n   */\n  private stop(): void {\n    this.isRunning = false\n    if (this.rafId !== null) {\n      cancelAnimationFrame(this.rafId)\n      this.rafId = null\n    }\n  }\n\n  /**\n   * Single animation frame - optimized single-pass update + cleanup\n   * Features:\n   * - WeakRef dereferencing with automatic cleanup of dead refs\n   * - Delta time clamping for frame-drop resilience\n   * - O(n) single-pass performance\n   * - Frame listener notifications\n   */\n  private tick = (): void => {\n    const now = performance.now()\n\n    // Calculate and clamp delta time to prevent physics explosions\n    // This handles tab suspension, debugger pauses, etc.\n    const rawDelta = now - this.lastTime\n    const clampedDelta = Math.min(rawDelta, MAX_DELTA_TIME)\n    this.lastTime = now\n\n    // Notify frame listeners (with error isolation)\n    for (const listener of this.frameListeners) {\n      try {\n        listener(clampedDelta)\n      } catch (e) {\n        console.error('[SpringKit] Frame listener error:', e)\n      }\n    }\n\n    // Single pass: update all animations and collect refs to remove\n    const toRemove: WeakRef<Animatable>[] = []\n\n    for (const ref of this.animations) {\n      const animation = ref.deref()\n\n      // If WeakRef is dead (animation was garbage collected), mark for removal\n      if (!animation) {\n        toRemove.push(ref)\n        continue\n      }\n\n      animation.update(now)\n\n      if (animation.isComplete()) {\n        toRemove.push(ref)\n        this.animationMap.delete(animation)\n        this.idMap.delete(animation)\n      }\n    }\n\n    // Remove dead/completed refs\n    for (let i = 0; i < toRemove.length; i++) {\n      this.animations.delete(toRemove[i]!)\n    }\n\n    // Continue or stop loop\n    if (this.animations.size > 0) {\n      this.rafId = requestAnimationFrame(this.tick)\n    } else {\n      this.stop()\n    }\n  }\n\n  /**\n   * Get the number of active animations (including potentially dead refs)\n   */\n  get size(): number {\n    return this.animations.size\n  }\n\n  /**\n   * Get count of actually alive animations (for debugging/testing)\n   */\n  getAliveCount(): number {\n    let count = 0\n    for (const ref of this.animations) {\n      if (ref.deref()) count++\n    }\n    return count\n  }\n\n  /**\n   * Get current frame rate (based on last delta)\n   */\n  getFPS(): number {\n    const delta = performance.now() - this.lastTime\n    return delta > 0 ? Math.round(1000 / delta) : 60\n  }\n}\n\n/**\n * Global animation loop instance\n */\nexport const globalLoop = new AnimationLoop()\n","/**\r\n * Clamp a value between a minimum and maximum\r\n * @param value - The value to clamp\r\n * @param min - The minimum allowed value\r\n * @param max - The maximum allowed value\r\n * @returns The clamped value\r\n */\r\nexport function clamp(value: number, min: number, max: number): number {\r\n  // Handle inverted min/max (swap them)\r\n  const actualMin = Math.min(min, max)\r\n  const actualMax = Math.max(min, max)\r\n  return Math.max(actualMin, Math.min(actualMax, value))\r\n}\r\n\r\n/**\r\n * Linear interpolation between two values\r\n * @param a - The start value\r\n * @param b - The end value\r\n * @param t - The interpolation factor (0-1)\r\n * @returns The interpolated value\r\n */\r\nexport function lerp(a: number, b: number, t: number): number {\r\n  return a + (b - a) * t\r\n}\r\n\r\n/**\r\n * Map a value from one range to another\r\n * @param value - The value to map\r\n * @param inMin - The minimum of the input range\r\n * @param inMax - The maximum of the input range\r\n * @param outMin - The minimum of the output range\r\n * @param outMax - The maximum of the output range\r\n * @returns The mapped value\r\n */\r\nexport function mapRange(\r\n  value: number,\r\n  inMin: number,\r\n  inMax: number,\r\n  outMin: number,\r\n  outMax: number\r\n): number {\r\n  // Guard against division by zero - return outMin when input range is zero\r\n  const inputRange = inMax - inMin\r\n  if (inputRange === 0) {\r\n    return outMin\r\n  }\r\n  return ((value - inMin) * (outMax - outMin)) / inputRange + outMin\r\n}\r\n\r\n/**\r\n * Convert degrees to radians\r\n * @param degrees - The angle in degrees\r\n * @returns The angle in radians\r\n */\r\nexport function degToRad(degrees: number): number {\r\n  return (degrees * Math.PI) / 180\r\n}\r\n\r\n/**\r\n * Convert radians to degrees\r\n * @param radians - The angle in radians\r\n * @returns The angle in degrees\r\n */\r\nexport function radToDeg(radians: number): number {\r\n  return (radians * 180) / Math.PI\r\n}\r\n","/**\n * Development mode warnings for SpringKit\n * These warnings help developers avoid common configuration mistakes\n */\n\nconst isDev = typeof process !== 'undefined' && process.env?.NODE_ENV !== 'production'\nconst warnedMessages = new Set<string>()\n\n/**\n * Log a warning message once (won't repeat the same message)\n */\nfunction warnOnce(message: string): void {\n  if (!isDev || warnedMessages.has(message)) return\n  warnedMessages.add(message)\n  console.warn(`[SpringKit] ${message}`)\n}\n\n/**\n * Validate spring configuration and warn about potential issues\n */\nexport function validateSpringConfig(config: {\n  stiffness?: number\n  damping?: number\n  mass?: number\n}): void {\n  if (!isDev) return\n\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n\n  // Check for extreme stiffness with low damping (unstable oscillation)\n  if (stiffness > 400 && damping < 10) {\n    warnOnce(\n      `High stiffness (${stiffness}) with low damping (${damping}) may cause excessive oscillation. ` +\n      `Consider increasing damping to at least ${Math.round(stiffness / 20)} for smoother animation.`\n    )\n  }\n\n  // Check for very low stiffness (sluggish animation)\n  if (stiffness < 20) {\n    warnOnce(\n      `Very low stiffness (${stiffness}) will result in sluggish animation. ` +\n      `Consider using stiffness >= 50 for more responsive feel.`\n    )\n  }\n\n  // Check for very high damping (overdamped, no spring feel)\n  if (damping > stiffness) {\n    warnOnce(\n      `Damping (${damping}) is higher than stiffness (${stiffness}), ` +\n      `which removes the \"springy\" feel. Consider reducing damping for bouncier animation.`\n    )\n  }\n\n  // Check for zero or negative mass\n  if (mass <= 0) {\n    warnOnce(\n      `Mass must be positive. Got ${mass}. Using default mass of 1.`\n    )\n  }\n\n  // Check for very high mass (slow animation)\n  if (mass > 10) {\n    warnOnce(\n      `High mass (${mass}) will make the animation very slow. ` +\n      `Consider mass between 0.5 and 5 for typical use cases.`\n    )\n  }\n}\n\n/**\n * Validate drag configuration\n */\nexport function validateDragConfig(config: {\n  rubberBandFactor?: number\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n}): void {\n  if (!isDev) return\n\n  const { rubberBandFactor, bounds } = config\n\n  // Check rubber band factor range\n  if (rubberBandFactor !== undefined && (rubberBandFactor < 0 || rubberBandFactor > 1)) {\n    warnOnce(\n      `rubberBandFactor should be between 0 and 1. Got ${rubberBandFactor}. ` +\n      `Values outside this range may cause unexpected behavior.`\n    )\n  }\n\n  // Check for inverted bounds\n  if (bounds) {\n    if (bounds.left !== undefined && bounds.right !== undefined && bounds.left > bounds.right) {\n      warnOnce(\n        `Drag bounds are inverted: left (${bounds.left}) > right (${bounds.right}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n    if (bounds.top !== undefined && bounds.bottom !== undefined && bounds.top > bounds.bottom) {\n      warnOnce(\n        `Drag bounds are inverted: top (${bounds.top}) > bottom (${bounds.bottom}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n  }\n}\n\n/**\n * Validate decay configuration\n */\nexport function validateDecayConfig(config: {\n  velocity: number\n  deceleration?: number\n}): void {\n  if (!isDev) return\n\n  const { velocity, deceleration = 0.998 } = config\n\n  // Check for zero velocity\n  if (velocity === 0) {\n    warnOnce(\n      `Decay animation started with zero velocity. ` +\n      `The animation will complete immediately.`\n    )\n  }\n\n  // Check deceleration range\n  if (deceleration <= 0 || deceleration >= 1) {\n    warnOnce(\n      `Deceleration should be between 0 and 1 (exclusive). Got ${deceleration}. ` +\n      `Typical values are 0.99-0.999.`\n    )\n  }\n}\n\n/**\n * Validate a numeric value, checking for NaN and Infinity\n * Returns a safe default value if invalid\n */\nexport function validateNumber(\n  value: number,\n  name: string,\n  defaultValue: number = 0\n): number {\n  if (typeof value !== 'number' || Number.isNaN(value)) {\n    if (isDev) {\n      warnOnce(`${name} received NaN, using ${defaultValue} instead.`)\n    }\n    return defaultValue\n  }\n\n  if (!Number.isFinite(value)) {\n    if (isDev) {\n      warnOnce(`${name} received Infinity, using ${defaultValue} instead.`)\n    }\n    return defaultValue\n  }\n\n  return value\n}\n\n/**\n * Validate animation target value\n * Throws in development, returns safe value in production\n */\nexport function validateAnimationValue(value: number, context: string): number {\n  if (typeof value !== 'number' || Number.isNaN(value)) {\n    const message = `Invalid animation value in ${context}: expected number, got ${value}`\n    if (isDev) {\n      console.error(`[SpringKit] ${message}`)\n    }\n    return 0\n  }\n\n  if (!Number.isFinite(value)) {\n    const message = `Invalid animation value in ${context}: Infinity is not supported`\n    if (isDev) {\n      console.error(`[SpringKit] ${message}`)\n    }\n    return 0\n  }\n\n  return value\n}\n\n/**\n * Clear warned messages (useful for testing)\n */\nexport function clearWarnings(): void {\n  warnedMessages.clear()\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { simulateSpring } from './physics.js'\nimport { globalLoop, type Animatable, AnimationState } from '../animation/loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateSpringConfig, validateAnimationValue } from '../utils/warnings.js'\n\n/**\n * Spring animation control interface\n */\nexport interface SpringAnimation {\n  /** Start the animation */\n  start(): SpringAnimation\n  /** Stop the animation immediately */\n  stop(): void\n  /** Pause the animation */\n  pause(): void\n  /** Resume the animation */\n  resume(): void\n  /** Reverse the animation direction */\n  reverse(): void\n  /** Update the target value */\n  set(to: number): void\n  /** Update target while preserving current velocity (for smooth interruptions) */\n  setWithVelocity(to: number, velocity?: number): void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Check if paused */\n  isPaused(): boolean\n  /** Check if complete */\n  isComplete(): boolean\n  /** Get current value */\n  getValue(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring animation implementation\n */\nclass SpringAnimationImpl implements SpringAnimation, Animatable {\n  private position: number\n  private velocity: number\n  private target: number\n  private config: SpringConfig & Required<Pick<SpringConfig, 'stiffness' | 'damping' | 'mass' | 'restSpeed' | 'restDelta'>>\n  private state: AnimationState = AnimationState.Idle\n  private resolveComplete: (() => void) | null = null\n  private from: number\n  private to: number\n  private clampedFrom: number\n  private clampedTo: number\n\n  finished: Promise<void>\n\n  constructor(\n    from: number,\n    to: number,\n    config: SpringConfig = {}\n  ) {\n    // Validate config in development mode\n    validateSpringConfig(config)\n\n    // Validate input values\n    this.from = validateAnimationValue(from, 'spring.from')\n    this.to = validateAnimationValue(to, 'spring.to')\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.position = this.from\n    this.velocity = config.velocity ?? 0\n    this.target = this.to\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      stiffness: config.stiffness ?? defaultConfig.stiffness!,\n      damping: config.damping ?? defaultConfig.damping!,\n      mass: config.mass ?? defaultConfig.mass!,\n      restSpeed: config.restSpeed ?? defaultConfig.restSpeed!,\n      restDelta: config.restDelta ?? defaultConfig.restDelta!,\n    }\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): SpringAnimation {\n    if (this.state === AnimationState.Running) return this\n\n    this.state = AnimationState.Running\n    this.config.onStart?.()\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  pause(): void {\n    if (this.state === AnimationState.Running) {\n      this.state = AnimationState.Paused\n      globalLoop.remove(this)\n    }\n  }\n\n  resume(): void {\n    if (this.state === AnimationState.Paused) {\n      this.state = AnimationState.Running\n      globalLoop.add(this)\n    }\n  }\n\n  reverse(): void {\n    // Swap from and to\n    const temp = this.from\n    this.from = this.to\n    this.to = temp\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.target = this.to\n\n    // Negate velocity for proper direction reversal during animation\n    if (this.state === AnimationState.Running) {\n      this.velocity = -this.velocity\n    }\n    // Position stays at current value - the animation will move toward the new target\n    // This allows smooth reversal mid-animation and correct behavior when not running\n  }\n\n  set(to: number): void {\n    const validTo = validateAnimationValue(to, 'spring.set')\n    this.to = validTo\n    this.clampedTo = validTo\n    this.target = validTo\n  }\n\n  setWithVelocity(to: number, velocity?: number): void {\n    const validTo = validateAnimationValue(to, 'spring.setWithVelocity')\n\n    // Update from to current position for smooth continuation\n    this.from = this.position\n    this.clampedFrom = this.position\n    this.to = validTo\n    this.clampedTo = validTo\n    this.target = validTo\n\n    // Use provided velocity or preserve current velocity\n    if (velocity !== undefined) {\n      this.velocity = validateAnimationValue(velocity, 'spring.setWithVelocity.velocity')\n    }\n    // If not running, start the animation\n    if (this.state !== AnimationState.Running) {\n      this.start()\n    }\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    const result = simulateSpring(\n      this.position,\n      this.velocity,\n      this.target,\n      this.config\n    )\n\n    this.position = result.position\n    this.velocity = result.velocity\n\n    // Handle clamping\n    if (this.config.clamp) {\n      const min = Math.min(this.clampedFrom, this.clampedTo)\n      const max = Math.max(this.clampedFrom, this.clampedTo)\n      this.position = clamp(this.position, min, max)\n    }\n\n    // Emit update\n    this.config.onUpdate?.(this.position)\n\n    // Check rest state\n    if (result.isRest) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.position = this.target // Ensure we end exactly at target\n      this.config.onUpdate?.(this.position)\n      this.config.onComplete?.()\n      this.config.onRest?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.state === AnimationState.Running\n  }\n\n  isPaused(): boolean {\n    return this.state === AnimationState.Paused\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  getValue(): number {\n    return this.position\n  }\n\n  getVelocity(): number {\n    return this.velocity\n  }\n\n  destroy(): void {\n    this.stop()\n    // Resolve the promise to prevent memory leaks from pending .finished handlers\n    this.resolveComplete?.()\n    this.resolveComplete = null\n    this.config.onUpdate = undefined\n    this.config.onStart = undefined\n    this.config.onComplete = undefined\n    this.config.onRest = undefined\n  }\n}\n\n/**\n * Create a spring animation\n *\n * @param from - Starting value\n * @param to - Target value\n * @param config - Spring configuration\n * @returns Spring animation controller\n *\n * @example\n * ```ts\n * const anim = spring(0, 100, {\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function spring(\n  from: number,\n  to: number,\n  config?: SpringConfig\n): SpringAnimation {\n  return new SpringAnimationImpl(from, to, config)\n}\n","import type { SpringConfig } from './config.js'\r\nimport { defaultConfig } from './config.js'\r\nimport { spring, type SpringAnimation } from './spring.js'\r\nimport { validateAnimationValue } from '../utils/warnings.js'\r\n\r\n/**\r\n * Spring value interface\r\n */\r\nexport interface SpringValue {\r\n  /** Get current value */\r\n  get(): number\r\n  /** Get current velocity */\r\n  getVelocity(): number\r\n  /** Animate to a new value */\r\n  set(to: number, config?: Partial<SpringConfig>): void\r\n  /** Set value immediately without animation */\r\n  jump(to: number): void\r\n  /** Stop current animation at current position */\r\n  stop(): void\r\n  /** Update spring configuration */\r\n  setConfig(config: Partial<SpringConfig>): void\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (value: number) => void): () => void\r\n  /** Check if currently animating */\r\n  isAnimating(): boolean\r\n  /** Promise that resolves when current animation completes */\r\n  finished: Promise<void>\r\n  /** Clean up resources */\r\n  destroy(): void\r\n  /** Check if destroyed */\r\n  isDestroyed(): boolean\r\n}\r\n\r\n/**\r\n * Spring value implementation\r\n */\r\nclass SpringValueImpl implements SpringValue {\r\n  private value: number\r\n  private config: SpringConfig\r\n  private currentAnimation: SpringAnimation | null = null\r\n  private subscribers = new Set<(value: number) => void>()\r\n  private resolveComplete: (() => void) | null = null\r\n  private finishedPromise: Promise<void>\r\n  private destroyed: boolean = false\r\n\r\n  constructor(initial: number, config: SpringConfig = {}) {\r\n    // Validate initial value\r\n    this.value = validateAnimationValue(initial, 'createSpringValue.initial')\r\n    this.config = { ...defaultConfig, ...config }\r\n\r\n    this.finishedPromise = new Promise((resolve) => {\r\n      this.resolveComplete = resolve\r\n    })\r\n  }\r\n\r\n  get(): number {\r\n    return this.value\r\n  }\r\n\r\n  getVelocity(): number {\r\n    return this.currentAnimation?.getVelocity() ?? 0\r\n  }\r\n\r\n  set(to: number, config: Partial<SpringConfig> = {}): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    // Validate target value\r\n    const validTo = validateAnimationValue(to, 'SpringValue.set')\r\n\r\n    // Cancel existing animation\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.destroy()\r\n      this.currentAnimation = null\r\n    }\r\n\r\n    // Capture resolver in local scope to prevent race condition\r\n    // Each animation gets its own resolver that won't be overwritten\r\n    let animationResolver: (() => void) | null = null\r\n\r\n    // Create new promise for this animation\r\n    this.finishedPromise = new Promise((resolve) => {\r\n      animationResolver = resolve\r\n      this.resolveComplete = resolve\r\n    })\r\n\r\n    // Create new animation\r\n    const mergedConfig = { ...this.config, ...config }\r\n    const originalOnUpdate = mergedConfig.onUpdate\r\n    const originalOnComplete = mergedConfig.onComplete\r\n\r\n    this.currentAnimation = spring(this.value, validTo, {\r\n      ...mergedConfig,\r\n      onUpdate: (value) => {\r\n        if (this.destroyed) return\r\n        this.value = value\r\n        this.notify()\r\n        // Also call original onUpdate if provided\r\n        originalOnUpdate?.(value)\r\n      },\r\n      onComplete: () => {\r\n        originalOnComplete?.()\r\n        // Use captured resolver to prevent race condition\r\n        animationResolver?.()\r\n      },\r\n    })\r\n\r\n    this.currentAnimation.start()\r\n  }\r\n\r\n  jump(to: number): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    // Validate target value\r\n    const validTo = validateAnimationValue(to, 'SpringValue.jump')\r\n\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.destroy()\r\n      this.currentAnimation = null\r\n    }\r\n    this.value = validTo\r\n    this.notify()\r\n  }\r\n\r\n  stop(): void {\r\n    if (this.currentAnimation) {\r\n      this.currentAnimation.destroy()\r\n      this.currentAnimation = null\r\n    }\r\n    if (this.resolveComplete) {\r\n      this.resolveComplete()\r\n    }\r\n  }\r\n\r\n  setConfig(config: Partial<SpringConfig>): void {\r\n    this.config = { ...this.config, ...config }\r\n  }\r\n\r\n  subscribe(callback: (value: number) => void): () => void {\r\n    this.subscribers.add(callback)\r\n\r\n    // Immediately call with current value (with error isolation)\r\n    try {\r\n      callback(this.value)\r\n    } catch (e) {\r\n      console.error('[SpringKit] Subscriber error:', e)\r\n    }\r\n\r\n    return () => {\r\n      this.subscribers.delete(callback)\r\n    }\r\n  }\r\n\r\n  isAnimating(): boolean {\r\n    return this.currentAnimation?.isAnimating() ?? false\r\n  }\r\n\r\n  get finished(): Promise<void> {\r\n    return this.finishedPromise\r\n  }\r\n\r\n  private notify(): void {\r\n    for (const subscriber of this.subscribers) {\r\n      try {\r\n        subscriber(this.value)\r\n      } catch (e) {\r\n        console.error('[SpringKit] Subscriber error:', e)\r\n      }\r\n    }\r\n  }\r\n\r\n  isDestroyed(): boolean {\r\n    return this.destroyed\r\n  }\r\n\r\n  destroy(): void {\r\n    if (this.destroyed) return\r\n    this.destroyed = true\r\n\r\n    this.currentAnimation?.destroy()\r\n    this.currentAnimation = null\r\n    // Resolve pending promise to prevent memory leaks\r\n    this.resolveComplete?.()\r\n    this.resolveComplete = null\r\n    this.subscribers.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a spring value\r\n *\r\n * @param initial - Initial value\r\n * @param config - Spring configuration\r\n * @returns Spring value controller\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createSpringValue(0, { stiffness: 100, damping: 10 })\r\n *\r\n * x.subscribe((value) => {\r\n *   element.style.transform = `translateX(${value}px)`\r\n * })\r\n *\r\n * x.set(100) // Animates to 100\r\n * x.jump(0)  // Jumps to 0 immediately\r\n * ```\r\n */\r\nexport function createSpringValue(\r\n  initial: number,\r\n  config?: SpringConfig\r\n): SpringValue {\r\n  return new SpringValueImpl(initial, config)\r\n}\r\n\r\n// Re-export for type usage\r\nexport { SpringValueImpl as SpringValueClass }\r\n","import type { SpringConfig } from './config.js'\r\nimport { defaultConfig } from './config.js'\r\nimport { createSpringValue, type SpringValue } from './spring-value.js'\r\n\r\n/**\r\n * Spring group interface\r\n */\r\nexport interface SpringGroup<T extends Record<string, number>> {\r\n  /** Get all current values */\r\n  get(): T\r\n  /** Get a single value by key */\r\n  getValue(key: keyof T): number\r\n  /** Animate to new values (partial update) */\r\n  set(values: Partial<T>, config?: Partial<SpringConfig>): void\r\n  /** Set values immediately without animation */\r\n  jump(values: Partial<T>): void\r\n  /** Stop all animations at current position */\r\n  stop(): void\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (values: T) => void): () => void\r\n  /** Check if any spring is animating */\r\n  isAnimating(): boolean\r\n  /** Promise that resolves when all animations complete */\r\n  finished: Promise<void>\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Spring group implementation\r\n */\r\nclass SpringGroupImpl<T extends Record<string, number>> implements SpringGroup<T> {\r\n  private values: Map<keyof T, SpringValue>\r\n  private config: SpringConfig\r\n  private subscribers = new Set<(values: T) => void>()\r\n  private resolveComplete: (() => void) | null = null\r\n  private finishedPromise: Promise<void>\r\n  private notifyRafId: number | null = null\r\n  private destroyed = false\r\n\r\n  constructor(initialValues: T, config: SpringConfig = {}) {\r\n    this.config = { ...defaultConfig, ...config }\r\n\r\n    // Create SpringValue for each key\r\n    this.values = new Map()\r\n    for (const [key, value] of Object.entries(initialValues)) {\r\n      const springValue = createSpringValue(value, this.config)\r\n      springValue.subscribe(() => this.scheduleNotify())\r\n      this.values.set(key as keyof T, springValue)\r\n    }\r\n\r\n    this.finishedPromise = Promise.resolve()\r\n\r\n    // Initialize promise handler\r\n    this.resetPromise()\r\n  }\r\n\r\n  private resetPromise(): void {\r\n    this.finishedPromise = new Promise((resolve) => {\r\n      this.resolveComplete = resolve\r\n    })\r\n  }\r\n\r\n  get(): T {\r\n    const result = {} as T\r\n    for (const [key, springValue] of this.values) {\r\n      (result as Record<string, number>)[key as string] = springValue.get()\r\n    }\r\n    return result\r\n  }\r\n\r\n  getValue(key: keyof T): number {\r\n    return this.values.get(key)?.get() ?? 0\r\n  }\r\n\r\n  set(values: Partial<T>, config: Partial<SpringConfig> = {}): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    // Reset promise for new batch of animations\r\n    this.resetPromise()\r\n\r\n    const promises: Promise<void>[] = []\r\n\r\n    for (const [key, value] of Object.entries(values)) {\r\n      const springValue = this.values.get(key as keyof T)\r\n      if (springValue && typeof value === 'number') {\r\n        springValue.set(value, config)\r\n        promises.push(springValue.finished)\r\n      }\r\n    }\r\n\r\n    // Resolve when all animations complete\r\n    Promise.all(promises).then(() => {\r\n      if (this.resolveComplete && !this.destroyed) {\r\n        this.resolveComplete()\r\n      }\r\n    })\r\n  }\r\n\r\n  jump(values: Partial<T>): void {\r\n    // Guard against use after destroy\r\n    if (this.destroyed) return\r\n\r\n    for (const [key, value] of Object.entries(values)) {\r\n      const springValue = this.values.get(key as keyof T)\r\n      if (springValue && typeof value === 'number') {\r\n        springValue.jump(value)\r\n      }\r\n    }\r\n    // Note: notify() is already called by the spring subscriptions, so we don't call it again\r\n  }\r\n\r\n  stop(): void {\r\n    for (const springValue of this.values.values()) {\r\n      springValue.stop()\r\n    }\r\n    // Resolve the promise since animations are stopped\r\n    this.resolveComplete?.()\r\n  }\r\n\r\n  subscribe(callback: (values: T) => void): () => void {\r\n    this.subscribers.add(callback)\r\n    // Immediately call with current values (with error isolation)\r\n    try {\r\n      callback(this.get())\r\n    } catch (e) {\r\n      console.error('[SpringKit] SpringGroup subscriber error:', e)\r\n    }\r\n    return () => this.subscribers.delete(callback)\r\n  }\r\n\r\n  isAnimating(): boolean {\r\n    for (const springValue of this.values.values()) {\r\n      if (springValue.isAnimating()) return true\r\n    }\r\n    return false\r\n  }\r\n\r\n  get finished(): Promise<void> {\r\n    return this.finishedPromise\r\n  }\r\n\r\n  /**\r\n   * Schedule notification for next animation frame to prevent excessive updates.\r\n   * When animating multiple properties, this debounces notifications to once per frame\r\n   * instead of once per property update.\r\n   */\r\n  private scheduleNotify(): void {\r\n    // Skip if destroyed or already scheduled\r\n    if (this.destroyed || this.notifyRafId !== null) return\r\n\r\n    this.notifyRafId = requestAnimationFrame(() => {\r\n      this.notifyRafId = null\r\n      // Double-check destroyed state after RAF\r\n      if (!this.destroyed) {\r\n        this.notify()\r\n      }\r\n    })\r\n  }\r\n\r\n  private notify(): void {\r\n    const values = this.get()\r\n    for (const subscriber of this.subscribers) {\r\n      try {\r\n        subscriber(values)\r\n      } catch (e) {\r\n        console.error('[SpringKit] SpringGroup subscriber error:', e)\r\n      }\r\n    }\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Cancel pending RAF to prevent memory leak\r\n    if (this.notifyRafId !== null) {\r\n      cancelAnimationFrame(this.notifyRafId)\r\n      this.notifyRafId = null\r\n    }\r\n\r\n    for (const springValue of this.values.values()) {\r\n      springValue.destroy()\r\n    }\r\n\r\n    // Resolve pending promise to prevent memory leaks\r\n    this.resolveComplete?.()\r\n    this.resolveComplete = null\r\n\r\n    this.subscribers.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a spring group for animating multiple values together\r\n *\r\n * @param initialValues - Initial values object\r\n * @param config - Spring configuration\r\n * @returns Spring group controller\r\n *\r\n * @example\r\n * ```ts\r\n * const group = createSpringGroup(\r\n *   { x: 0, y: 0, scale: 1 },\r\n *   { stiffness: 100, damping: 10 }\r\n * )\r\n *\r\n * group.subscribe((values) => {\r\n *   element.style.transform = `\r\n *     translate(${values.x}px, ${values.y}px)\r\n *     scale(${values.scale})\r\n *   `\r\n * })\r\n *\r\n * group.set({ x: 100, scale: 1.5 })\r\n * ```\r\n */\r\nexport function createSpringGroup<T extends Record<string, number>>(\r\n  initialValues: T,\r\n  config?: SpringConfig\r\n): SpringGroup<T> {\r\n  return new SpringGroupImpl(initialValues, config)\r\n}\r\n\r\n// Re-export for type usage\r\nexport { SpringGroupImpl as SpringGroupClass }\r\n","/**\n * Variants System - Named animation states with cascading support\n *\n * Provides a declarative way to define and orchestrate animations\n * across component hierarchies.\n */\n\nimport type { SpringConfig } from './config.js'\n\n// ============ Types ============\n\n/**\n * Animation values that can be animated\n */\nexport interface AnimationValues {\n  x?: number | string\n  y?: number | string\n  scale?: number\n  scaleX?: number\n  scaleY?: number\n  rotate?: number\n  rotateX?: number\n  rotateY?: number\n  rotateZ?: number\n  skewX?: number\n  skewY?: number\n  opacity?: number\n  width?: number | string\n  height?: number | string\n  backgroundColor?: string\n  borderRadius?: number | string\n  borderColor?: string\n  boxShadow?: string\n  color?: string\n  [key: string]: number | string | VariantTransition | undefined\n}\n\n/**\n * Transition configuration for a variant\n */\nexport interface VariantTransition {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Stagger children by this amount (ms) */\n  staggerChildren?: number\n  /** Delay children by this amount (ms) */\n  delayChildren?: number\n  /** Animate children before or after parent */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Custom stagger direction */\n  staggerDirection?: 1 | -1\n  /** Duration override for non-spring animations */\n  duration?: number\n  /** Easing function */\n  ease?: (t: number) => number\n}\n\n/**\n * A single variant definition\n */\nexport interface Variant extends AnimationValues {\n  transition?: VariantTransition\n}\n\n/**\n * Map of variant names to their definitions\n */\nexport interface Variants {\n  [key: string]: Variant | ((custom?: unknown) => Variant)\n}\n\n/**\n * Orchestration options for variant animations\n */\nexport interface OrchestrationOptions {\n  /** Delay before starting */\n  delay?: number\n  /** Animate children before or after */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Stagger children animations */\n  staggerChildren?: number\n  /** Delay before children start */\n  delayChildren?: number\n  /** Direction of stagger (-1 for reverse) */\n  staggerDirection?: 1 | -1\n}\n\n/**\n * Resolved variant with all values computed\n */\nexport interface ResolvedVariant {\n  values: AnimationValues\n  transition: VariantTransition\n}\n\n// ============ Variant Resolution ============\n\n/**\n * Resolve a variant definition to concrete values\n */\nexport function resolveVariant(\n  variant: Variant | ((custom?: unknown) => Variant) | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variant) {\n    return { values: {}, transition: {} }\n  }\n\n  // Handle function variants\n  const resolved = typeof variant === 'function' ? variant(custom) : variant\n\n  // Extract transition from values\n  const { transition = {}, ...values } = resolved\n\n  return { values, transition }\n}\n\n/**\n * Get variant from variants object by name\n */\nexport function getVariant(\n  variants: Variants | undefined,\n  name: string | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variants || !name) {\n    return { values: {}, transition: {} }\n  }\n\n  return resolveVariant(variants[name], custom)\n}\n\n/**\n * Merge multiple variants together\n */\nexport function mergeVariants(...variants: (Variant | undefined)[]): Variant {\n  const merged: Variant = {}\n\n  for (const variant of variants) {\n    if (variant) {\n      Object.assign(merged, variant)\n      // Merge transitions\n      if (variant.transition) {\n        merged.transition = { ...merged.transition, ...variant.transition }\n      }\n    }\n  }\n\n  return merged\n}\n\n// ============ Animation Value Helpers ============\n\n/**\n * Check if a value is a transform property\n */\nexport function isTransformProperty(key: string): boolean {\n  return [\n    'x', 'y', 'z',\n    'scale', 'scaleX', 'scaleY', 'scaleZ',\n    'rotate', 'rotateX', 'rotateY', 'rotateZ',\n    'skew', 'skewX', 'skewY',\n    'perspective',\n    'transformOrigin',\n  ].includes(key)\n}\n\n/**\n * Check if a value is animatable\n */\nexport function isAnimatable(value: unknown): value is number | string {\n  return typeof value === 'number' || typeof value === 'string'\n}\n\n/**\n * Parse a value with unit (e.g., \"100px\" -> { value: 100, unit: \"px\" })\n */\nexport function parseValueWithUnit(value: string | number): { value: number; unit: string } {\n  if (typeof value === 'number') {\n    return { value, unit: '' }\n  }\n\n  const match = value.match(/^(-?[\\d.]+)(.*)$/)\n  if (match && match[1]) {\n    return { value: parseFloat(match[1]), unit: match[2] || '' }\n  }\n\n  return { value: 0, unit: '' }\n}\n\n/**\n * Build transform string from values\n */\nexport function buildTransformString(values: AnimationValues): string {\n  const transforms: string[] = []\n\n  if (values.x !== undefined || values.y !== undefined) {\n    const x = values.x ?? 0\n    const y = values.y ?? 0\n    transforms.push(`translate(${x}px, ${y}px)`)\n  }\n\n  if (values.scale !== undefined) {\n    transforms.push(`scale(${values.scale})`)\n  } else {\n    if (values.scaleX !== undefined) {\n      transforms.push(`scaleX(${values.scaleX})`)\n    }\n    if (values.scaleY !== undefined) {\n      transforms.push(`scaleY(${values.scaleY})`)\n    }\n  }\n\n  if (values.rotate !== undefined) {\n    transforms.push(`rotate(${values.rotate}deg)`)\n  }\n  if (values.rotateX !== undefined) {\n    transforms.push(`rotateX(${values.rotateX}deg)`)\n  }\n  if (values.rotateY !== undefined) {\n    transforms.push(`rotateY(${values.rotateY}deg)`)\n  }\n  if (values.rotateZ !== undefined) {\n    transforms.push(`rotateZ(${values.rotateZ}deg)`)\n  }\n\n  if (values.skewX !== undefined) {\n    transforms.push(`skewX(${values.skewX}deg)`)\n  }\n  if (values.skewY !== undefined) {\n    transforms.push(`skewY(${values.skewY}deg)`)\n  }\n\n  return transforms.join(' ')\n}\n\n/**\n * Apply animation values to an element's style\n */\nexport function applyValuesToElement(element: HTMLElement, values: AnimationValues): void {\n  const transform = buildTransformString(values)\n  if (transform) {\n    element.style.transform = transform\n  }\n\n  // Apply non-transform properties\n  if (values.opacity !== undefined) {\n    element.style.opacity = String(values.opacity)\n  }\n  if (values.backgroundColor !== undefined) {\n    element.style.backgroundColor = values.backgroundColor\n  }\n  if (values.borderRadius !== undefined) {\n    element.style.borderRadius =\n      typeof values.borderRadius === 'number' ? `${values.borderRadius}px` : values.borderRadius\n  }\n  if (values.borderColor !== undefined) {\n    element.style.borderColor = values.borderColor\n  }\n  if (values.boxShadow !== undefined) {\n    element.style.boxShadow = values.boxShadow\n  }\n  if (values.color !== undefined) {\n    element.style.color = values.color\n  }\n  if (values.width !== undefined) {\n    element.style.width =\n      typeof values.width === 'number' ? `${values.width}px` : values.width\n  }\n  if (values.height !== undefined) {\n    element.style.height =\n      typeof values.height === 'number' ? `${values.height}px` : values.height\n  }\n}\n\n// ============ Orchestration ============\n\n/**\n * Calculate stagger delays for children\n */\nexport function calculateStaggerDelays(\n  count: number,\n  options: OrchestrationOptions\n): number[] {\n  const { staggerChildren = 0, staggerDirection = 1, delayChildren = 0 } = options\n\n  const delays: number[] = []\n  for (let i = 0; i < count; i++) {\n    const index = staggerDirection === -1 ? count - 1 - i : i\n    delays.push(delayChildren + index * staggerChildren)\n  }\n\n  return delays\n}\n\n/**\n * Create an orchestrated animation sequence\n */\nexport interface OrchestrationSequence {\n  /** Execute parent animation */\n  parent: () => Promise<void>\n  /** Execute children animations */\n  children: () => Promise<void>\n  /** Execute all with proper ordering */\n  execute: () => Promise<void>\n}\n\nexport function createOrchestration(\n  parentAnim: () => Promise<void>,\n  childrenAnims: (() => Promise<void>)[],\n  options: OrchestrationOptions = {}\n): OrchestrationSequence {\n  const { when = false, delay = 0 } = options\n  const delays = calculateStaggerDelays(childrenAnims.length, options)\n\n  const parent = async () => {\n    if (delay > 0) {\n      await new Promise((resolve) => setTimeout(resolve, delay))\n    }\n    await parentAnim()\n  }\n\n  const children = async () => {\n    await Promise.all(\n      childrenAnims.map((anim, i) =>\n        new Promise<void>((resolve) => {\n          setTimeout(async () => {\n            await anim()\n            resolve()\n          }, delays[i])\n        })\n      )\n    )\n  }\n\n  const execute = async () => {\n    switch (when) {\n      case 'beforeChildren':\n        await parent()\n        await children()\n        break\n      case 'afterChildren':\n        await children()\n        await parent()\n        break\n      default:\n        // Run in parallel\n        await Promise.all([parent(), children()])\n    }\n  }\n\n  return { parent, children, execute }\n}\n\n// ============ Variant Presets ============\n\n/**\n * Common animation presets\n */\nexport const variantPresets: Record<string, { initial: Variant; animate: Variant; exit: Variant }> = {\n  /** Fade in from invisible */\n  fadeIn: {\n    initial: { opacity: 0 },\n    animate: { opacity: 1 },\n    exit: { opacity: 0 },\n  },\n\n  /** Fade in and slide up */\n  fadeInUp: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n\n  /** Fade in and slide down */\n  fadeInDown: {\n    initial: { opacity: 0, y: -20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: 20 },\n  },\n\n  /** Fade in and slide from left */\n  fadeInLeft: {\n    initial: { opacity: 0, x: -20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: 20 },\n  },\n\n  /** Fade in and slide from right */\n  fadeInRight: {\n    initial: { opacity: 0, x: 20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: -20 },\n  },\n\n  /** Scale up from small */\n  scaleIn: {\n    initial: { opacity: 0, scale: 0.8 },\n    animate: { opacity: 1, scale: 1 },\n    exit: { opacity: 0, scale: 0.8 },\n  },\n\n  /** Pop in with overshoot */\n  popIn: {\n    initial: { opacity: 0, scale: 0.5 },\n    animate: {\n      opacity: 1,\n      scale: 1,\n      transition: { spring: { stiffness: 400, damping: 15 } },\n    },\n    exit: { opacity: 0, scale: 0.5 },\n  },\n\n  /** Slide in from bottom (percentage-based) */\n  slideUp: {\n    initial: { y: 100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: 100, opacity: 0 },\n  },\n\n  /** Slide in from top */\n  slideDown: {\n    initial: { y: -100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: -100, opacity: 0 },\n  },\n\n  /** Slide in from left */\n  slideLeft: {\n    initial: { x: -100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: -100, opacity: 0 },\n  },\n\n  /** Slide in from right */\n  slideRight: {\n    initial: { x: 100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: 100, opacity: 0 },\n  },\n\n  /** Container with staggered children */\n  staggerContainer: {\n    initial: {},\n    animate: {\n      transition: {\n        staggerChildren: 0.1,\n        delayChildren: 0.1,\n      },\n    },\n    exit: {\n      transition: {\n        staggerChildren: 0.05,\n        staggerDirection: -1,\n      },\n    },\n  },\n\n  /** Item for staggered lists */\n  staggerItem: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n}\n\n/**\n * Create a custom variant preset\n */\nexport function createVariantPreset(\n  initial: Variant,\n  animate: Variant,\n  exit?: Variant\n): { initial: Variant; animate: Variant; exit: Variant } {\n  return {\n    initial,\n    animate,\n    exit: exit || initial,\n  }\n}\n\n// ============ Type Guards ============\n\n/**\n * Check if a value is a Variants object\n */\nexport function isVariants(value: unknown): value is Variants {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    !Array.isArray(value) &&\n    Object.values(value).every(\n      (v) => typeof v === 'object' || typeof v === 'function'\n    )\n  )\n}\n\n/**\n * Check if a value is a Variant\n */\nexport function isVariant(value: unknown): value is Variant {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n}\n","import type { SpringConfig } from '../core/config.js'\r\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\r\n\r\n/**\r\n * Trail configuration interface\r\n */\r\nexport interface TrailConfig extends SpringConfig {\r\n  /** Frames delay between items following each other */\r\n  followDelay?: number\r\n}\r\n\r\n/**\r\n * Trail interface\r\n */\r\nexport interface Trail {\r\n  /** Set the leader value (followers will follow with delay) */\r\n  set(value: number): void\r\n  /** Set all values immediately without animation */\r\n  jump(value: number): void\r\n  /** Get all current values */\r\n  getValues(): number[]\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (values: number[]) => void): () => void\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Trail implementation\r\n * Creates a chain of springs where each spring follows the previous one\r\n */\r\nclass TrailImpl implements Trail {\r\n  private springs: SpringValue[]\r\n  private leader: SpringValue\r\n  private followDelay: number\r\n  private subscribers = new Set<(values: number[]) => void>()\r\n  private frameCount: number = 0\r\n  private pendingUpdates: Map<number, number> = new Map()\r\n  // Track timeout IDs for cleanup to prevent memory leaks\r\n  private pendingTimeouts: Set<ReturnType<typeof setTimeout>> = new Set()\r\n  private destroyed = false\r\n\r\n  constructor(count: number, config: TrailConfig = {}) {\r\n    const { followDelay = 2, ...springConfig } = config\r\n\r\n    this.followDelay = followDelay\r\n\r\n    // Create leader spring\r\n    this.leader = createSpringValue(0, springConfig)\r\n\r\n    // Create follower springs\r\n    this.springs = []\r\n    for (let i = 0; i < count; i++) {\r\n      const spring = createSpringValue(0, springConfig)\r\n      this.springs.push(spring)\r\n    }\r\n\r\n    // Connect leader to followers with delay\r\n    this.leader.subscribe(() => {\r\n      this.frameCount++\r\n      this.scheduleFollowerUpdates()\r\n    })\r\n  }\r\n\r\n  private scheduleFollowerUpdates(): void {\r\n    const targetValue = this.leader.get()\r\n\r\n    for (let i = 0; i < this.springs.length; i++) {\r\n      const delayFrames = (i + 1) * this.followDelay\r\n      const targetFrame = this.frameCount + delayFrames\r\n\r\n      // Store the pending update\r\n      this.pendingUpdates.set(i, targetFrame)\r\n\r\n      // Schedule the update\r\n      this.scheduleFollowerUpdate(i, targetValue, targetFrame, delayFrames)\r\n    }\r\n  }\r\n\r\n  private scheduleFollowerUpdate(\r\n    index: number,\r\n    targetValue: number,\r\n    targetFrame: number,\r\n    _delayFrames: number\r\n  ): void {\r\n    const startFrame = this.frameCount\r\n    const framesToWait = targetFrame - startFrame\r\n\r\n    if (framesToWait <= 0) {\r\n      // Update immediately if delay has passed\r\n      this.springs[index]!.set(targetValue)\r\n    } else {\r\n      // Use setTimeout for delay (approximately 16ms per frame at 60fps)\r\n      const delayMs = Math.max(framesToWait * 16, 0)\r\n\r\n      const timeoutId = setTimeout(() => {\r\n        // Remove from pending set\r\n        this.pendingTimeouts.delete(timeoutId)\r\n\r\n        // Skip if destroyed or not the current pending update\r\n        if (this.destroyed) return\r\n        const currentTarget = this.pendingUpdates.get(index)\r\n        if (currentTarget === targetFrame) {\r\n          this.springs[index]!.set(targetValue)\r\n        }\r\n      }, delayMs)\r\n\r\n      // Track timeout for cleanup\r\n      this.pendingTimeouts.add(timeoutId)\r\n    }\r\n  }\r\n\r\n  set(value: number): void {\r\n    this.leader.set(value)\r\n  }\r\n\r\n  jump(value: number): void {\r\n    this.leader.jump(value)\r\n    for (const spring of this.springs) {\r\n      spring.jump(value)\r\n    }\r\n  }\r\n\r\n  getValues(): number[] {\r\n    return this.springs.map((s) => s.get())\r\n  }\r\n\r\n  subscribe(callback: (values: number[]) => void): () => void {\r\n    this.subscribers.add(callback)\r\n\r\n    // Subscribe to each follower spring\r\n    const unsubscribers: (() => void)[] = []\r\n    for (const spring of this.springs) {\r\n      unsubscribers.push(\r\n        spring.subscribe(() => {\r\n          this.notify()\r\n        })\r\n      )\r\n    }\r\n\r\n    // Immediately call with current values\r\n    callback(this.getValues())\r\n\r\n    // Return unsubscribe function\r\n    return () => {\r\n      this.subscribers.delete(callback)\r\n      for (const unsubscribe of unsubscribers) {\r\n        unsubscribe()\r\n      }\r\n    }\r\n  }\r\n\r\n  private notify(): void {\r\n    const values = this.getValues()\r\n    for (const subscriber of this.subscribers) {\r\n      subscriber(values)\r\n    }\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Clear all pending timeouts to prevent memory leaks\r\n    for (const timeoutId of this.pendingTimeouts) {\r\n      clearTimeout(timeoutId)\r\n    }\r\n    this.pendingTimeouts.clear()\r\n\r\n    this.leader.destroy()\r\n    for (const spring of this.springs) {\r\n      spring.destroy()\r\n    }\r\n    this.subscribers.clear()\r\n    this.pendingUpdates.clear()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a trail animation\r\n *\r\n * @param count - Number of items in the trail\r\n * @param config - Trail configuration\r\n * @returns Trail controller\r\n *\r\n * @example\r\n * ```ts\r\n * const trail = createTrail(5, {\r\n *   stiffness: 200,\r\n *   damping: 25,\r\n *   followDelay: 3,\r\n * })\r\n *\r\n * trail.subscribe((values) => {\r\n *   elements.forEach((el, i) => {\r\n *     el.style.transform = `translateX(${values[i]}px)`\r\n *   })\r\n * })\r\n *\r\n * trail.set(100) // First item moves immediately, others follow\r\n * ```\r\n */\r\nexport function createTrail(count: number, config?: TrailConfig): Trail {\r\n  return new TrailImpl(count, config)\r\n}\r\n","import { createSpringValue, type SpringValue } from '../core/spring-value.js'\r\nimport { clamp } from '../utils/math.js'\r\n\r\n/**\r\n * Snap point configuration\r\n */\r\nexport interface SnapPoint {\r\n  x: number\r\n  y: number\r\n  /** Attraction radius (pixels) */\r\n  radius?: number\r\n}\r\n\r\n/**\r\n * Snap configuration\r\n */\r\nexport interface SnapConfig {\r\n  /** Array of snap points */\r\n  points?: SnapPoint[]\r\n  /** Snap to grid with given cell size */\r\n  grid?: { x: number; y: number }\r\n  /** Velocity threshold to snap (lower = snap more easily) */\r\n  velocityThreshold?: number\r\n  /** Whether to snap only on release */\r\n  snapOnRelease?: boolean\r\n}\r\n\r\n/**\r\n * Constraint configuration - supports multiple constraint types\r\n */\r\nexport interface DragConstraints {\r\n  /** Simple box bounds */\r\n  bounds?: {\r\n    left?: number\r\n    right?: number\r\n    top?: number\r\n    bottom?: number\r\n  }\r\n  /** Constrain to parent element */\r\n  constrainToParent?: boolean\r\n  /** Constrain to specific element */\r\n  constrainToElement?: HTMLElement\r\n  /** Padding when constrained to element */\r\n  constraintPadding?: number | { top?: number; right?: number; bottom?: number; left?: number }\r\n  /** Lock to specific axis */\r\n  lockAxis?: 'x' | 'y' | null\r\n  /** Lock to 45-degree diagonal lines */\r\n  lockToDiagonal?: boolean\r\n}\r\n\r\n/**\r\n * Drag spring configuration interface\r\n */\r\nexport interface DragSpringConfig {\r\n  /** Spring stiffness (default: 100) */\r\n  stiffness?: number\r\n  /** Damping ratio (default: 10) */\r\n  damping?: number\r\n  /** Mass (default: 1) */\r\n  mass?: number\r\n  /** Initial velocity */\r\n  velocity?: number\r\n  /** Speed threshold for considering spring at rest (default: 0.01) */\r\n  restSpeed?: number\r\n  /** Position threshold for considering spring at rest (default: 0.01) */\r\n  restDelta?: number\r\n  /** Clamp value to [from, to] range */\r\n  clamp?: boolean\r\n  /** Axis constraint (deprecated, use constraints.lockAxis) */\r\n  axis?: 'x' | 'y' | 'both'\r\n  /** Boundary constraints (deprecated, use constraints.bounds) */\r\n  bounds?: {\r\n    left?: number\r\n    right?: number\r\n    top?: number\r\n    bottom?: number\r\n  }\r\n  /** Enhanced constraint configuration */\r\n  constraints?: DragConstraints\r\n  /** Snap configuration */\r\n  snap?: SnapConfig\r\n  /** Enable rubber band effect at bounds */\r\n  rubberBand?: boolean\r\n  /** Rubber band stretch factor (0-1, default: 0.5) */\r\n  rubberBandFactor?: number\r\n  /** Elastic bounce power (0-1, default: 0.3) */\r\n  elasticBounce?: number\r\n  /** Momentum after release (true = continue with velocity) */\r\n  momentum?: boolean\r\n  /** Deceleration rate for momentum (0-1, default: 0.95) */\r\n  momentumDecay?: number\r\n  /** Elastic factor (0-1) - how much element can be dragged outside bounds */\r\n  dragElastic?: number | boolean | { top?: number; right?: number; bottom?: number; left?: number }\r\n  /** Modify the target position during inertia (useful for snap-to-grid) */\r\n  modifyTarget?: (target: { x: number; y: number }) => { x: number; y: number }\r\n  /** Callback called when drag starts */\r\n  onDragStart?: (event: PointerEvent) => void\r\n  /** Callback called during drag */\r\n  onDrag?: (x: number, y: number, event: PointerEvent) => void\r\n  /** Callback called when drag ends */\r\n  onDragEnd?: (x: number, y: number, velocity: { x: number; y: number }) => void\r\n  /** Callback called on position update */\r\n  onUpdate?: (x: number, y: number) => void\r\n  /** Callback when snapping to a point */\r\n  onSnapStart?: (point: SnapPoint) => void\r\n  /** Callback when snap animation completes */\r\n  onSnapComplete?: (point: SnapPoint) => void\r\n  /** Callback when hitting bounds */\r\n  onBoundsHit?: (edge: 'left' | 'right' | 'top' | 'bottom') => void\r\n}\r\n\r\n/**\r\n * Drag spring interface\r\n */\r\nexport interface DragSpring {\r\n  /** Enable drag interaction */\r\n  enable(): void\r\n  /** Disable drag interaction */\r\n  disable(): void\r\n  /** Check if currently enabled */\r\n  isEnabled(): boolean\r\n  /** Check if currently dragging */\r\n  isDragging(): boolean\r\n  /** Reset to initial position */\r\n  reset(): void\r\n  /** Get current position */\r\n  getPosition(): { x: number; y: number }\r\n  /** Get current velocity */\r\n  getVelocity(): { x: number; y: number }\r\n  /** Set position instantly */\r\n  setPosition(x: number, y: number): void\r\n  /** Jump to position (instant, alias for setPosition) */\r\n  jumpTo(x: number, y: number): void\r\n  /** Animate to position with spring physics */\r\n  animateTo(x: number, y: number): void\r\n  /** Release with velocity */\r\n  release(velocityX: number, velocityY: number): void\r\n  /** Snap to nearest point */\r\n  snapToNearest(): void\r\n  /** Snap to specific point */\r\n  snapTo(point: SnapPoint): void\r\n  /** Update constraints dynamically */\r\n  setConstraints(constraints: DragConstraints): void\r\n  /** Update snap configuration dynamically */\r\n  setSnap(snap: SnapConfig): void\r\n  /** Clean up resources */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Default drag spring configuration\r\n */\r\nconst defaultDragConfig = {\r\n  axis: 'both' as const,\r\n  rubberBand: false,\r\n  rubberBandFactor: 0.5,\r\n  elasticBounce: 0.3,\r\n  momentum: true,\r\n  momentumDecay: 0.95,\r\n  stiffness: 200,\r\n  damping: 20,\r\n  mass: 1,\r\n  restSpeed: 0.01,\r\n  restDelta: 0.01,\r\n  clamp: false,\r\n}\r\n\r\n/**\r\n * Drag spring implementation\r\n */\r\nclass DragSpringImpl implements DragSpring {\r\n  private element: HTMLElement\r\n  private config: DragSpringConfig\r\n  private enabled = true\r\n  private position = { x: 0, y: 0 }\r\n  private _isDragging = false\r\n  private startPosition = { x: 0, y: 0 }\r\n  private pointerStart = { x: 0, y: 0 }\r\n  private lastPosition = { x: 0, y: 0 }\r\n  private lastTime = 0\r\n  private velocity = { x: 0, y: 0 }\r\n  private currentSnap: SnapPoint | null = null\r\n  private snapTimeoutId: ReturnType<typeof setTimeout> | null = null\r\n  private destroyed = false\r\n\r\n  // Springs for each axis\r\n  private springX: SpringValue\r\n  private springY: SpringValue\r\n\r\n  constructor(element: HTMLElement, config: DragSpringConfig = {}) {\r\n    this.element = element\r\n    this.config = { ...defaultDragConfig, ...config }\r\n\r\n    // Extract only spring physics config for createSpringValue\r\n    const springConfig = {\r\n      stiffness: this.config.stiffness,\r\n      damping: this.config.damping,\r\n      mass: this.config.mass,\r\n      restSpeed: this.config.restSpeed,\r\n      restDelta: this.config.restDelta,\r\n      clamp: this.config.clamp,\r\n    }\r\n\r\n    this.springX = createSpringValue(0, springConfig)\r\n    this.springY = createSpringValue(0, springConfig)\r\n\r\n    // Subscribe to spring updates\r\n    this.springX.subscribe(() => {\r\n      if (!this._isDragging) {\r\n        this.position.x = this.springX.get()\r\n        if (this.config.onUpdate) {\r\n          this.config.onUpdate(this.position.x, this.position.y)\r\n        }\r\n      }\r\n    })\r\n\r\n    this.springY.subscribe(() => {\r\n      if (!this._isDragging) {\r\n        this.position.y = this.springY.get()\r\n        if (this.config.onUpdate) {\r\n          this.config.onUpdate(this.position.x, this.position.y)\r\n        }\r\n      }\r\n    })\r\n\r\n    this.setupPointerEvents()\r\n  }\r\n\r\n  private setupPointerEvents(): void {\r\n    this.element.addEventListener('pointerdown', this.onPointerDown)\r\n  }\r\n\r\n  private onPointerDown = (e: PointerEvent): void => {\r\n    if (!this.enabled || e.button !== 0) return\r\n\r\n    this._isDragging = true\r\n    this.startPosition = { ...this.position }\r\n    this.pointerStart = { x: e.clientX, y: e.clientY }\r\n    this.lastPosition = { x: e.clientX, y: e.clientY }\r\n    this.lastTime = performance.now()\r\n    this.velocity = { x: 0, y: 0 }\r\n\r\n    this.element.setPointerCapture(e.pointerId)\r\n    this.element.addEventListener('pointermove', this.onPointerMove)\r\n    this.element.addEventListener('pointerup', this.onPointerUp)\r\n    this.element.addEventListener('pointercancel', this.onPointerUp)\r\n\r\n    // Explicit if for better branch coverage\r\n    if (this.config.onDragStart) {\r\n      this.config.onDragStart(e)\r\n    }\r\n  }\r\n\r\n  private onPointerMove = (e: PointerEvent): void => {\r\n    const now = performance.now()\r\n    const dt = now - this.lastTime\r\n\r\n    // Calculate instant velocity with minimum dt to prevent spikes\r\n    // Use at least 16ms (one frame) to avoid unrealistic velocity on first move\r\n    const safeDt = Math.max(dt, 16)\r\n    const instantVelocity = {\r\n      x: (e.clientX - this.lastPosition.x) / safeDt,\r\n      y: (e.clientY - this.lastPosition.y) / safeDt,\r\n    }\r\n\r\n    // Smooth velocity using exponential moving average to prevent jarring animations\r\n    // This prevents velocity spikes on quick movements or first move events\r\n    const smoothingFactor = 0.2\r\n    this.velocity = {\r\n      x: this.velocity.x * (1 - smoothingFactor) + instantVelocity.x * smoothingFactor,\r\n      y: this.velocity.y * (1 - smoothingFactor) + instantVelocity.y * smoothingFactor,\r\n    }\r\n\r\n    this.lastPosition = { x: e.clientX, y: e.clientY }\r\n    this.lastTime = now\r\n\r\n    // Calculate new position\r\n    let newX = this.startPosition.x + (e.clientX - this.pointerStart.x)\r\n    let newY = this.startPosition.y + (e.clientY - this.pointerStart.y)\r\n\r\n    // Apply bounds with elastic effect\r\n    if (this.config.bounds) {\r\n      newX = this.applyBounds(\r\n        newX,\r\n        this.config.bounds.left ?? -Infinity,\r\n        this.config.bounds.right ?? Infinity,\r\n        'x'\r\n      )\r\n      newY = this.applyBounds(\r\n        newY,\r\n        this.config.bounds.top ?? -Infinity,\r\n        this.config.bounds.bottom ?? Infinity,\r\n        'y'\r\n      )\r\n    }\r\n\r\n    // Apply axis constraint\r\n    if (this.config.axis === 'x') {\r\n      newY = 0\r\n    } else if (this.config.axis === 'y') {\r\n      newX = 0\r\n    }\r\n\r\n    this.position = { x: newX, y: newY }\r\n    if (this.config.onDrag) {\r\n      this.config.onDrag(newX, newY, e)\r\n    }\r\n    if (this.config.onUpdate) {\r\n      this.config.onUpdate(newX, newY)\r\n    }\r\n  }\r\n\r\n  private getElasticFactor(edge: 'left' | 'right' | 'top' | 'bottom'): number {\r\n    const dragElastic = this.config.dragElastic\r\n\r\n    // If not specified, use rubberBand settings\r\n    if (dragElastic === undefined) {\r\n      if (this.config.rubberBand) {\r\n        return this.config.rubberBandFactor ?? 0.5\r\n      }\r\n      return 0 // No elasticity\r\n    }\r\n\r\n    // Boolean: true = 0.5, false = 0\r\n    if (typeof dragElastic === 'boolean') {\r\n      return dragElastic ? 0.5 : 0\r\n    }\r\n\r\n    // Number: use directly\r\n    if (typeof dragElastic === 'number') {\r\n      return clamp(dragElastic, 0, 1)\r\n    }\r\n\r\n    // Object: per-edge configuration\r\n    return clamp(dragElastic[edge] ?? 0.5, 0, 1)\r\n  }\r\n\r\n  private applyBounds(value: number, min: number, max: number, axis: 'x' | 'y' = 'x'): number {\r\n    if (!isFinite(min) && !isFinite(max)) return value\r\n\r\n    const actualMin = isFinite(min) ? min : -Infinity\r\n    const actualMax = isFinite(max) ? max : Infinity\r\n\r\n    // Determine elastic factor based on which edge\r\n    const hasElastic = this.config.dragElastic !== undefined || this.config.rubberBand\r\n\r\n    if (hasElastic) {\r\n      if (value < actualMin) {\r\n        const elasticFactor = this.getElasticFactor(axis === 'x' ? 'left' : 'top')\r\n        return actualMin - (actualMin - value) * elasticFactor\r\n      }\r\n      if (value > actualMax) {\r\n        const elasticFactor = this.getElasticFactor(axis === 'x' ? 'right' : 'bottom')\r\n        return actualMax + (value - actualMax) * elasticFactor\r\n      }\r\n    }\r\n\r\n    return clamp(value, actualMin, actualMax)\r\n  }\r\n\r\n  private onPointerUp = (e: PointerEvent): void => {\r\n    this._isDragging = false\r\n\r\n    // Safety check: element might be removed from DOM during drag\r\n    if (this.element && document.contains(this.element)) {\r\n      try {\r\n        this.element.releasePointerCapture(e.pointerId)\r\n      } catch {\r\n        // Ignore errors if pointer capture was already released\r\n      }\r\n      this.element.removeEventListener('pointermove', this.onPointerMove)\r\n      this.element.removeEventListener('pointerup', this.onPointerUp)\r\n      this.element.removeEventListener('pointercancel', this.onPointerUp)\r\n    }\r\n\r\n    // Check for snap points first\r\n    if (this.config.snap?.snapOnRelease !== false) {\r\n      const snapPoint = this.findNearestSnapPoint()\r\n      if (snapPoint) {\r\n        this.snapTo(snapPoint)\r\n        if (this.config.onDragEnd) {\r\n          this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\r\n        }\r\n        return\r\n      }\r\n    }\r\n\r\n    // Scale velocity for spring (convert from pixels/ms to more reasonable units)\r\n    this.release(this.velocity.x * 16, this.velocity.y * 16)\r\n\r\n    if (this.config.onDragEnd) {\r\n      this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\r\n    }\r\n  }\r\n\r\n  private findNearestSnapPoint(): SnapPoint | null {\r\n    const snap = this.config.snap\r\n    if (!snap) return null\r\n\r\n    // Check grid snapping first\r\n    if (snap.grid) {\r\n      const gridX = Math.round(this.position.x / snap.grid.x) * snap.grid.x\r\n      const gridY = Math.round(this.position.y / snap.grid.y) * snap.grid.y\r\n      return { x: gridX, y: gridY }\r\n    }\r\n\r\n    // Check snap points\r\n    if (snap.points && snap.points.length > 0) {\r\n      const velocityMagnitude = Math.sqrt(this.velocity.x ** 2 + this.velocity.y ** 2)\r\n      const threshold = snap.velocityThreshold ?? 0.5\r\n\r\n      // Don't snap if moving too fast\r\n      if (velocityMagnitude > threshold) return null\r\n\r\n      let nearestPoint: SnapPoint | null = null\r\n      let nearestDistance = Infinity\r\n\r\n      for (const point of snap.points) {\r\n        const dx = this.position.x - point.x\r\n        const dy = this.position.y - point.y\r\n        const distance = Math.sqrt(dx * dx + dy * dy)\r\n        const radius = point.radius ?? 50\r\n\r\n        if (distance < radius && distance < nearestDistance) {\r\n          nearestDistance = distance\r\n          nearestPoint = point\r\n        }\r\n      }\r\n\r\n      return nearestPoint\r\n    }\r\n\r\n    return null\r\n  }\r\n\r\n  private getEffectiveBounds(): { left: number; right: number; top: number; bottom: number } {\r\n    // Start with explicit bounds\r\n    const bounds = {\r\n      left: this.config.bounds?.left ?? this.config.constraints?.bounds?.left ?? -Infinity,\r\n      right: this.config.bounds?.right ?? this.config.constraints?.bounds?.right ?? Infinity,\r\n      top: this.config.bounds?.top ?? this.config.constraints?.bounds?.top ?? -Infinity,\r\n      bottom: this.config.bounds?.bottom ?? this.config.constraints?.bounds?.bottom ?? Infinity,\r\n    }\r\n\r\n    const constraints = this.config.constraints\r\n\r\n    // Handle constrainToParent\r\n    if (constraints?.constrainToParent && this.element.parentElement) {\r\n      const parent = this.element.parentElement\r\n      const parentRect = parent.getBoundingClientRect()\r\n      const elementRect = this.element.getBoundingClientRect()\r\n\r\n      const padding = this.normalizePadding(constraints.constraintPadding)\r\n\r\n      bounds.left = Math.max(bounds.left, padding.left)\r\n      bounds.right = Math.min(bounds.right, parentRect.width - elementRect.width - padding.right)\r\n      bounds.top = Math.max(bounds.top, padding.top)\r\n      bounds.bottom = Math.min(bounds.bottom, parentRect.height - elementRect.height - padding.bottom)\r\n    }\r\n\r\n    // Handle constrainToElement\r\n    if (constraints?.constrainToElement) {\r\n      const constraintRect = constraints.constrainToElement.getBoundingClientRect()\r\n      const elementRect = this.element.getBoundingClientRect()\r\n      const parentRect = this.element.parentElement?.getBoundingClientRect() ?? { left: 0, top: 0 }\r\n\r\n      const padding = this.normalizePadding(constraints.constraintPadding)\r\n\r\n      const offsetX = constraintRect.left - parentRect.left\r\n      const offsetY = constraintRect.top - parentRect.top\r\n\r\n      bounds.left = Math.max(bounds.left, offsetX + padding.left)\r\n      bounds.right = Math.min(bounds.right, offsetX + constraintRect.width - elementRect.width - padding.right)\r\n      bounds.top = Math.max(bounds.top, offsetY + padding.top)\r\n      bounds.bottom = Math.min(bounds.bottom, offsetY + constraintRect.height - elementRect.height - padding.bottom)\r\n    }\r\n\r\n    return bounds\r\n  }\r\n\r\n  private normalizePadding(padding: number | { top?: number; right?: number; bottom?: number; left?: number } | undefined): { top: number; right: number; bottom: number; left: number } {\r\n    if (typeof padding === 'number') {\r\n      return { top: padding, right: padding, bottom: padding, left: padding }\r\n    }\r\n    return {\r\n      top: padding?.top ?? 0,\r\n      right: padding?.right ?? 0,\r\n      bottom: padding?.bottom ?? 0,\r\n      left: padding?.left ?? 0,\r\n    }\r\n  }\r\n\r\n  enable(): void {\r\n    this.enabled = true\r\n  }\r\n\r\n  disable(): void {\r\n    this.enabled = false\r\n    if (this._isDragging) {\r\n      this._isDragging = false\r\n    }\r\n  }\r\n\r\n  isEnabled(): boolean {\r\n    return this.enabled\r\n  }\r\n\r\n  isDragging(): boolean {\r\n    return this._isDragging\r\n  }\r\n\r\n  reset(): void {\r\n    this.springX.jump(0)\r\n    this.springY.jump(0)\r\n    this.position = { x: 0, y: 0 }\r\n    this.velocity = { x: 0, y: 0 }\r\n    this.currentSnap = null\r\n    // Explicit if for better branch coverage\r\n    if (this.config.onUpdate) {\r\n      this.config.onUpdate(0, 0)\r\n    }\r\n  }\r\n\r\n  getPosition(): { x: number; y: number } {\r\n    return { ...this.position }\r\n  }\r\n\r\n  getVelocity(): { x: number; y: number } {\r\n    return { ...this.velocity }\r\n  }\r\n\r\n  setPosition(x: number, y: number): void {\r\n    // Guard against destroyed state and invalid values\r\n    if (this.destroyed) return\r\n    const safeX = Number.isFinite(x) ? x : this.position.x\r\n    const safeY = Number.isFinite(y) ? y : this.position.y\r\n\r\n    // Instant position change (same as jumpTo for backwards compatibility)\r\n    this.position = { x: safeX, y: safeY }\r\n    this.springX.jump(safeX)\r\n    this.springY.jump(safeY)\r\n  }\r\n\r\n  jumpTo(x: number, y: number): void {\r\n    // Guard against destroyed state and invalid values\r\n    if (this.destroyed) return\r\n    const safeX = Number.isFinite(x) ? x : this.position.x\r\n    const safeY = Number.isFinite(y) ? y : this.position.y\r\n\r\n    // Update position immediately for synchronous access\r\n    this.position = { x: safeX, y: safeY }\r\n    this.springX.jump(safeX)\r\n    this.springY.jump(safeY)\r\n    if (this.config.onUpdate) {\r\n      this.config.onUpdate(safeX, safeY)\r\n    }\r\n  }\r\n\r\n  animateTo(x: number, y: number): void {\r\n    // Guard against destroyed state and invalid values\r\n    if (this.destroyed) return\r\n    const safeX = Number.isFinite(x) ? x : this.position.x\r\n    const safeY = Number.isFinite(y) ? y : this.position.y\r\n\r\n    // Animate to the position with spring physics\r\n    this.springX.set(safeX)\r\n    this.springY.set(safeY)\r\n  }\r\n\r\n  release(velocityX: number, velocityY: number): void {\r\n    const bounds = this.getEffectiveBounds()\r\n    const { left, right, top, bottom } = bounds\r\n\r\n    let targetX = this.position.x\r\n    let targetY = this.position.y\r\n\r\n    // Apply momentum if enabled\r\n    if (this.config.momentum) {\r\n      // Clamp decay to valid range [0, 0.99] to prevent division by zero\r\n      const rawDecay = this.config.momentumDecay ?? 0.95\r\n      const decay = Math.max(0, Math.min(0.99, rawDecay))\r\n      const decayFactor = decay < 1 ? (1 / (1 - decay)) : 100 // Fallback for edge case\r\n      const momentumX = velocityX * decayFactor * 0.1\r\n      const momentumY = velocityY * decayFactor * 0.1\r\n      targetX += momentumX\r\n      targetY += momentumY\r\n    }\r\n\r\n    // Apply modifyTarget for snap-to-grid or custom modifications\r\n    if (this.config.modifyTarget) {\r\n      const modified = this.config.modifyTarget({ x: targetX, y: targetY })\r\n      targetX = modified.x\r\n      targetY = modified.y\r\n    }\r\n\r\n    // Clamp to bounds\r\n    targetX = clamp(targetX, left, right)\r\n    targetY = clamp(targetY, top, bottom)\r\n\r\n    // Notify bounds hit\r\n    if (this.config.onBoundsHit) {\r\n      if (this.position.x < left) this.config.onBoundsHit('left')\r\n      if (this.position.x > right) this.config.onBoundsHit('right')\r\n      if (this.position.y < top) this.config.onBoundsHit('top')\r\n      if (this.position.y > bottom) this.config.onBoundsHit('bottom')\r\n    }\r\n\r\n    // Animate to target with elastic bounce\r\n    if (targetX !== this.position.x || this.position.x < left || this.position.x > right) {\r\n      this.springX.set(targetX, { velocity: velocityX })\r\n    }\r\n    if (targetY !== this.position.y || this.position.y < top || this.position.y > bottom) {\r\n      this.springY.set(targetY, { velocity: velocityY })\r\n    }\r\n  }\r\n\r\n  snapToNearest(): void {\r\n    const snapPoint = this.findNearestSnapPoint()\r\n    if (snapPoint) {\r\n      this.snapTo(snapPoint)\r\n    }\r\n  }\r\n\r\n  snapTo(point: SnapPoint): void {\r\n    this.currentSnap = point\r\n    if (this.config.onSnapStart) {\r\n      this.config.onSnapStart(point)\r\n    }\r\n\r\n    this.springX.set(point.x)\r\n    this.springY.set(point.y)\r\n\r\n    // Cancel previous snap timeout to prevent memory leak\r\n    if (this.snapTimeoutId !== null) {\r\n      clearTimeout(this.snapTimeoutId)\r\n    }\r\n\r\n    // Simple completion detection with tracked timeout\r\n    this.snapTimeoutId = setTimeout(() => {\r\n      this.snapTimeoutId = null\r\n      if (!this.destroyed && this.currentSnap === point && this.config.onSnapComplete) {\r\n        this.config.onSnapComplete(point)\r\n      }\r\n    }, 500)\r\n  }\r\n\r\n  setConstraints(constraints: DragConstraints): void {\r\n    this.config.constraints = constraints\r\n  }\r\n\r\n  setSnap(snap: SnapConfig): void {\r\n    this.config.snap = snap\r\n  }\r\n\r\n  destroy(): void {\r\n    this.destroyed = true\r\n\r\n    // Cancel any pending snap timeout\r\n    if (this.snapTimeoutId !== null) {\r\n      clearTimeout(this.snapTimeoutId)\r\n      this.snapTimeoutId = null\r\n    }\r\n\r\n    this.element.removeEventListener('pointerdown', this.onPointerDown)\r\n    this.springX.destroy()\r\n    this.springY.destroy()\r\n  }\r\n}\r\n\r\n/**\r\n * Create a drag spring\r\n *\r\n * @param element - HTML element to make draggable\r\n * @param config - Drag spring configuration\r\n * @returns Drag spring controller\r\n *\r\n * @example\r\n * ```ts\r\n * const drag = createDragSpring(element, {\r\n *   onUpdate: (x, y) => {\r\n *     element.style.transform = `translate(${x}px, ${y}px)`\r\n *   },\r\n * })\r\n * ```\r\n */\r\nexport function createDragSpring(\r\n  element: HTMLElement,\r\n  config?: DragSpringConfig\r\n): DragSpring {\r\n  return new DragSpringImpl(element, config)\r\n}\r\n","\r\n/**\r\n * RGB color representation\r\n */\r\nexport interface RGB {\r\n  r: number\r\n  g: number\r\n  b: number\r\n}\r\n\r\n/**\r\n * HSL color representation\r\n */\r\nexport interface HSL {\r\n  h: number\r\n  s: number\r\n  l: number\r\n}\r\n\r\n/**\r\n * Parse a color string to RGB\r\n * Supports hex (#rgb, #rrggbb), rgb(), and named colors\r\n * @param color - The color string to parse\r\n * @returns The RGB representation\r\n */\r\nexport function parseColor(color: string): RGB {\r\n  // Try hex format first\r\n  const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\r\n  if (hexMatch) {\r\n    return hexToRgb(color)\r\n  }\r\n\r\n  // Try rgb() format\r\n  const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\r\n  if (rgbMatch) {\r\n    return {\r\n      r: parseInt(rgbMatch[1]!, 10),\r\n      g: parseInt(rgbMatch[2]!, 10),\r\n      b: parseInt(rgbMatch[3]!, 10),\r\n    }\r\n  }\r\n\r\n  // Try rgba() format\r\n  const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\r\n  if (rgbaMatch) {\r\n    return {\r\n      r: parseInt(rgbaMatch[1]!, 10),\r\n      g: parseInt(rgbaMatch[2]!, 10),\r\n      b: parseInt(rgbaMatch[3]!, 10),\r\n    }\r\n  }\r\n\r\n  // Try hsl() format\r\n  const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\r\n  if (hslMatch) {\r\n    return hslToRgb(\r\n      parseInt(hslMatch[1]!, 10),\r\n      parseInt(hslMatch[2]!, 10),\r\n      parseInt(hslMatch[3]!, 10)\r\n    )\r\n  }\r\n\r\n  // Default to black for unknown formats\r\n  return { r: 0, g: 0, b: 0 }\r\n}\r\n\r\n/**\r\n * Convert RGB to hex color string\r\n * @param r - Red component (0-255)\r\n * @param g - Green component (0-255)\r\n * @param b - Blue component (0-255)\r\n * @returns Hex color string\r\n */\r\nexport function rgbToHex(r: number, g: number, b: number): string {\r\n  const toHex = (n: number): string => {\r\n    const clamped = Math.round(Math.max(0, Math.min(255, n)))\r\n    return clamped.toString(16).padStart(2, '0')\r\n  }\r\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}`\r\n}\r\n\r\n/**\r\n * Convert hex color string to RGB\r\n * @param hex - Hex color string (with or without #)\r\n * @returns RGB representation\r\n */\r\nexport function hexToRgb(hex: string): RGB {\r\n  const cleanHex = hex.replace('#', '')\r\n\r\n  if (cleanHex.length === 3) {\r\n    return {\r\n      r: parseInt(cleanHex.charAt(0) + cleanHex.charAt(0), 16),\r\n      g: parseInt(cleanHex.charAt(1) + cleanHex.charAt(1), 16),\r\n      b: parseInt(cleanHex.charAt(2) + cleanHex.charAt(2), 16),\r\n    }\r\n  }\r\n\r\n  return {\r\n    r: parseInt(cleanHex.slice(0, 2), 16),\r\n    g: parseInt(cleanHex.slice(2, 4), 16),\r\n    b: parseInt(cleanHex.slice(4, 6), 16),\r\n  }\r\n}\r\n\r\n/**\r\n * Convert HSL to RGB\r\n * @param h - Hue (0-360)\r\n * @param s - Saturation (0-100)\r\n * @param l - Lightness (0-100)\r\n * @returns RGB representation\r\n */\r\nexport function hslToRgb(h: number, s: number, l: number): RGB {\r\n  h = ((h % 360) + 360) % 360\r\n  s = Math.max(0, Math.min(100, s)) / 100\r\n  l = Math.max(0, Math.min(100, l)) / 100\r\n\r\n  if (s === 0) {\r\n    const gray = Math.round(l * 255)\r\n    return { r: gray, g: gray, b: gray }\r\n  }\r\n\r\n  const hue2rgb = (p: number, q: number, t: number): number => {\r\n    if (t < 0) t += 1\r\n    if (t > 1) t -= 1\r\n    if (t < 1 / 6) return p + (q - p) * 6 * t\r\n    if (t < 1 / 2) return q\r\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\r\n    return p\r\n  }\r\n\r\n  const q = l < 0.5 ? l * (1 + s) : l + s - l * s\r\n  const p = 2 * l - q\r\n\r\n  return {\r\n    r: Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\r\n    g: Math.round(hue2rgb(p, q, h / 360) * 255),\r\n    b: Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\r\n  }\r\n}\r\n\r\n/**\r\n * Convert RGB to HSL\r\n * @param r - Red component (0-255)\r\n * @param g - Green component (0-255)\r\n * @param b - Blue component (0-255)\r\n * @returns HSL representation\r\n */\r\nexport function rgbToHsl(r: number, g: number, b: number): HSL {\r\n  r = Math.max(0, Math.min(255, r)) / 255\r\n  g = Math.max(0, Math.min(255, g)) / 255\r\n  b = Math.max(0, Math.min(255, b)) / 255\r\n\r\n  const max = Math.max(r, g, b)\r\n  const min = Math.min(r, g, b)\r\n  const delta = max - min\r\n\r\n  let h = 0\r\n  let s = 0\r\n\r\n  if (delta !== 0) {\r\n    s = (max + min) / 2 > 0.5\r\n      ? delta / (2 - max - min)\r\n      : delta / (max + min)\r\n\r\n    if (max === r) {\r\n      h = ((g - b) / delta + (g < b ? 6 : 0)) / 6\r\n    } else if (max === g) {\r\n      h = ((b - r) / delta + 2) / 6\r\n    } else {\r\n      h = ((r - g) / delta + 4) / 6\r\n    }\r\n  }\r\n\r\n  return {\r\n    h: Math.round(h * 360),\r\n    s: Math.round(s * 100),\r\n    l: Math.round(((max + min) / 2) * 100),\r\n  }\r\n}\r\n","/**\r\n * Scroll-linked animations - Bind animations directly to scroll position\r\n *\r\n * Unlike spring-based scroll animations, these animations are directly\r\n * tied to scroll progress (0-1) for precise control.\r\n */\r\n\r\nimport { clamp, lerp } from '../utils/math.js'\r\nimport { parseColor, rgbToHex } from '../utils/color.js'\r\n\r\n/**\r\n * Simple color lerp for scroll-linked animations\r\n */\r\nfunction lerpColor(colorA: string, colorB: string, t: number): string {\r\n  const a = parseColor(colorA)\r\n  const b = parseColor(colorB)\r\n  return rgbToHex(\r\n    Math.round(lerp(a.r, b.r, t)),\r\n    Math.round(lerp(a.g, b.g, t)),\r\n    Math.round(lerp(a.b, b.b, t))\r\n  )\r\n}\r\n\r\n/**\r\n * Scroll progress info passed to callbacks\r\n */\r\nexport interface ScrollInfo {\r\n  /** Progress from 0 to 1 */\r\n  progress: number\r\n  /** Absolute scroll position in pixels */\r\n  scrollY: number\r\n  /** Scroll velocity in pixels per second */\r\n  velocity: number\r\n  /** Scroll direction: 1 = down, -1 = up, 0 = stationary */\r\n  direction: -1 | 0 | 1\r\n  /** Whether element is in viewport */\r\n  isInView: boolean\r\n  /** How much of the element is visible (0-1) */\r\n  visibleRatio: number\r\n}\r\n\r\n/**\r\n * Scroll trigger configuration\r\n */\r\nexport interface ScrollTriggerConfig {\r\n  /** Start trigger position: 'top', 'center', 'bottom', or pixel value */\r\n  start?: 'top' | 'center' | 'bottom' | number\r\n  /** End trigger position: 'top', 'center', 'bottom', or pixel value */\r\n  end?: 'top' | 'center' | 'bottom' | number\r\n  /** Offset from start position in pixels */\r\n  startOffset?: number\r\n  /** Offset from end position in pixels */\r\n  endOffset?: number\r\n  /** Callback when entering viewport */\r\n  onEnter?: (info: ScrollInfo) => void\r\n  /** Callback when leaving viewport */\r\n  onLeave?: (info: ScrollInfo) => void\r\n  /** Callback on progress update */\r\n  onProgress?: (info: ScrollInfo) => void\r\n  /** Only trigger once */\r\n  once?: boolean\r\n  /** Scrub animation to scroll (true = instant, number = smoothing factor) */\r\n  scrub?: boolean | number\r\n}\r\n\r\n/**\r\n * Parallax configuration\r\n */\r\nexport interface ParallaxConfig {\r\n  /** Speed multiplier (negative = opposite direction) */\r\n  speed?: number\r\n  /** Direction of parallax effect */\r\n  direction?: 'vertical' | 'horizontal'\r\n  /** Easing function */\r\n  easing?: (t: number) => number\r\n  /** Root margin for intersection observer */\r\n  rootMargin?: string\r\n}\r\n\r\n/**\r\n * Scroll-linked value configuration\r\n */\r\nexport interface ScrollLinkedConfig {\r\n  /** Input range (scroll positions or progress values) */\r\n  inputRange: number[]\r\n  /** Output range (values to interpolate between) */\r\n  outputRange: (number | string)[]\r\n  /** Clamp output to range */\r\n  clamp?: boolean\r\n  /** Use smooth interpolation */\r\n  smooth?: number\r\n  /** Easing function */\r\n  easing?: (t: number) => number\r\n}\r\n\r\n/**\r\n * Scroll progress tracker\r\n */\r\nexport interface ScrollProgress {\r\n  /** Get current progress (0-1) */\r\n  get(): number\r\n  /** Get current scroll info */\r\n  getInfo(): ScrollInfo\r\n  /** Subscribe to progress changes */\r\n  subscribe(callback: (info: ScrollInfo) => void): () => void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Parallax controller\r\n */\r\nexport interface Parallax {\r\n  /** Get current offset */\r\n  getOffset(): number\r\n  /** Update parallax (call on scroll) */\r\n  update(): void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Scroll trigger controller\r\n */\r\nexport interface ScrollTrigger {\r\n  /** Check if currently active */\r\n  isActive(): boolean\r\n  /** Get current progress within trigger range */\r\n  getProgress(): number\r\n  /** Refresh trigger calculations */\r\n  refresh(): void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Scroll-linked value controller\r\n */\r\nexport interface ScrollLinkedValue {\r\n  /** Get current interpolated value */\r\n  get(): number | string\r\n  /** Subscribe to value changes */\r\n  subscribe(callback: (value: number | string) => void): () => void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n// ============ Implementation ============\r\n\r\n/**\r\n * Create scroll progress tracker for an element\r\n */\r\nexport function createScrollProgress(\r\n  element?: HTMLElement | null,\r\n  options: {\r\n    offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\r\n    smooth?: number\r\n  } = {}\r\n): ScrollProgress {\r\n  const { offset = ['start', 'end'], smooth = 0 } = options\r\n\r\n  let progress = 0\r\n  let smoothedProgress = 0\r\n  let lastScrollY = 0\r\n  let lastTime = performance.now()\r\n  let velocity = 0\r\n  let direction: -1 | 0 | 1 = 0\r\n  let rafId: number | null = null\r\n  const subscribers = new Set<(info: ScrollInfo) => void>()\r\n\r\n  const calculateProgress = (): ScrollInfo => {\r\n    const scrollY = window.scrollY\r\n    const windowHeight = window.innerHeight\r\n    const now = performance.now()\r\n    const dt = Math.max(now - lastTime, 1)\r\n\r\n    // Calculate velocity and direction\r\n    velocity = ((scrollY - lastScrollY) / dt) * 1000\r\n    direction = scrollY > lastScrollY ? 1 : scrollY < lastScrollY ? -1 : 0\r\n    lastScrollY = scrollY\r\n    lastTime = now\r\n\r\n    let newProgress: number\r\n    let isInView = true\r\n    let visibleRatio = 1\r\n\r\n    if (element) {\r\n      const rect = element.getBoundingClientRect()\r\n      const elementTop = rect.top + scrollY\r\n      const elementHeight = rect.height\r\n\r\n      // Calculate start and end points based on offset\r\n      const startPoint = offset[0] === 'start' ? elementTop :\r\n                        offset[0] === 'center' ? elementTop + elementHeight / 2 :\r\n                        elementTop + elementHeight\r\n\r\n      const endPoint = offset[1] === 'start' ? windowHeight :\r\n                      offset[1] === 'center' ? windowHeight / 2 :\r\n                      0\r\n\r\n      const scrollStart = startPoint - windowHeight\r\n      const scrollEnd = startPoint - endPoint\r\n\r\n      newProgress = clamp((scrollY - scrollStart) / (scrollEnd - scrollStart), 0, 1)\r\n\r\n      // Check if in view\r\n      isInView = rect.top < windowHeight && rect.bottom > 0\r\n      visibleRatio = isInView ?\r\n        clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0\r\n    } else {\r\n      // Track overall page scroll\r\n      const documentHeight = document.documentElement.scrollHeight - windowHeight\r\n      newProgress = documentHeight > 0 ? clamp(scrollY / documentHeight, 0, 1) : 0\r\n    }\r\n\r\n    // Apply smoothing\r\n    if (smooth > 0) {\r\n      smoothedProgress = lerp(smoothedProgress, newProgress, 1 - smooth)\r\n      progress = smoothedProgress\r\n    } else {\r\n      progress = newProgress\r\n    }\r\n\r\n    return {\r\n      progress,\r\n      scrollY,\r\n      velocity,\r\n      direction,\r\n      isInView,\r\n      visibleRatio,\r\n    }\r\n  }\r\n\r\n  const notify = (info: ScrollInfo) => {\r\n    subscribers.forEach(cb => cb(info))\r\n  }\r\n\r\n  const onScroll = () => {\r\n    if (rafId) return\r\n    rafId = requestAnimationFrame(() => {\r\n      rafId = null\r\n      const info = calculateProgress()\r\n      notify(info)\r\n    })\r\n  }\r\n\r\n  // Initial calculation\r\n  const initialInfo = calculateProgress()\r\n\r\n  window.addEventListener('scroll', onScroll, { passive: true })\r\n  window.addEventListener('resize', onScroll, { passive: true })\r\n\r\n  return {\r\n    get: () => progress,\r\n    getInfo: () => calculateProgress(),\r\n    subscribe: (callback) => {\r\n      subscribers.add(callback)\r\n      callback(initialInfo)\r\n      return () => subscribers.delete(callback)\r\n    },\r\n    destroy: () => {\r\n      if (rafId) cancelAnimationFrame(rafId)\r\n      window.removeEventListener('scroll', onScroll)\r\n      window.removeEventListener('resize', onScroll)\r\n      subscribers.clear()\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create parallax effect for an element\r\n *\r\n * @example\r\n * ```ts\r\n * const parallax = createParallax(element, { speed: 0.5 })\r\n * // Element moves at 50% scroll speed\r\n * ```\r\n */\r\nexport function createParallax(\r\n  element: HTMLElement,\r\n  config: ParallaxConfig = {}\r\n): Parallax {\r\n  const {\r\n    speed = 0.5,\r\n    direction = 'vertical',\r\n    easing = (t: number) => t,\r\n    rootMargin = '0px',\r\n  } = config\r\n\r\n  let offset = 0\r\n  let isInView = false\r\n  let observer: IntersectionObserver | null = null\r\n  let pendingRafId: number | null = null\r\n  let destroyed = false\r\n\r\n  const update = () => {\r\n    if (!isInView) return\r\n\r\n    const rect = element.getBoundingClientRect()\r\n    const windowHeight = window.innerHeight\r\n\r\n    // Calculate how far through the viewport the element is\r\n    const elementCenter = rect.top + rect.height / 2\r\n    const viewportCenter = windowHeight / 2\r\n    const distanceFromCenter = elementCenter - viewportCenter\r\n\r\n    // Apply speed and easing\r\n    const normalizedDistance = distanceFromCenter / windowHeight\r\n    const easedDistance = easing(Math.abs(normalizedDistance)) * Math.sign(normalizedDistance)\r\n    offset = easedDistance * speed * 100\r\n\r\n    // Apply transform\r\n    if (direction === 'vertical') {\r\n      element.style.transform = `translate3d(0, ${offset}px, 0)`\r\n    } else {\r\n      element.style.transform = `translate3d(${offset}px, 0, 0)`\r\n    }\r\n  }\r\n\r\n  // Use IntersectionObserver for performance\r\n  observer = new IntersectionObserver(\r\n    (entries) => {\r\n      const entry = entries[0]\r\n      if (entry) {\r\n        isInView = entry.isIntersecting\r\n        if (isInView) update()\r\n      }\r\n    },\r\n    { rootMargin }\r\n  )\r\n  observer.observe(element)\r\n\r\n  const onScroll = () => {\r\n    if (destroyed) return\r\n\r\n    if (isInView && pendingRafId === null) {\r\n      pendingRafId = requestAnimationFrame(() => {\r\n        pendingRafId = null\r\n        if (!destroyed) update()\r\n      })\r\n    }\r\n  }\r\n\r\n  window.addEventListener('scroll', onScroll, { passive: true })\r\n\r\n  return {\r\n    getOffset: () => offset,\r\n    update,\r\n    destroy: () => {\r\n      destroyed = true\r\n\r\n      // Cancel pending RAF to prevent memory leak\r\n      if (pendingRafId !== null) {\r\n        cancelAnimationFrame(pendingRafId)\r\n        pendingRafId = null\r\n      }\r\n\r\n      observer?.disconnect()\r\n      window.removeEventListener('scroll', onScroll)\r\n      element.style.transform = ''\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create scroll trigger for precise scroll-based animations\r\n *\r\n * @example\r\n * ```ts\r\n * const trigger = createScrollTrigger(element, {\r\n *   start: 'top',\r\n *   end: 'bottom',\r\n *   onProgress: (info) => {\r\n *     element.style.opacity = String(info.progress)\r\n *   },\r\n * })\r\n * ```\r\n */\r\nexport function createScrollTrigger(\r\n  element: HTMLElement,\r\n  config: ScrollTriggerConfig = {}\r\n): ScrollTrigger {\r\n  const {\r\n    start = 'top',\r\n    end = 'bottom',\r\n    startOffset = 0,\r\n    endOffset = 0,\r\n    onEnter,\r\n    onLeave,\r\n    onProgress,\r\n    once = false,\r\n    scrub = false,\r\n  } = config\r\n\r\n  let isActive = false\r\n  let progress = 0\r\n  let hasEntered = false\r\n  let smoothedProgress = 0\r\n  let rafId: number | null = null\r\n\r\n  const getPosition = (pos: 'top' | 'center' | 'bottom' | number, rect: DOMRect): number => {\r\n    if (typeof pos === 'number') return pos\r\n    switch (pos) {\r\n      case 'top': return rect.top\r\n      case 'center': return rect.top + rect.height / 2\r\n      case 'bottom': return rect.bottom\r\n    }\r\n  }\r\n\r\n  const calculateProgress = (): ScrollInfo => {\r\n    const rect = element.getBoundingClientRect()\r\n    const windowHeight = window.innerHeight\r\n\r\n    const startPos = getPosition(start, rect) + startOffset\r\n    const endPos = getPosition(end, rect) + endOffset\r\n\r\n    // Calculate progress based on viewport position\r\n    const triggerStart = windowHeight\r\n    const triggerEnd = 0\r\n\r\n    const startProgress = (triggerStart - startPos) / (triggerStart - triggerEnd)\r\n    const endProgress = (triggerStart - endPos) / (triggerStart - triggerEnd)\r\n\r\n    const rawProgress = clamp(startProgress / (endProgress || 1), 0, 1)\r\n\r\n    // Apply scrub smoothing\r\n    if (typeof scrub === 'number' && scrub > 0) {\r\n      smoothedProgress = lerp(smoothedProgress, rawProgress, 1 - scrub)\r\n      progress = smoothedProgress\r\n    } else {\r\n      progress = rawProgress\r\n    }\r\n\r\n    const isInView = rect.top < windowHeight && rect.bottom > 0\r\n\r\n    return {\r\n      progress,\r\n      scrollY: window.scrollY,\r\n      velocity: 0,\r\n      direction: 0,\r\n      isInView,\r\n      visibleRatio: isInView ? clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0,\r\n    }\r\n  }\r\n\r\n  const onScroll = () => {\r\n    if (rafId) return\r\n    rafId = requestAnimationFrame(() => {\r\n      rafId = null\r\n      const info = calculateProgress()\r\n\r\n      // Check for enter/leave\r\n      const wasActive = isActive\r\n      isActive = info.progress > 0 && info.progress < 1\r\n\r\n      if (!wasActive && isActive && (!once || !hasEntered)) {\r\n        hasEntered = true\r\n        onEnter?.(info)\r\n      }\r\n\r\n      if (wasActive && !isActive) {\r\n        onLeave?.(info)\r\n      }\r\n\r\n      if (isActive || scrub) {\r\n        onProgress?.(info)\r\n      }\r\n    })\r\n  }\r\n\r\n  window.addEventListener('scroll', onScroll, { passive: true })\r\n  window.addEventListener('resize', onScroll, { passive: true })\r\n\r\n  // Initial check\r\n  onScroll()\r\n\r\n  return {\r\n    isActive: () => isActive,\r\n    getProgress: () => progress,\r\n    refresh: () => {\r\n      calculateProgress()\r\n    },\r\n    destroy: () => {\r\n      if (rafId) cancelAnimationFrame(rafId)\r\n      window.removeEventListener('scroll', onScroll)\r\n      window.removeEventListener('resize', onScroll)\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create a scroll-linked interpolated value\r\n *\r\n * @example\r\n * ```ts\r\n * const opacity = createScrollLinkedValue(scrollProgress, {\r\n *   inputRange: [0, 0.5, 1],\r\n *   outputRange: [0, 1, 0],\r\n * })\r\n *\r\n * opacity.subscribe((value) => {\r\n *   element.style.opacity = String(value)\r\n * })\r\n * ```\r\n */\r\nexport function createScrollLinkedValue(\r\n  scrollProgress: ScrollProgress,\r\n  config: ScrollLinkedConfig\r\n): ScrollLinkedValue {\r\n  const { inputRange, outputRange, clamp: shouldClamp = true, easing } = config\r\n\r\n  if (inputRange.length !== outputRange.length) {\r\n    throw new Error('inputRange and outputRange must have the same length')\r\n  }\r\n\r\n  const firstOutput = outputRange[0]\r\n  const isColorOutput = typeof firstOutput === 'string' &&\r\n    (firstOutput.startsWith('#') || firstOutput.startsWith('rgb') || firstOutput.startsWith('hsl'))\r\n\r\n  let currentValue: number | string = firstOutput ?? 0\r\n  const subscribers = new Set<(value: number | string) => void>()\r\n\r\n  const interpolate = (progress: number): number | string => {\r\n    let p = progress\r\n    if (easing) p = easing(p)\r\n    const firstInput = inputRange[0] ?? 0\r\n    const lastInput = inputRange[inputRange.length - 1] ?? 1\r\n    if (shouldClamp) p = clamp(p, firstInput, lastInput)\r\n\r\n    // Find the segment\r\n    let segmentIndex = 0\r\n    for (let i = 0; i < inputRange.length - 1; i++) {\r\n      const curr = inputRange[i] ?? 0\r\n      const next = inputRange[i + 1] ?? 1\r\n      if (p >= curr && p <= next) {\r\n        segmentIndex = i\r\n        break\r\n      }\r\n      if (p > next) {\r\n        segmentIndex = i + 1\r\n      }\r\n    }\r\n\r\n    const segmentStart = inputRange[segmentIndex] ?? 0\r\n    const segmentEnd = inputRange[segmentIndex + 1] ?? segmentStart\r\n    const segmentProgress = segmentEnd !== segmentStart\r\n      ? (p - segmentStart) / (segmentEnd - segmentStart)\r\n      : 0\r\n\r\n    const startValue = outputRange[segmentIndex] ?? 0\r\n    const endValue = outputRange[segmentIndex + 1] ?? startValue\r\n\r\n    if (isColorOutput && typeof startValue === 'string' && typeof endValue === 'string') {\r\n      return lerpColor(startValue, endValue, segmentProgress)\r\n    }\r\n\r\n    return lerp(startValue as number, endValue as number, segmentProgress)\r\n  }\r\n\r\n  const unsubscribe = scrollProgress.subscribe((info) => {\r\n    currentValue = interpolate(info.progress)\r\n    subscribers.forEach(cb => cb(currentValue))\r\n  })\r\n\r\n  return {\r\n    get: () => currentValue,\r\n    subscribe: (callback) => {\r\n      subscribers.add(callback)\r\n      callback(currentValue)\r\n      return () => subscribers.delete(callback)\r\n    },\r\n    destroy: () => {\r\n      unsubscribe()\r\n      subscribers.clear()\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Easing functions for scroll-linked animations\r\n */\r\nexport const scrollEasings = {\r\n  linear: (t: number) => t,\r\n  easeIn: (t: number) => t * t,\r\n  easeOut: (t: number) => t * (2 - t),\r\n  easeInOut: (t: number) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\r\n  easeInCubic: (t: number) => t * t * t,\r\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\r\n  easeInOutCubic: (t: number) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\r\n  easeInQuart: (t: number) => t * t * t * t,\r\n  easeOutQuart: (t: number) => 1 - (--t) * t * t * t,\r\n  easeInOutQuart: (t: number) => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t,\r\n}\r\n","/**\r\n * Timeline API - GSAP-inspired animation sequencing with spring physics\r\n *\r\n * Create complex, coordinated animations with precise control over\r\n * timing, sequencing, and playback.\r\n */\r\n\r\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\r\nimport type { SpringConfig } from '../core/config.js'\r\nimport { clamp } from '../utils/math.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * Animation target - can be element, selector, or values object\r\n */\r\nexport type TimelineTarget = HTMLElement | string | Record<string, number>\r\n\r\n/**\r\n * Animation values (numeric properties to animate)\r\n */\r\nexport interface TimelineValues {\r\n  [key: string]: number | undefined\r\n}\r\n\r\n/**\r\n * Timeline animation options\r\n */\r\nexport interface TimelineOptions {\r\n  /** Animation duration override (not used with springs, but for timing) */\r\n  duration?: number\r\n  /** Delay before animation starts */\r\n  delay?: number\r\n  /** Spring configuration */\r\n  spring?: SpringConfig\r\n  /** Easing function (for non-spring animations) */\r\n  ease?: (t: number) => number\r\n  /** Callback when animation starts */\r\n  onStart?: () => void\r\n  /** Callback on each update */\r\n  onUpdate?: (progress: number) => void\r\n  /** Callback when animation completes */\r\n  onComplete?: () => void\r\n}\r\n\r\n/**\r\n * Animation properties - combines values with options\r\n */\r\nexport type TimelineProps = TimelineValues & TimelineOptions\r\n\r\n/**\r\n * Position in timeline - can be absolute, relative, or label\r\n */\r\nexport type TimelinePosition = number | string | `+=${number}` | `-=${number}` | `<` | `>`\r\n\r\n/**\r\n * Timeline segment representing a single animation\r\n */\r\ninterface TimelineSegment {\r\n  id: string\r\n  target: TimelineTarget\r\n  props: TimelineProps\r\n  startTime: number\r\n  endTime: number\r\n  spring: SpringGroup<Record<string, number>> | null\r\n  isActive: boolean\r\n  isComplete: boolean\r\n}\r\n\r\n/**\r\n * Timeline configuration\r\n */\r\nexport interface TimelineConfig {\r\n  /** Default spring configuration for all animations */\r\n  defaults?: SpringConfig\r\n  /** Whether to autoplay on creation */\r\n  autoplay?: boolean\r\n  /** Repeat count (-1 = infinite) */\r\n  repeat?: number\r\n  /** Yoyo (reverse on repeat) */\r\n  yoyo?: boolean\r\n  /** Delay between repeats */\r\n  repeatDelay?: number\r\n  /** Callback when timeline starts */\r\n  onStart?: () => void\r\n  /** Callback on each frame */\r\n  onUpdate?: (progress: number) => void\r\n  /** Callback when timeline completes */\r\n  onComplete?: () => void\r\n  /** Callback on repeat */\r\n  onRepeat?: (iteration: number) => void\r\n}\r\n\r\n/**\r\n * Timeline controller interface\r\n */\r\nexport interface Timeline {\r\n  /** Add animation to end of timeline */\r\n  to(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add animation from initial values */\r\n  from(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add animation from/to values */\r\n  fromTo(target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add a label at current position */\r\n  addLabel(label: string, position?: TimelinePosition): Timeline\r\n  /** Add a callback at position */\r\n  call(callback: () => void, position?: TimelinePosition): Timeline\r\n  /** Set properties instantly (no animation) */\r\n  set(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\r\n  /** Add pause at position */\r\n  addPause(position?: TimelinePosition, callback?: () => void): Timeline\r\n\r\n  /** Play timeline */\r\n  play(): Timeline\r\n  /** Pause timeline */\r\n  pause(): Timeline\r\n  /** Resume from pause */\r\n  resume(): Timeline\r\n  /** Reverse timeline */\r\n  reverse(): Timeline\r\n  /** Restart timeline */\r\n  restart(): Timeline\r\n  /** Seek to position */\r\n  seek(position: number | string): Timeline\r\n  /** Kill timeline and cleanup */\r\n  kill(): void\r\n\r\n  /** Get current time */\r\n  time(): number\r\n  /** Get total duration */\r\n  duration(): number\r\n  /** Get current progress (0-1) */\r\n  progress(): number\r\n  /** Check if playing */\r\n  isPlaying(): boolean\r\n  /** Check if reversed */\r\n  isReversed(): boolean\r\n\r\n  /** Get timeline by ID */\r\n  getById(id: string): TimelineSegment | undefined\r\n}\r\n\r\n// ============ Implementation ============\r\n\r\nlet timelineIdCounter = 0\r\n\r\n/**\r\n * Create a new timeline\r\n *\r\n * @example\r\n * ```ts\r\n * const tl = createTimeline()\r\n *   .to(element, { x: 100, opacity: 1 })\r\n *   .to(element, { y: 50 }, '+=0.2')\r\n *   .to(element, { scale: 1.2 }, '<')\r\n *\r\n * tl.play()\r\n * ```\r\n */\r\nexport function createTimeline(config: TimelineConfig = {}): Timeline {\r\n  const {\r\n    defaults = {},\r\n    autoplay = false,\r\n    repeat = 0,\r\n    yoyo = false,\r\n    repeatDelay = 0,\r\n    onStart,\r\n    onUpdate,\r\n    onComplete,\r\n    onRepeat,\r\n  } = config\r\n\r\n  const segments: TimelineSegment[] = []\r\n  const labels = new Map<string, number>()\r\n  const callbacks = new Map<number, (() => void)[]>()\r\n  const pauses = new Map<number, (() => void) | undefined>()\r\n\r\n  let currentTime = 0\r\n  let totalDuration = 0\r\n  let isPlaying = false\r\n  let isReversed = false\r\n  let isPaused = false\r\n  let repeatCount = 0\r\n  let rafId: number | null = null\r\n  let repeatDelayTimeoutId: ReturnType<typeof setTimeout> | null = null\r\n  let lastFrameTime = 0\r\n  let hasStarted = false\r\n  let insertTime = 0\r\n\r\n  // ============ Utility Functions ============\r\n\r\n  const parsePosition = (position?: TimelinePosition): number => {\r\n    if (position === undefined) {\r\n      return insertTime\r\n    }\r\n\r\n    if (typeof position === 'number') {\r\n      return position\r\n    }\r\n\r\n    // Relative to previous animation\r\n    if (position === '<') {\r\n      const lastSegment = segments[segments.length - 1]\r\n      return lastSegment ? lastSegment.startTime : 0\r\n    }\r\n\r\n    if (position === '>') {\r\n      return insertTime\r\n    }\r\n\r\n    // Relative offset\r\n    if (position.startsWith('+=')) {\r\n      return insertTime + parseFloat(position.slice(2))\r\n    }\r\n\r\n    if (position.startsWith('-=')) {\r\n      return insertTime - parseFloat(position.slice(2))\r\n    }\r\n\r\n    // Label reference\r\n    if (labels.has(position)) {\r\n      return labels.get(position)!\r\n    }\r\n\r\n    // Label with offset\r\n    const labelMatch = position.match(/^([a-zA-Z_]\\w*)([+-]=?\\d*\\.?\\d+)?$/)\r\n    if (labelMatch) {\r\n      const labelName = labelMatch[1]\r\n      const offset = labelMatch[2]\r\n      const labelTime = labelName ? (labels.get(labelName) ?? 0) : 0\r\n      if (offset) {\r\n        const offsetValue = parseFloat(offset.replace('=', ''))\r\n        return labelTime + offsetValue\r\n      }\r\n      return labelTime\r\n    }\r\n\r\n    return insertTime\r\n  }\r\n\r\n  const resolveTarget = (target: TimelineTarget): HTMLElement | null => {\r\n    if (typeof target === 'string') {\r\n      return document.querySelector(target)\r\n    }\r\n    if (target instanceof HTMLElement) {\r\n      return target\r\n    }\r\n    return null\r\n  }\r\n\r\n  const extractNumericProps = (props: TimelineProps): Record<string, number> => {\r\n    const result: Record<string, number> = {}\r\n    for (const [key, value] of Object.entries(props)) {\r\n      if (typeof value === 'number' && !['duration', 'delay'].includes(key)) {\r\n        result[key] = value\r\n      }\r\n    }\r\n    return result\r\n  }\r\n\r\n  const applyPropsToElement = (element: HTMLElement, props: Record<string, number>) => {\r\n    const transforms: string[] = []\r\n    const cssProps: Record<string, string> = {}\r\n\r\n    for (const [key, value] of Object.entries(props)) {\r\n      switch (key) {\r\n        case 'x':\r\n          transforms.push(`translateX(${value}px)`)\r\n          break\r\n        case 'y':\r\n          transforms.push(`translateY(${value}px)`)\r\n          break\r\n        case 'z':\r\n          transforms.push(`translateZ(${value}px)`)\r\n          break\r\n        case 'scale':\r\n          transforms.push(`scale(${value})`)\r\n          break\r\n        case 'scaleX':\r\n          transforms.push(`scaleX(${value})`)\r\n          break\r\n        case 'scaleY':\r\n          transforms.push(`scaleY(${value})`)\r\n          break\r\n        case 'rotate':\r\n        case 'rotation':\r\n          transforms.push(`rotate(${value}deg)`)\r\n          break\r\n        case 'rotateX':\r\n          transforms.push(`rotateX(${value}deg)`)\r\n          break\r\n        case 'rotateY':\r\n          transforms.push(`rotateY(${value}deg)`)\r\n          break\r\n        case 'rotateZ':\r\n          transforms.push(`rotateZ(${value}deg)`)\r\n          break\r\n        case 'skewX':\r\n          transforms.push(`skewX(${value}deg)`)\r\n          break\r\n        case 'skewY':\r\n          transforms.push(`skewY(${value}deg)`)\r\n          break\r\n        case 'opacity':\r\n          cssProps.opacity = String(value)\r\n          break\r\n        default:\r\n          // Assume pixels for numeric values\r\n          cssProps[key] = typeof value === 'number' ? `${value}px` : String(value)\r\n      }\r\n    }\r\n\r\n    if (transforms.length > 0) {\r\n      element.style.transform = transforms.join(' ')\r\n    }\r\n\r\n    for (const [prop, val] of Object.entries(cssProps)) {\r\n      ;(element.style as unknown as Record<string, string>)[prop] = val\r\n    }\r\n  }\r\n\r\n  const getCurrentElementValues = (element: HTMLElement, props: Record<string, number>): Record<string, number> => {\r\n    const current: Record<string, number> = {}\r\n    const computed = getComputedStyle(element)\r\n\r\n    for (const key of Object.keys(props)) {\r\n      switch (key) {\r\n        case 'opacity':\r\n          current[key] = parseFloat(computed.opacity) || 1\r\n          break\r\n        case 'x':\r\n        case 'y':\r\n        case 'z':\r\n        case 'scale':\r\n        case 'scaleX':\r\n        case 'scaleY':\r\n        case 'rotate':\r\n        case 'rotation':\r\n        case 'rotateX':\r\n        case 'rotateY':\r\n        case 'rotateZ':\r\n        case 'skewX':\r\n        case 'skewY':\r\n          // Parse from transform matrix - simplified, defaults to 0 or 1\r\n          current[key] = key.startsWith('scale') ? 1 : 0\r\n          break\r\n        default:\r\n          current[key] = parseFloat(computed.getPropertyValue(key)) || 0\r\n      }\r\n    }\r\n\r\n    return current\r\n  }\r\n\r\n  // ============ Animation Loop ============\r\n\r\n  // Maximum delta time to prevent jumps after tab suspension (64ms = ~15fps minimum)\r\n  const MAX_DELTA_TIME = 64\r\n\r\n  const tick = (timestamp: number) => {\r\n    if (!isPlaying || isPaused) return\r\n\r\n    // Clamp delta time to prevent jumps after tab suspension or debugger pauses\r\n    const rawDelta = lastFrameTime ? (timestamp - lastFrameTime) : 0\r\n    const deltaTime = Math.min(rawDelta, MAX_DELTA_TIME) / 1000\r\n    lastFrameTime = timestamp\r\n\r\n    // Update time\r\n    currentTime += isReversed ? -deltaTime : deltaTime\r\n    currentTime = clamp(currentTime, 0, totalDuration)\r\n\r\n    // Check for callbacks\r\n    const callbacksAtTime = callbacks.get(Math.floor(currentTime * 1000))\r\n    if (callbacksAtTime) {\r\n      callbacksAtTime.forEach(cb => {\r\n        try {\r\n          cb()\r\n        } catch (e) {\r\n          console.error('[SpringKit] Timeline callback error:', e)\r\n        }\r\n      })\r\n    }\r\n\r\n    // Check for pauses\r\n    const pauseCallback = pauses.get(Math.floor(currentTime * 1000))\r\n    if (pauseCallback !== undefined) {\r\n      isPaused = true\r\n      try {\r\n        pauseCallback?.()\r\n      } catch (e) {\r\n        console.error('[SpringKit] Timeline pause callback error:', e)\r\n      }\r\n      return\r\n    }\r\n\r\n    // Update segments\r\n    for (const segment of segments) {\r\n      const segmentProgress = clamp(\r\n        (currentTime - segment.startTime) / (segment.endTime - segment.startTime),\r\n        0,\r\n        1\r\n      )\r\n\r\n      const shouldBeActive = currentTime >= segment.startTime && currentTime <= segment.endTime\r\n\r\n      if (shouldBeActive && !segment.isActive) {\r\n        segment.isActive = true\r\n        segment.props.onStart?.()\r\n      }\r\n\r\n      if (segment.isActive && segment.spring) {\r\n        segment.props.onUpdate?.(segmentProgress)\r\n      }\r\n\r\n      if (shouldBeActive && segmentProgress >= 1 && !segment.isComplete) {\r\n        segment.isComplete = true\r\n        segment.props.onComplete?.()\r\n      }\r\n    }\r\n\r\n    onUpdate?.(currentTime / totalDuration)\r\n\r\n    // Check for completion\r\n    if ((isReversed && currentTime <= 0) || (!isReversed && currentTime >= totalDuration)) {\r\n      if (repeat === -1 || repeatCount < repeat) {\r\n        repeatCount++\r\n        onRepeat?.(repeatCount)\r\n\r\n        if (yoyo) {\r\n          isReversed = !isReversed\r\n        } else {\r\n          currentTime = 0\r\n          segments.forEach(s => {\r\n            s.isActive = false\r\n            s.isComplete = false\r\n          })\r\n        }\r\n\r\n        if (repeatDelay > 0) {\r\n          repeatDelayTimeoutId = setTimeout(() => {\r\n            repeatDelayTimeoutId = null\r\n            rafId = requestAnimationFrame(tick)\r\n          }, repeatDelay * 1000)\r\n          return\r\n        }\r\n      } else {\r\n        isPlaying = false\r\n        onComplete?.()\r\n        return\r\n      }\r\n    }\r\n\r\n    rafId = requestAnimationFrame(tick)\r\n  }\r\n\r\n  // ============ Public API ============\r\n\r\n  const timeline: Timeline = {\r\n    to(target, props, position) {\r\n      const startTime = parsePosition(position) + (props.delay || 0)\r\n      const duration = props.duration || 0.5\r\n      const endTime = startTime + duration\r\n\r\n      const element = resolveTarget(target)\r\n      const numericProps = extractNumericProps(props)\r\n\r\n      const segment: TimelineSegment = {\r\n        id: `segment_${timelineIdCounter++}`,\r\n        target,\r\n        props,\r\n        startTime,\r\n        endTime,\r\n        spring: null,\r\n        isActive: false,\r\n        isComplete: false,\r\n      }\r\n\r\n      if (element && Object.keys(numericProps).length > 0) {\r\n        const currentValues = getCurrentElementValues(element, numericProps)\r\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\r\n\r\n        segment.spring = createSpringGroup(currentValues, springConfig)\r\n\r\n        segment.spring.subscribe((values: Record<string, number>) => {\r\n          applyPropsToElement(element, values)\r\n        })\r\n\r\n        // Set target values when segment becomes active\r\n        const originalOnStart = segment.props.onStart\r\n        segment.props.onStart = () => {\r\n          segment.spring?.set(numericProps)\r\n          originalOnStart?.()\r\n        }\r\n      }\r\n\r\n      segments.push(segment)\r\n      insertTime = endTime\r\n      totalDuration = Math.max(totalDuration, endTime)\r\n\r\n      return timeline\r\n    },\r\n\r\n    from(target, props, position) {\r\n      const startTime = parsePosition(position) + (props.delay || 0)\r\n      const duration = props.duration || 0.5\r\n      const endTime = startTime + duration\r\n\r\n      const element = resolveTarget(target)\r\n      const numericProps = extractNumericProps(props)\r\n\r\n      const segment: TimelineSegment = {\r\n        id: `segment_${timelineIdCounter++}`,\r\n        target,\r\n        props,\r\n        startTime,\r\n        endTime,\r\n        spring: null,\r\n        isActive: false,\r\n        isComplete: false,\r\n      }\r\n\r\n      if (element && Object.keys(numericProps).length > 0) {\r\n        const targetValues = getCurrentElementValues(element, numericProps)\r\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\r\n\r\n        // Start from props, animate to current\r\n        segment.spring = createSpringGroup(numericProps, springConfig)\r\n        applyPropsToElement(element, numericProps)\r\n\r\n        segment.spring.subscribe((values: Record<string, number>) => {\r\n          applyPropsToElement(element, values)\r\n        })\r\n\r\n        const originalOnStart = segment.props.onStart\r\n        segment.props.onStart = () => {\r\n          segment.spring?.set(targetValues)\r\n          originalOnStart?.()\r\n        }\r\n      }\r\n\r\n      segments.push(segment)\r\n      insertTime = endTime\r\n      totalDuration = Math.max(totalDuration, endTime)\r\n\r\n      return timeline\r\n    },\r\n\r\n    fromTo(target, fromProps, toProps, position) {\r\n      const startTime = parsePosition(position) + (toProps.delay || 0)\r\n      const duration = toProps.duration || 0.5\r\n      const endTime = startTime + duration\r\n\r\n      const element = resolveTarget(target)\r\n      const fromNumeric = extractNumericProps(fromProps)\r\n      const toNumeric = extractNumericProps(toProps)\r\n\r\n      const segment: TimelineSegment = {\r\n        id: `segment_${timelineIdCounter++}`,\r\n        target,\r\n        props: toProps,\r\n        startTime,\r\n        endTime,\r\n        spring: null,\r\n        isActive: false,\r\n        isComplete: false,\r\n      }\r\n\r\n      if (element && Object.keys(toNumeric).length > 0) {\r\n        const springConfig: SpringConfig = { ...defaults, ...toProps.spring }\r\n\r\n        segment.spring = createSpringGroup(fromNumeric, springConfig)\r\n        applyPropsToElement(element, fromNumeric)\r\n\r\n        segment.spring.subscribe((values: Record<string, number>) => {\r\n          applyPropsToElement(element, values)\r\n        })\r\n\r\n        const originalOnStart = segment.props.onStart\r\n        segment.props.onStart = () => {\r\n          segment.spring?.set(toNumeric)\r\n          originalOnStart?.()\r\n        }\r\n      }\r\n\r\n      segments.push(segment)\r\n      insertTime = endTime\r\n      totalDuration = Math.max(totalDuration, endTime)\r\n\r\n      return timeline\r\n    },\r\n\r\n    addLabel(label, position) {\r\n      const time = parsePosition(position)\r\n      labels.set(label, time)\r\n      return timeline\r\n    },\r\n\r\n    call(callback, position) {\r\n      const time = Math.floor(parsePosition(position) * 1000)\r\n      if (!callbacks.has(time)) {\r\n        callbacks.set(time, [])\r\n      }\r\n      callbacks.get(time)!.push(callback)\r\n      return timeline\r\n    },\r\n\r\n    set(target, props, position) {\r\n      const element = resolveTarget(target)\r\n      if (element) {\r\n        const time = parsePosition(position)\r\n        this.call(() => {\r\n          applyPropsToElement(element, extractNumericProps(props))\r\n        }, time)\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    addPause(position, callback) {\r\n      const time = Math.floor(parsePosition(position) * 1000)\r\n      pauses.set(time, callback)\r\n      return timeline\r\n    },\r\n\r\n    play() {\r\n      if (!hasStarted) {\r\n        hasStarted = true\r\n        onStart?.()\r\n      }\r\n      isPlaying = true\r\n      isPaused = false\r\n      lastFrameTime = 0\r\n      rafId = requestAnimationFrame(tick)\r\n      return timeline\r\n    },\r\n\r\n    pause() {\r\n      isPaused = true\r\n      if (rafId) {\r\n        cancelAnimationFrame(rafId)\r\n        rafId = null\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    resume() {\r\n      if (isPaused) {\r\n        isPaused = false\r\n        lastFrameTime = 0\r\n        rafId = requestAnimationFrame(tick)\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    reverse() {\r\n      isReversed = !isReversed\r\n      return timeline\r\n    },\r\n\r\n    restart() {\r\n      currentTime = isReversed ? totalDuration : 0\r\n      repeatCount = 0\r\n      hasStarted = false\r\n      segments.forEach(s => {\r\n        s.isActive = false\r\n        s.isComplete = false\r\n      })\r\n      return this.play()\r\n    },\r\n\r\n    seek(position) {\r\n      if (typeof position === 'string') {\r\n        currentTime = labels.get(position) ?? 0\r\n      } else {\r\n        currentTime = clamp(position, 0, totalDuration)\r\n      }\r\n      return timeline\r\n    },\r\n\r\n    kill() {\r\n      isPlaying = false\r\n      if (rafId) {\r\n        cancelAnimationFrame(rafId)\r\n        rafId = null\r\n      }\r\n      // Clear repeat delay timeout to prevent memory leak\r\n      if (repeatDelayTimeoutId) {\r\n        clearTimeout(repeatDelayTimeoutId)\r\n        repeatDelayTimeoutId = null\r\n      }\r\n      segments.forEach(s => s.spring?.destroy())\r\n      segments.length = 0\r\n      labels.clear()\r\n      callbacks.clear()\r\n      pauses.clear()\r\n    },\r\n\r\n    time: () => currentTime,\r\n    duration: () => totalDuration,\r\n    progress: () => totalDuration > 0 ? currentTime / totalDuration : 0,\r\n    isPlaying: () => isPlaying && !isPaused,\r\n    isReversed: () => isReversed,\r\n\r\n    getById(id) {\r\n      return segments.find(s => s.id === id)\r\n    },\r\n  }\r\n\r\n  if (autoplay) {\r\n    timeline.play()\r\n  }\r\n\r\n  return timeline\r\n}\r\n\r\n/**\r\n * Create a simple tween (single animation)\r\n */\r\nexport function tween(\r\n  target: TimelineTarget,\r\n  props: TimelineProps\r\n): Timeline {\r\n  return createTimeline().to(target, props).play()\r\n}\r\n\r\n/**\r\n * Create a timeline that animates all targets simultaneously\r\n */\r\nexport function allTo(\r\n  targets: TimelineTarget[],\r\n  props: TimelineProps\r\n): Timeline {\r\n  const tl = createTimeline()\r\n  targets.forEach((target, i) => {\r\n    tl.to(target, props, i === 0 ? 0 : '<')\r\n  })\r\n  return tl.play()\r\n}\r\n","/**\r\n * SVG Morphing - Smooth path shape interpolation with spring physics\r\n *\r\n * Enables morphing between SVG paths with automatic path normalization\r\n * and spring-based animation.\r\n */\r\n\r\nimport { createSpringValue } from '../core/spring-value.js'\r\nimport type { SpringConfig } from '../core/config.js'\r\nimport { lerp, clamp } from '../utils/math.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * SVG path command types\r\n */\r\ntype CommandType = 'M' | 'L' | 'C' | 'Q' | 'A' | 'Z' | 'H' | 'V' | 'S' | 'T'\r\n\r\n/**\r\n * Parsed path command\r\n */\r\ninterface PathCommand {\r\n  type: CommandType\r\n  values: number[]\r\n}\r\n\r\n/**\r\n * Normalized point with control points\r\n */\r\ninterface NormalizedPoint {\r\n  x: number\r\n  y: number\r\n  cp1x?: number\r\n  cp1y?: number\r\n  cp2x?: number\r\n  cp2y?: number\r\n}\r\n\r\n/**\r\n * Morph configuration\r\n */\r\nexport interface MorphConfig {\r\n  /** Spring configuration */\r\n  spring?: SpringConfig\r\n  /** Number of samples for path normalization (higher = smoother) */\r\n  samples?: number\r\n  /** Callback on progress update */\r\n  onProgress?: (progress: number) => void\r\n  /** Callback when morph completes */\r\n  onComplete?: () => void\r\n}\r\n\r\n/**\r\n * Morph controller interface\r\n */\r\nexport interface MorphController {\r\n  /** Get current morphed path */\r\n  getPath(): string\r\n  /** Get current progress (0-1) */\r\n  getProgress(): number\r\n  /** Morph to a new path */\r\n  morphTo(path: string): void\r\n  /** Set progress directly (0-1) */\r\n  setProgress(progress: number): void\r\n  /** Subscribe to path changes */\r\n  subscribe(callback: (path: string) => void): () => void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n// ============ Path Parsing ============\r\n\r\n/**\r\n * Parse SVG path string into commands\r\n */\r\nfunction parsePath(d: string): PathCommand[] {\r\n  const commands: PathCommand[] = []\r\n  const regex = /([MLCQAZHVST])([^MLCQAZHVST]*)/gi\r\n\r\n  // Use matchAll instead of regex.exec for safer iteration\r\n  const matches = d.matchAll(regex)\r\n\r\n  for (const matchItem of matches) {\r\n    const typeChar = matchItem[1]\r\n    const valuesStr = matchItem[2]\r\n    if (!typeChar || valuesStr === undefined) continue\r\n\r\n    const type = typeChar.toUpperCase() as CommandType\r\n    const values = valuesStr\r\n      .trim()\r\n      .split(/[\\s,]+/)\r\n      .filter(v => v !== '')\r\n      .map(parseFloat)\r\n      .filter(v => !isNaN(v))\r\n\r\n    commands.push({ type, values })\r\n  }\r\n\r\n  return commands\r\n}\r\n\r\n/**\r\n * Convert path commands to absolute coordinates\r\n */\r\nfunction toAbsolute(commands: PathCommand[]): PathCommand[] {\r\n  let currentX = 0\r\n  let currentY = 0\r\n  let startX = 0\r\n  let startY = 0\r\n\r\n  return commands.map(cmd => {\r\n    const { type, values } = cmd\r\n    const absValues = [...values]\r\n\r\n    switch (type) {\r\n      case 'M':\r\n        currentX = values[0] ?? 0\r\n        currentY = values[1] ?? 0\r\n        startX = currentX\r\n        startY = currentY\r\n        break\r\n\r\n      case 'L':\r\n        currentX = values[0] ?? 0\r\n        currentY = values[1] ?? 0\r\n        break\r\n\r\n      case 'H':\r\n        absValues[0] = values[0] ?? 0\r\n        currentX = values[0] ?? 0\r\n        break\r\n\r\n      case 'V':\r\n        absValues[0] = values[0] ?? 0\r\n        currentY = values[0] ?? 0\r\n        break\r\n\r\n      case 'C':\r\n        currentX = values[4] ?? 0\r\n        currentY = values[5] ?? 0\r\n        break\r\n\r\n      case 'Q':\r\n        currentX = values[2] ?? 0\r\n        currentY = values[3] ?? 0\r\n        break\r\n\r\n      case 'A':\r\n        currentX = values[5] ?? 0\r\n        currentY = values[6] ?? 0\r\n        break\r\n\r\n      case 'Z':\r\n        currentX = startX\r\n        currentY = startY\r\n        break\r\n    }\r\n\r\n    return { type, values: absValues }\r\n  })\r\n}\r\n\r\n/**\r\n * Check if SVG path methods are available (real browser, not JSDOM)\r\n */\r\nfunction hasSvgPathSupport(): boolean {\r\n  if (typeof document === 'undefined') return false\r\n  try {\r\n    const svgNS = 'http://www.w3.org/2000/svg'\r\n    const svg = document.createElementNS(svgNS, 'svg')\r\n    const path = document.createElementNS(svgNS, 'path')\r\n    path.setAttribute('d', 'M0,0 L10,10')\r\n    svg.appendChild(path)\r\n    document.body.appendChild(svg)\r\n    const hasSupport = typeof path.getTotalLength === 'function'\r\n    let works = false\r\n    if (hasSupport) {\r\n      try {\r\n        path.getTotalLength()\r\n        works = true\r\n      } catch {\r\n        works = false\r\n      }\r\n    }\r\n    document.body.removeChild(svg)\r\n    return works\r\n  } catch {\r\n    return false\r\n  }\r\n}\r\n\r\n/**\r\n * Simple linear sampling fallback for non-browser environments\r\n */\r\nfunction samplePathFallback(commands: PathCommand[], samples: number): NormalizedPoint[] {\r\n  const points: NormalizedPoint[] = []\r\n\r\n  for (const cmd of commands) {\r\n    if (cmd.type === 'M' || cmd.type === 'L') {\r\n      points.push({ x: cmd.values[0] ?? 0, y: cmd.values[1] ?? 0 })\r\n    } else if (cmd.type === 'C') {\r\n      points.push({\r\n        x: cmd.values[4] ?? 0,\r\n        y: cmd.values[5] ?? 0,\r\n        cp1x: cmd.values[0] ?? 0,\r\n        cp1y: cmd.values[1] ?? 0,\r\n        cp2x: cmd.values[2] ?? 0,\r\n        cp2y: cmd.values[3] ?? 0,\r\n      })\r\n    } else if (cmd.type === 'Q') {\r\n      points.push({\r\n        x: cmd.values[2] ?? 0,\r\n        y: cmd.values[3] ?? 0,\r\n        cp1x: cmd.values[0] ?? 0,\r\n        cp1y: cmd.values[1] ?? 0,\r\n      })\r\n    } else if (cmd.type === 'A') {\r\n      points.push({ x: cmd.values[5] ?? 0, y: cmd.values[6] ?? 0 })\r\n    } else if (cmd.type === 'H') {\r\n      const lastPoint = points[points.length - 1]\r\n      points.push({ x: cmd.values[0] ?? 0, y: lastPoint?.y ?? 0 })\r\n    } else if (cmd.type === 'V') {\r\n      const lastPoint = points[points.length - 1]\r\n      points.push({ x: lastPoint?.x ?? 0, y: cmd.values[0] ?? 0 })\r\n    }\r\n  }\r\n\r\n  // Interpolate to reach desired sample count\r\n  if (points.length > 0 && points.length < samples) {\r\n    const interpolated: NormalizedPoint[] = []\r\n    const step = (points.length - 1) / (samples - 1)\r\n\r\n    for (let i = 0; i < samples; i++) {\r\n      const t = i * step\r\n      const index = Math.floor(t)\r\n      const frac = t - index\r\n\r\n      if (index >= points.length - 1) {\r\n        interpolated.push(points[points.length - 1]!)\r\n      } else {\r\n        const p1 = points[index]!\r\n        const p2 = points[index + 1]!\r\n        interpolated.push({\r\n          x: lerp(p1.x, p2.x, frac),\r\n          y: lerp(p1.y, p2.y, frac),\r\n        })\r\n      }\r\n    }\r\n    return interpolated\r\n  }\r\n\r\n  return points\r\n}\r\n\r\n/**\r\n * Sample points along a path at regular intervals\r\n */\r\nfunction samplePath(commands: PathCommand[], samples: number): NormalizedPoint[] {\r\n  // Use fallback for non-browser or JSDOM environments\r\n  if (!hasSvgPathSupport()) {\r\n    return samplePathFallback(commands, samples)\r\n  }\r\n\r\n  const points: NormalizedPoint[] = []\r\n  const svgNS = 'http://www.w3.org/2000/svg'\r\n  const svg = document.createElementNS(svgNS, 'svg')\r\n  const path = document.createElementNS(svgNS, 'path')\r\n\r\n  // Build path string\r\n  let d = ''\r\n  for (const cmd of commands) {\r\n    d += cmd.type + cmd.values.join(' ')\r\n  }\r\n  path.setAttribute('d', d)\r\n  svg.appendChild(path)\r\n  document.body.appendChild(svg)\r\n\r\n  try {\r\n    const totalLength = path.getTotalLength()\r\n    const step = totalLength / (samples - 1)\r\n\r\n    for (let i = 0; i < samples; i++) {\r\n      const point = path.getPointAtLength(i * step)\r\n      points.push({ x: point.x, y: point.y })\r\n    }\r\n  } finally {\r\n    document.body.removeChild(svg)\r\n  }\r\n\r\n  return points\r\n}\r\n\r\n/**\r\n * Interpolate between two points\r\n */\r\nfunction interpolatePoint(p1: NormalizedPoint, p2: NormalizedPoint, t: number): NormalizedPoint {\r\n  return {\r\n    x: lerp(p1.x, p2.x, t),\r\n    y: lerp(p1.y, p2.y, t),\r\n  }\r\n}\r\n\r\n/**\r\n * Convert normalized points back to path string\r\n */\r\nfunction pointsToPath(points: NormalizedPoint[]): string {\r\n  if (points.length === 0) return ''\r\n\r\n  const firstPoint = points[0]!\r\n  let d = `M ${firstPoint.x} ${firstPoint.y}`\r\n\r\n  for (let i = 1; i < points.length; i++) {\r\n    const point = points[i]!\r\n    d += ` L ${point.x} ${point.y}`\r\n  }\r\n\r\n  return d\r\n}\r\n\r\n// ============ Morph Implementation ============\r\n\r\n/**\r\n * Create SVG path morph controller\r\n *\r\n * @example\r\n * ```ts\r\n * const morph = createMorph(circlePath, {\r\n *   spring: { stiffness: 120, damping: 14 },\r\n *   onProgress: (p) => console.log('Progress:', p),\r\n * })\r\n *\r\n * morph.subscribe((path) => {\r\n *   element.setAttribute('d', path)\r\n * })\r\n *\r\n * morph.morphTo(starPath)\r\n * ```\r\n */\r\nexport function createMorph(\r\n  initialPath: string,\r\n  config: MorphConfig = {}\r\n): MorphController {\r\n  const {\r\n    spring: springConfig = { stiffness: 120, damping: 14 },\r\n    samples = 100,\r\n    onProgress,\r\n    onComplete,\r\n  } = config\r\n\r\n  let currentPath = initialPath\r\n  let fromPoints: NormalizedPoint[] = []\r\n  let toPoints: NormalizedPoint[] = []\r\n  let currentPoints: NormalizedPoint[] = []\r\n\r\n  const subscribers = new Set<(path: string) => void>()\r\n\r\n  // Parse initial path\r\n  const initialCommands = parsePath(initialPath)\r\n  fromPoints = samplePath(toAbsolute(initialCommands), samples)\r\n  currentPoints = [...fromPoints]\r\n  toPoints = [...fromPoints]\r\n\r\n  // Create spring for progress\r\n  const progressSpring = createSpringValue(0, springConfig)\r\n\r\n  progressSpring.subscribe(() => {\r\n    const progress = progressSpring.get()\r\n    onProgress?.(progress)\r\n\r\n    // Interpolate points\r\n    currentPoints = fromPoints.map((from, i) =>\r\n      interpolatePoint(from, toPoints[i] ?? from, progress)\r\n    )\r\n\r\n    currentPath = pointsToPath(currentPoints)\r\n    subscribers.forEach(cb => {\r\n      try {\r\n        cb(currentPath)\r\n      } catch (e) {\r\n        console.error('[SpringKit] Morph subscriber error:', e)\r\n      }\r\n    })\r\n\r\n    if (progress >= 0.999) {\r\n      onComplete?.()\r\n    }\r\n  })\r\n\r\n  return {\r\n    getPath: () => currentPath,\r\n    getProgress: () => progressSpring.get(),\r\n\r\n    morphTo(path: string) {\r\n      // Normalize paths\r\n      const targetCommands = parsePath(path)\r\n      const targetPoints = samplePath(toAbsolute(targetCommands), samples)\r\n\r\n      fromPoints = [...currentPoints]\r\n      toPoints = targetPoints\r\n\r\n      // Ensure same number of points\r\n      while (fromPoints.length < toPoints.length) {\r\n        fromPoints.push(fromPoints[fromPoints.length - 1] || { x: 0, y: 0 })\r\n      }\r\n      while (toPoints.length < fromPoints.length) {\r\n        toPoints.push(toPoints[toPoints.length - 1] || { x: 0, y: 0 })\r\n      }\r\n\r\n      // Reset and animate\r\n      progressSpring.jump(0)\r\n      progressSpring.set(1)\r\n    },\r\n\r\n    setProgress(progress: number) {\r\n      const p = clamp(progress, 0, 1)\r\n      progressSpring.jump(p)\r\n\r\n      currentPoints = fromPoints.map((from, i) =>\r\n        interpolatePoint(from, toPoints[i] ?? from, p)\r\n      )\r\n\r\n      currentPath = pointsToPath(currentPoints)\r\n      subscribers.forEach(cb => {\r\n        try {\r\n          cb(currentPath)\r\n        } catch (e) {\r\n          console.error('[SpringKit] Morph subscriber error:', e)\r\n        }\r\n      })\r\n    },\r\n\r\n    subscribe(callback) {\r\n      subscribers.add(callback)\r\n      try {\r\n        callback(currentPath)\r\n      } catch (e) {\r\n        console.error('[SpringKit] Morph subscriber error:', e)\r\n      }\r\n      return () => subscribers.delete(callback)\r\n    },\r\n\r\n    destroy() {\r\n      progressSpring.destroy()\r\n      subscribers.clear()\r\n    },\r\n  }\r\n}\r\n\r\n/**\r\n * Create a morph between multiple paths (morphing sequence)\r\n *\r\n * @example\r\n * ```ts\r\n * const sequence = createMorphSequence([\r\n *   circlePath,\r\n *   squarePath,\r\n *   starPath,\r\n * ])\r\n *\r\n * sequence.subscribe((path) => {\r\n *   element.setAttribute('d', path)\r\n * })\r\n *\r\n * sequence.morphToIndex(2) // Morph to star\r\n * ```\r\n */\r\nexport function createMorphSequence(\r\n  paths: string[],\r\n  config: MorphConfig = {}\r\n): {\r\n  getPath(): string\r\n  getCurrentIndex(): number\r\n  morphToIndex(index: number): void\r\n  morphToNext(): void\r\n  morphToPrevious(): void\r\n  subscribe(callback: (path: string) => void): () => void\r\n  destroy(): void\r\n} {\r\n  if (paths.length === 0) {\r\n    throw new Error('At least one path is required')\r\n  }\r\n\r\n  let currentIndex = 0\r\n  const firstPath = paths[0]!\r\n  const morph = createMorph(firstPath, config)\r\n\r\n  return {\r\n    getPath: () => morph.getPath(),\r\n    getCurrentIndex: () => currentIndex,\r\n\r\n    morphToIndex(index: number) {\r\n      const targetIndex = clamp(index, 0, paths.length - 1)\r\n      if (targetIndex !== currentIndex) {\r\n        currentIndex = targetIndex\r\n        const targetPath = paths[targetIndex]!\r\n        morph.morphTo(targetPath)\r\n      }\r\n    },\r\n\r\n    morphToNext() {\r\n      this.morphToIndex((currentIndex + 1) % paths.length)\r\n    },\r\n\r\n    morphToPrevious() {\r\n      this.morphToIndex((currentIndex - 1 + paths.length) % paths.length)\r\n    },\r\n\r\n    subscribe: (callback) => morph.subscribe(callback),\r\n    destroy: () => morph.destroy(),\r\n  }\r\n}\r\n\r\n// ============ Preset Shapes ============\r\n\r\n/**\r\n * Generate common SVG shape paths\r\n */\r\nexport const shapes = {\r\n  /**\r\n   * Generate circle path\r\n   */\r\n  circle(cx: number, cy: number, r: number): string {\r\n    return `M ${cx - r} ${cy}\r\n            A ${r} ${r} 0 1 1 ${cx + r} ${cy}\r\n            A ${r} ${r} 0 1 1 ${cx - r} ${cy}`\r\n  },\r\n\r\n  /**\r\n   * Generate rectangle path\r\n   */\r\n  rect(x: number, y: number, width: number, height: number, rx = 0): string {\r\n    if (rx === 0) {\r\n      return `M ${x} ${y}\r\n              L ${x + width} ${y}\r\n              L ${x + width} ${y + height}\r\n              L ${x} ${y + height}\r\n              Z`\r\n    }\r\n\r\n    return `M ${x + rx} ${y}\r\n            L ${x + width - rx} ${y}\r\n            Q ${x + width} ${y} ${x + width} ${y + rx}\r\n            L ${x + width} ${y + height - rx}\r\n            Q ${x + width} ${y + height} ${x + width - rx} ${y + height}\r\n            L ${x + rx} ${y + height}\r\n            Q ${x} ${y + height} ${x} ${y + height - rx}\r\n            L ${x} ${y + rx}\r\n            Q ${x} ${y} ${x + rx} ${y}\r\n            Z`\r\n  },\r\n\r\n  /**\r\n   * Generate polygon path\r\n   */\r\n  polygon(cx: number, cy: number, r: number, sides: number): string {\r\n    const points: string[] = []\r\n\r\n    for (let i = 0; i < sides; i++) {\r\n      const angle = (i / sides) * Math.PI * 2 - Math.PI / 2\r\n      const x = cx + r * Math.cos(angle)\r\n      const y = cy + r * Math.sin(angle)\r\n      points.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\r\n    }\r\n\r\n    return points.join(' ') + ' Z'\r\n  },\r\n\r\n  /**\r\n   * Generate star path\r\n   */\r\n  star(cx: number, cy: number, outerR: number, innerR: number, points: number): string {\r\n    const path: string[] = []\r\n    const step = Math.PI / points\r\n\r\n    for (let i = 0; i < points * 2; i++) {\r\n      const r = i % 2 === 0 ? outerR : innerR\r\n      const angle = i * step - Math.PI / 2\r\n      const x = cx + r * Math.cos(angle)\r\n      const y = cy + r * Math.sin(angle)\r\n      path.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\r\n    }\r\n\r\n    return path.join(' ') + ' Z'\r\n  },\r\n\r\n  /**\r\n   * Generate heart path\r\n   */\r\n  heart(cx: number, cy: number, size: number): string {\r\n    const d = size / 4\r\n    return `M ${cx} ${cy + d}\r\n            C ${cx} ${cy} ${cx - 2 * d} ${cy} ${cx - 2 * d} ${cy - d}\r\n            C ${cx - 2 * d} ${cy - 2 * d} ${cx} ${cy - 2 * d} ${cx} ${cy - d}\r\n            C ${cx} ${cy - 2 * d} ${cx + 2 * d} ${cy - 2 * d} ${cx + 2 * d} ${cy - d}\r\n            C ${cx + 2 * d} ${cy} ${cx} ${cy} ${cx} ${cy + d}\r\n            Z`\r\n  },\r\n\r\n  /**\r\n   * Generate arrow path\r\n   */\r\n  arrow(x: number, y: number, width: number, height: number, direction: 'up' | 'down' | 'left' | 'right' = 'right'): string {\r\n    const hw = width / 2\r\n    const hh = height / 2\r\n\r\n    switch (direction) {\r\n      case 'right':\r\n        return `M ${x} ${y - hh} L ${x + width} ${y} L ${x} ${y + hh} Z`\r\n      case 'left':\r\n        return `M ${x + width} ${y - hh} L ${x} ${y} L ${x + width} ${y + hh} Z`\r\n      case 'up':\r\n        return `M ${x - hw} ${y + height} L ${x} ${y} L ${x + hw} ${y + height} Z`\r\n      case 'down':\r\n        return `M ${x - hw} ${y} L ${x} ${y + height} L ${x + hw} ${y} Z`\r\n    }\r\n  },\r\n}\r\n","/**\r\n * Shared Layout Animations - Cross-component FLIP animations with layoutId\r\n *\r\n * Enables smooth transitions between components that share the same layoutId,\r\n * similar to Framer Motion's layout animations.\r\n */\r\n\r\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\r\nimport type { SpringConfig } from '../core/config.js'\r\n\r\n// ============ Types ============\r\n\r\n/**\r\n * Element measurement for FLIP\r\n */\r\nexport interface LayoutMeasurement {\r\n  x: number\r\n  y: number\r\n  width: number\r\n  height: number\r\n  opacity?: number\r\n  borderRadius?: number\r\n  scaleX?: number\r\n  scaleY?: number\r\n}\r\n\r\n/**\r\n * Shared layout element info\r\n */\r\ninterface SharedLayoutElement {\r\n  id: string\r\n  element: HTMLElement\r\n  measurement: LayoutMeasurement\r\n  spring: SpringGroup<Record<string, number>> | null\r\n  isAnimating: boolean\r\n  pendingRafId: number | null\r\n}\r\n\r\n/**\r\n * Layout animation configuration\r\n */\r\nexport interface LayoutAnimationConfig {\r\n  /** Spring configuration */\r\n  spring?: SpringConfig\r\n  /** Duration hint for spring (optional) */\r\n  duration?: number\r\n  /** Callback when animation starts */\r\n  onAnimationStart?: (id: string) => void\r\n  /** Callback when animation completes */\r\n  onAnimationComplete?: (id: string) => void\r\n  /** Enable crossfade during transition */\r\n  crossfade?: boolean\r\n  /** Custom transition properties */\r\n  transition?: {\r\n    x?: SpringConfig\r\n    y?: SpringConfig\r\n    width?: SpringConfig\r\n    height?: SpringConfig\r\n    opacity?: SpringConfig\r\n    borderRadius?: SpringConfig\r\n  }\r\n}\r\n\r\n/**\r\n * Layout group for managing shared elements\r\n */\r\nexport interface LayoutGroup {\r\n  /** Register element with layoutId */\r\n  register(id: string, element: HTMLElement): void\r\n  /** Unregister element */\r\n  unregister(id: string, element: HTMLElement): void\r\n  /** Update layout (call after DOM changes) */\r\n  update(): void\r\n  /** Force re-measure all elements */\r\n  forceUpdate(): void\r\n  /** Destroy and cleanup */\r\n  destroy(): void\r\n}\r\n\r\n/**\r\n * Shared layout context for cross-component animations\r\n */\r\nexport interface SharedLayoutContext {\r\n  /** Register a layout group */\r\n  createGroup(id?: string): LayoutGroup\r\n  /** Get group by id */\r\n  getGroup(id: string): LayoutGroup | undefined\r\n  /** Update all groups */\r\n  updateAll(): void\r\n  /** Destroy all groups */\r\n  destroy(): void\r\n}\r\n\r\n// ============ Measurement Utilities ============\r\n\r\n/**\r\n * Measure element position and size\r\n */\r\nfunction measureElement(element: HTMLElement): LayoutMeasurement {\r\n  const rect = element.getBoundingClientRect()\r\n  const styles = getComputedStyle(element)\r\n\r\n  return {\r\n    x: rect.left + window.scrollX,\r\n    y: rect.top + window.scrollY,\r\n    width: rect.width,\r\n    height: rect.height,\r\n    opacity: parseFloat(styles.opacity) || 1,\r\n    borderRadius: parseFloat(styles.borderRadius) || 0,\r\n    scaleX: 1,\r\n    scaleY: 1,\r\n  }\r\n}\r\n\r\n/**\r\n * Apply FLIP transform to element\r\n */\r\nfunction applyTransform(\r\n  element: HTMLElement,\r\n  from: LayoutMeasurement,\r\n  to: LayoutMeasurement,\r\n  current: Record<string, number>\r\n): void {\r\n  // Calculate deltas\r\n  const dx = current.x !== undefined ? from.x - to.x + (current.x - from.x) : 0\r\n  const dy = current.y !== undefined ? from.y - to.y + (current.y - from.y) : 0\r\n  const scaleX = current.width !== undefined ? current.width / to.width : 1\r\n  const scaleY = current.height !== undefined ? current.height / to.height : 1\r\n\r\n  // Apply transform\r\n  element.style.transform = `translate(${dx}px, ${dy}px) scale(${scaleX}, ${scaleY})`\r\n  element.style.transformOrigin = 'top left'\r\n\r\n  // Apply opacity if transitioning\r\n  if (current.opacity !== undefined) {\r\n    element.style.opacity = String(current.opacity)\r\n  }\r\n\r\n  // Apply border radius (scale-compensated)\r\n  if (current.borderRadius !== undefined) {\r\n    const compensatedRadius = current.borderRadius / Math.max(scaleX, scaleY)\r\n    element.style.borderRadius = `${compensatedRadius}px`\r\n  }\r\n}\r\n\r\n/**\r\n * Reset element transform\r\n */\r\nfunction resetTransform(element: HTMLElement): void {\r\n  element.style.transform = ''\r\n  element.style.transformOrigin = ''\r\n  element.style.opacity = ''\r\n  element.style.borderRadius = ''\r\n}\r\n\r\n// ============ Layout Group Implementation ============\r\n\r\n/**\r\n * Create a layout group for managing shared layout elements\r\n *\r\n * @example\r\n * ```ts\r\n * const group = createLayoutGroup({\r\n *   spring: { stiffness: 300, damping: 30 },\r\n * })\r\n *\r\n * // Register elements with same layoutId\r\n * group.register('card-1', cardElement)\r\n *\r\n * // After DOM changes\r\n * group.update()\r\n * ```\r\n */\r\nexport function createLayoutGroup(config: LayoutAnimationConfig = {}): LayoutGroup {\r\n  const {\r\n    spring: defaultSpring = { stiffness: 300, damping: 30 },\r\n    onAnimationStart,\r\n    onAnimationComplete,\r\n    crossfade = false,\r\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n    transition: _transition = {},\r\n  } = config\r\n\r\n  const elements = new Map<string, SharedLayoutElement[]>()\r\n  const previousMeasurements = new Map<string, LayoutMeasurement>()\r\n\r\n  const register = (id: string, element: HTMLElement): void => {\r\n    if (!elements.has(id)) {\r\n      elements.set(id, [])\r\n    }\r\n\r\n    const existing = elements.get(id)!\r\n    const alreadyRegistered = existing.some(e => e.element === element)\r\n\r\n    if (!alreadyRegistered) {\r\n      const measurement = measureElement(element)\r\n      existing.push({\r\n        id,\r\n        element,\r\n        measurement,\r\n        spring: null,\r\n        isAnimating: false,\r\n        pendingRafId: null,\r\n      })\r\n\r\n      // Store measurement for future animations\r\n      if (!previousMeasurements.has(id)) {\r\n        previousMeasurements.set(id, measurement)\r\n      }\r\n    }\r\n  }\r\n\r\n  const unregister = (id: string, element: HTMLElement): void => {\r\n    const group = elements.get(id)\r\n    if (!group) return\r\n\r\n    const index = group.findIndex(e => e.element === element)\r\n    if (index !== -1) {\r\n      const entry = group[index]!\r\n\r\n      // Store final measurement before removal\r\n      previousMeasurements.set(id, measureElement(element))\r\n\r\n      // Cancel pending RAF to prevent memory leak\r\n      if (entry.pendingRafId !== null) {\r\n        cancelAnimationFrame(entry.pendingRafId)\r\n        entry.pendingRafId = null\r\n      }\r\n\r\n      // Cleanup spring\r\n      entry.spring?.destroy()\r\n      group.splice(index, 1)\r\n\r\n      if (group.length === 0) {\r\n        elements.delete(id)\r\n      }\r\n    }\r\n  }\r\n\r\n  const animateElement = (\r\n    entry: SharedLayoutElement,\r\n    from: LayoutMeasurement,\r\n    to: LayoutMeasurement\r\n  ): void => {\r\n    // Cleanup previous animation\r\n    entry.spring?.destroy()\r\n\r\n    // Create spring with initial values\r\n    const initialValues: Record<string, number> = {\r\n      x: from.x,\r\n      y: from.y,\r\n      width: from.width,\r\n      height: from.height,\r\n    }\r\n\r\n    if (crossfade) {\r\n      initialValues.opacity = from.opacity ?? 1\r\n    }\r\n\r\n    if (from.borderRadius !== undefined) {\r\n      initialValues.borderRadius = from.borderRadius\r\n    }\r\n\r\n    entry.spring = createSpringGroup(initialValues, defaultSpring)\r\n    entry.isAnimating = true\r\n\r\n    onAnimationStart?.(entry.id)\r\n\r\n    entry.spring.subscribe((values: Record<string, number>) => {\r\n      applyTransform(entry.element, from, to, values)\r\n    })\r\n\r\n    // Set target values\r\n    const targetValues: Record<string, number> = {\r\n      x: to.x,\r\n      y: to.y,\r\n      width: to.width,\r\n      height: to.height,\r\n    }\r\n\r\n    if (crossfade) {\r\n      targetValues.opacity = to.opacity ?? 1\r\n    }\r\n\r\n    if (to.borderRadius !== undefined) {\r\n      targetValues.borderRadius = to.borderRadius\r\n    }\r\n\r\n    entry.spring.set(targetValues)\r\n\r\n    // Check for animation completion\r\n    const checkComplete = () => {\r\n      entry.pendingRafId = null\r\n\r\n      if (entry.spring && !entry.spring.isAnimating()) {\r\n        entry.isAnimating = false\r\n        resetTransform(entry.element)\r\n        onAnimationComplete?.(entry.id)\r\n      } else if (entry.isAnimating) {\r\n        entry.pendingRafId = requestAnimationFrame(checkComplete)\r\n      }\r\n    }\r\n\r\n    entry.pendingRafId = requestAnimationFrame(checkComplete)\r\n  }\r\n\r\n  const update = (): void => {\r\n    for (const [id, group] of elements) {\r\n      for (const entry of group) {\r\n        const previousMeasurement = previousMeasurements.get(id)\r\n        const currentMeasurement = measureElement(entry.element)\r\n\r\n        // Check if position/size changed\r\n        if (previousMeasurement) {\r\n          const hasChanged =\r\n            previousMeasurement.x !== currentMeasurement.x ||\r\n            previousMeasurement.y !== currentMeasurement.y ||\r\n            previousMeasurement.width !== currentMeasurement.width ||\r\n            previousMeasurement.height !== currentMeasurement.height\r\n\r\n          if (hasChanged) {\r\n            animateElement(entry, previousMeasurement, currentMeasurement)\r\n          }\r\n        }\r\n\r\n        // Update stored measurement\r\n        entry.measurement = currentMeasurement\r\n        previousMeasurements.set(id, currentMeasurement)\r\n      }\r\n    }\r\n  }\r\n\r\n  const forceUpdate = (): void => {\r\n    // Re-measure all elements\r\n    for (const [id, group] of elements) {\r\n      for (const entry of group) {\r\n        entry.measurement = measureElement(entry.element)\r\n        previousMeasurements.set(id, entry.measurement)\r\n      }\r\n    }\r\n  }\r\n\r\n  const destroy = (): void => {\r\n    for (const group of elements.values()) {\r\n      for (const entry of group) {\r\n        // Cancel pending RAF to prevent memory leak\r\n        if (entry.pendingRafId !== null) {\r\n          cancelAnimationFrame(entry.pendingRafId)\r\n          entry.pendingRafId = null\r\n        }\r\n        entry.spring?.destroy()\r\n        resetTransform(entry.element)\r\n      }\r\n    }\r\n    elements.clear()\r\n    previousMeasurements.clear()\r\n  }\r\n\r\n  return {\r\n    register,\r\n    unregister,\r\n    update,\r\n    forceUpdate,\r\n    destroy,\r\n  }\r\n}\r\n\r\n// ============ Shared Layout Context ============\r\n\r\nlet groupIdCounter = 0\r\n\r\n/**\r\n * Create a shared layout context for managing multiple layout groups\r\n *\r\n * @example\r\n * ```ts\r\n * const context = createSharedLayoutContext()\r\n *\r\n * // Create groups for different animation contexts\r\n * const listGroup = context.createGroup('list')\r\n * const cardGroup = context.createGroup('cards')\r\n *\r\n * // Register elements\r\n * listGroup.register('item-1', element1)\r\n * cardGroup.register('card-1', element2)\r\n *\r\n * // After route change or DOM update\r\n * context.updateAll()\r\n * ```\r\n */\r\nexport function createSharedLayoutContext(): SharedLayoutContext {\r\n  const groups = new Map<string, LayoutGroup>()\r\n\r\n  return {\r\n    createGroup(id?: string) {\r\n      const groupId = id ?? `layout-group-${groupIdCounter++}`\r\n      const group = createLayoutGroup()\r\n      groups.set(groupId, group)\r\n      return group\r\n    },\r\n\r\n    getGroup(id: string) {\r\n      return groups.get(id)\r\n    },\r\n\r\n    updateAll() {\r\n      for (const group of groups.values()) {\r\n        group.update()\r\n      }\r\n    },\r\n\r\n    destroy() {\r\n      for (const group of groups.values()) {\r\n        group.destroy()\r\n      }\r\n      groups.clear()\r\n    },\r\n  }\r\n}\r\n\r\n// ============ Auto Layout Observer ============\r\n\r\n/**\r\n * Configuration for auto layout observer\r\n */\r\nexport interface AutoLayoutConfig extends LayoutAnimationConfig {\r\n  /** Root element to observe (default: document.body) */\r\n  root?: HTMLElement\r\n  /** Attribute name for layout ID (default: 'data-layout-id') */\r\n  attribute?: string\r\n  /** Debounce time for mutations (ms) */\r\n  debounce?: number\r\n}\r\n\r\n/**\r\n * Create auto layout observer that automatically animates\r\n * elements with layoutId attribute\r\n *\r\n * @example\r\n * ```html\r\n * <div data-layout-id=\"card-1\">Content</div>\r\n * ```\r\n *\r\n * ```ts\r\n * const observer = createAutoLayout({\r\n *   spring: { stiffness: 200, damping: 20 },\r\n * })\r\n *\r\n * // Elements with data-layout-id will automatically animate\r\n * // when their position changes\r\n *\r\n * observer.destroy() // Cleanup when done\r\n * ```\r\n */\r\nexport function createAutoLayout(config: AutoLayoutConfig = {}): {\r\n  update(): void\r\n  forceUpdate(): void\r\n  destroy(): void\r\n} {\r\n  const {\r\n    root = typeof document !== 'undefined' ? document.body : null,\r\n    attribute = 'data-layout-id',\r\n    debounce: debounceTime = 0,\r\n    ...layoutConfig\r\n  } = config\r\n\r\n  if (!root) {\r\n    return {\r\n      update: () => {},\r\n      forceUpdate: () => {},\r\n      destroy: () => {},\r\n    }\r\n  }\r\n\r\n  const group = createLayoutGroup(layoutConfig)\r\n  let observer: MutationObserver | null = null\r\n  let resizeObserver: ResizeObserver | null = null\r\n  let debounceTimer: ReturnType<typeof setTimeout> | null = null\r\n\r\n  const scanAndRegister = () => {\r\n    const elements = root.querySelectorAll(`[${attribute}]`)\r\n    elements.forEach((el) => {\r\n      const id = el.getAttribute(attribute)\r\n      if (id && el instanceof HTMLElement) {\r\n        group.register(id, el)\r\n      }\r\n    })\r\n  }\r\n\r\n  const debouncedUpdate = () => {\r\n    if (debounceTimer) {\r\n      clearTimeout(debounceTimer)\r\n    }\r\n\r\n    if (debounceTime > 0) {\r\n      debounceTimer = setTimeout(() => {\r\n        scanAndRegister()\r\n        group.update()\r\n      }, debounceTime)\r\n    } else {\r\n      scanAndRegister()\r\n      group.update()\r\n    }\r\n  }\r\n\r\n  // Initial scan\r\n  scanAndRegister()\r\n\r\n  // Observe DOM changes\r\n  observer = new MutationObserver((mutations) => {\r\n    let shouldUpdate = false\r\n\r\n    for (const mutation of mutations) {\r\n      if (mutation.type === 'childList') {\r\n        // Check added nodes\r\n        mutation.addedNodes.forEach((node) => {\r\n          if (node instanceof HTMLElement) {\r\n            if (node.hasAttribute(attribute)) {\r\n              shouldUpdate = true\r\n            }\r\n            // Check descendants\r\n            if (node.querySelector(`[${attribute}]`)) {\r\n              shouldUpdate = true\r\n            }\r\n          }\r\n        })\r\n\r\n        // Check removed nodes\r\n        mutation.removedNodes.forEach((node) => {\r\n          if (node instanceof HTMLElement) {\r\n            const id = node.getAttribute(attribute)\r\n            if (id) {\r\n              group.unregister(id, node)\r\n            }\r\n          }\r\n        })\r\n      }\r\n\r\n      if (mutation.type === 'attributes' && mutation.attributeName === attribute) {\r\n        shouldUpdate = true\r\n      }\r\n    }\r\n\r\n    if (shouldUpdate) {\r\n      debouncedUpdate()\r\n    }\r\n  })\r\n\r\n  observer.observe(root, {\r\n    childList: true,\r\n    subtree: true,\r\n    attributes: true,\r\n    attributeFilter: [attribute],\r\n  })\r\n\r\n  // Observe resize changes\r\n  resizeObserver = new ResizeObserver(() => {\r\n    debouncedUpdate()\r\n  })\r\n\r\n  resizeObserver.observe(root)\r\n\r\n  return {\r\n    update: () => {\r\n      scanAndRegister()\r\n      group.update()\r\n    },\r\n\r\n    forceUpdate: () => {\r\n      scanAndRegister()\r\n      group.forceUpdate()\r\n    },\r\n\r\n    destroy: () => {\r\n      if (debounceTimer) {\r\n        clearTimeout(debounceTimer)\r\n      }\r\n      observer?.disconnect()\r\n      resizeObserver?.disconnect()\r\n      group.destroy()\r\n    },\r\n  }\r\n}\r\n","/**\r\n * MotionValue - High-performance animated value without React re-renders\r\n *\r\n * Unlike React state, MotionValue updates don't trigger component re-renders.\r\n * This makes it ideal for high-frequency animations like drag, scroll, and gestures.\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n *\r\n * // Subscribe to changes (no React re-render)\r\n * x.on('change', (value) => {\r\n *   element.style.transform = `translateX(${value}px)`\r\n * })\r\n *\r\n * // Update value\r\n * x.set(100)  // Triggers spring animation\r\n * x.jump(100) // Instant update, no animation\r\n * ```\r\n */\r\n\r\nimport { createSpringValue } from './spring-value.js'\r\nimport type { SpringConfig } from '../types.js'\r\n\r\nexport type MotionValueSubscriber<T> = (value: T) => void\r\nexport type MotionValueEvent = 'change' | 'animationStart' | 'animationEnd' | 'animationComplete' | 'animationCancel'\r\n\r\nexport interface MotionValueOptions {\r\n  /** Spring configuration for animated transitions */\r\n  spring?: SpringConfig\r\n}\r\n\r\n/**\r\n * MotionValue class - Performant animated values\r\n *\r\n * Key advantages over React state:\r\n * - No re-renders on value change\r\n * - Direct DOM manipulation for 60fps animations\r\n * - Chainable with useTransform\r\n * - Memory efficient with automatic cleanup\r\n */\r\nexport class MotionValue<T = number> {\r\n  private _value: T\r\n  private _velocity: number = 0\r\n  private _subscribers: Set<MotionValueSubscriber<T>> = new Set()\r\n  private _eventListeners: Map<MotionValueEvent, Set<() => void>> = new Map()\r\n  private _springValue: ReturnType<typeof createSpringValue> | null = null\r\n  private _springConfig: SpringConfig\r\n  private _isAnimating: boolean = false\r\n  private _destroyed: boolean = false\r\n  private _checkEndRafId: number | null = null\r\n\r\n  constructor(initialValue: T, options: MotionValueOptions = {}) {\r\n    this._value = initialValue\r\n    this._springConfig = options.spring ?? { stiffness: 100, damping: 15 }\r\n\r\n    // Initialize spring for numeric values\r\n    if (typeof initialValue === 'number') {\r\n      this._springValue = createSpringValue(initialValue as number, {\r\n        ...this._springConfig,\r\n        onUpdate: (v: number) => {\r\n          if (this._destroyed) return\r\n          this._value = v as T\r\n          this._velocity = this._springValue?.getVelocity() ?? 0\r\n          this._notify()\r\n        },\r\n      })\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Get current value synchronously\r\n   */\r\n  get(): T {\r\n    return this._value\r\n  }\r\n\r\n  /**\r\n   * Get current velocity (for numeric values)\r\n   */\r\n  getVelocity(): number {\r\n    return this._velocity\r\n  }\r\n\r\n  /**\r\n   * Check if currently animating\r\n   */\r\n  isAnimating(): boolean {\r\n    return this._isAnimating\r\n  }\r\n\r\n  /**\r\n   * Check if this MotionValue has been destroyed\r\n   */\r\n  isDestroyed(): boolean {\r\n    return this._destroyed\r\n  }\r\n\r\n  /**\r\n   * Set value with spring animation\r\n   */\r\n  set(newValue: T, animate: boolean = true): void {\r\n    if (this._destroyed) return\r\n\r\n    // Cancel any pending animation end check to prevent memory leak\r\n    if (this._checkEndRafId !== null) {\r\n      cancelAnimationFrame(this._checkEndRafId)\r\n      this._checkEndRafId = null\r\n    }\r\n\r\n    if (typeof newValue === 'number' && this._springValue && animate) {\r\n      this._isAnimating = true\r\n      this._emit('animationStart')\r\n\r\n      this._springValue.set(newValue as number)\r\n\r\n      // Check for animation end with proper cleanup\r\n      const checkEnd = () => {\r\n        // Bail out if destroyed during animation\r\n        if (this._destroyed) {\r\n          this._checkEndRafId = null\r\n          return\r\n        }\r\n\r\n        if (this._springValue && Math.abs(this._springValue.getVelocity()) < 0.01) {\r\n          this._isAnimating = false\r\n          this._checkEndRafId = null\r\n          this._emit('animationEnd')\r\n        } else if (this._isAnimating) {\r\n          this._checkEndRafId = requestAnimationFrame(checkEnd)\r\n        } else {\r\n          this._checkEndRafId = null\r\n        }\r\n      }\r\n      this._checkEndRafId = requestAnimationFrame(checkEnd)\r\n    } else {\r\n      this._value = newValue\r\n      this._velocity = 0\r\n      this._notify()\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Instantly set value without animation\r\n   */\r\n  jump(newValue: T): void {\r\n    if (this._destroyed) return\r\n\r\n    this._value = newValue\r\n    this._velocity = 0\r\n\r\n    if (typeof newValue === 'number' && this._springValue) {\r\n      this._springValue.jump(newValue as number)\r\n    }\r\n\r\n    this._isAnimating = false\r\n    this._notify()\r\n  }\r\n\r\n  /**\r\n   * Stop any running animation at current position\r\n   */\r\n  stop(): void {\r\n    // Cancel pending RAF callback\r\n    if (this._checkEndRafId !== null) {\r\n      cancelAnimationFrame(this._checkEndRafId)\r\n      this._checkEndRafId = null\r\n    }\r\n\r\n    // Use stop() which halts at current position and resolves promise\r\n    if (this._springValue) {\r\n      this._springValue.stop()\r\n    }\r\n    this._isAnimating = false\r\n    this._emit('animationEnd')\r\n  }\r\n\r\n  /**\r\n   * Subscribe to value changes\r\n   * Returns unsubscribe function\r\n   */\r\n  subscribe(callback: MotionValueSubscriber<T>): () => void {\r\n    this._subscribers.add(callback)\r\n\r\n    // Immediately call with current value\r\n    callback(this._value)\r\n\r\n    return () => {\r\n      this._subscribers.delete(callback)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Add event listener\r\n   */\r\n  on(event: MotionValueEvent, callback: () => void): () => void {\r\n    if (!this._eventListeners.has(event)) {\r\n      this._eventListeners.set(event, new Set())\r\n    }\r\n    this._eventListeners.get(event)!.add(callback)\r\n\r\n    return () => {\r\n      this._eventListeners.get(event)?.delete(callback)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Update spring configuration\r\n   * Takes effect immediately on ongoing animations\r\n   */\r\n  setConfig(config: Partial<SpringConfig>): void {\r\n    this._springConfig = { ...this._springConfig, ...config }\r\n    // Update existing spring if present\r\n    if (this._springValue) {\r\n      this._springValue.setConfig(config)\r\n    }\r\n  }\r\n\r\n  /**\r\n   * Destroy and cleanup\r\n   */\r\n  destroy(): void {\r\n    this._destroyed = true\r\n\r\n    // Cancel pending RAF callback to prevent memory leak\r\n    if (this._checkEndRafId !== null) {\r\n      cancelAnimationFrame(this._checkEndRafId)\r\n      this._checkEndRafId = null\r\n    }\r\n\r\n    this._subscribers.clear()\r\n    this._eventListeners.clear()\r\n\r\n    if (this._springValue) {\r\n      this._springValue.destroy()\r\n      this._springValue = null\r\n    }\r\n  }\r\n\r\n  private _notify(): void {\r\n    this._subscribers.forEach((callback) => {\r\n      try {\r\n        callback(this._value)\r\n      } catch (e) {\r\n        console.error('MotionValue subscriber error:', e)\r\n      }\r\n    })\r\n    this._emit('change')\r\n  }\r\n\r\n  private _emit(event: MotionValueEvent): void {\r\n    this._eventListeners.get(event)?.forEach((callback) => {\r\n      try {\r\n        callback()\r\n      } catch (e) {\r\n        console.error(`MotionValue ${event} listener error:`, e)\r\n      }\r\n    })\r\n  }\r\n}\r\n\r\n/**\r\n * Create a new MotionValue\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n * const opacity = createMotionValue(1)\r\n * const scale = createMotionValue(1, { spring: { stiffness: 300, damping: 30 } })\r\n * ```\r\n */\r\nexport function createMotionValue<T = number>(\r\n  initialValue: T,\r\n  options?: MotionValueOptions\r\n): MotionValue<T> {\r\n  return new MotionValue(initialValue, options)\r\n}\r\n\r\n/**\r\n * Transform a MotionValue using a mapping function\r\n *\r\n * Creates a derived MotionValue that automatically updates\r\n * when the source value changes.\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n * const opacity = transformValue(x, (v) => 1 - v / 100)\r\n * const inverted = transformValue(x, (v) => -v)\r\n * ```\r\n */\r\nexport function transformValue<T, U>(\r\n  source: MotionValue<T>,\r\n  transform: (value: T) => U\r\n): MotionValue<U> {\r\n  const derived = new MotionValue<U>(transform(source.get()))\r\n\r\n  // Store unsubscribe function for cleanup\r\n  const unsubscribe = source.subscribe((value) => {\r\n    derived.jump(transform(value))\r\n  })\r\n\r\n  // Override destroy to clean up subscription (prevents memory leak)\r\n  const originalDestroy = derived.destroy.bind(derived)\r\n  derived.destroy = () => {\r\n    unsubscribe()\r\n    originalDestroy()\r\n  }\r\n\r\n  return derived\r\n}\r\n\r\n/**\r\n * Map a MotionValue from one range to another\r\n *\r\n * @example\r\n * ```ts\r\n * const x = createMotionValue(0)\r\n * // Map 0-100 to 0-1\r\n * const progress = mapRange(x, [0, 100], [0, 1])\r\n * // Map with extrapolation clamped\r\n * const clamped = mapRange(x, [0, 100], [0, 1], { clamp: true })\r\n * ```\r\n */\r\nexport function mapRange(\r\n  source: MotionValue<number>,\r\n  inputRange: [number, number],\r\n  outputRange: [number, number],\r\n  options: { clamp?: boolean } = {}\r\n): MotionValue<number> {\r\n  const [inMin, inMax] = inputRange\r\n  const [outMin, outMax] = outputRange\r\n  const inputDelta = inMax - inMin\r\n\r\n  return transformValue(source, (value) => {\r\n    // Guard against division by zero\r\n    if (inputDelta === 0) {\r\n      return outMin\r\n    }\r\n\r\n    let normalized = (value - inMin) / inputDelta\r\n\r\n    if (options.clamp) {\r\n      normalized = Math.max(0, Math.min(1, normalized))\r\n    }\r\n\r\n    return outMin + normalized * (outMax - outMin)\r\n  })\r\n}\r\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Measured box dimensions\n */\nexport interface MeasuredBox {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n/**\n * FLIP animation options\n */\nexport interface FlipOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to animate position */\n  position?: boolean\n  /** Whether to animate size */\n  size?: boolean\n  /** Callback when animation completes */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (progress: number) => void\n}\n\n/**\n * FLIP animation controller\n */\nexport interface FlipAnimation {\n  /** Play the FLIP animation */\n  play: () => Promise<void>\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Cancel the animation */\n  cancel: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n}\n\n/**\n * Measure the bounding box of an element\n */\nexport function measureElement(element: HTMLElement): MeasuredBox {\n  const rect = element.getBoundingClientRect()\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n  }\n}\n\n/**\n * Create a FLIP (First, Last, Invert, Play) animation.\n *\n * FLIP is a technique for animating layout changes performantly:\n * 1. First: Measure the element's initial position\n * 2. Last: Apply the change and measure final position\n * 3. Invert: Apply transforms to make it look like it's still in the first position\n * 4. Play: Animate the transforms to zero\n *\n * @example Basic FLIP\n * ```ts\n * // Measure first position\n * const first = measureElement(element)\n *\n * // Make layout change\n * element.classList.toggle('expanded')\n *\n * // Measure last position\n * const last = measureElement(element)\n *\n * // Create and play FLIP animation\n * const flip = createFlip(element, first, last)\n * await flip.play()\n * ```\n *\n * @example With options\n * ```ts\n * const flip = createFlip(element, first, last, {\n *   config: { stiffness: 300, damping: 30 },\n *   position: true,  // Animate position\n *   size: true,      // Animate size\n *   onComplete: () => console.log('Done!'),\n * })\n * ```\n */\nexport function createFlip(\n  element: HTMLElement,\n  first: MeasuredBox,\n  last: MeasuredBox,\n  options: FlipOptions = {}\n): FlipAnimation {\n  const {\n    config = {},\n    position = true,\n    size = true,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Calculate the inversion (how much to transform to get back to \"first\")\n  const deltaX = first.x - last.x\n  const deltaY = first.y - last.y\n  // Guard against division by zero (zero-sized elements)\n  const deltaWidth = last.width === 0 ? 1 : first.width / last.width\n  const deltaHeight = last.height === 0 ? 1 : first.height / last.height\n\n  let progress = 0\n  let isPlaying = false\n  let cancelled = false\n  let pendingRafId: number | null = null\n  let pendingTimeoutId: ReturnType<typeof setTimeout> | null = null\n  let resolvePlay: (() => void) | null = null\n\n  const spring = createSpringValue(0, config)\n\n  // Store original transform\n  const originalTransform = element.style.transform\n  const originalTransformOrigin = element.style.transformOrigin\n\n  // Set transform origin to top-left for size animations\n  if (size) {\n    element.style.transformOrigin = '0 0'\n  }\n\n  const applyTransform = (t: number) => {\n    progress = t\n    const invertedT = 1 - t\n\n    const transforms: string[] = []\n\n    if (position) {\n      transforms.push(`translate(${deltaX * invertedT}px, ${deltaY * invertedT}px)`)\n    }\n\n    if (size && (deltaWidth !== 1 || deltaHeight !== 1)) {\n      const scaleX = 1 + (deltaWidth - 1) * invertedT\n      const scaleY = 1 + (deltaHeight - 1) * invertedT\n      transforms.push(`scale(${scaleX}, ${scaleY})`)\n    }\n\n    element.style.transform = transforms.length > 0 ? transforms.join(' ') : ''\n    try {\n      onUpdate?.(t)\n    } catch (e) {\n      console.error('[SpringKit] FLIP onUpdate error:', e)\n    }\n  }\n\n  // Apply initial inversion\n  applyTransform(0)\n\n  const cleanup = () => {\n    // Restore original styles\n    element.style.transform = originalTransform\n    element.style.transformOrigin = originalTransformOrigin\n  }\n\n  return {\n    play: async () => {\n      if (cancelled) return\n\n      isPlaying = true\n\n      return new Promise<void>((resolve) => {\n        resolvePlay = resolve\n\n        const unsubscribe = spring.subscribe((value) => {\n          if (cancelled) {\n            unsubscribe()\n            resolvePlay = null\n            resolve()\n            return\n          }\n          applyTransform(value)\n        })\n\n        spring.set(1)\n\n        // Wait for animation to complete\n        const checkComplete = () => {\n          pendingRafId = null\n\n          if (cancelled) {\n            unsubscribe()\n            cleanup()\n            resolvePlay = null\n            resolve()\n            return\n          }\n\n          if (!spring.isAnimating()) {\n            isPlaying = false\n            unsubscribe()\n            cleanup()\n            try {\n              onComplete?.()\n            } catch (e) {\n              console.error('[SpringKit] FLIP onComplete error:', e)\n            }\n            resolvePlay = null\n            resolve()\n          } else {\n            pendingRafId = requestAnimationFrame(checkComplete)\n          }\n        }\n\n        pendingTimeoutId = setTimeout(() => {\n          pendingTimeoutId = null\n          checkComplete()\n        }, 16)\n      })\n    },\n\n    getProgress: () => progress,\n\n    cancel: () => {\n      cancelled = true\n      isPlaying = false\n\n      // Cancel pending RAF and timeout to prevent memory leak\n      if (pendingRafId !== null) {\n        cancelAnimationFrame(pendingRafId)\n        pendingRafId = null\n      }\n      if (pendingTimeoutId !== null) {\n        clearTimeout(pendingTimeoutId)\n        pendingTimeoutId = null\n      }\n\n      spring.stop()\n      cleanup()\n\n      // Resolve the play promise if it's pending\n      if (resolvePlay) {\n        resolvePlay()\n        resolvePlay = null\n      }\n    },\n\n    isAnimating: () => isPlaying,\n  }\n}\n\n/**\n * Higher-level helper that handles the full FLIP flow.\n * Automatically measures before/after states.\n *\n * @example\n * ```ts\n * await flip(element, () => {\n *   element.classList.toggle('expanded')\n * }, { config: { stiffness: 200 } })\n * ```\n */\nexport async function flip(\n  element: HTMLElement,\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure initial state\n  const first = measureElement(element)\n\n  // Last: apply mutation and measure final state\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetHeight\n\n  const last = measureElement(element)\n\n  // Invert & Play\n  const animation = createFlip(element, first, last, options)\n  await animation.play()\n}\n\n/**\n * Batch FLIP animations for multiple elements.\n * Useful when multiple elements change position together.\n *\n * @example\n * ```ts\n * await flipBatch(\n *   [card1, card2, card3],\n *   () => container.classList.toggle('grid'),\n *   { config: { stiffness: 150 } }\n * )\n * ```\n */\nexport async function flipBatch(\n  elements: HTMLElement[],\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure all elements\n  const firstStates = elements.map((el) => measureElement(el))\n\n  // Last: apply mutation\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  document.body.offsetHeight\n\n  // Measure all final states and create animations\n  const animations = elements.map((element, i) => {\n    const last = measureElement(element)\n    return createFlip(element, firstStates[i]!, last, options)\n  })\n\n  // Play all animations\n  await Promise.all(animations.map((anim) => anim.play()))\n}\n","import { useEffect, useRef, useState, useMemo } from 'react'\r\nimport { createSpringGroup } from '../../../index.js'\r\nimport type { SpringConfig, SpringGroup } from '../../../types.js'\r\n\r\n/**\r\n * Animated values type\r\n */\r\nexport type AnimatedValues<T extends Record<string, number>> = {\r\n  [K in keyof T]: number\r\n}\r\n\r\n/**\r\n * Hook for animating multiple values with springs\r\n *\r\n * @param values - Target values object\r\n * @param config - Spring configuration\r\n * @returns Current animated values\r\n *\r\n * @example\r\n * ```tsx\r\n * function Box() {\r\n *   const [isOpen, setIsOpen] = useState(false)\r\n *\r\n *   const style = useSpring({\r\n *     width: isOpen ? 300 : 100,\r\n *     height: isOpen ? 200 : 100,\r\n *     opacity: isOpen ? 1 : 0.5,\r\n *   }, {\r\n *     stiffness: 100,\r\n *     damping: 10,\r\n *   })\r\n *\r\n *   return (\r\n *     <div\r\n *       onClick={() => setIsOpen(!isOpen)}\r\n *       style={{\r\n *         width: style.width,\r\n *         height: style.height,\r\n *         opacity: style.opacity,\r\n *       }}\r\n *     />\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useSpring<T extends Record<string, number>>(\r\n  values: T,\r\n  config: Partial<SpringConfig> = {}\r\n): AnimatedValues<T> {\r\n  const springRef = useRef<SpringGroup<T> | null>(null)\r\n  const [currentValues, setCurrentValues] = useState<T>(values)\r\n  const isFirstRender = useRef(true)\r\n  const isMounted = useRef(false)\r\n  const prevValuesRef = useRef<T>(values)\r\n  const configRef = useRef(config)\r\n\r\n  // Memoize values to detect actual changes without JSON.stringify on every render\r\n  const valuesKey = useMemo(() => {\r\n    const keys = Object.keys(values).sort()\r\n    return keys.map(k => `${k}:${values[k]}`).join('|')\r\n  }, [values])\r\n\r\n  // Keep config ref updated\r\n  configRef.current = config\r\n\r\n  // Initialize spring group with ACTUAL initial values (not 0)\r\n  if (!springRef.current) {\r\n    springRef.current = createSpringGroup(values, config)\r\n  }\r\n\r\n  // Subscribe to spring updates after mount\r\n  useEffect(() => {\r\n    isMounted.current = true\r\n    const spring = springRef.current\r\n    if (!spring) return\r\n\r\n    const unsubscribe = spring.subscribe((newValues) => {\r\n      if (isMounted.current) {\r\n        setCurrentValues(newValues)\r\n      }\r\n    })\r\n\r\n    return () => {\r\n      isMounted.current = false\r\n      unsubscribe()\r\n    }\r\n  }, [])\r\n\r\n  // Update when values change (skip first render since we initialized with values)\r\n  useEffect(() => {\r\n    if (isFirstRender.current) {\r\n      isFirstRender.current = false\r\n      return\r\n    }\r\n\r\n    // Check if any value actually changed\r\n    const prev = prevValuesRef.current\r\n    const hasChanged = Object.keys(values).some(\r\n      key => values[key] !== prev[key]\r\n    )\r\n\r\n    if (hasChanged) {\r\n      springRef.current?.set(values, configRef.current)\r\n      prevValuesRef.current = values\r\n    }\r\n  }, [valuesKey, values])\r\n\r\n  // Cleanup on unmount: stop animations but don't destroy\r\n  // (Springs are reused across React StrictMode remounts)\r\n  useEffect(() => {\r\n    return () => springRef.current?.stop()\r\n  }, [])\r\n\r\n  return currentValues as AnimatedValues<T>\r\n}\r\n","import { useEffect, useRef } from 'react'\nimport { createSpringValue } from '../../../index.js'\nimport type { SpringConfig, SpringValue } from '../../../types.js'\n\n/**\n * Hook for creating a spring value\n *\n * @param initial - Initial value\n * @param config - Spring configuration\n * @returns Spring value controller\n *\n * @example\n * ```tsx\n * function ProgressBar({ value }) {\n *   const progress = useSpringValue(value, {\n *     stiffness: 100,\n *     damping: 20,\n *   })\n *\n *   useEffect(() => {\n *     progress.set(value)\n *   }, [value])\n *\n *   return (\n *     <div className=\"progress-container\">\n *       <div\n *         className=\"progress-bar\"\n *         style={{ width: `${progress.get()}%` }}\n *       />\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useSpringValue(\n  initial: number,\n  config: SpringConfig = {}\n): SpringValue {\n  const springRef = useRef<SpringValue | null>(null)\n\n  if (!springRef.current) {\n    springRef.current = createSpringValue(initial, config)\n  }\n\n  useEffect(() => {\n    return () => springRef.current?.destroy()\n  }, [])\n\n  return springRef.current\n}\n","import { useEffect, useRef, useState, useCallback } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Spring item configuration\n */\nexport interface SpringItem<T> {\n  values: T\n  from?: Partial<T>\n  delay?: number\n  config?: Partial<SpringConfig>\n}\n\n/**\n * Hook for managing multiple spring animations\n *\n * @param count - Number of springs\n * @param items - Function that returns spring config for each index\n * @param defaultConfig - Default spring configuration\n * @returns Array of animated values\n *\n * @example\n * ```tsx\n * function AnimatedList({ items }) {\n *   const springs = useSprings(\n *     items.length,\n *     (index) => ({\n *       opacity: 1,\n *       y: 0,\n *       from: { opacity: 0, y: 20 },\n *       delay: index * 50,\n *     })\n *   )\n *\n *   return (\n *     <ul>\n *       {items.map((item, index) => (\n *         <li\n *           key={item.id}\n *           style={{\n *             opacity: springs[index].opacity,\n *             transform: `translateY(${springs[index].y}px)`,\n *           }}\n *         >\n *           {item.name}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useSprings<T extends Record<string, number>>(\n  count: number,\n  items: (index: number) => SpringItem<T>,\n  defaultConfig: Partial<SpringConfig> = {}\n): Array<{ [K in keyof T]: number }> {\n  const springsRef = useRef<Array<ReturnType<typeof createSpringGroup<T>>>>([])\n  const isMountedRef = useRef(false)\n\n  // Use ref to always have access to the latest items function\n  // This prevents stale closure issues while avoiding infinite effect loops\n  const itemsRef = useRef(items)\n  itemsRef.current = items\n\n  // Initialize current values state based on initial items\n  const getInitialValues = useCallback(() => {\n    const result: Array<{ [K in keyof T]: number }> = []\n    for (let i = 0; i < count; i++) {\n      const item = itemsRef.current(i)\n      result.push((item.from ?? item.values) as { [K in keyof T]: number })\n    }\n    return result\n  }, [count])\n\n  const [currentValues, setCurrentValues] = useState<Array<{ [K in keyof T]: number }>>(getInitialValues)\n\n  // Initialize springs\n  useEffect(() => {\n    isMountedRef.current = true\n\n    // Clean up old springs\n    springsRef.current.forEach((s) => s?.destroy())\n    springsRef.current = []\n\n    // Track timeouts for cleanup to prevent memory leaks\n    const timeoutIds: ReturnType<typeof setTimeout>[] = []\n    const unsubscribers: (() => void)[] = []\n\n    // Create new springs\n    for (let i = 0; i < count; i++) {\n      const item = itemsRef.current(i)\n      const initialValues = (item.from ?? item.values) as T\n      const spring = createSpringGroup(initialValues, {\n        ...defaultConfig,\n        ...item.config,\n      })\n\n      springsRef.current.push(spring)\n\n      // Subscribe with mount check\n      const index = i\n      const unsubscribe = spring.subscribe((values) => {\n        if (isMountedRef.current) {\n          setCurrentValues(prev => {\n            const next = [...prev]\n            next[index] = values as { [K in keyof T]: number }\n            return next\n          })\n        }\n      })\n      unsubscribers.push(unsubscribe)\n\n      // Start animation with delay (track timeout for cleanup)\n      const timeoutId = setTimeout(() => {\n        spring.set(item.values as Partial<T>)\n      }, item.delay ?? 0)\n      timeoutIds.push(timeoutId)\n    }\n\n    return () => {\n      isMountedRef.current = false\n      // Unsubscribe all\n      unsubscribers.forEach(unsub => unsub())\n      // Clear all pending timeouts to prevent memory leaks\n      timeoutIds.forEach(clearTimeout)\n      springsRef.current.forEach((s) => s?.destroy())\n    }\n  }, [count, defaultConfig])\n\n  return currentValues\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { createSpringValue, type SpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Hook for creating trail animations with staggered delays\n *\n * @param count - Number of items in the trail\n * @param values - Target values object (all numeric properties will be animated)\n * @param config - Spring configuration\n * @returns Array of animated value objects\n *\n * @example\n * ```tsx\n * function TrailList({ items, isVisible }) {\n *   const trail = useTrail(items.length, {\n *     opacity: isVisible ? 1 : 0,\n *     x: isVisible ? 0 : -20,\n *   }, { stiffness: 120, damping: 14 })\n *\n *   return (\n *     <ul>\n *       {trail.map((style, index) => (\n *         <li\n *           key={items[index].id}\n *           style={{\n *             opacity: style.opacity,\n *             transform: `translateX(${style.x}px)`,\n *           }}\n *         >\n *           {items[index].name}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useTrail<T extends Record<string, number>>(\n  count: number,\n  values: T,\n  config: SpringConfig = {}\n): Array<T> {\n  // Store springs for each item and each property\n  const springsRef = useRef<Map<string, SpringValue[]> | null>(null)\n  const isMountedRef = useRef(false)\n  const [currentValues, setCurrentValues] = useState<T[]>(() =>\n    Array.from({ length: count }, () => ({ ...values }))\n  )\n  const isFirstRender = useRef(true)\n  const prevValuesRef = useRef<string>(JSON.stringify(values))\n  // Track timeouts for cleanup to prevent memory leaks\n  const timeoutsRef = useRef<ReturnType<typeof setTimeout>[]>([])\n\n  // Initialize springs\n  useEffect(() => {\n    isMountedRef.current = true\n    const keys = Object.keys(values)\n    const springs = new Map<string, SpringValue[]>()\n\n    // Create springs for each property and each item\n    keys.forEach(key => {\n      const propSprings: SpringValue[] = []\n      const initialValue = values[key] as number\n      for (let i = 0; i < count; i++) {\n        const spring = createSpringValue(initialValue, config)\n        propSprings.push(spring)\n      }\n      springs.set(key, propSprings)\n    })\n\n    springsRef.current = springs\n\n    // Subscribe to all springs and update state\n    const unsubscribers: (() => void)[] = []\n\n    springs.forEach((propSprings, _key) => {\n      propSprings.forEach((spring, index) => {\n        const unsub = spring.subscribe(() => {\n          if (!isMountedRef.current) return\n          setCurrentValues(prev => {\n            const next = [...prev]\n            if (!next[index]) {\n              next[index] = { ...values }\n            }\n            // Get current values from all springs for this index\n            const newItem = { ...next[index] } as T\n            springs.forEach((ps, k) => {\n              (newItem as Record<string, number>)[k] = ps[index]!.get()\n            })\n            next[index] = newItem\n            return next\n          })\n        })\n        unsubscribers.push(unsub)\n      })\n    })\n\n    return () => {\n      isMountedRef.current = false\n      unsubscribers.forEach(unsub => unsub())\n      // Stop animations but don't destroy springs\n      // (Springs are reused across React StrictMode remounts)\n      springs.forEach(propSprings => {\n        propSprings.forEach(spring => spring.stop())\n      })\n    }\n  }, [count]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Update springs when values change with staggered delay\n  useEffect(() => {\n    if (!springsRef.current) return\n\n    const currentValuesString = JSON.stringify(values)\n    if (isFirstRender.current) {\n      isFirstRender.current = false\n      prevValuesRef.current = currentValuesString\n      return\n    }\n\n    if (currentValuesString === prevValuesRef.current) return\n    prevValuesRef.current = currentValuesString\n\n    const keys = Object.keys(values)\n    const staggerDelay = 50 // ms between each item\n\n    // Clear any pending timeouts from previous animation\n    timeoutsRef.current.forEach(clearTimeout)\n    timeoutsRef.current = []\n\n    keys.forEach(key => {\n      const propSprings = springsRef.current?.get(key)\n      if (!propSprings) return\n\n      const targetValue = values[key] as number\n      propSprings.forEach((spring, index) => {\n        const timeoutId = setTimeout(() => {\n          spring.set(targetValue, config)\n        }, index * staggerDelay)\n        timeoutsRef.current.push(timeoutId)\n      })\n    })\n\n    // Cleanup function for this effect\n    return () => {\n      timeoutsRef.current.forEach(clearTimeout)\n      timeoutsRef.current = []\n    }\n  }, [JSON.stringify(values), config.stiffness, config.damping]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  return currentValues\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { createDragSpring } from '../../../index.js'\nimport type { DragSpring, DragSpringConfig } from '../../../types.js'\n\n/**\n * Drag API interface\n */\nexport interface DragAPI {\n  /** Ref callback to attach to your draggable element */\n  ref: (el: HTMLElement | null) => void\n  /** Set position */\n  set(values: { x?: number; y?: number }): void\n  /** Reset to initial position */\n  reset(): void\n  /** Whether currently dragging */\n  isDragging: boolean\n}\n\n/**\n * Hook for creating drag interactions\n *\n * @param config - Drag spring configuration\n * @returns Tuple of [position, api]\n *\n * @example\n * ```tsx\n * function DraggableCard() {\n *   const [{ x, y }, api] = useDrag({\n *     bounds: { left: 0, right: 300, top: 0, bottom: 200 },\n *     rubberBand: true,\n *     stiffness: 200,\n *     damping: 20,\n *   })\n *\n *   return (\n *     <div\n *       ref={api.ref}\n *       style={{\n *         transform: `translate(${x}px, ${y}px)`,\n *         width: 100,\n *         height: 100,\n *         background: '#3b82f6',\n *       }}\n *     >\n *       Drag me!\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useDrag(config: DragSpringConfig = {}): [\n  { x: number; y: number },\n  DragAPI\n] {\n  const dragSpringRef = useRef<DragSpring | null>(null)\n  const positionRef = useRef({ x: 0, y: 0 })\n  const [element, setElement] = useState<HTMLElement | null>(null)\n  const [isDragging, setIsDragging] = useState(false)\n  const [, forceUpdate] = useState({})\n  const configRef = useRef(config)\n\n  // Keep config ref updated\n  configRef.current = config\n\n  // Ref callback - triggers re-render when element changes\n  const refCallback = (el: HTMLElement | null) => {\n    setElement(el)\n  }\n\n  // Setup/cleanup drag spring when element changes\n  useEffect(() => {\n    // Cleanup previous instance\n    if (dragSpringRef.current) {\n      dragSpringRef.current.destroy()\n      dragSpringRef.current = null\n    }\n\n    if (element) {\n      // Create drag spring with the element\n      dragSpringRef.current = createDragSpring(element, {\n        ...configRef.current,\n        onDragStart: (e) => {\n          setIsDragging(true)\n          configRef.current.onDragStart?.(e)\n        },\n        onDragEnd: (x, y, velocity) => {\n          setIsDragging(false)\n          configRef.current.onDragEnd?.(x, y, velocity)\n        },\n        onUpdate: (x, y) => {\n          positionRef.current = { x, y }\n          forceUpdate({})\n          configRef.current.onUpdate?.(x, y)\n        },\n      })\n    }\n\n    return () => {\n      dragSpringRef.current?.destroy()\n      dragSpringRef.current = null\n    }\n  }, [element])\n\n  // API methods with validation\n  const set = (values: { x?: number; y?: number }) => {\n    // Validate input values - skip NaN/Infinity\n    const rawX = values.x ?? positionRef.current.x\n    const rawY = values.y ?? positionRef.current.y\n\n    // Guard against NaN/Infinity\n    const x = Number.isFinite(rawX) ? rawX : positionRef.current.x\n    const y = Number.isFinite(rawY) ? rawY : positionRef.current.y\n\n    dragSpringRef.current?.setPosition(x, y)\n  }\n\n  const reset = () => {\n    dragSpringRef.current?.reset()\n    positionRef.current = { x: 0, y: 0 }\n    forceUpdate({})\n  }\n\n  return [positionRef.current, { ref: refCallback, set, reset, isDragging }]\n}\n","import { useRef } from 'react'\r\n\r\n/**\r\n * Gesture state\r\n */\r\nexport interface GestureState {\r\n  x: number\r\n  y: number\r\n  scale?: number\r\n  angle?: number\r\n}\r\n\r\n/**\r\n * Gesture handlers\r\n */\r\nexport interface GestureHandlers {\r\n  onDrag?: (state: GestureState) => void\r\n  onPinch?: (state: GestureState) => void\r\n  onRotate?: (state: GestureState) => void\r\n}\r\n\r\n/**\r\n * Gesture bind function return type\r\n */\r\nexport interface GestureBind {\r\n  onPointerDown: (e: React.PointerEvent) => void\r\n  onPointerMove: (e: React.PointerEvent) => void\r\n  onPointerUp: (e: React.PointerEvent) => void\r\n  onPointerCancel: (e: React.PointerEvent) => void\r\n}\r\n\r\n/**\r\n * Hook for gesture interactions\r\n *\r\n * @param handlers - Gesture event handlers\r\n * @returns Bind function for attaching to elements\r\n *\r\n * @example\r\n * ```tsx\r\n * function GestureCard() {\r\n *   const [style, setStyle] = useState({\r\n *     x: 0,\r\n *     y: 0,\r\n *     scale: 1,\r\n *     rotation: 0,\r\n *   })\r\n *\r\n *   const bind = useGesture({\r\n *     onDrag: ({ x, y }) => {\r\n *       setStyle(s => ({ ...s, x, y }))\r\n *     },\r\n *     onPinch: ({ scale }) => {\r\n *       setStyle(s => ({ ...s, scale }))\r\n *     },\r\n *   })\r\n *\r\n *   return (\r\n *     <div\r\n *       {...bind()}\r\n *       style={{\r\n *         transform: `translate(${style.x}px, ${style.y}px) scale(${style.scale})`,\r\n *       }}\r\n *     >\r\n *       Gesture enabled card\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useGesture(handlers: GestureHandlers): GestureBind {\r\n  const stateRef = useRef({\r\n    isDragging: false,\r\n    startX: 0,\r\n    startY: 0,\r\n    currentX: 0,\r\n    currentY: 0,\r\n  })\r\n\r\n  const onPointerDown = (e: React.PointerEvent) => {\r\n    stateRef.current = {\r\n      isDragging: true,\r\n      startX: e.clientX,\r\n      startY: e.clientY,\r\n      currentX: e.clientX,\r\n      currentY: e.clientY,\r\n    }\r\n  }\r\n\r\n  const onPointerMove = (e: React.PointerEvent) => {\r\n    if (!stateRef.current.isDragging) return\r\n\r\n    const deltaX = e.clientX - stateRef.current.startX\r\n    const deltaY = e.clientY - stateRef.current.startY\r\n\r\n    handlers.onDrag?.({ x: deltaX, y: deltaY })\r\n\r\n    stateRef.current.currentX = e.clientX\r\n    stateRef.current.currentY = e.clientY\r\n  }\r\n\r\n  const onPointerUp = () => {\r\n    stateRef.current.isDragging = false\r\n  }\r\n\r\n  const onPointerCancel = () => {\r\n    stateRef.current.isDragging = false\r\n  }\r\n\r\n  return {\r\n    onPointerDown,\r\n    onPointerMove,\r\n    onPointerUp,\r\n    onPointerCancel,\r\n  }\r\n}\r\n","import { createContext } from 'react'\n\n/**\n * Context value for presence state in AnimatePresence\n */\nexport interface PresenceContextValue {\n  /** Unique ID for this presence instance */\n  id: string\n  /** Whether the component is present in the tree */\n  isPresent: boolean\n  /** Call this when exit animation is complete to allow unmounting */\n  safeToRemove: () => void\n  /** Custom data passed from AnimatePresence */\n  custom?: unknown\n}\n\n/**\n * Context for managing presence state in AnimatePresence\n *\n * When a child is removed from AnimatePresence, it stays mounted\n * while its exit animation plays. This context provides:\n * - isPresent: false when the child should animate out\n * - safeToRemove: callback to signal animation completion\n */\nexport const PresenceContext = createContext<PresenceContextValue | null>(null)\n\nPresenceContext.displayName = 'PresenceContext'\n","import { useContext } from 'react'\r\nimport { PresenceContext } from '../context/PresenceContext.js'\r\n\r\n/**\r\n * Hook for custom exit animation control in AnimatePresence\r\n *\r\n * Returns a tuple of [isPresent, safeToRemove]:\r\n * - isPresent: true when component should be visible, false when exiting\r\n * - safeToRemove: call this when your exit animation is complete\r\n *\r\n * @example\r\n * ```tsx\r\n * function Modal() {\r\n *   const [isPresent, safeToRemove] = usePresence()\r\n *\r\n *   useEffect(() => {\r\n *     if (!isPresent) {\r\n *       // Animate out, then call safeToRemove\r\n *       animate(element, { opacity: 0 }).then(safeToRemove)\r\n *     }\r\n *   }, [isPresent])\r\n *\r\n *   return <div>Modal content</div>\r\n * }\r\n *\r\n * // In parent:\r\n * <AnimatePresence>\r\n *   {showModal && <Modal key=\"modal\" />}\r\n * </AnimatePresence>\r\n * ```\r\n */\r\nexport function usePresence(): [boolean, () => void] {\r\n  const context = useContext(PresenceContext)\r\n\r\n  // If not inside AnimatePresence, always present\r\n  if (context === null) {\r\n    return [true, () => {}]\r\n  }\r\n\r\n  return [context.isPresent, context.safeToRemove]\r\n}\r\n\r\n/**\r\n * Hook that returns whether the component is present\r\n *\r\n * Simpler alternative to usePresence when you only need the presence state\r\n * and are using built-in exit animations (via exit prop).\r\n *\r\n * @example\r\n * ```tsx\r\n * function Item() {\r\n *   const isPresent = useIsPresent()\r\n *   return <div style={{ opacity: isPresent ? 1 : 0 }}>Item</div>\r\n * }\r\n * ```\r\n */\r\nexport function useIsPresent(): boolean {\r\n  const context = useContext(PresenceContext)\r\n  return context === null ? true : context.isPresent\r\n}\r\n\r\n/**\r\n * Hook that returns custom data passed from AnimatePresence\r\n *\r\n * Useful for passing dynamic values to exit animations\r\n *\r\n * @example\r\n * ```tsx\r\n * <AnimatePresence custom={direction}>\r\n *   <Slide key={index} />\r\n * </AnimatePresence>\r\n *\r\n * function Slide() {\r\n *   const custom = usePresenceCustom<number>()\r\n *   const exitX = custom > 0 ? 100 : -100\r\n *   return <Animated.div exit={{ x: exitX }} />\r\n * }\r\n * ```\r\n */\r\nexport function usePresenceCustom<T = unknown>(): T | undefined {\r\n  const context = useContext(PresenceContext)\r\n  return context?.custom as T | undefined\r\n}\r\n","import { useRef, useCallback, useEffect } from 'react'\r\nimport { createSpringValue } from '../../../core/spring-value.js'\r\nimport type { SpringConfig } from '../../../types.js'\r\n\r\n/**\r\n * Animation target - either a CSS property object or a keyframe array\r\n */\r\nexport interface AnimationTarget {\r\n  [property: string]: number | number[]\r\n}\r\n\r\n/**\r\n * Animation options for useAnimate\r\n */\r\nexport interface AnimateOptions {\r\n  /** Spring configuration */\r\n  config?: SpringConfig\r\n  /** Delay before animation starts (ms) */\r\n  delay?: number\r\n  /** Callback when animation completes */\r\n  onComplete?: () => void\r\n}\r\n\r\n/**\r\n * Animate function returned by useAnimate\r\n */\r\nexport type AnimateFunction = (\r\n  target: AnimationTarget,\r\n  options?: AnimateOptions\r\n) => Promise<void>\r\n\r\n/**\r\n * Animation controls for managing animations\r\n */\r\nexport interface AnimationControls {\r\n  /** Stop all running animations */\r\n  stop: () => void\r\n  /** Get current value of a property */\r\n  get: (property: string) => number | undefined\r\n  /** Check if any animation is running */\r\n  isAnimating: () => boolean\r\n}\r\n\r\n/**\r\n * Return type of useAnimate hook\r\n */\r\nexport type UseAnimateReturn = [\r\n  React.RefObject<HTMLElement | null>,\r\n  AnimateFunction,\r\n  AnimationControls\r\n]\r\n\r\n/**\r\n * Imperative animation hook for programmatic control.\r\n * Returns a ref to attach to elements and an animate function.\r\n *\r\n * @example Basic usage\r\n * ```tsx\r\n * function Component() {\r\n *   const [scope, animate, controls] = useAnimate()\r\n *\r\n *   const handleClick = async () => {\r\n *     await animate({ opacity: 1, x: 100 })\r\n *     await animate({ scale: 1.2 })\r\n *     await animate({ scale: 1, opacity: 0.5 })\r\n *   }\r\n *\r\n *   return (\r\n *     <div ref={scope} onClick={handleClick}>\r\n *       Animate me\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n *\r\n * @example With options\r\n * ```tsx\r\n * const [scope, animate] = useAnimate()\r\n *\r\n * await animate(\r\n *   { x: 200, rotation: 45 },\r\n *   { config: { stiffness: 300, damping: 20 }, delay: 100 }\r\n * )\r\n * ```\r\n *\r\n * @example Keyframe animation\r\n * ```tsx\r\n * const [scope, animate] = useAnimate()\r\n *\r\n * // Animate through multiple values\r\n * await animate({ opacity: [0, 1, 0.5, 1] })\r\n * ```\r\n */\r\nexport function useAnimate(): UseAnimateReturn {\r\n  const scopeRef = useRef<HTMLElement | null>(null)\r\n  const springsRef = useRef<Map<string, ReturnType<typeof createSpringValue>>>(new Map())\r\n  const valuesRef = useRef<Map<string, number>>(new Map())\r\n  const isAnimatingRef = useRef(false)\r\n  const cleanupRef = useRef<(() => void)[]>([])\r\n  // Track RAF IDs and timeouts for proper cleanup\r\n  const rafIdsRef = useRef<Set<number>>(new Set())\r\n  const timeoutIdsRef = useRef<Set<ReturnType<typeof setTimeout>>>(new Set())\r\n  const isDestroyedRef = useRef(false)\r\n\r\n  // Reset destroyed flag on mount (handles React StrictMode remount)\r\n  useEffect(() => {\r\n    isDestroyedRef.current = false\r\n  }, [])\r\n\r\n  // Map CSS property names to transform functions (reserved for future use)\r\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\r\n  const _getPropertyStyle = useCallback((_property: string, _value: number): string | null => {\r\n    return null // Direct style property\r\n  }, [])\r\n\r\n  const applyStyles = useCallback(() => {\r\n    const element = scopeRef.current\r\n    if (!element) return\r\n\r\n    const transforms: string[] = []\r\n    const styles: Record<string, string> = {}\r\n\r\n    valuesRef.current.forEach((value, property) => {\r\n      switch (property) {\r\n        case 'x':\r\n          transforms.push(`translateX(${value}px)`)\r\n          break\r\n        case 'y':\r\n          transforms.push(`translateY(${value}px)`)\r\n          break\r\n        case 'z':\r\n          transforms.push(`translateZ(${value}px)`)\r\n          break\r\n        case 'scale':\r\n          transforms.push(`scale(${value})`)\r\n          break\r\n        case 'scaleX':\r\n          transforms.push(`scaleX(${value})`)\r\n          break\r\n        case 'scaleY':\r\n          transforms.push(`scaleY(${value})`)\r\n          break\r\n        case 'rotate':\r\n        case 'rotateZ':\r\n          transforms.push(`rotate(${value}deg)`)\r\n          break\r\n        case 'rotateX':\r\n          transforms.push(`rotateX(${value}deg)`)\r\n          break\r\n        case 'rotateY':\r\n          transforms.push(`rotateY(${value}deg)`)\r\n          break\r\n        case 'opacity':\r\n          styles.opacity = String(value)\r\n          break\r\n        default:\r\n          // Assume pixel values for other properties\r\n          styles[property] = `${value}px`\r\n      }\r\n    })\r\n\r\n    if (transforms.length > 0) {\r\n      element.style.transform = transforms.join(' ')\r\n    }\r\n\r\n    Object.entries(styles).forEach(([prop, val]) => {\r\n      element.style.setProperty(prop, val)\r\n    })\r\n  }, [])\r\n\r\n  const animate: AnimateFunction = useCallback(async (target, options = {}) => {\r\n    const { config = {}, delay = 0, onComplete } = options\r\n\r\n    try {\r\n      if (delay > 0) {\r\n        await new Promise<void>((resolve) => {\r\n          const timeoutId = setTimeout(() => {\r\n            timeoutIdsRef.current.delete(timeoutId)\r\n            resolve()\r\n          }, delay)\r\n          timeoutIdsRef.current.add(timeoutId)\r\n        })\r\n      }\r\n\r\n      // Check if destroyed during delay\r\n      if (isDestroyedRef.current) return\r\n\r\n      isAnimatingRef.current = true\r\n\r\n      const promises: Promise<void>[] = []\r\n\r\n      for (const [property, value] of Object.entries(target)) {\r\n        const targetValues = Array.isArray(value) ? value : [value]\r\n\r\n        // Animate through each value in sequence\r\n        let animationPromise = Promise.resolve()\r\n\r\n        for (const targetValue of targetValues) {\r\n          animationPromise = animationPromise.then(() => {\r\n            return new Promise<void>((resolve) => {\r\n              // Early exit if destroyed\r\n              if (isDestroyedRef.current) {\r\n                resolve()\r\n                return\r\n              }\r\n\r\n              try {\r\n                // Get or create spring for this property\r\n                let spring = springsRef.current.get(property)\r\n\r\n                if (!spring) {\r\n                  spring = createSpringValue(valuesRef.current.get(property) ?? 0, config)\r\n                  springsRef.current.set(property, spring)\r\n\r\n                  const unsubscribe = spring.subscribe((v) => {\r\n                    if (!isDestroyedRef.current) {\r\n                      valuesRef.current.set(property, v)\r\n                      applyStyles()\r\n                    }\r\n                  })\r\n\r\n                  cleanupRef.current.push(unsubscribe)\r\n                }\r\n\r\n                // Update config if provided\r\n                if (config.stiffness || config.damping || config.mass) {\r\n                  spring.setConfig(config)\r\n                }\r\n\r\n                spring.set(targetValue)\r\n\r\n                // Wait for animation to complete with tracked RAF\r\n                const checkComplete = () => {\r\n                  // If destroyed or animation complete, resolve\r\n                  if (isDestroyedRef.current || !spring || !spring.isAnimating()) {\r\n                    resolve()\r\n                  } else {\r\n                    const rafId = requestAnimationFrame(checkComplete)\r\n                    rafIdsRef.current.add(rafId)\r\n                  }\r\n                }\r\n\r\n                // Initial check after one frame\r\n                const initialRafId = requestAnimationFrame(checkComplete)\r\n                rafIdsRef.current.add(initialRafId)\r\n              } catch {\r\n                // If animation fails, resolve anyway to prevent hanging\r\n                resolve()\r\n              }\r\n            })\r\n          })\r\n        }\r\n\r\n        promises.push(animationPromise)\r\n      }\r\n\r\n      await Promise.all(promises)\r\n\r\n      if (!isDestroyedRef.current) {\r\n        isAnimatingRef.current = false\r\n        onComplete?.()\r\n      }\r\n    } catch {\r\n      // Ensure animating flag is reset on error\r\n      isAnimatingRef.current = false\r\n    }\r\n  }, [applyStyles])\r\n\r\n  const controls: AnimationControls = {\r\n    stop: useCallback(() => {\r\n      springsRef.current.forEach((spring) => {\r\n        spring.stop()\r\n      })\r\n      isAnimatingRef.current = false\r\n    }, []),\r\n\r\n    get: useCallback((property: string) => {\r\n      return valuesRef.current.get(property)\r\n    }, []),\r\n\r\n    isAnimating: useCallback(() => {\r\n      return isAnimatingRef.current\r\n    }, []),\r\n  }\r\n\r\n  // Cleanup on unmount: stop animations but don't destroy springs\r\n  // (Springs are reused across React StrictMode remounts)\r\n  useEffect(() => {\r\n    return () => {\r\n      // Mark as destroyed to prevent further updates\r\n      isDestroyedRef.current = true\r\n\r\n      // Cancel all pending RAF callbacks\r\n      rafIdsRef.current.forEach((id) => cancelAnimationFrame(id))\r\n      rafIdsRef.current.clear()\r\n\r\n      // Clear all pending timeouts\r\n      timeoutIdsRef.current.forEach((id) => clearTimeout(id))\r\n      timeoutIdsRef.current.clear()\r\n\r\n      // Run cleanup functions\r\n      cleanupRef.current.forEach((cleanup) => cleanup())\r\n\r\n      // Stop springs instead of destroying them\r\n      springsRef.current.forEach((spring) => spring.stop())\r\n    }\r\n  }, [])\r\n\r\n  return [scopeRef, animate, controls]\r\n}\r\n","import { useRef, useEffect, useState } from 'react'\r\nimport { MotionValue, createMotionValue, type MotionValueOptions } from '../../../core/MotionValue.js'\r\n\r\n/**\r\n * Create a MotionValue that persists across renders\r\n *\r\n * Unlike useState, updating a MotionValue doesn't trigger re-renders.\r\n * This makes it perfect for high-frequency animations.\r\n *\r\n * @example\r\n * ```tsx\r\n * function DragBox() {\r\n *   const x = useMotionValue(0)\r\n *   const y = useMotionValue(0)\r\n *\r\n *   return (\r\n *     <div\r\n *       ref={(el) => {\r\n *         if (!el) return\r\n *         x.subscribe((v) => el.style.transform = `translateX(${v}px)`)\r\n *       }}\r\n *       onMouseMove={(e) => {\r\n *         x.set(e.clientX)\r\n *         y.set(e.clientY)\r\n *       }}\r\n *     />\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useMotionValue<T = number>(\r\n  initialValue: T,\r\n  options?: MotionValueOptions\r\n): MotionValue<T> {\r\n  const motionValueRef = useRef<MotionValue<T> | null>(null)\r\n\r\n  // Create on first render only\r\n  if (motionValueRef.current === null) {\r\n    motionValueRef.current = createMotionValue(initialValue, options)\r\n  }\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      motionValueRef.current?.destroy()\r\n    }\r\n  }, [])\r\n\r\n  return motionValueRef.current\r\n}\r\n\r\n/**\r\n * Subscribe to a MotionValue and trigger re-renders\r\n *\r\n * Use this when you need the value in render.\r\n * For most cases, prefer direct DOM updates via subscribe.\r\n *\r\n * @example\r\n * ```tsx\r\n * function ValueDisplay({ motionValue }) {\r\n *   const value = useMotionValueState(motionValue)\r\n *   return <span>{value?.toFixed(2) ?? '0'}</span>\r\n * }\r\n * ```\r\n */\r\nexport function useMotionValueState<T>(motionValue: MotionValue<T> | null | undefined): T | undefined {\r\n  const [value, setValue] = useState<T | undefined>(() => motionValue?.get())\r\n\r\n  useEffect(() => {\r\n    if (!motionValue) return\r\n\r\n    // Sync initial value in case it changed between initial state and effect\r\n    setValue(motionValue.get())\r\n\r\n    const unsubscribe = motionValue.subscribe((newValue) => {\r\n      setValue(newValue)\r\n    })\r\n\r\n    return unsubscribe\r\n  }, [motionValue])\r\n\r\n  return value\r\n}\r\n\r\n/**\r\n * Create a MotionValue that syncs with an external value\r\n *\r\n * Useful when you need a MotionValue that tracks a prop or state.\r\n *\r\n * @example\r\n * ```tsx\r\n * function AnimatedProgress({ progress }) {\r\n *   const motionProgress = useMotionValueSync(progress)\r\n *\r\n *   // motionProgress animates smoothly when progress prop changes\r\n *   return <ProgressBar motionValue={motionProgress} />\r\n * }\r\n * ```\r\n */\r\nexport function useMotionValueSync(\r\n  externalValue: number,\r\n  options?: MotionValueOptions\r\n): MotionValue<number> {\r\n  const motionValue = useMotionValue(externalValue, options)\r\n\r\n  useEffect(() => {\r\n    motionValue.set(externalValue)\r\n  }, [externalValue, motionValue])\r\n\r\n  return motionValue\r\n}\r\n\r\n/**\r\n * Create multiple MotionValues at once\r\n *\r\n * @example\r\n * ```tsx\r\n * function TransformBox() {\r\n *   const { x, y, scale, rotate } = useMotionValues({\r\n *     x: 0,\r\n *     y: 0,\r\n *     scale: 1,\r\n *     rotate: 0,\r\n *   })\r\n *\r\n *   // Each is an independent MotionValue\r\n *   x.set(100)\r\n *   scale.set(1.5)\r\n * }\r\n * ```\r\n */\r\nexport function useMotionValues<T extends Record<string, number>>(\r\n  initialValues: T,\r\n  options?: MotionValueOptions\r\n): { [K in keyof T]: MotionValue<number> } {\r\n  type ResultType = { [K in keyof T]: MotionValue<number> }\r\n  const motionValuesRef = useRef<ResultType | null>(null)\r\n\r\n  if (motionValuesRef.current === null) {\r\n    const values: Record<string, MotionValue<number>> = {}\r\n\r\n    for (const key in initialValues) {\r\n      if (Object.prototype.hasOwnProperty.call(initialValues, key)) {\r\n        const value = initialValues[key]\r\n        values[key] = createMotionValue(value as number, options)\r\n      }\r\n    }\r\n\r\n    motionValuesRef.current = values as ResultType\r\n  }\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      if (motionValuesRef.current) {\r\n        const current = motionValuesRef.current\r\n        for (const key in current) {\r\n          if (Object.prototype.hasOwnProperty.call(current, key)) {\r\n            current[key].destroy()\r\n          }\r\n        }\r\n      }\r\n    }\r\n  }, [])\r\n\r\n  return motionValuesRef.current\r\n}\r\n","import { useRef, useEffect, useMemo, useCallback } from 'react'\nimport { MotionValue, createMotionValue } from '../../../core/MotionValue.js'\n\n/**\n * Track the velocity of a MotionValue\n *\n * Creates a new MotionValue that outputs the velocity of the source value.\n * Useful for velocity-based effects like skewing elements while scrolling.\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const velocity = useVelocity(x)\n *\n * // Use velocity for visual effects\n * const skew = useTransform(velocity, [-1000, 0, 1000], [-10, 0, 10])\n * ```\n *\n * @example With scroll\n * ```tsx\n * const { scrollY } = useScroll()\n * const scrollVelocity = useVelocity(scrollY)\n *\n * // Show indicator when scrolling fast\n * const opacity = useTransform(scrollVelocity, [-500, 0, 500], [1, 0, 1])\n * ```\n */\nexport function useVelocity(source: MotionValue<number>): MotionValue<number> {\n  const velocityRef = useRef<MotionValue<number> | null>(null)\n  const frameRef = useRef<number | null>(null)\n  const lastVelocityRef = useRef(0)\n\n  if (velocityRef.current === null) {\n    velocityRef.current = createMotionValue(source.getVelocity())\n  }\n\n  useEffect(() => {\n    const update = () => {\n      const velocity = source.getVelocity()\n      // Only update if velocity changed significantly\n      if (Math.abs(velocity - lastVelocityRef.current) > 0.001) {\n        velocityRef.current?.jump(velocity)\n        lastVelocityRef.current = velocity\n      }\n      frameRef.current = requestAnimationFrame(update)\n    }\n\n    frameRef.current = requestAnimationFrame(update)\n\n    return () => {\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current)\n      }\n    }\n  }, [source])\n\n  useEffect(() => {\n    return () => {\n      velocityRef.current?.destroy()\n    }\n  }, [])\n\n  return velocityRef.current\n}\n\n/**\n * Subscribe to MotionValue events\n *\n * A hook that allows you to subscribe to motion value lifecycle events\n * without manually managing subscriptions.\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n *\n * useMotionValueEvent(x, 'change', (latest) => {\n *   console.log('Value changed:', latest)\n * })\n *\n * useMotionValueEvent(x, 'animationStart', () => {\n *   console.log('Animation started')\n * })\n *\n * useMotionValueEvent(x, 'animationComplete', () => {\n *   console.log('Animation completed')\n * })\n * ```\n */\nexport function useMotionValueEvent<T>(\n  value: MotionValue<T>,\n  event: 'change' | 'animationStart' | 'animationComplete' | 'animationCancel',\n  callback: (latest: T) => void\n): void {\n  const callbackRef = useRef(callback)\n  callbackRef.current = callback\n\n  useEffect(() => {\n    if (event === 'change') {\n      return value.subscribe((v) => callbackRef.current(v))\n    }\n\n    // For animation events, use the on method\n    return value.on(event, () => callbackRef.current(value.get()))\n  }, [value, event])\n}\n\ntype InputRange = number[]\ntype OutputRange = number[] | string[]\n\nexport interface UseTransformOptions {\n  /** Clamp output to the output range bounds */\n  clamp?: boolean\n  /** Custom easing function for the interpolation */\n  ease?: (t: number) => number\n}\n\n/**\n * Transform a MotionValue to a new derived value\n *\n * Supports two forms:\n * 1. Range mapping: useTransform(value, [0, 100], [0, 1])\n * 2. Function: useTransform(value, (v) => v * 2)\n *\n * @example Range mapping\n * ```tsx\n * const x = useMotionValue(0)\n * const opacity = useTransform(x, [0, 100], [1, 0])\n * const scale = useTransform(x, [-100, 0, 100], [0.5, 1, 1.5])\n * ```\n *\n * @example Function transform\n * ```tsx\n * const x = useMotionValue(0)\n * const inverted = useTransform(x, (v) => -v)\n * const clamped = useTransform(x, (v) => Math.max(0, Math.min(100, v)))\n * ```\n *\n * @example Chaining transforms\n * ```tsx\n * const x = useMotionValue(0)\n * const scale = useTransform(x, [0, 100], [1, 2])\n * const opacity = useTransform(scale, [1, 2], [0.5, 1])\n * ```\n */\nexport function useTransform<O = number>(\n  source: MotionValue<number>,\n  inputRangeOrTransform: InputRange | ((value: number) => O),\n  outputRange?: OutputRange,\n  options?: UseTransformOptions\n): MotionValue<O> {\n  const derivedRef = useRef<MotionValue<O> | null>(null)\n  const unsubscribeRef = useRef<(() => void) | null>(null)\n\n  // Determine transform function\n  const transformFn = useMemo(() => {\n    if (typeof inputRangeOrTransform === 'function') {\n      return inputRangeOrTransform\n    }\n\n    if (!outputRange) {\n      throw new Error('useTransform: outputRange is required when using range mapping')\n    }\n\n    const inputRange = inputRangeOrTransform\n\n    // Use core interpolate for numeric outputs\n    if (typeof outputRange[0] === 'number') {\n      return (value: number): O => {\n        // Find the segment\n        let i = 0\n        for (; i < inputRange.length - 1; i++) {\n          const nextVal = inputRange[i + 1]\n          if (nextVal !== undefined && value <= nextVal) break\n        }\n\n        const inputMin = inputRange[i] ?? 0\n        const inputMax = inputRange[Math.min(i + 1, inputRange.length - 1)] ?? 1\n        const outputMin = (outputRange[i] ?? 0) as number\n        const outputMax = (outputRange[Math.min(i + 1, outputRange.length - 1)] ?? 1) as number\n\n        // Normalize to 0-1\n        let t = inputMax !== inputMin\n          ? (value - inputMin) / (inputMax - inputMin)\n          : 0\n\n        // Apply easing if provided\n        if (options?.ease) {\n          t = options.ease(t)\n        }\n\n        // Clamp if requested\n        if (options?.clamp) {\n          t = Math.max(0, Math.min(1, t))\n        }\n\n        // Interpolate\n        return (outputMin + t * (outputMax - outputMin)) as O\n      }\n    }\n\n    // String interpolation (colors, etc.)\n    return (value: number): O => {\n      // Simple string interpolation - find nearest\n      let i = 0\n      for (; i < inputRange.length - 1; i++) {\n        const nextVal = inputRange[i + 1]\n        if (nextVal !== undefined && value <= nextVal) break\n      }\n\n      const inCurr = inputRange[i] ?? 0\n      const inNext = inputRange[i + 1] ?? 1\n\n      const t = inNext !== inCurr\n        ? (value - inCurr) / (inNext - inCurr)\n        : 0\n\n      // For strings, just return the nearest one\n      // (full color interpolation would require parsing)\n      return (t < 0.5 ? outputRange[i] : outputRange[i + 1]) as O\n    }\n  }, [inputRangeOrTransform, outputRange, options?.clamp, options?.ease]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Create derived value on first render\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transformFn(source.get()))\n  }\n\n  // Subscribe to source changes\n  useEffect(() => {\n    unsubscribeRef.current = source.subscribe((value) => {\n      derivedRef.current?.jump(transformFn(value))\n    })\n\n    return () => {\n      unsubscribeRef.current?.()\n    }\n  }, [source, transformFn])\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n/**\n * Combine multiple MotionValues into one\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const y = useMotionValue(0)\n *\n * const distance = useCombinedTransform(\n *   [x, y],\n *   ([xVal, yVal]) => Math.sqrt(xVal ** 2 + yVal ** 2)\n * )\n * ```\n */\nexport function useCombinedTransform<T extends number[], O = number>(\n  sources: { [K in keyof T]: MotionValue<T[K]> },\n  transform: (values: T) => O\n): MotionValue<O> {\n  const derivedRef = useRef<MotionValue<O> | null>(null)\n  const unsubscribesRef = useRef<Array<() => void>>([])\n\n  // Get current values\n  const getCurrentValues = (): T => {\n    return sources.map((source) => source.get()) as T\n  }\n\n  // Create on first render\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transform(getCurrentValues()))\n  }\n\n  useEffect(() => {\n    // Subscribe to all sources\n    unsubscribesRef.current = sources.map((source) =>\n      source.subscribe(() => {\n        derivedRef.current?.jump(transform(getCurrentValues()))\n      })\n    )\n\n    return () => {\n      unsubscribesRef.current.forEach((unsub) => unsub())\n    }\n    // getCurrentValues is stable - defined within component\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [sources, transform])\n\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n/**\n * Apply velocity-based transform\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const skewX = useVelocityTransform(x, (velocity) => velocity * 0.1)\n * ```\n */\nexport function useVelocityTransform(\n  source: MotionValue<number>,\n  transform: (velocity: number) => number\n): MotionValue<number> {\n  const derivedRef = useRef<MotionValue<number> | null>(null)\n  const frameRef = useRef<number | null>(null)\n\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transform(source.getVelocity()))\n  }\n\n  useEffect(() => {\n    const update = () => {\n      derivedRef.current?.jump(transform(source.getVelocity()))\n      frameRef.current = requestAnimationFrame(update)\n    }\n\n    frameRef.current = requestAnimationFrame(update)\n\n    return () => {\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current)\n      }\n    }\n  }, [source, transform])\n\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n/**\n * Spring-based transform that animates to the transformed value\n *\n * Unlike useTransform which instantly updates, this animates smoothly.\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const smoothScale = useSpringTransform(x, [0, 100], [1, 2], {\n *   stiffness: 300,\n *   damping: 30\n * })\n * ```\n */\nexport function useSpringTransform(\n  source: MotionValue<number>,\n  inputRange: InputRange,\n  outputRange: number[],\n  springConfig?: { stiffness?: number; damping?: number }\n): MotionValue<number> {\n  const derivedRef = useRef<MotionValue<number> | null>(null)\n  const unsubscribeRef = useRef<(() => void) | null>(null)\n\n  const transform = useMemo(() => {\n    return (value: number): number => {\n      let i = 0\n      for (; i < inputRange.length - 1; i++) {\n        const nextVal = inputRange[i + 1]\n        if (nextVal !== undefined && value <= nextVal) break\n      }\n\n      const inCurr = inputRange[i] ?? 0\n      const inNext = inputRange[i + 1] ?? 1\n      const outCurr = outputRange[i] ?? 0\n      const outNext = outputRange[i + 1] ?? 1\n\n      const t = (value - inCurr) / (inNext - inCurr)\n      return outCurr + t * (outNext - outCurr)\n    }\n  }, [inputRange, outputRange])\n\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transform(source.get()), {\n      spring: springConfig,\n    })\n  }\n\n  useEffect(() => {\n    unsubscribeRef.current = source.subscribe((value) => {\n      // Use set (animated) instead of jump\n      derivedRef.current?.set(transform(value))\n    })\n\n    return () => {\n      unsubscribeRef.current?.()\n    }\n  }, [source, transform])\n\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n// ============ useMotionTemplate ============\n\n/**\n * Combine multiple MotionValues into a template string\n *\n * Creates a MotionValue that outputs a string by combining multiple\n * motion values using a template literal-like syntax.\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const y = useMotionValue(0)\n *\n * // Create a transform string\n * const transform = useMotionTemplate`translateX(${x}px) translateY(${y}px)`\n *\n * // Use in style\n * <div style={{ transform: transform.get() }} />\n * ```\n *\n * @example With colors\n * ```tsx\n * const r = useMotionValue(255)\n * const g = useMotionValue(100)\n * const b = useMotionValue(50)\n *\n * const color = useMotionTemplate`rgb(${r}, ${g}, ${b})`\n * ```\n */\nexport function useMotionTemplate(\n  strings: TemplateStringsArray,\n  ...values: MotionValue<number>[]\n): MotionValue<string> {\n  const templateRef = useRef<MotionValue<string> | null>(null)\n  const unsubscribesRef = useRef<Array<() => void>>([])\n\n  // Store values in ref to avoid dependency issues with rest parameters\n  const valuesRef = useRef(values)\n  valuesRef.current = values\n\n  // Stable reference to strings (TemplateStringsArray is stable per call site)\n  const stringsRef = useRef(strings)\n  stringsRef.current = strings\n\n  const buildString = useCallback((): string => {\n    let result = ''\n    stringsRef.current.forEach((str, i) => {\n      result += str\n      if (i < valuesRef.current.length) {\n        result += String(valuesRef.current[i]?.get() ?? '')\n      }\n    })\n    return result\n  }, [])\n\n  if (templateRef.current === null) {\n    templateRef.current = createMotionValue(buildString()) as MotionValue<string>\n  }\n\n  // Use values.length as stable dependency instead of array reference\n  const valuesLength = values.length\n\n  useEffect(() => {\n    // Clear previous subscriptions\n    unsubscribesRef.current.forEach((unsub) => unsub())\n\n    // Subscribe to all values\n    unsubscribesRef.current = valuesRef.current.map((value) =>\n      value.subscribe(() => {\n        templateRef.current?.jump(buildString())\n      })\n    )\n\n    return () => {\n      unsubscribesRef.current.forEach((unsub) => unsub())\n      unsubscribesRef.current = []\n    }\n  }, [valuesLength, buildString])\n\n  useEffect(() => {\n    return () => {\n      templateRef.current?.destroy()\n    }\n  }, [])\n\n  return templateRef.current as MotionValue<string>\n}\n\n// ============ useTime ============\n\n/**\n * Returns a MotionValue that updates every frame with elapsed time\n *\n * The value starts at 0 and increases by the delta time each frame.\n * Useful for creating time-based animations.\n *\n * @example\n * ```tsx\n * const time = useTime()\n *\n * // Create a pulsing effect\n * const scale = useTransform(time, (t) => 1 + Math.sin(t / 500) * 0.1)\n *\n * // Create a rotating element\n * const rotate = useTransform(time, (t) => (t / 10) % 360)\n * ```\n *\n * @example Oscillating animation\n * ```tsx\n * const time = useTime()\n * const x = useTransform(time, (t) => Math.sin(t / 1000) * 100)\n * const y = useTransform(time, (t) => Math.cos(t / 1000) * 100)\n * ```\n */\nexport function useTime(): MotionValue<number> {\n  const timeRef = useRef<MotionValue<number> | null>(null)\n  const frameRef = useRef<number | null>(null)\n  const startTimeRef = useRef<number | null>(null)\n\n  if (timeRef.current === null) {\n    timeRef.current = createMotionValue(0)\n  }\n\n  useEffect(() => {\n    const update = (timestamp: number) => {\n      if (startTimeRef.current === null) {\n        startTimeRef.current = timestamp\n      }\n      const elapsed = timestamp - startTimeRef.current\n      timeRef.current?.jump(elapsed)\n      frameRef.current = requestAnimationFrame(update)\n    }\n\n    frameRef.current = requestAnimationFrame(update)\n\n    return () => {\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current)\n      }\n    }\n  }, [])\n\n  useEffect(() => {\n    return () => {\n      timeRef.current?.destroy()\n    }\n  }, [])\n\n  return timeRef.current\n}\n\n// ============ useAnimationFrame ============\n\n/**\n * Runs a callback on every animation frame\n *\n * The callback receives the timestamp and delta time since last frame.\n * Automatically cleans up on unmount.\n *\n * @example\n * ```tsx\n * useAnimationFrame((time, delta) => {\n *   // Update custom animation logic\n *   element.style.transform = `rotate(${time / 10}deg)`\n * })\n * ```\n *\n * @example With conditional running\n * ```tsx\n * const [isPlaying, setIsPlaying] = useState(true)\n *\n * useAnimationFrame((time, delta) => {\n *   if (!isPlaying) return\n *   // Animation logic\n * })\n * ```\n */\nexport function useAnimationFrame(\n  callback: (time: number, delta: number) => void\n): void {\n  const callbackRef = useRef(callback)\n  const frameRef = useRef<number | null>(null)\n  const lastTimeRef = useRef<number | null>(null)\n\n  callbackRef.current = callback\n\n  useEffect(() => {\n    const update = (timestamp: number) => {\n      const delta = lastTimeRef.current !== null\n        ? timestamp - lastTimeRef.current\n        : 0\n      lastTimeRef.current = timestamp\n\n      callbackRef.current(timestamp, delta)\n      frameRef.current = requestAnimationFrame(update)\n    }\n\n    frameRef.current = requestAnimationFrame(update)\n\n    return () => {\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current)\n      }\n    }\n  }, [])\n}\n\n// ============ useWillChange ============\n\n/**\n * Automatically manages the CSS will-change property for better performance\n *\n * Returns a MotionValue that can be used as a style value. When any of the\n * source values are animating, will-change is automatically applied.\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const willChange = useWillChange([x])\n *\n * <motion.div style={{ x, willChange: willChange.get() }} />\n * ```\n *\n * @example With multiple values\n * ```tsx\n * const x = useMotionValue(0)\n * const opacity = useMotionValue(1)\n * const willChange = useWillChange([x, opacity])\n *\n * <div style={{\n *   transform: `translateX(${x.get()}px)`,\n *   opacity: opacity.get(),\n *   willChange: willChange.get()\n * }} />\n * ```\n */\nexport function useWillChange(\n  sources: MotionValue<number>[],\n  properties: string[] = ['transform', 'opacity']\n): MotionValue<string> {\n  const willChangeRef = useRef<MotionValue<string> | null>(null)\n  const frameRef = useRef<number | null>(null)\n  const wasAnimatingRef = useRef(false)\n  const isDestroyedRef = useRef(false)\n\n  // Store sources in ref to avoid dependency issues with array reference changes\n  const sourcesRef = useRef(sources)\n  sourcesRef.current = sources\n\n  // Store properties in ref too\n  const propertiesRef = useRef(properties)\n  propertiesRef.current = properties\n\n  if (willChangeRef.current === null) {\n    willChangeRef.current = createMotionValue('auto') as MotionValue<string>\n  }\n\n  // Use sources.length as stable dependency instead of array reference\n  const sourcesLength = sources.length\n\n  useEffect(() => {\n    isDestroyedRef.current = false\n\n    const checkAnimating = () => {\n      if (isDestroyedRef.current) return\n\n      const isAnimating = sourcesRef.current.some((source) => source.isAnimating())\n\n      if (isAnimating && !wasAnimatingRef.current) {\n        ;(willChangeRef.current as MotionValue<string>)?.jump(propertiesRef.current.join(', '))\n        wasAnimatingRef.current = true\n      } else if (!isAnimating && wasAnimatingRef.current) {\n        ;(willChangeRef.current as MotionValue<string>)?.jump('auto')\n        wasAnimatingRef.current = false\n      }\n\n      if (!isDestroyedRef.current) {\n        frameRef.current = requestAnimationFrame(checkAnimating)\n      }\n    }\n\n    frameRef.current = requestAnimationFrame(checkAnimating)\n\n    return () => {\n      isDestroyedRef.current = true\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current)\n        frameRef.current = null\n      }\n    }\n  }, [sourcesLength])\n\n  useEffect(() => {\n    return () => {\n      willChangeRef.current?.destroy()\n    }\n  }, [])\n\n  return willChangeRef.current as MotionValue<string>\n}\n\n// ============ Motion Value Combiners ============\n\n/**\n * Sum multiple MotionValues together\n *\n * @example\n * ```tsx\n * const base = useMotionValue(100)\n * const offset = useMotionValue(50)\n * const total = useSum(base, offset) // 150\n * ```\n */\nexport function useSum(...sources: MotionValue<number>[]): MotionValue<number> {\n  return useCombinedTransform(sources, (values) =>\n    values.reduce((sum, v) => sum + v, 0)\n  )\n}\n\n/**\n * Multiply multiple MotionValues together\n *\n * @example\n * ```tsx\n * const scale = useMotionValue(2)\n * const modifier = useMotionValue(1.5)\n * const total = useProduct(scale, modifier) // 3\n * ```\n */\nexport function useProduct(...sources: MotionValue<number>[]): MotionValue<number> {\n  return useCombinedTransform(sources, (values) =>\n    values.reduce((product, v) => product * v, 1)\n  )\n}\n\n/**\n * Get the difference between two MotionValues\n *\n * @example\n * ```tsx\n * const end = useMotionValue(100)\n * const start = useMotionValue(25)\n * const diff = useDifference(end, start) // 75\n * ```\n */\nexport function useDifference(\n  a: MotionValue<number>,\n  b: MotionValue<number>\n): MotionValue<number> {\n  return useCombinedTransform([a, b], ([aVal, bVal]) => aVal - bVal)\n}\n\n/**\n * Clamp a MotionValue between min and max\n *\n * @example\n * ```tsx\n * const value = useMotionValue(150)\n * const clamped = useClamp(value, 0, 100) // 100\n * ```\n */\nexport function useClamp(\n  source: MotionValue<number>,\n  min: number,\n  max: number\n): MotionValue<number> {\n  return useTransform(source, (v) => Math.max(min, Math.min(max, v)))\n}\n\n/**\n * Round a MotionValue to nearest step\n *\n * @example\n * ```tsx\n * const value = useMotionValue(47)\n * const snapped = useSnap(value, 10) // 50\n * ```\n */\nexport function useSnap(\n  source: MotionValue<number>,\n  step: number\n): MotionValue<number> {\n  return useTransform(source, (v) => Math.round(v / step) * step)\n}\n\n/**\n * Smooth a MotionValue using exponential moving average\n *\n * @example\n * ```tsx\n * const rawValue = useMotionValue(0)\n * const smoothed = useSmooth(rawValue, 0.1) // Lower = smoother\n * ```\n */\nexport function useSmooth(\n  source: MotionValue<number>,\n  factor: number = 0.1\n): MotionValue<number> {\n  const smoothedRef = useRef<MotionValue<number> | null>(null)\n  const currentRef = useRef(source.get())\n\n  if (smoothedRef.current === null) {\n    smoothedRef.current = createMotionValue(source.get())\n  }\n\n  useEffect(() => {\n    const unsub = source.subscribe((target) => {\n      currentRef.current = currentRef.current + (target - currentRef.current) * factor\n      smoothedRef.current?.jump(currentRef.current)\n    })\n\n    return unsub\n  }, [source, factor])\n\n  useEffect(() => {\n    return () => {\n      smoothedRef.current?.destroy()\n    }\n  }, [])\n\n  return smoothedRef.current\n}\n\n/**\n * Delay a MotionValue by a number of frames\n *\n * @example\n * ```tsx\n * const leader = useMotionValue(0)\n * const follower = useDelay(leader, 5) // 5 frames behind\n * ```\n */\nexport function useDelay(\n  source: MotionValue<number>,\n  frames: number\n): MotionValue<number> {\n  const delayedRef = useRef<MotionValue<number> | null>(null)\n  const bufferRef = useRef<number[]>([])\n\n  if (delayedRef.current === null) {\n    delayedRef.current = createMotionValue(source.get())\n    bufferRef.current = Array(frames).fill(source.get())\n  }\n\n  useEffect(() => {\n    const unsub = source.subscribe((value) => {\n      bufferRef.current.push(value)\n      const delayed = bufferRef.current.shift()\n      if (delayed !== undefined) {\n        delayedRef.current?.jump(delayed)\n      }\n    })\n\n    return unsub\n  }, [source, frames])\n\n  useEffect(() => {\n    return () => {\n      delayedRef.current?.destroy()\n    }\n  }, [])\n\n  return delayedRef.current\n}\n","import { useRef, useCallback } from 'react'\n\n/**\n * Drag controls for programmatic drag initiation\n */\nexport interface DragControls {\n  /** Start dragging from a pointer event */\n  start: (event: React.PointerEvent | PointerEvent, options?: DragStartOptions) => void\n  /** Stop any active drag */\n  stop: () => void\n  /** Check if currently dragging */\n  isDragging: () => boolean\n}\n\nexport interface DragStartOptions {\n  /** Snap to cursor position on start */\n  snapToCursor?: boolean\n  /** Cursor offset from element center */\n  cursorOffset?: { x: number; y: number }\n}\n\n/**\n * Creates drag controls for programmatic drag initiation\n *\n * This hook allows you to start a drag from a different element than\n * the one being dragged, useful for drag handles.\n *\n * @example Basic usage with drag handle\n * ```tsx\n * function DraggableCard() {\n *   const controls = useDragControls()\n *\n *   return (\n *     <div>\n *       <div\n *         className=\"drag-handle\"\n *         onPointerDown={(e) => controls.start(e)}\n *       >\n *          Drag here\n *       </div>\n *       <Animated.div\n *         dragControls={controls}\n *         drag=\"both\"\n *       >\n *         Card content\n *       </Animated.div>\n *     </div>\n *   )\n * }\n * ```\n *\n * @example With snap to cursor\n * ```tsx\n * const controls = useDragControls()\n *\n * <button\n *   onPointerDown={(e) => controls.start(e, { snapToCursor: true })}\n * >\n *   Pick up item\n * </button>\n * ```\n *\n * @example Multiple draggable items\n * ```tsx\n * function DraggableList({ items }) {\n *   return items.map((item) => {\n *     const controls = useDragControls()\n *\n *     return (\n *       <div key={item.id}>\n *         <GripIcon onPointerDown={(e) => controls.start(e)} />\n *         <Animated.div dragControls={controls} drag=\"y\">\n *           {item.content}\n *         </Animated.div>\n *       </div>\n *     )\n *   })\n * }\n * ```\n */\nexport function useDragControls(): DragControls {\n  const isDraggingRef = useRef(false)\n  const listenerRef = useRef<((event: PointerEvent, options?: DragStartOptions) => void) | null>(null)\n  const stopRef = useRef<(() => void) | null>(null)\n\n  const start = useCallback((\n    event: React.PointerEvent | PointerEvent,\n    options?: DragStartOptions\n  ) => {\n    isDraggingRef.current = true\n\n    // Prevent default to avoid text selection\n    event.preventDefault()\n\n    // Call the registered drag handler\n    if (listenerRef.current) {\n      const pointerEvent = 'nativeEvent' in event ? event.nativeEvent : event\n      listenerRef.current(pointerEvent, options)\n    }\n  }, [])\n\n  const stop = useCallback(() => {\n    isDraggingRef.current = false\n    if (stopRef.current) {\n      stopRef.current()\n    }\n  }, [])\n\n  const isDragging = useCallback(() => {\n    return isDraggingRef.current\n  }, [])\n\n  // Create a controls object with internal setters for the drag component\n  const controls: DragControls & {\n    _setDragHandler: (handler: (event: PointerEvent, options?: DragStartOptions) => void) => void\n    _setStopHandler: (handler: () => void) => void\n    _notifyDragEnd: () => void\n  } = {\n    start,\n    stop,\n    isDragging,\n    _setDragHandler: (handler) => {\n      listenerRef.current = handler\n    },\n    _setStopHandler: (handler) => {\n      stopRef.current = handler\n    },\n    _notifyDragEnd: () => {\n      isDraggingRef.current = false\n    },\n  }\n\n  return controls\n}\n\nexport type { DragControls as DragControlsType }\n","import { useCallback, useRef, useTransition, startTransition } from 'react'\n\n/**\n * Options for useInstantTransition\n */\nexport interface UseInstantTransitionOptions {\n  /**\n   * If true, skip the transition and update immediately.\n   * Useful for urgent updates that shouldn't be deferred.\n   */\n  instant?: boolean\n}\n\n/**\n * A hook that provides instant layout updates without animation\n *\n * This is useful when you want to update layout immediately (like when\n * switching tabs or pages) without the spring animation that would\n * normally occur.\n *\n * @example Basic usage\n * ```tsx\n * function Tabs() {\n *   const [activeTab, setActiveTab] = useState(0)\n *   const [startInstant, isPending] = useInstantTransition()\n *\n *   const switchTab = (index: number) => {\n *     startInstant(() => {\n *       setActiveTab(index)\n *     })\n *   }\n *\n *   return (\n *     <div>\n *       <TabBar onTabClick={switchTab} activeTab={activeTab} />\n *       <TabContent tab={activeTab} />\n *     </div>\n *   )\n * }\n * ```\n *\n * @example With layout animations\n * ```tsx\n * function App() {\n *   const [page, setPage] = useState('home')\n *   const [startInstant] = useInstantTransition()\n *\n *   // Instant navigation (no layout animation)\n *   const navigate = (newPage: string) => {\n *     startInstant(() => setPage(newPage))\n *   }\n *\n *   return (\n *     <LayoutGroup>\n *       <Animated.div layoutId=\"page\" key={page}>\n *         {page === 'home' ? <Home /> : <About />}\n *       </Animated.div>\n *     </LayoutGroup>\n *   )\n * }\n * ```\n */\nexport function useInstantTransition(): [\n  startTransition: (callback: () => void) => void,\n  isPending: boolean\n] {\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [isPending, _setIsPending] = useTransition()\n\n  const startInstantTransition = useCallback((callback: () => void) => {\n    // Use React's startTransition for concurrent mode compatibility\n    startTransition(() => {\n      callback()\n    })\n  }, [])\n\n  return [startInstantTransition, isPending]\n}\n\n/**\n * Force a layout recalculation (useful for FLIP animations)\n *\n * @example\n * ```tsx\n * const forceLayout = useForceUpdate()\n *\n * const handleResize = () => {\n *   // Trigger layout recalculation\n *   forceLayout()\n * }\n * ```\n */\nexport function useForceUpdate(): () => void {\n  const [, setTick] = useState(0)\n\n  return useCallback(() => {\n    setTick((t) => t + 1)\n  }, [])\n}\n\n/**\n * Measure layout before and after a change\n *\n * @example\n * ```tsx\n * const { measureBefore, measureAfter, getLayoutDelta } = useLayoutMeasure()\n *\n * const handleChange = () => {\n *   measureBefore(elementRef.current)\n *   setItems(newItems)\n *   requestAnimationFrame(() => {\n *     const delta = getLayoutDelta(elementRef.current)\n *     // Use delta to animate\n *   })\n * }\n * ```\n */\nexport function useLayoutMeasure() {\n  const beforeRef = useRef<DOMRect | null>(null)\n\n  const measureBefore = useCallback((element: HTMLElement | null) => {\n    if (element) {\n      beforeRef.current = element.getBoundingClientRect()\n    }\n  }, [])\n\n  const measureAfter = useCallback((element: HTMLElement | null): DOMRect | null => {\n    if (element) {\n      return element.getBoundingClientRect()\n    }\n    return null\n  }, [])\n\n  const getLayoutDelta = useCallback((element: HTMLElement | null) => {\n    if (!element || !beforeRef.current) {\n      return { x: 0, y: 0, scaleX: 1, scaleY: 1 }\n    }\n\n    const after = element.getBoundingClientRect()\n    const before = beforeRef.current\n\n    return {\n      x: before.left - after.left,\n      y: before.top - after.top,\n      scaleX: before.width / after.width,\n      scaleY: before.height / after.height,\n    }\n  }, [])\n\n  return { measureBefore, measureAfter, getLayoutDelta }\n}\n\n// Re-export useState for compatibility\nimport { useState } from 'react'\n","import { useLayoutEffect, useEffect } from 'react'\n\n/**\n * Whether we're running in a browser environment\n */\nexport const isBrowser = typeof window !== 'undefined'\n\n/**\n * Whether we're running in a server environment (SSR)\n */\nexport const isServer = !isBrowser\n\n/**\n * SSR-safe version of useLayoutEffect\n *\n * Uses useLayoutEffect in the browser and useEffect on the server\n * to avoid React SSR warnings about useLayoutEffect.\n */\nexport const useIsomorphicLayoutEffect = isBrowser ? useLayoutEffect : useEffect\n\n/**\n * Check if we should skip animations (e.g., during SSR or initial hydration)\n */\nexport function shouldSkipAnimation(): boolean {\n  // Skip on server\n  if (isServer) return true\n\n  // Could add hydration detection here if needed\n  return false\n}\n\n/**\n * Safe requestAnimationFrame that works on server\n */\nexport function safeRequestAnimationFrame(callback: FrameRequestCallback): number {\n  if (isBrowser && typeof requestAnimationFrame !== 'undefined') {\n    return requestAnimationFrame(callback)\n  }\n  // Return a dummy ID on server\n  return 0\n}\n\n/**\n * Safe cancelAnimationFrame that works on server\n */\nexport function safeCancelAnimationFrame(id: number): void {\n  if (isBrowser && typeof cancelAnimationFrame !== 'undefined') {\n    cancelAnimationFrame(id)\n  }\n}\n","import { useState, useRef, useEffect, type RefObject } from 'react'\nimport { isBrowser } from '../utils/ssr.js'\n\nexport interface UseInViewOptions {\n  /**\n   * Only trigger once when element enters viewport\n   * @default false\n   */\n  once?: boolean\n\n  /**\n   * How much of the element should be visible\n   * - 'some': Any part visible (default)\n   * - 'all': Entire element visible\n   * - number: Percentage (0-1)\n   * @default 'some'\n   */\n  amount?: 'some' | 'all' | number\n\n  /**\n   * Margin around the root (viewport)\n   * Same format as CSS margin: \"10px\" or \"10px 20px\" etc.\n   * @default \"0px\"\n   */\n  margin?: string\n\n  /**\n   * Root element for intersection (null = viewport)\n   */\n  root?: RefObject<Element | null>\n}\n\nexport interface UseInViewReturn {\n  /** Ref to attach to the target element */\n  ref: RefObject<HTMLElement | null>\n  /** Whether the element is currently in view */\n  inView: boolean\n  /** IntersectionObserverEntry for advanced usage */\n  entry?: IntersectionObserverEntry\n}\n\n/**\n * Detect when an element enters/exits the viewport\n *\n * SSR-safe: Returns false on server, activates on client.\n *\n * @example Basic usage\n * ```tsx\n * function AnimatedBox() {\n *   const { ref, inView } = useInView()\n *\n *   return (\n *     <div\n *       ref={ref}\n *       style={{ opacity: inView ? 1 : 0 }}\n *     >\n *       I fade in when visible\n *     </div>\n *   )\n * }\n * ```\n *\n * @example Trigger once\n * ```tsx\n * function LazyLoad() {\n *   const { ref, inView } = useInView({ once: true })\n *\n *   return (\n *     <div ref={ref}>\n *       {inView && <ExpensiveComponent />}\n *     </div>\n *   )\n * }\n * ```\n *\n * @example With amount threshold\n * ```tsx\n * function FullyVisible() {\n *   const { ref, inView } = useInView({ amount: 'all' })\n *   // or amount: 0.5 for 50% visible\n * }\n * ```\n */\nexport function useInView(options: UseInViewOptions = {}): UseInViewReturn {\n  const {\n    once = false,\n    amount = 'some',\n    margin = '0px',\n    root,\n  } = options\n\n  const ref = useRef<HTMLElement | null>(null)\n  const [inView, setInView] = useState(false)\n  const [entry, setEntry] = useState<IntersectionObserverEntry | undefined>()\n  const hasTriggered = useRef(false)\n\n  useEffect(() => {\n    // SSR safety\n    if (!isBrowser) return\n\n    const element = ref.current\n    if (!element) return\n\n    // Skip if already triggered with once option\n    if (once && hasTriggered.current) return\n\n    // Calculate threshold\n    let threshold: number | number[]\n    if (amount === 'some') {\n      threshold = 0\n    } else if (amount === 'all') {\n      threshold = 1\n    } else {\n      threshold = amount\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const [observerEntry] = entries\n\n        if (observerEntry) {\n          const isIntersecting = observerEntry.isIntersecting\n\n          setEntry(observerEntry)\n          setInView(isIntersecting)\n\n          if (isIntersecting && once) {\n            hasTriggered.current = true\n            observer.disconnect()\n          }\n        }\n      },\n      {\n        root: root?.current ?? null,\n        rootMargin: margin,\n        threshold,\n      }\n    )\n\n    observer.observe(element)\n\n    return () => {\n      observer.disconnect()\n    }\n  }, [once, amount, margin, root])\n\n  return { ref, inView, entry }\n}\n\n/**\n * Create an InView trigger with a callback\n *\n * @example\n * ```tsx\n * function LazyImage({ src }) {\n *   const [loaded, setLoaded] = useState(false)\n *   const ref = useInViewCallback(() => setLoaded(true), { once: true })\n *\n *   return (\n *     <div ref={ref}>\n *       {loaded ? <img src={src} /> : <Placeholder />}\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useInViewCallback(\n  callback: (entry: IntersectionObserverEntry) => void,\n  options: UseInViewOptions = {}\n): RefObject<HTMLElement | null> {\n  const ref = useRef<HTMLElement | null>(null)\n  const callbackRef = useRef(callback)\n  const hasTriggered = useRef(false)\n\n  // Keep callback ref updated\n  callbackRef.current = callback\n\n  const { once = false, amount = 'some', margin = '0px', root } = options\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    const element = ref.current\n    if (!element) return\n\n    if (once && hasTriggered.current) return\n\n    let threshold: number\n    if (amount === 'some') {\n      threshold = 0\n    } else if (amount === 'all') {\n      threshold = 1\n    } else {\n      threshold = amount\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const [entry] = entries\n\n        if (entry?.isIntersecting) {\n          callbackRef.current(entry)\n\n          if (once) {\n            hasTriggered.current = true\n            observer.disconnect()\n          }\n        }\n      },\n      {\n        root: root?.current ?? null,\n        rootMargin: margin,\n        threshold,\n      }\n    )\n\n    observer.observe(element)\n\n    return () => observer.disconnect()\n  }, [once, amount, margin, root])\n\n  return ref\n}\n\n/**\n * Track multiple elements' visibility\n *\n * @example\n * ```tsx\n * function AnimatedList({ items }) {\n *   const { setRef, getInView } = useInViewMultiple({ stagger: 100 })\n *\n *   return (\n *     <ul>\n *       {items.map((item, i) => (\n *         <li\n *           key={item.id}\n *           ref={(el) => setRef(item.id, el)}\n *           style={{ opacity: getInView(item.id) ? 1 : 0 }}\n *         >\n *           {item.text}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useInViewMultiple(options: UseInViewOptions = {}) {\n  const elementsRef = useRef<Map<string, HTMLElement>>(new Map())\n  const [inViewMap, setInViewMap] = useState<Map<string, boolean>>(new Map())\n  const observerRef = useRef<IntersectionObserver | null>(null)\n\n  const { once = false, amount = 'some', margin = '0px', root } = options\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    let threshold: number\n    if (amount === 'some') {\n      threshold = 0\n    } else if (amount === 'all') {\n      threshold = 1\n    } else {\n      threshold = amount\n    }\n\n    observerRef.current = new IntersectionObserver(\n      (entries) => {\n        setInViewMap((prev) => {\n          const next = new Map(prev)\n\n          entries.forEach((entry) => {\n            const id = (entry.target as HTMLElement).dataset.inviewId\n            if (id) {\n              next.set(id, entry.isIntersecting)\n\n              if (entry.isIntersecting && once) {\n                observerRef.current?.unobserve(entry.target)\n              }\n            }\n          })\n\n          return next\n        })\n      },\n      {\n        root: root?.current ?? null,\n        rootMargin: margin,\n        threshold,\n      }\n    )\n\n    // Observe all registered elements\n    elementsRef.current.forEach((element) => {\n      observerRef.current?.observe(element)\n    })\n\n    return () => {\n      observerRef.current?.disconnect()\n    }\n  }, [once, amount, margin, root])\n\n  const setRef = (id: string, element: HTMLElement | null) => {\n    if (element) {\n      element.dataset.inviewId = id\n      elementsRef.current.set(id, element)\n      observerRef.current?.observe(element)\n    } else {\n      const existing = elementsRef.current.get(id)\n      if (existing) {\n        observerRef.current?.unobserve(existing)\n        elementsRef.current.delete(id)\n      }\n    }\n  }\n\n  const getInView = (id: string): boolean => {\n    return inViewMap.get(id) ?? false\n  }\n\n  return { setRef, getInView, inViewMap }\n}\n","import { useRef, useEffect, type RefObject } from 'react'\r\nimport { MotionValue, createMotionValue } from '../../../core/MotionValue.js'\r\nimport { isBrowser } from '../utils/ssr.js'\r\n\r\nexport interface UseScrollOptions {\r\n  /**\r\n   * Target element to track scroll of\r\n   * If not provided, tracks window/document scroll\r\n   */\r\n  target?: RefObject<HTMLElement | null>\r\n\r\n  /**\r\n   * Container element for scroll tracking\r\n   * Used for calculating progress of target within container\r\n   */\r\n  container?: RefObject<HTMLElement | null>\r\n\r\n  /**\r\n   * Offset for start/end of scroll tracking\r\n   * Format: [\"start end\", \"end start\"]\r\n   *\r\n   * Values can be:\r\n   * - \"start\", \"center\", \"end\" (of element)\r\n   * - Pixels: \"100px\"\r\n   * - Percentage: \"50%\"\r\n   *\r\n   * @default [\"start start\", \"end end\"]\r\n   */\r\n  offset?: [string, string]\r\n\r\n  /**\r\n   * Axis to track\r\n   * @default \"y\"\r\n   */\r\n  axis?: 'x' | 'y'\r\n}\r\n\r\nexport interface UseScrollReturn {\r\n  /** Absolute scroll position X */\r\n  scrollX: MotionValue<number>\r\n  /** Absolute scroll position Y */\r\n  scrollY: MotionValue<number>\r\n  /** Scroll progress X (0-1) */\r\n  scrollXProgress: MotionValue<number>\r\n  /** Scroll progress Y (0-1) */\r\n  scrollYProgress: MotionValue<number>\r\n}\r\n\r\n/**\r\n * Track scroll position and progress with MotionValues\r\n *\r\n * Returns MotionValues that update without React re-renders,\r\n * making it perfect for scroll-linked animations.\r\n *\r\n * @example Window scroll\r\n * ```tsx\r\n * function ScrollProgress() {\r\n *   const { scrollYProgress } = useScroll()\r\n *\r\n *   useEffect(() => {\r\n *     return scrollYProgress.subscribe((progress) => {\r\n *       progressBar.style.scaleX = progress\r\n *     })\r\n *   }, [scrollYProgress])\r\n * }\r\n * ```\r\n *\r\n * @example Element scroll\r\n * ```tsx\r\n * function ScrollableContainer() {\r\n *   const containerRef = useRef(null)\r\n *   const { scrollY } = useScroll({ target: containerRef })\r\n *\r\n *   return (\r\n *     <div ref={containerRef} style={{ overflow: 'auto' }}>\r\n *       ...\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n *\r\n * @example Scroll-linked animation\r\n * ```tsx\r\n * function ParallaxImage() {\r\n *   const ref = useRef(null)\r\n *   const { scrollYProgress } = useScroll({\r\n *     target: ref,\r\n *     offset: [\"start end\", \"end start\"]\r\n *   })\r\n *   const y = useTransform(scrollYProgress, [0, 1], [\"-50%\", \"50%\"])\r\n *\r\n *   return (\r\n *     <div ref={ref}>\r\n *       <img style={{ transform: `translateY(${y.get()})` }} />\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useScroll(options: UseScrollOptions = {}): UseScrollReturn {\r\n  const { target, container, offset = ['start start', 'end end'], axis = 'y' } = options\r\n\r\n  // Create MotionValues\r\n  const scrollXRef = useRef<MotionValue<number> | null>(null)\r\n  const scrollYRef = useRef<MotionValue<number> | null>(null)\r\n  const scrollXProgressRef = useRef<MotionValue<number> | null>(null)\r\n  const scrollYProgressRef = useRef<MotionValue<number> | null>(null)\r\n\r\n  if (scrollXRef.current === null) {\r\n    scrollXRef.current = createMotionValue(0)\r\n    scrollYRef.current = createMotionValue(0)\r\n    scrollXProgressRef.current = createMotionValue(0)\r\n    scrollYProgressRef.current = createMotionValue(0)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!isBrowser) return\r\n\r\n    const scrollX = scrollXRef.current!\r\n    const scrollY = scrollYRef.current!\r\n    const scrollXProgress = scrollXProgressRef.current!\r\n    const scrollYProgress = scrollYProgressRef.current!\r\n\r\n    // Determine scroll container\r\n    const scrollContainer = container?.current ?? (target?.current ?? window)\r\n    const isWindow = scrollContainer === window\r\n\r\n    const getScrollPosition = () => {\r\n      if (isWindow) {\r\n        return {\r\n          x: window.scrollX || window.pageXOffset,\r\n          y: window.scrollY || window.pageYOffset,\r\n        }\r\n      }\r\n      const el = scrollContainer as HTMLElement\r\n      return {\r\n        x: el.scrollLeft,\r\n        y: el.scrollTop,\r\n      }\r\n    }\r\n\r\n    const getScrollSize = () => {\r\n      if (isWindow) {\r\n        return {\r\n          width: document.documentElement.scrollWidth - window.innerWidth,\r\n          height: document.documentElement.scrollHeight - window.innerHeight,\r\n        }\r\n      }\r\n      const el = scrollContainer as HTMLElement\r\n      return {\r\n        width: el.scrollWidth - el.clientWidth,\r\n        height: el.scrollHeight - el.clientHeight,\r\n      }\r\n    }\r\n\r\n    const calculateProgress = () => {\r\n      const position = getScrollPosition()\r\n      const size = getScrollSize()\r\n\r\n      // Update absolute positions\r\n      scrollX.jump(position.x)\r\n      scrollY.jump(position.y)\r\n\r\n      // Update progress (0-1)\r\n      scrollXProgress.jump(size.width > 0 ? position.x / size.width : 0)\r\n      scrollYProgress.jump(size.height > 0 ? position.y / size.height : 0)\r\n    }\r\n\r\n    // Target element progress (element visibility in viewport)\r\n    const calculateTargetProgress = () => {\r\n      const targetEl = target?.current\r\n      if (!targetEl) {\r\n        calculateProgress()\r\n        return\r\n      }\r\n\r\n      const position = getScrollPosition()\r\n      scrollX.jump(position.x)\r\n      scrollY.jump(position.y)\r\n\r\n      // Get target bounds\r\n      const rect = targetEl.getBoundingClientRect()\r\n      const viewportHeight = window.innerHeight\r\n      const viewportWidth = window.innerWidth\r\n\r\n      // Parse offsets\r\n      const [startOffset, endOffset] = offset\r\n\r\n      // Calculate start and end points\r\n      // \"start end\" = when target top hits viewport bottom\r\n      // \"end start\" = when target bottom hits viewport top\r\n      const startPoint = parseOffset(startOffset, rect, viewportHeight, viewportWidth, 'start')\r\n      const endPoint = parseOffset(endOffset, rect, viewportHeight, viewportWidth, 'end')\r\n\r\n      // Current position in the range\r\n      const current = axis === 'y' ? rect.top : rect.left\r\n      const range = endPoint - startPoint\r\n\r\n      const progress = range !== 0 ? (startPoint - current) / range : 0\r\n      const clampedProgress = Math.max(0, Math.min(1, progress))\r\n\r\n      if (axis === 'y') {\r\n        scrollYProgress.jump(clampedProgress)\r\n      } else {\r\n        scrollXProgress.jump(clampedProgress)\r\n      }\r\n    }\r\n\r\n    // Use RAF for smooth updates\r\n    let rafId: number | null = null\r\n    const handleScroll = () => {\r\n      if (rafId !== null) return\r\n\r\n      rafId = requestAnimationFrame(() => {\r\n        if (target?.current) {\r\n          calculateTargetProgress()\r\n        } else {\r\n          calculateProgress()\r\n        }\r\n        rafId = null\r\n      })\r\n    }\r\n\r\n    // Initial calculation\r\n    handleScroll()\r\n\r\n    // Add scroll listener\r\n    const scrollTarget = isWindow ? window : scrollContainer\r\n    scrollTarget.addEventListener('scroll', handleScroll, { passive: true })\r\n\r\n    // Also listen to resize for progress recalculation\r\n    window.addEventListener('resize', handleScroll, { passive: true })\r\n\r\n    return () => {\r\n      scrollTarget.removeEventListener('scroll', handleScroll)\r\n      window.removeEventListener('resize', handleScroll)\r\n      if (rafId !== null) {\r\n        cancelAnimationFrame(rafId)\r\n      }\r\n    }\r\n  }, [target, container, offset, axis])\r\n\r\n  // Cleanup on unmount\r\n  useEffect(() => {\r\n    return () => {\r\n      scrollXRef.current?.destroy()\r\n      scrollYRef.current?.destroy()\r\n      scrollXProgressRef.current?.destroy()\r\n      scrollYProgressRef.current?.destroy()\r\n    }\r\n  }, [])\r\n\r\n  return {\r\n    scrollX: scrollXRef.current!,\r\n    scrollY: scrollYRef.current!,\r\n    scrollXProgress: scrollXProgressRef.current!,\r\n    scrollYProgress: scrollYProgressRef.current!,\r\n  }\r\n}\r\n\r\n/**\r\n * Parse offset string like \"start end\" or \"100px\"\r\n */\r\nfunction parseOffset(\r\n  offset: string,\r\n  rect: DOMRect,\r\n  viewportHeight: number,\r\n  _viewportWidth: number,\r\n  _type: 'start' | 'end'\r\n): number {\r\n  const parts = offset.split(' ')\r\n  const elementPart = parts[0] || 'start'\r\n  const viewportPart = parts[1] || 'start'\r\n\r\n  // Element position\r\n  let elementPos: number\r\n  if (elementPart === 'start') {\r\n    elementPos = rect.top\r\n  } else if (elementPart === 'center') {\r\n    elementPos = rect.top + rect.height / 2\r\n  } else if (elementPart === 'end') {\r\n    elementPos = rect.bottom\r\n  } else if (elementPart.endsWith('px')) {\r\n    elementPos = rect.top + parseFloat(elementPart)\r\n  } else if (elementPart.endsWith('%')) {\r\n    elementPos = rect.top + (rect.height * parseFloat(elementPart)) / 100\r\n  } else {\r\n    elementPos = rect.top\r\n  }\r\n\r\n  // Viewport position\r\n  let viewportPos: number\r\n  if (viewportPart === 'start') {\r\n    viewportPos = 0\r\n  } else if (viewportPart === 'center') {\r\n    viewportPos = viewportHeight / 2\r\n  } else if (viewportPart === 'end') {\r\n    viewportPos = viewportHeight\r\n  } else if (viewportPart.endsWith('px')) {\r\n    viewportPos = parseFloat(viewportPart)\r\n  } else if (viewportPart.endsWith('%')) {\r\n    viewportPos = (viewportHeight * parseFloat(viewportPart)) / 100\r\n  } else {\r\n    viewportPos = 0\r\n  }\r\n\r\n  return viewportPos - elementPos\r\n}\r\n\r\n/**\r\n * Simple scroll velocity tracking\r\n *\r\n * @example\r\n * ```tsx\r\n * function ScrollVelocityText() {\r\n *   const velocity = useScrollVelocity()\r\n *\r\n *   return (\r\n *     <div style={{\r\n *       transform: `skewY(${velocity.get() * 0.01}deg)`\r\n *     }}>\r\n *       Skews based on scroll speed\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useScrollVelocity(axis: 'x' | 'y' = 'y'): MotionValue<number> {\r\n  const velocityRef = useRef<MotionValue<number> | null>(null)\r\n  const lastScrollRef = useRef(0)\r\n  const lastTimeRef = useRef(Date.now())\r\n\r\n  if (velocityRef.current === null) {\r\n    velocityRef.current = createMotionValue(0)\r\n  }\r\n\r\n  useEffect(() => {\r\n    if (!isBrowser) return\r\n\r\n    const velocity = velocityRef.current!\r\n\r\n    const handleScroll = () => {\r\n      const now = Date.now()\r\n      const currentScroll = axis === 'y'\r\n        ? (window.scrollY || window.pageYOffset)\r\n        : (window.scrollX || window.pageXOffset)\r\n\r\n      const deltaTime = now - lastTimeRef.current\r\n      const deltaScroll = currentScroll - lastScrollRef.current\r\n\r\n      if (deltaTime > 0) {\r\n        velocity.jump(deltaScroll / deltaTime * 1000) // pixels per second\r\n      }\r\n\r\n      lastScrollRef.current = currentScroll\r\n      lastTimeRef.current = now\r\n    }\r\n\r\n    window.addEventListener('scroll', handleScroll, { passive: true })\r\n\r\n    return () => {\r\n      window.removeEventListener('scroll', handleScroll)\r\n    }\r\n  }, [axis])\r\n\r\n  useEffect(() => {\r\n    return () => {\r\n      velocityRef.current?.destroy()\r\n    }\r\n  }, [])\r\n\r\n  return velocityRef.current!\r\n}\r\n","import { useState, useRef, useEffect, type RefObject } from 'react'\r\nimport { isBrowser } from '../utils/ssr.js'\r\n\r\nexport interface GestureState {\r\n  /** Is the element being hovered */\r\n  isHovered: boolean\r\n  /** Is the element being pressed/tapped */\r\n  isPressed: boolean\r\n  /** Is the element focused */\r\n  isFocused: boolean\r\n  /** Is the element being dragged */\r\n  isDragging: boolean\r\n}\r\n\r\nexport interface UseGestureStateOptions {\r\n  /** Enable hover tracking */\r\n  hover?: boolean\r\n  /** Enable press/tap tracking */\r\n  press?: boolean\r\n  /** Enable focus tracking */\r\n  focus?: boolean\r\n  /** Enable drag tracking */\r\n  drag?: boolean\r\n}\r\n\r\nexport interface UseGestureStateReturn extends GestureState {\r\n  /** Ref to attach to the target element */\r\n  ref: RefObject<HTMLElement | null>\r\n  /** Handlers to spread on the element */\r\n  handlers: {\r\n    onMouseEnter?: () => void\r\n    onMouseLeave?: () => void\r\n    onMouseDown?: () => void\r\n    onMouseUp?: () => void\r\n    onTouchStart?: () => void\r\n    onTouchEnd?: () => void\r\n    onFocus?: () => void\r\n    onBlur?: () => void\r\n    onDragStart?: () => void\r\n    onDragEnd?: () => void\r\n  }\r\n}\r\n\r\n/**\r\n * Track gesture states for an element\r\n *\r\n * @example\r\n * ```tsx\r\n * function InteractiveButton() {\r\n *   const { ref, isHovered, isPressed, handlers } = useGestureState({\r\n *     hover: true,\r\n *     press: true,\r\n *   })\r\n *\r\n *   const scale = isPressed ? 0.95 : isHovered ? 1.05 : 1\r\n *\r\n *   return (\r\n *     <button\r\n *       ref={ref}\r\n *       {...handlers}\r\n *       style={{ transform: `scale(${scale})` }}\r\n *     >\r\n *       Click me\r\n *     </button>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useGestureState(\r\n  options: UseGestureStateOptions = {}\r\n): UseGestureStateReturn {\r\n  const {\r\n    hover = true,\r\n    press = true,\r\n    focus = true,\r\n    drag = false,\r\n  } = options\r\n\r\n  const ref = useRef<HTMLElement | null>(null)\r\n  const [state, setState] = useState<GestureState>({\r\n    isHovered: false,\r\n    isPressed: false,\r\n    isFocused: false,\r\n    isDragging: false,\r\n  })\r\n\r\n  // Memoized handlers\r\n  const handlers = {\r\n    ...(hover && {\r\n      onMouseEnter: () => setState((s) => ({ ...s, isHovered: true })),\r\n      onMouseLeave: () => setState((s) => ({ ...s, isHovered: false, isPressed: false })),\r\n    }),\r\n    ...(press && {\r\n      onMouseDown: () => setState((s) => ({ ...s, isPressed: true })),\r\n      onMouseUp: () => setState((s) => ({ ...s, isPressed: false })),\r\n      onTouchStart: () => setState((s) => ({ ...s, isPressed: true })),\r\n      onTouchEnd: () => setState((s) => ({ ...s, isPressed: false })),\r\n    }),\r\n    ...(focus && {\r\n      onFocus: () => setState((s) => ({ ...s, isFocused: true })),\r\n      onBlur: () => setState((s) => ({ ...s, isFocused: false })),\r\n    }),\r\n    ...(drag && {\r\n      onDragStart: () => setState((s) => ({ ...s, isDragging: true })),\r\n      onDragEnd: () => setState((s) => ({ ...s, isDragging: false })),\r\n    }),\r\n  }\r\n\r\n  // Global mouseup listener for press\r\n  useEffect(() => {\r\n    if (!press || !isBrowser) return\r\n\r\n    const handleGlobalMouseUp = () => {\r\n      setState((s) => (s.isPressed ? { ...s, isPressed: false } : s))\r\n    }\r\n\r\n    window.addEventListener('mouseup', handleGlobalMouseUp)\r\n    window.addEventListener('touchend', handleGlobalMouseUp)\r\n\r\n    return () => {\r\n      window.removeEventListener('mouseup', handleGlobalMouseUp)\r\n      window.removeEventListener('touchend', handleGlobalMouseUp)\r\n    }\r\n  }, [press])\r\n\r\n  return {\r\n    ref,\r\n    ...state,\r\n    handlers,\r\n  }\r\n}\r\n\r\n/**\r\n * Hook for hover state only\r\n *\r\n * @example\r\n * ```tsx\r\n * function HoverCard() {\r\n *   const { ref, isHovered, handlers } = useHover()\r\n *\r\n *   return (\r\n *     <div\r\n *       ref={ref}\r\n *       {...handlers}\r\n *       style={{ opacity: isHovered ? 1 : 0.7 }}\r\n *     >\r\n *       Hover me\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useHover() {\r\n  const ref = useRef<HTMLElement | null>(null)\r\n  const [isHovered, setIsHovered] = useState(false)\r\n\r\n  const handlers = {\r\n    onMouseEnter: () => setIsHovered(true),\r\n    onMouseLeave: () => setIsHovered(false),\r\n  }\r\n\r\n  return { ref, isHovered, handlers }\r\n}\r\n\r\n/**\r\n * Hook for tap/press state\r\n *\r\n * @example\r\n * ```tsx\r\n * function TapButton() {\r\n *   const { ref, isPressed, handlers } = useTap()\r\n *\r\n *   return (\r\n *     <button\r\n *       ref={ref}\r\n *       {...handlers}\r\n *       style={{ transform: `scale(${isPressed ? 0.95 : 1})` }}\r\n *     >\r\n *       Press me\r\n *     </button>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useTap() {\r\n  const ref = useRef<HTMLElement | null>(null)\r\n  const [isPressed, setIsPressed] = useState(false)\r\n\r\n  const handlers = {\r\n    onMouseDown: () => setIsPressed(true),\r\n    onMouseUp: () => setIsPressed(false),\r\n    onMouseLeave: () => setIsPressed(false),\r\n    onTouchStart: () => setIsPressed(true),\r\n    onTouchEnd: () => setIsPressed(false),\r\n  }\r\n\r\n  // Global release\r\n  useEffect(() => {\r\n    if (!isBrowser) return\r\n\r\n    const handleUp = () => setIsPressed(false)\r\n    window.addEventListener('mouseup', handleUp)\r\n    window.addEventListener('touchend', handleUp)\r\n\r\n    return () => {\r\n      window.removeEventListener('mouseup', handleUp)\r\n      window.removeEventListener('touchend', handleUp)\r\n    }\r\n  }, [])\r\n\r\n  return { ref, isPressed, handlers }\r\n}\r\n\r\n/**\r\n * Hook for focus state\r\n *\r\n * @example\r\n * ```tsx\r\n * function FocusInput() {\r\n *   const { ref, isFocused, handlers } = useFocus()\r\n *\r\n *   return (\r\n *     <input\r\n *       ref={ref}\r\n *       {...handlers}\r\n *       style={{ borderColor: isFocused ? 'blue' : 'gray' }}\r\n *     />\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useFocus() {\r\n  const ref = useRef<HTMLElement | null>(null)\r\n  const [isFocused, setIsFocused] = useState(false)\r\n\r\n  const handlers = {\r\n    onFocus: () => setIsFocused(true),\r\n    onBlur: () => setIsFocused(false),\r\n  }\r\n\r\n  return { ref, isFocused, handlers }\r\n}\r\n\r\n/**\r\n * Combined hook for common interaction states\r\n *\r\n * Returns the current \"active\" state based on priority:\r\n * pressed > hovered > focused > default\r\n *\r\n * @example\r\n * ```tsx\r\n * function InteractiveElement() {\r\n *   const { ref, activeState, handlers } = useInteractionState()\r\n *\r\n *   const styles = {\r\n *     default: { scale: 1, opacity: 0.7 },\r\n *     hovered: { scale: 1.05, opacity: 0.9 },\r\n *     pressed: { scale: 0.95, opacity: 1 },\r\n *     focused: { scale: 1, opacity: 1 },\r\n *   }\r\n *\r\n *   const current = styles[activeState]\r\n *\r\n *   return (\r\n *     <div ref={ref} {...handlers} style={{ transform: `scale(${current.scale})` }}>\r\n *       Interact with me\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useInteractionState() {\r\n  const { ref, isHovered, isPressed, isFocused, handlers } = useGestureState({\r\n    hover: true,\r\n    press: true,\r\n    focus: true,\r\n  })\r\n\r\n  const activeState: 'default' | 'hovered' | 'pressed' | 'focused' =\r\n    isPressed ? 'pressed' :\r\n    isHovered ? 'hovered' :\r\n    isFocused ? 'focused' :\r\n    'default'\r\n\r\n  return { ref, isHovered, isPressed, isFocused, activeState, handlers }\r\n}\r\n\r\n/**\r\n * Hook that returns animated values for gesture states\r\n *\r\n * @example\r\n * ```tsx\r\n * function AnimatedButton() {\r\n *   const { ref, scale, opacity, handlers } = useGestureAnimation({\r\n *     default: { scale: 1, opacity: 0.8 },\r\n *     hover: { scale: 1.05, opacity: 1 },\r\n *     press: { scale: 0.95, opacity: 1 },\r\n *   })\r\n *\r\n *   return (\r\n *     <button\r\n *       ref={ref}\r\n *       {...handlers}\r\n *       style={{ transform: `scale(${scale})`, opacity }}\r\n *     >\r\n *       Animated Button\r\n *     </button>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useGestureAnimation<T extends Record<string, number>>(\r\n  states: {\r\n    default: T\r\n    hover?: Partial<T>\r\n    press?: Partial<T>\r\n    focus?: Partial<T>\r\n  }\r\n) {\r\n  const { ref, isHovered, isPressed, isFocused, handlers } = useGestureState({\r\n    hover: !!states.hover,\r\n    press: !!states.press,\r\n    focus: !!states.focus,\r\n  })\r\n\r\n  // Merge states based on priority\r\n  const currentValues = { ...states.default }\r\n\r\n  if (isFocused && states.focus) {\r\n    Object.assign(currentValues, states.focus)\r\n  }\r\n  if (isHovered && states.hover) {\r\n    Object.assign(currentValues, states.hover)\r\n  }\r\n  if (isPressed && states.press) {\r\n    Object.assign(currentValues, states.press)\r\n  }\r\n\r\n  return {\r\n    ref,\r\n    handlers,\r\n    isHovered,\r\n    isPressed,\r\n    isFocused,\r\n    ...currentValues,\r\n  }\r\n}\r\n","import { useState, useEffect } from 'react'\r\nimport { isBrowser } from '../utils/ssr.js'\r\n\r\n/**\r\n * Detect user's reduced motion preference\r\n *\r\n * Respects the `prefers-reduced-motion` media query.\r\n * Returns true when the user has requested reduced motion.\r\n *\r\n * @example\r\n * ```tsx\r\n * function AnimatedComponent() {\r\n *   const prefersReducedMotion = useReducedMotion()\r\n *\r\n *   const config = prefersReducedMotion\r\n *     ? { duration: 0 } // Instant\r\n *     : { stiffness: 100, damping: 15 } // Spring\r\n *\r\n *   return <Animated.div config={config}>...</Animated.div>\r\n * }\r\n * ```\r\n *\r\n * @example With fallback animation\r\n * ```tsx\r\n * function FadeIn({ children }) {\r\n *   const prefersReducedMotion = useReducedMotion()\r\n *\r\n *   return (\r\n *     <Animated.div\r\n *       initial={{ opacity: prefersReducedMotion ? 1 : 0 }}\r\n *       animate={{ opacity: 1 }}\r\n *     >\r\n *       {children}\r\n *     </Animated.div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useReducedMotion(): boolean {\r\n  // Always start with false to prevent SSR hydration mismatch\r\n  // The actual value will be set in useEffect after hydration\r\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(false)\r\n\r\n  useEffect(() => {\r\n    if (!isBrowser) return\r\n\r\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')\r\n\r\n    // Set initial value after mount (prevents hydration mismatch)\r\n    setPrefersReducedMotion(mediaQuery.matches)\r\n\r\n    // Update state when preference changes\r\n    const handleChange = (event: MediaQueryListEvent) => {\r\n      setPrefersReducedMotion(event.matches)\r\n    }\r\n\r\n    // Modern API\r\n    if (mediaQuery.addEventListener) {\r\n      mediaQuery.addEventListener('change', handleChange)\r\n      return () => mediaQuery.removeEventListener('change', handleChange)\r\n    }\r\n\r\n    // Legacy API (Safari < 14)\r\n    mediaQuery.addListener(handleChange)\r\n    return () => mediaQuery.removeListener(handleChange)\r\n  }, [])\r\n\r\n  return prefersReducedMotion\r\n}\r\n\r\n/**\r\n * Get reduced motion preference synchronously (for SSR)\r\n *\r\n * @returns false on server, actual value on client\r\n */\r\nexport function getReducedMotionPreference(): boolean {\r\n  if (!isBrowser) return false\r\n  return window.matchMedia('(prefers-reduced-motion: reduce)').matches\r\n}\r\n\r\n/**\r\n * Create animation config based on reduced motion preference\r\n *\r\n * @example\r\n * ```tsx\r\n * function AnimatedBox() {\r\n *   const config = useReducedMotionConfig({\r\n *     default: { stiffness: 100, damping: 15 },\r\n *     reduced: { stiffness: 500, damping: 50 }, // Much stiffer = faster\r\n *   })\r\n *\r\n *   return <Animated.div config={config}>...</Animated.div>\r\n * }\r\n * ```\r\n */\r\nexport function useReducedMotionConfig<T>(configs: {\r\n  default: T\r\n  reduced: T\r\n}): T {\r\n  const prefersReducedMotion = useReducedMotion()\r\n  return prefersReducedMotion ? configs.reduced : configs.default\r\n}\r\n\r\n/**\r\n * Skip animations entirely when reduced motion is preferred\r\n *\r\n * @example\r\n * ```tsx\r\n * function AnimatedList() {\r\n *   const shouldAnimate = useShouldAnimate()\r\n *\r\n *   return items.map((item, i) => (\r\n *     <Animated.li\r\n *       initial={shouldAnimate ? { opacity: 0 } : false}\r\n *       animate={{ opacity: 1 }}\r\n *       transition={shouldAnimate ? { delay: i * 0.1 } : { duration: 0 }}\r\n *     >\r\n *       {item}\r\n *     </Animated.li>\r\n *   ))\r\n * }\r\n * ```\r\n */\r\nexport function useShouldAnimate(): boolean {\r\n  return !useReducedMotion()\r\n}\r\n\r\n/**\r\n * Create an animation value that respects reduced motion\r\n *\r\n * Returns the full animation when motion is allowed,\r\n * or the final value immediately when reduced motion is preferred.\r\n *\r\n * @example\r\n * ```tsx\r\n * function SlideIn() {\r\n *   const x = useReducedMotionValue(0, 100)\r\n *   // Returns 0  100 normally\r\n *   // Returns 100 immediately with reduced motion\r\n *\r\n *   return <Animated.div animate={{ x }}>...</Animated.div>\r\n * }\r\n * ```\r\n */\r\nexport function useReducedMotionValue<T>(\r\n  animatedValue: T,\r\n  reducedValue: T\r\n): T {\r\n  const prefersReducedMotion = useReducedMotion()\r\n  return prefersReducedMotion ? reducedValue : animatedValue\r\n}\r\n","/**\r\n * React hooks for scroll-linked animations\r\n */\r\nimport { useRef, useState } from 'react'\r\nimport {\r\n  createScrollProgress,\r\n  createParallax,\r\n  createScrollTrigger,\r\n  createScrollLinkedValue,\r\n  type ScrollInfo,\r\n  type ScrollProgress,\r\n  type ParallaxConfig,\r\n  type ScrollTriggerConfig,\r\n  type ScrollLinkedConfig,\r\n} from '../../../index.js'\r\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\r\n\r\n// ============ useScrollProgress ============\r\n\r\nexport interface UseScrollProgressOptions {\r\n  /** Target element ref (uses page scroll if not provided) */\r\n  target?: React.RefObject<HTMLElement>\r\n  /** Scroll offset configuration */\r\n  offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\r\n  /** Smoothing factor (0-1, higher = smoother) */\r\n  smooth?: number\r\n}\r\n\r\nexport interface UseScrollProgressReturn {\r\n  /** Current scroll progress (0-1) */\r\n  progress: number\r\n  /** Full scroll info object */\r\n  info: ScrollInfo\r\n  /** The scroll progress controller */\r\n  scrollProgress: ScrollProgress | null\r\n}\r\n\r\n/**\r\n * Track scroll progress for an element or the page\r\n *\r\n * @example\r\n * ```tsx\r\n * function ScrollIndicator() {\r\n *   const { progress } = useScrollProgress()\r\n *   return <div style={{ width: `${progress * 100}%` }} />\r\n * }\r\n *\r\n * function SectionProgress() {\r\n *   const ref = useRef<HTMLDivElement>(null)\r\n *   const { progress } = useScrollProgress({ target: ref })\r\n *   return <div ref={ref}>{Math.round(progress * 100)}%</div>\r\n * }\r\n * ```\r\n */\r\nexport function useScrollProgress(\r\n  options: UseScrollProgressOptions = {}\r\n): UseScrollProgressReturn {\r\n  const { target, offset, smooth } = options\r\n\r\n  const [progress, setProgress] = useState(0)\r\n  const [info, setInfo] = useState<ScrollInfo>({\r\n    progress: 0,\r\n    scrollY: 0,\r\n    velocity: 0,\r\n    direction: 0,\r\n    isInView: true,\r\n    visibleRatio: 1,\r\n  })\r\n  const scrollProgressRef = useRef<ScrollProgress | null>(null)\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    const element = target?.current ?? null\r\n    const scrollProgress = createScrollProgress(element, { offset, smooth })\r\n    scrollProgressRef.current = scrollProgress\r\n\r\n    const unsubscribe = scrollProgress.subscribe((scrollInfo) => {\r\n      setProgress(scrollInfo.progress)\r\n      setInfo(scrollInfo)\r\n    })\r\n\r\n    return () => {\r\n      unsubscribe()\r\n      scrollProgress.destroy()\r\n    }\r\n  }, [target?.current, offset?.[0], offset?.[1], smooth])\r\n\r\n  return {\r\n    progress,\r\n    info,\r\n    scrollProgress: scrollProgressRef.current,\r\n  }\r\n}\r\n\r\n// ============ useParallax ============\r\n\r\nexport interface UseParallaxOptions extends Omit<ParallaxConfig, 'easing'> {\r\n  /** Easing function */\r\n  easing?: (t: number) => number\r\n}\r\n\r\nexport interface UseParallaxReturn {\r\n  /** Ref to attach to the element */\r\n  ref: React.RefObject<HTMLElement>\r\n  /** Current offset value */\r\n  offset: number\r\n}\r\n\r\n/**\r\n * Create a parallax effect for an element\r\n *\r\n * @example\r\n * ```tsx\r\n * function ParallaxImage() {\r\n *   const { ref } = useParallax({ speed: 0.5 })\r\n *   return <img ref={ref} src=\"...\" />\r\n * }\r\n * ```\r\n */\r\nexport function useParallax(\r\n  options: UseParallaxOptions = {}\r\n): UseParallaxReturn {\r\n  const ref = useRef<HTMLElement>(null)\r\n  const [offset, setOffset] = useState(0)\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (!ref.current) return\r\n\r\n    const parallax = createParallax(ref.current, options)\r\n\r\n    // Update offset periodically\r\n    const intervalId = setInterval(() => {\r\n      setOffset(parallax.getOffset())\r\n    }, 16) // ~60fps\r\n\r\n    return () => {\r\n      clearInterval(intervalId)\r\n      parallax.destroy()\r\n    }\r\n  }, [options.speed, options.direction, options.rootMargin])\r\n\r\n  return { ref: ref as React.RefObject<HTMLElement>, offset }\r\n}\r\n\r\n// ============ useScrollTrigger ============\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\r\nexport interface UseScrollTriggerOptions\r\n  extends Omit<ScrollTriggerConfig, 'onEnter' | 'onLeave' | 'onProgress'> {}\r\n\r\nexport interface UseScrollTriggerReturn {\r\n  /** Ref to attach to the element */\r\n  ref: React.RefObject<HTMLElement>\r\n  /** Whether the trigger is currently active */\r\n  isActive: boolean\r\n  /** Current progress within the trigger range */\r\n  progress: number\r\n  /** Whether element has entered the trigger zone */\r\n  hasEntered: boolean\r\n}\r\n\r\n/**\r\n * Create a scroll trigger for animations\r\n *\r\n * @example\r\n * ```tsx\r\n * function FadeInSection() {\r\n *   const { ref, isActive, progress } = useScrollTrigger({\r\n *     start: 'top',\r\n *     end: 'center',\r\n *   })\r\n *\r\n *   return (\r\n *     <div ref={ref} style={{ opacity: progress }}>\r\n *       Content fades in as you scroll\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useScrollTrigger(\r\n  options: UseScrollTriggerOptions = {}\r\n): UseScrollTriggerReturn {\r\n  const ref = useRef<HTMLElement>(null)\r\n  const [isActive, setIsActive] = useState(false)\r\n  const [progress, setProgress] = useState(0)\r\n  const [hasEntered, setHasEntered] = useState(false)\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (!ref.current) return\r\n\r\n    const trigger = createScrollTrigger(ref.current, {\r\n      ...options,\r\n      onEnter: () => setHasEntered(true),\r\n      onProgress: (info) => {\r\n        setIsActive(info.progress > 0 && info.progress < 1)\r\n        setProgress(info.progress)\r\n      },\r\n    })\r\n\r\n    return () => trigger.destroy()\r\n  }, [\r\n    options.start,\r\n    options.end,\r\n    options.startOffset,\r\n    options.endOffset,\r\n    options.once,\r\n    options.scrub,\r\n  ])\r\n\r\n  return { ref: ref as React.RefObject<HTMLElement>, isActive, progress, hasEntered }\r\n}\r\n\r\n// ============ useScrollLinkedValue ============\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\r\nexport interface UseScrollLinkedValueOptions extends ScrollLinkedConfig {}\r\n\r\n/**\r\n * Create a scroll-linked interpolated value\r\n *\r\n * @example\r\n * ```tsx\r\n * function ColorTransition() {\r\n *   const { progress } = useScrollProgress()\r\n *   const color = useScrollLinkedValue(progress, {\r\n *     inputRange: [0, 0.5, 1],\r\n *     outputRange: ['#ff0000', '#00ff00', '#0000ff'],\r\n *   })\r\n *\r\n *   return <div style={{ backgroundColor: color }}>...</div>\r\n * }\r\n * ```\r\n */\r\nexport function useScrollLinkedValue(\r\n  scrollProgress: ScrollProgress | null,\r\n  config: UseScrollLinkedValueOptions\r\n): number | string {\r\n  const [value, setValue] = useState<number | string>(config.outputRange[0] ?? 0)\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (!scrollProgress) return\r\n\r\n    const linkedValue = createScrollLinkedValue(scrollProgress, config)\r\n\r\n    const unsubscribe = linkedValue.subscribe((newValue) => {\r\n      setValue(newValue)\r\n    })\r\n\r\n    return () => {\r\n      unsubscribe()\r\n      linkedValue.destroy()\r\n    }\r\n  }, [scrollProgress, config.inputRange, config.outputRange, config.clamp, config.smooth])\r\n\r\n  return value\r\n}\r\n","/**\r\n * React hook for Timeline API\r\n */\r\nimport { useRef, useCallback, useMemo } from 'react'\r\nimport {\r\n  createTimeline,\r\n  type TimelineConfig,\r\n  type Timeline,\r\n  type TimelineTarget,\r\n  type TimelineProps,\r\n  type TimelinePosition,\r\n} from '../../../index.js'\r\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\r\n\r\n// ============ Types ============\r\n\r\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\r\nexport interface UseTimelineOptions extends TimelineConfig {}\r\n\r\nexport interface UseTimelineReturn {\r\n  /** The timeline instance */\r\n  timeline: Timeline | null\r\n  /** Play the timeline */\r\n  play: () => void\r\n  /** Pause the timeline */\r\n  pause: () => void\r\n  /** Resume from paused state */\r\n  resume: () => void\r\n  /** Reverse the timeline */\r\n  reverse: () => void\r\n  /** Restart from beginning */\r\n  restart: () => void\r\n  /** Seek to a specific progress (0-1) or time */\r\n  seek: (progress: number) => void\r\n  /** Add a .to() animation */\r\n  to: (target: TimelineTarget, props: TimelineProps, position?: TimelinePosition) => UseTimelineReturn\r\n  /** Add a .from() animation */\r\n  from: (target: TimelineTarget, props: TimelineProps, position?: TimelinePosition) => UseTimelineReturn\r\n  /** Add a .fromTo() animation */\r\n  fromTo: (target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition) => UseTimelineReturn\r\n  /** Add a label */\r\n  addLabel: (label: string, position?: TimelinePosition) => UseTimelineReturn\r\n  /** Kill the timeline */\r\n  kill: () => void\r\n  /** Check if playing */\r\n  isPlaying: boolean\r\n  /** Check if paused */\r\n  isPaused: boolean\r\n  /** Current progress (0-1) */\r\n  progress: number\r\n}\r\n\r\n/**\r\n * Create and control a timeline animation\r\n *\r\n * @example Basic usage\r\n * ```tsx\r\n * function AnimatedSequence() {\r\n *   const box1 = useRef<HTMLDivElement>(null)\r\n *   const box2 = useRef<HTMLDivElement>(null)\r\n *\r\n *   const { timeline, play } = useTimeline({\r\n *     paused: true,\r\n *     onComplete: () => console.log('Done!'),\r\n *   })\r\n *\r\n *   useEffect(() => {\r\n *     if (timeline && box1.current && box2.current) {\r\n *       timeline\r\n *         .to(box1.current, { x: 100, opacity: 1 })\r\n *         .to(box2.current, { x: 100, opacity: 1 }, '-=200')\r\n *     }\r\n *   }, [timeline])\r\n *\r\n *   return (\r\n *     <>\r\n *       <button onClick={play}>Play</button>\r\n *       <div ref={box1} style={{ opacity: 0 }}>Box 1</div>\r\n *       <div ref={box2} style={{ opacity: 0 }}>Box 2</div>\r\n *     </>\r\n *   )\r\n * }\r\n * ```\r\n *\r\n * @example With labels\r\n * ```tsx\r\n * const { timeline } = useTimeline()\r\n *\r\n * timeline\r\n *   .addLabel('start')\r\n *   .to(element, { x: 100 })\r\n *   .addLabel('middle')\r\n *   .to(element, { y: 100 })\r\n *   .to(otherElement, { opacity: 1 }, 'start') // Jump back to start label\r\n * ```\r\n */\r\nexport function useTimeline(\r\n  options: UseTimelineOptions = {}\r\n): UseTimelineReturn {\r\n  const timelineRef = useRef<Timeline | null>(null)\r\n\r\n  // Create timeline on mount\r\n  useIsomorphicLayoutEffect(() => {\r\n    const timeline = createTimeline(options)\r\n    timelineRef.current = timeline\r\n\r\n    return () => {\r\n      timeline.kill()\r\n    }\r\n  }, [])\r\n\r\n  const play = useCallback(() => {\r\n    timelineRef.current?.play()\r\n  }, [])\r\n\r\n  const pause = useCallback(() => {\r\n    timelineRef.current?.pause()\r\n  }, [])\r\n\r\n  const resume = useCallback(() => {\r\n    timelineRef.current?.resume()\r\n  }, [])\r\n\r\n  const reverse = useCallback(() => {\r\n    timelineRef.current?.reverse()\r\n  }, [])\r\n\r\n  const restart = useCallback(() => {\r\n    timelineRef.current?.restart()\r\n  }, [])\r\n\r\n  const seek = useCallback((progress: number) => {\r\n    timelineRef.current?.seek(progress)\r\n  }, [])\r\n\r\n  const kill = useCallback(() => {\r\n    timelineRef.current?.kill()\r\n  }, [])\r\n\r\n  // Chainable methods that return the hook result\r\n  const returnValue = useMemo(() => {\r\n    const result: UseTimelineReturn = {\r\n      timeline: timelineRef.current,\r\n      play,\r\n      pause,\r\n      resume,\r\n      reverse,\r\n      restart,\r\n      seek,\r\n      kill,\r\n      get isPlaying() {\r\n        return timelineRef.current?.isPlaying() ?? false\r\n      },\r\n      get isPaused() {\r\n        // Timeline doesn't expose isPaused directly, derive from isPlaying\r\n        return !(timelineRef.current?.isPlaying() ?? false)\r\n      },\r\n      get progress() {\r\n        return timelineRef.current?.progress() ?? 0\r\n      },\r\n      to: (target, props, position) => {\r\n        timelineRef.current?.to(target, props, position)\r\n        return result\r\n      },\r\n      from: (target, props, position) => {\r\n        timelineRef.current?.from(target, props, position)\r\n        return result\r\n      },\r\n      fromTo: (target, fromProps, toProps, position) => {\r\n        timelineRef.current?.fromTo(target, fromProps, toProps, position)\r\n        return result\r\n      },\r\n      addLabel: (label, position) => {\r\n        timelineRef.current?.addLabel(label, position)\r\n        return result\r\n      },\r\n    }\r\n    return result\r\n  }, [play, pause, resume, reverse, restart, seek, kill])\r\n\r\n  return returnValue\r\n}\r\n\r\n// ============ useTimelineState ============\r\n\r\nexport interface UseTimelineStateReturn {\r\n  /** Current progress (0-1) */\r\n  progress: number\r\n  /** Is the timeline playing */\r\n  isPlaying: boolean\r\n  /** Is the timeline paused */\r\n  isPaused: boolean\r\n  /** Is the timeline reversed */\r\n  isReversed: boolean\r\n}\r\n\r\n/**\r\n * Subscribe to timeline state changes\r\n *\r\n * @example\r\n * ```tsx\r\n * function TimelineProgress({ timeline }: { timeline: Timeline }) {\r\n *   const { progress, isPlaying } = useTimelineState(timeline)\r\n *\r\n *   return (\r\n *     <div>\r\n *       <progress value={progress} max={1} />\r\n *       <span>{isPlaying ? 'Playing' : 'Paused'}</span>\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useTimelineState(\r\n  timeline: Timeline | null\r\n): UseTimelineStateReturn {\r\n  const progressRef = useRef(0)\r\n  const isPlayingRef = useRef(false)\r\n  const isPausedRef = useRef(true)\r\n  const isReversedRef = useRef(false)\r\n\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (!timeline) return\r\n\r\n    const updateState = () => {\r\n      progressRef.current = timeline.progress()\r\n      isPlayingRef.current = timeline.isPlaying()\r\n      isPausedRef.current = !timeline.isPlaying()\r\n      isReversedRef.current = timeline.isReversed()\r\n    }\r\n\r\n    // Update initially\r\n    updateState()\r\n\r\n    // Use a ref to store the latest rafId to ensure proper cleanup\r\n    // This fixes the memory leak where intermediate RAF callbacks weren't cancelled\r\n    let currentRafId: number | null = null\r\n    let isActive = true\r\n\r\n    const tick = () => {\r\n      if (!isActive) return\r\n      updateState()\r\n      currentRafId = requestAnimationFrame(tick)\r\n    }\r\n    currentRafId = requestAnimationFrame(tick)\r\n\r\n    return () => {\r\n      isActive = false\r\n      if (currentRafId !== null) {\r\n        cancelAnimationFrame(currentRafId)\r\n        currentRafId = null\r\n      }\r\n    }\r\n  }, [timeline])\r\n\r\n  return {\r\n    get progress() {\r\n      return progressRef.current\r\n    },\r\n    get isPlaying() {\r\n      return isPlayingRef.current\r\n    },\r\n    get isPaused() {\r\n      return isPausedRef.current\r\n    },\r\n    get isReversed() {\r\n      return isReversedRef.current\r\n    },\r\n  }\r\n}\r\n","/**\n * React hooks for SVG morphing\n */\nimport { useState, useRef, useCallback } from 'react'\nimport {\n  createMorph,\n  createMorphSequence,\n  type MorphConfig,\n  type MorphController,\n} from '../../../index.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ useMorph ============\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface UseMorphOptions extends MorphConfig {}\n\nexport interface UseMorphReturn {\n  /** Current morphed path string */\n  path: string\n  /** Current morph progress (0-1) */\n  progress: number\n  /** Morph to a new path */\n  morphTo: (path: string) => void\n  /** Set progress directly */\n  setProgress: (progress: number) => void\n  /** The morph controller instance */\n  controller: MorphController | null\n}\n\n/**\n * Create an SVG path morph animation\n *\n * @example\n * ```tsx\n * const circlePath = 'M50,50 m-25,0 a25,25 0 1,0 50,0 a25,25 0 1,0 -50,0'\n * const starPath = 'M50,25 L58,42 L75,42 L62,52 L67,70 L50,60 L33,70 L38,52 L25,42 L42,42 Z'\n *\n * function MorphingShape() {\n *   const { path, morphTo } = useMorph(circlePath, {\n *     spring: { stiffness: 120, damping: 14 },\n *   })\n *\n *   return (\n *     <svg onClick={() => morphTo(starPath)}>\n *       <path d={path} fill=\"blue\" />\n *     </svg>\n *   )\n * }\n * ```\n */\nexport function useMorph(\n  initialPath: string,\n  options: UseMorphOptions = {}\n): UseMorphReturn {\n  const [path, setPath] = useState(initialPath)\n  const [progress, setProgressState] = useState(0)\n  const morphRef = useRef<MorphController | null>(null)\n  const isMountedRef = useRef(false)\n\n  // Use ref to capture latest options without causing effect re-runs\n  const optionsRef = useRef(options)\n  optionsRef.current = options\n\n  useIsomorphicLayoutEffect(() => {\n    isMountedRef.current = true\n    const currentOptions = optionsRef.current\n    const morph = createMorph(initialPath, {\n      ...currentOptions,\n      onProgress: (p) => {\n        if (!isMountedRef.current) return\n        setProgressState(p)\n        currentOptions.onProgress?.(p)\n      },\n    })\n\n    // Store unsubscribe function to prevent memory leak\n    const unsubscribe = morph.subscribe((newPath) => {\n      if (!isMountedRef.current) return\n      setPath(newPath)\n    })\n\n    morphRef.current = morph\n\n    return () => {\n      isMountedRef.current = false\n      unsubscribe()\n      morph.destroy()\n    }\n  }, [initialPath])\n\n  const morphTo = useCallback((targetPath: string) => {\n    morphRef.current?.morphTo(targetPath)\n  }, [])\n\n  const setProgress = useCallback((p: number) => {\n    morphRef.current?.setProgress(p)\n  }, [])\n\n  return {\n    path,\n    progress,\n    morphTo,\n    setProgress,\n    controller: morphRef.current,\n  }\n}\n\n// ============ useMorphSequence ============\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface UseMorphSequenceOptions extends MorphConfig {}\n\nexport interface UseMorphSequenceReturn {\n  /** Current morphed path string */\n  path: string\n  /** Current path index */\n  currentIndex: number\n  /** Morph to a specific index */\n  morphToIndex: (index: number) => void\n  /** Morph to the next path */\n  morphToNext: () => void\n  /** Morph to the previous path */\n  morphToPrevious: () => void\n}\n\n/**\n * Create a morphing sequence between multiple paths\n *\n * @example\n * ```tsx\n * const paths = [circlePath, squarePath, trianglePath, starPath]\n *\n * function MorphSequence() {\n *   const { path, currentIndex, morphToNext } = useMorphSequence(paths, {\n *     spring: { stiffness: 100, damping: 12 },\n *   })\n *\n *   return (\n *     <svg onClick={morphToNext}>\n *       <path d={path} fill=\"purple\" />\n *       <text>Shape {currentIndex + 1}</text>\n *     </svg>\n *   )\n * }\n * ```\n */\nexport function useMorphSequence(\n  paths: string[],\n  options: UseMorphSequenceOptions = {}\n): UseMorphSequenceReturn {\n  const [path, setPath] = useState(paths[0] ?? '')\n  const [currentIndex, setCurrentIndex] = useState(0)\n  const isMountedRef = useRef(false)\n\n  const sequenceRef = useRef<ReturnType<typeof createMorphSequence> | null>(null)\n\n  // Use ref to capture latest options without causing effect re-runs\n  const optionsRef = useRef(options)\n  optionsRef.current = options\n\n  // Memoize paths to detect content changes, not just length\n  const pathsKey = paths.join('|')\n\n  useIsomorphicLayoutEffect(() => {\n    if (paths.length === 0) return\n    isMountedRef.current = true\n\n    const sequence = createMorphSequence(paths, optionsRef.current)\n\n    // Store unsubscribe function to prevent memory leak\n    const unsubscribe = sequence.subscribe((newPath) => {\n      if (!isMountedRef.current) return\n      setPath(newPath)\n      setCurrentIndex(sequence.getCurrentIndex())\n    })\n\n    sequenceRef.current = sequence\n\n    return () => {\n      isMountedRef.current = false\n      unsubscribe()\n      sequence.destroy()\n    }\n  }, [pathsKey])\n\n  const morphToIndex = useCallback((index: number) => {\n    sequenceRef.current?.morphToIndex(index)\n  }, [])\n\n  const morphToNext = useCallback(() => {\n    sequenceRef.current?.morphToNext()\n  }, [])\n\n  const morphToPrevious = useCallback(() => {\n    sequenceRef.current?.morphToPrevious()\n  }, [])\n\n  return {\n    path,\n    currentIndex,\n    morphToIndex,\n    morphToNext,\n    morphToPrevious,\n  }\n}\n\n// ============ useMorphRef ============\n\n/**\n * Create a ref callback that automatically updates path on SVG elements\n *\n * @example\n * ```tsx\n * function AutoMorphPath() {\n *   const { pathRef, morphTo } = useMorphRef(circlePath)\n *\n *   return (\n *     <svg>\n *       <path ref={pathRef} fill=\"green\" />\n *       <button onClick={() => morphTo(starPath)}>Morph</button>\n *     </svg>\n *   )\n * }\n * ```\n */\nexport function useMorphRef(\n  initialPath: string,\n  options: UseMorphOptions = {}\n): {\n  pathRef: React.RefCallback<SVGPathElement>\n  morphTo: (path: string) => void\n  setProgress: (progress: number) => void\n  progress: number\n} {\n  const [progress, setProgressState] = useState(0)\n  const morphRef = useRef<MorphController | null>(null)\n  const elementRef = useRef<SVGPathElement | null>(null)\n  const unsubscribeRef = useRef<(() => void) | null>(null)\n\n  const pathRef = useCallback(\n    (element: SVGPathElement | null) => {\n      // Cleanup previous subscription to prevent memory leak\n      unsubscribeRef.current?.()\n      unsubscribeRef.current = null\n\n      if (!element) {\n        morphRef.current?.destroy()\n        morphRef.current = null\n        elementRef.current = null\n        return\n      }\n\n      elementRef.current = element\n\n      const morph = createMorph(initialPath, {\n        ...options,\n        onProgress: (p) => {\n          setProgressState(p)\n          options.onProgress?.(p)\n        },\n      })\n\n      // Store unsubscribe function to prevent memory leak\n      unsubscribeRef.current = morph.subscribe((path) => {\n        element.setAttribute('d', path)\n      })\n\n      morphRef.current = morph\n    },\n    // options used only on initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n    [initialPath]\n  )\n\n  const morphTo = useCallback((targetPath: string) => {\n    morphRef.current?.morphTo(targetPath)\n  }, [])\n\n  const setProgress = useCallback((p: number) => {\n    morphRef.current?.setProgress(p)\n  }, [])\n\n  return {\n    pathRef,\n    morphTo,\n    setProgress,\n    progress,\n  }\n}\n","/**\n * React hooks for layout animations (FLIP)\n */\nimport { useRef, useCallback, createContext, type ReactNode, type RefCallback } from 'react'\nimport React from 'react'\nimport {\n  createLayoutGroup,\n  createSharedLayoutContext,\n  createAutoLayout,\n  measureElement,\n  flip,\n  type LayoutAnimationConfig,\n  type LayoutGroup,\n  type SharedLayoutContext,\n  type AutoLayoutConfig,\n  type LayoutMeasurement,\n  type FlipOptions,\n} from '../../../index.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ Context ============\n\nconst LayoutGroupContext = createContext<LayoutGroup | null>(null)\nconst SharedLayoutContextReact = createContext<SharedLayoutContext | null>(null)\n\n// ============ useLayoutGroup ============\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface UseLayoutGroupOptions extends LayoutAnimationConfig {}\n\nexport interface UseLayoutGroupReturn {\n  /** Register an element with a layoutId */\n  register: (id: string, element: HTMLElement) => void\n  /** Unregister an element */\n  unregister: (id: string, element: HTMLElement) => void\n  /** Trigger layout update */\n  update: () => void\n  /** Force re-measure all elements */\n  forceUpdate: () => void\n  /** The layout group controller */\n  layoutGroup: LayoutGroup | null\n}\n\n/**\n * Create a layout animation group\n *\n * @example\n * ```tsx\n * function ReorderableList({ items }) {\n *   const { register, unregister, update } = useLayoutGroup()\n *\n *   const handleReorder = () => {\n *     // Reorder items...\n *     update()\n *   }\n *\n *   return (\n *     <ul>\n *       {items.map((item) => (\n *         <li\n *           key={item.id}\n *           ref={(el) => {\n *             if (el) register(item.id, el)\n *           }}\n *         >\n *           {item.name}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useLayoutGroup(\n  options: UseLayoutGroupOptions = {}\n): UseLayoutGroupReturn {\n  const layoutGroupRef = useRef<LayoutGroup | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    const layoutGroup = createLayoutGroup(options)\n    layoutGroupRef.current = layoutGroup\n\n    return () => {\n      layoutGroup.destroy()\n    }\n  }, [])\n\n  const register = useCallback((id: string, element: HTMLElement) => {\n    layoutGroupRef.current?.register(id, element)\n  }, [])\n\n  const unregister = useCallback((id: string, element: HTMLElement) => {\n    layoutGroupRef.current?.unregister(id, element)\n  }, [])\n\n  const update = useCallback(() => {\n    layoutGroupRef.current?.update()\n  }, [])\n\n  const forceUpdate = useCallback(() => {\n    layoutGroupRef.current?.forceUpdate()\n  }, [])\n\n  return {\n    register,\n    unregister,\n    update,\n    forceUpdate,\n    layoutGroup: layoutGroupRef.current,\n  }\n}\n\n// ============ useLayoutId ============\n\nexport interface UseLayoutIdOptions extends LayoutAnimationConfig {\n  /** The layout group to use (from useLayoutGroup) */\n  group?: LayoutGroup | null\n}\n\nexport interface UseLayoutIdReturn {\n  /** Ref callback to attach to the element */\n  ref: RefCallback<HTMLElement>\n  /** Manually trigger layout update */\n  update: () => void\n}\n\n/**\n * Register an element with a layout ID for shared animations\n *\n * @example\n * ```tsx\n * function Card({ id, layoutGroup }) {\n *   const { ref } = useLayoutId(id, { group: layoutGroup })\n *\n *   return <div ref={ref}>Card {id}</div>\n * }\n * ```\n */\nexport function useLayoutId(\n  layoutId: string,\n  options: UseLayoutIdOptions = {}\n): UseLayoutIdReturn {\n  const { group, ...config } = options\n  const elementRef = useRef<HTMLElement | null>(null)\n  const localGroupRef = useRef<LayoutGroup | null>(null)\n\n  // Create local group if none provided\n  useIsomorphicLayoutEffect(() => {\n    if (!group) {\n      localGroupRef.current = createLayoutGroup(config)\n      return () => {\n        localGroupRef.current?.destroy()\n      }\n    }\n  }, [group])\n\n  const ref = useCallback(\n    (element: HTMLElement | null) => {\n      const activeGroup = group ?? localGroupRef.current\n\n      if (elementRef.current && activeGroup) {\n        activeGroup.unregister(layoutId, elementRef.current)\n      }\n\n      elementRef.current = element\n\n      if (element && activeGroup) {\n        activeGroup.register(layoutId, element)\n      }\n    },\n    [layoutId, group]\n  )\n\n  const update = useCallback(() => {\n    const activeGroup = group ?? localGroupRef.current\n    activeGroup?.update()\n  }, [group])\n\n  return { ref, update }\n}\n\n// ============ useFlip ============\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface UseFlipOptions extends FlipOptions {}\n\nexport interface UseFlipReturn {\n  /** Ref callback to attach to the element */\n  ref: RefCallback<HTMLElement>\n  /** Animate the element from its last position */\n  flip: (mutate?: () => void) => Promise<void>\n  /** Get current measurement */\n  measure: () => LayoutMeasurement | null\n}\n\n/**\n * Create a FLIP animation for an element\n *\n * @example\n * ```tsx\n * function ExpandingCard({ isExpanded }) {\n *   const { ref, flip: flipAnim } = useFlip()\n *\n *   useEffect(() => {\n *     flipAnim()\n *   }, [isExpanded, flipAnim])\n *\n *   return (\n *     <div\n *       ref={ref}\n *       className={isExpanded ? 'expanded' : 'collapsed'}\n *     >\n *       Content\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useFlip(options: UseFlipOptions = {}): UseFlipReturn {\n  const elementRef = useRef<HTMLElement | null>(null)\n  const lastMeasurementRef = useRef<LayoutMeasurement | null>(null)\n\n  const ref = useCallback((element: HTMLElement | null) => {\n    if (element) {\n      lastMeasurementRef.current = measureElement(element)\n    }\n    elementRef.current = element\n  }, [])\n\n  const flipFn = useCallback(async (mutate?: () => void) => {\n    if (!elementRef.current) return\n\n    await flip(elementRef.current, mutate ?? (() => {}), options)\n\n    lastMeasurementRef.current = measureElement(elementRef.current)\n  }, [options])\n\n  const measure = useCallback(() => {\n    if (!elementRef.current) return null\n    return measureElement(elementRef.current)\n  }, [])\n\n  return { ref, flip: flipFn, measure }\n}\n\n// ============ useAutoLayout ============\n\n// eslint-disable-next-line @typescript-eslint/no-empty-object-type\nexport interface UseAutoLayoutOptions extends AutoLayoutConfig {}\n\nexport interface UseAutoLayoutReturn {\n  /** Ref callback to attach to the container */\n  containerRef: RefCallback<HTMLElement>\n  /** Trigger layout update */\n  update: () => void\n  /** Force re-measure and animate */\n  forceUpdate: () => void\n}\n\n/**\n * Automatically animate layout changes for child elements\n *\n * @example\n * ```tsx\n * function AutoAnimatedList({ items }) {\n *   const { containerRef, update } = useAutoLayout({\n *     spring: { stiffness: 150, damping: 15 },\n *   })\n *\n *   return (\n *     <ul ref={containerRef}>\n *       {items.map((item) => (\n *         <li key={item.id}>{item.name}</li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useAutoLayout(\n  options: UseAutoLayoutOptions = {}\n): UseAutoLayoutReturn {\n  const autoLayoutRef = useRef<ReturnType<typeof createAutoLayout> | null>(null)\n\n  const containerRef = useCallback((element: HTMLElement | null) => {\n    if (autoLayoutRef.current) {\n      autoLayoutRef.current.destroy()\n      autoLayoutRef.current = null\n    }\n\n    if (element) {\n      autoLayoutRef.current = createAutoLayout(options)\n    }\n  }, []) // eslint-disable-line react-hooks/exhaustive-deps\n\n  const update = useCallback(() => {\n    autoLayoutRef.current?.update()\n  }, [])\n\n  const forceUpdate = useCallback(() => {\n    autoLayoutRef.current?.forceUpdate()\n  }, [])\n\n  return { containerRef, update, forceUpdate }\n}\n\n// ============ LayoutGroup Provider ============\n\nexport interface LayoutGroupProviderProps {\n  children: ReactNode\n  config?: LayoutAnimationConfig\n}\n\n/**\n * Provider for layout group context\n */\nexport function LayoutGroupProvider({\n  children,\n  config,\n}: LayoutGroupProviderProps): React.ReactElement {\n  const layoutGroupRef = useRef<LayoutGroup | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    layoutGroupRef.current = createLayoutGroup(config)\n\n    return () => {\n      layoutGroupRef.current?.destroy()\n    }\n  }, [])\n\n  return React.createElement(\n    LayoutGroupContext.Provider,\n    { value: layoutGroupRef.current },\n    children\n  )\n}\n\n// ============ SharedLayout Provider ============\n\nexport interface SharedLayoutProviderProps {\n  children: ReactNode\n  config?: LayoutAnimationConfig\n}\n\n/**\n * Provider for shared layout context\n */\nexport function SharedLayoutProvider({\n  children,\n}: SharedLayoutProviderProps): React.ReactElement {\n  const sharedContextRef = useRef<SharedLayoutContext | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    sharedContextRef.current = createSharedLayoutContext()\n\n    return () => {\n      sharedContextRef.current?.destroy()\n    }\n  }, [])\n\n  return React.createElement(\n    SharedLayoutContextReact.Provider,\n    { value: sharedContextRef.current },\n    children\n  )\n}\n\n// ============ Export context for advanced use ============\n\nexport { LayoutGroupContext, SharedLayoutContextReact }\n","/**\r\n * React hooks for Variants System\r\n */\r\nimport { useRef, useCallback, useMemo, useState, createContext, useContext, type ReactNode } from 'react'\r\nimport React from 'react'\r\nimport {\r\n  getVariant,\r\n  calculateStaggerDelays,\r\n  type Variants,\r\n  type AnimationValues,\r\n  type VariantTransition,\r\n} from '../../../index.js'\r\nimport { useSpring } from './useSpring.js'\r\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\r\n\r\n// ============ Context ============\r\n\r\ninterface VariantContextValue {\r\n  /** Current variant name */\r\n  variant: string | undefined\r\n  /** Custom data passed to variant functions */\r\n  custom?: unknown\r\n  /** Inherited transition settings */\r\n  transition?: VariantTransition\r\n  /** Stagger index for children */\r\n  staggerIndex?: number\r\n  /** Total stagger count */\r\n  staggerCount?: number\r\n}\r\n\r\nconst VariantContext = createContext<VariantContextValue>({\r\n  variant: undefined,\r\n})\r\n\r\n// ============ useVariantContext ============\r\n\r\n/**\r\n * Get the current variant context\r\n */\r\nexport function useVariantContext(): VariantContextValue {\r\n  return useContext(VariantContext)\r\n}\r\n\r\n// ============ useVariants ============\r\n\r\nexport interface UseVariantsOptions {\r\n  /** Named animation states */\r\n  variants?: Variants\r\n  /** Current animation state */\r\n  animate?: string | AnimationValues\r\n  /** Initial animation state */\r\n  initial?: string | AnimationValues | false\r\n  /** Custom data for variant functions */\r\n  custom?: unknown\r\n  /** Inherit variant from parent */\r\n  inherit?: boolean\r\n  /** Spring configuration override */\r\n  spring?: { stiffness?: number; damping?: number; mass?: number }\r\n  /** Callback when animation completes */\r\n  onAnimationComplete?: (variant: string) => void\r\n}\r\n\r\nexport interface UseVariantsReturn {\r\n  /** Current animation values */\r\n  values: AnimationValues\r\n  /** Trigger a specific variant */\r\n  setVariant: (name: string) => void\r\n  /** Current variant name */\r\n  currentVariant: string | undefined\r\n  /** Whether animation is in progress */\r\n  isAnimating: boolean\r\n}\r\n\r\n/**\r\n * Use variants for declarative animation states\r\n *\r\n * @example\r\n * ```tsx\r\n * const variants = {\r\n *   hidden: { opacity: 0, y: 20 },\r\n *   visible: {\r\n *     opacity: 1,\r\n *     y: 0,\r\n *     transition: { staggerChildren: 0.1 }\r\n *   },\r\n * }\r\n *\r\n * function MyComponent() {\r\n *   const { values, setVariant } = useVariants({\r\n *     variants,\r\n *     initial: 'hidden',\r\n *     animate: 'visible',\r\n *   })\r\n *\r\n *   return (\r\n *     <div style={{\r\n *       opacity: values.opacity,\r\n *       transform: `translateY(${values.y}px)`,\r\n *     }}>\r\n *       Content\r\n *     </div>\r\n *   )\r\n * }\r\n * ```\r\n */\r\nexport function useVariants(options: UseVariantsOptions): UseVariantsReturn {\r\n  const {\r\n    variants,\r\n    animate,\r\n    initial,\r\n    custom,\r\n    inherit = true,\r\n    spring: springConfig,\r\n    onAnimationComplete,\r\n  } = options\r\n\r\n  const parentContext = useVariantContext()\r\n  const currentVariantRef = useRef<string | undefined>(undefined)\r\n  const isAnimatingRef = useRef<boolean>(false)\r\n\r\n  // Determine the target variant\r\n  const targetVariant = useMemo(() => {\r\n    // If animate is a string, use it\r\n    if (typeof animate === 'string') {\r\n      return animate\r\n    }\r\n    // If inherit and parent has a variant, use that\r\n    if (inherit && parentContext.variant) {\r\n      return parentContext.variant\r\n    }\r\n    return undefined\r\n  }, [animate, inherit, parentContext.variant])\r\n\r\n  // Resolve initial values\r\n  const initialValues = useMemo(() => {\r\n    if (initial === false) {\r\n      // Skip initial animation\r\n      return getVariant(variants, targetVariant, custom).values\r\n    }\r\n    if (typeof initial === 'string') {\r\n      return getVariant(variants, initial, custom).values\r\n    }\r\n    if (typeof initial === 'object') {\r\n      return initial\r\n    }\r\n    return {}\r\n  }, [initial, variants, targetVariant, custom])\r\n\r\n  // Resolve target values\r\n  const targetValues = useMemo(() => {\r\n    if (typeof animate === 'object') {\r\n      return animate\r\n    }\r\n    if (targetVariant && variants) {\r\n      return getVariant(variants, targetVariant, custom).values\r\n    }\r\n    return initialValues\r\n  }, [animate, targetVariant, variants, custom, initialValues])\r\n\r\n  // Get transition settings\r\n  const transition = useMemo(() => {\r\n    if (targetVariant && variants) {\r\n      return getVariant(variants, targetVariant, custom).transition\r\n    }\r\n    return parentContext.transition || {}\r\n  }, [targetVariant, variants, custom, parentContext.transition])\r\n\r\n  // Calculate delay from stagger\r\n  const staggerDelay = useMemo(() => {\r\n    if (parentContext.staggerIndex !== undefined && transition.staggerChildren) {\r\n      return (\r\n        (parentContext.staggerIndex * transition.staggerChildren) +\r\n        (transition.delayChildren || 0)\r\n      )\r\n    }\r\n    return transition.delay || 0\r\n  }, [parentContext.staggerIndex, transition])\r\n\r\n  // Helper to convert string/number values to numbers for spring\r\n  const toNumber = (val: string | number | undefined, fallback: number): number => {\r\n    if (val === undefined) return fallback\r\n    if (typeof val === 'number') return val\r\n    // Parse numeric strings (e.g., \"100px\" -> 100, \"50%\" -> 50)\r\n    const parsed = parseFloat(val)\r\n    return isNaN(parsed) ? fallback : parsed\r\n  }\r\n\r\n  // Helper to compute spring values from variant values\r\n  const computeSpringValues = useCallback((values: AnimationValues, fallbackValues?: AnimationValues) => ({\r\n    x: toNumber(values.x ?? fallbackValues?.x, 0),\r\n    y: toNumber(values.y ?? fallbackValues?.y, 0),\r\n    scale: values.scale ?? fallbackValues?.scale ?? 1,\r\n    scaleX: values.scaleX ?? fallbackValues?.scaleX ?? 1,\r\n    scaleY: values.scaleY ?? fallbackValues?.scaleY ?? 1,\r\n    rotate: values.rotate ?? fallbackValues?.rotate ?? 0,\r\n    opacity: values.opacity ?? fallbackValues?.opacity ?? 1,\r\n  }), [])\r\n\r\n  // Track if initial animation has been triggered\r\n  const hasAnimatedRef = useRef(false)\r\n  // Track the last variant we animated to, to detect actual changes\r\n  const lastAnimatedVariantRef = useRef<string | undefined>(undefined)\r\n\r\n  // Store target values that should be animated to after initial render\r\n  // Initialize with initial values so spring starts there\r\n  const [animatedTargetValues, setAnimatedTargetValues] = useState(() =>\r\n    computeSpringValues(initialValues)\r\n  )\r\n\r\n  // Spring values for animation\r\n  const springValues = useSpring(\r\n    animatedTargetValues,\r\n    {\r\n      stiffness: springConfig?.stiffness ?? transition.spring?.stiffness ?? 100,\r\n      damping: springConfig?.damping ?? transition.spring?.damping ?? 15,\r\n      mass: springConfig?.mass ?? transition.spring?.mass ?? 1,\r\n    }\r\n  )\r\n\r\n  // Trigger initial animation and handle subsequent variant changes\r\n  // Only depend on targetVariant (string) to avoid object reference issues\r\n  useIsomorphicLayoutEffect(() => {\r\n    // On mount, animate from initial to target\r\n    if (!hasAnimatedRef.current) {\r\n      hasAnimatedRef.current = true\r\n      lastAnimatedVariantRef.current = targetVariant\r\n      // Use setTimeout to ensure this runs after the spring is initialized\r\n      const timeoutId = setTimeout(() => {\r\n        setAnimatedTargetValues(computeSpringValues(targetValues, initialValues))\r\n      }, 0)\r\n      return () => clearTimeout(timeoutId)\r\n    }\r\n\r\n    // On subsequent renders, only update if the variant actually changed\r\n    if (targetVariant !== lastAnimatedVariantRef.current) {\r\n      lastAnimatedVariantRef.current = targetVariant\r\n      setAnimatedTargetValues(computeSpringValues(targetValues, initialValues))\r\n    }\r\n  }, [targetVariant, computeSpringValues, targetValues, initialValues])\r\n\r\n  // Track variant changes and detect animation completion\r\n  useIsomorphicLayoutEffect(() => {\r\n    if (targetVariant && targetVariant !== currentVariantRef.current) {\r\n      currentVariantRef.current = targetVariant\r\n      isAnimatingRef.current = true\r\n\r\n      // Use ref to capture onAnimationComplete for cleanup safety\r\n      const capturedVariant = targetVariant\r\n      const capturedCallback = onAnimationComplete\r\n\r\n      // Calculate a reasonable timeout based on spring physics\r\n      // Time constant for a damped spring system: 2 * mass / damping\r\n      // For settling to ~2% of initial amplitude, use ~4 time constants\r\n      const damping = springConfig?.damping ?? 15\r\n      const mass = springConfig?.mass ?? 1\r\n      // Estimated settle time: ~4 time constants = 4 * (2 * mass / damping)\r\n      const estimatedDuration = Math.max(200, Math.min(2000, (8 * mass / damping) * 1000))\r\n      const totalDelay = staggerDelay + estimatedDuration\r\n\r\n      const timer = setTimeout(() => {\r\n        isAnimatingRef.current = false\r\n        capturedCallback?.(capturedVariant)\r\n      }, totalDelay)\r\n\r\n      return () => clearTimeout(timer)\r\n    }\r\n  }, [targetVariant, staggerDelay, onAnimationComplete, springConfig?.stiffness, springConfig?.damping, springConfig?.mass])\r\n\r\n  const setVariant = useCallback((name: string) => {\r\n    currentVariantRef.current = name\r\n  }, [])\r\n\r\n  return {\r\n    values: {\r\n      ...targetValues,\r\n      ...springValues,\r\n    },\r\n    setVariant,\r\n    currentVariant: currentVariantRef.current,\r\n    isAnimating: isAnimatingRef.current,\r\n  }\r\n}\r\n\r\n// ============ VariantProvider ============\r\n\r\nexport interface VariantProviderProps {\r\n  children: ReactNode\r\n  /** Current variant for all children */\r\n  variant?: string\r\n  /** Custom data for variant functions */\r\n  custom?: unknown\r\n  /** Transition settings for children */\r\n  transition?: VariantTransition\r\n}\r\n\r\n/**\r\n * Provide variant context to children\r\n */\r\nexport function VariantProvider({\r\n  children,\r\n  variant,\r\n  custom,\r\n  transition,\r\n}: VariantProviderProps): React.ReactElement {\r\n  const value = useMemo(\r\n    () => ({ variant, custom, transition }),\r\n    [variant, custom, transition]\r\n  )\r\n\r\n  return React.createElement(VariantContext.Provider, { value }, children)\r\n}\r\n\r\n// ============ useStaggerChildren ============\r\n\r\nexport interface UseStaggerChildrenOptions {\r\n  /** Number of children to stagger */\r\n  count: number\r\n  /** Stagger delay between children (ms) */\r\n  staggerChildren?: number\r\n  /** Initial delay before first child (ms) */\r\n  delayChildren?: number\r\n  /** Direction of stagger */\r\n  staggerDirection?: 1 | -1\r\n}\r\n\r\nexport interface UseStaggerChildrenReturn {\r\n  /** Get delay for a specific child index */\r\n  getDelay: (index: number) => number\r\n  /** Get props to pass to a child */\r\n  getChildProps: (index: number) => { style: { transitionDelay: string } }\r\n  /** All delays */\r\n  delays: number[]\r\n}\r\n\r\n/**\r\n * Calculate stagger delays for children\r\n */\r\nexport function useStaggerChildren(options: UseStaggerChildrenOptions): UseStaggerChildrenReturn {\r\n  const {\r\n    count,\r\n    staggerChildren = 100,\r\n    delayChildren = 0,\r\n    staggerDirection = 1,\r\n  } = options\r\n\r\n  const delays = useMemo(() => {\r\n    return calculateStaggerDelays(count, {\r\n      staggerChildren,\r\n      delayChildren,\r\n      staggerDirection,\r\n    })\r\n  }, [count, staggerChildren, delayChildren, staggerDirection])\r\n\r\n  const getDelay = useCallback(\r\n    (index: number) => delays[index] || 0,\r\n    [delays]\r\n  )\r\n\r\n  const getChildProps = useCallback(\r\n    (index: number) => ({\r\n      style: { transitionDelay: `${getDelay(index)}ms` },\r\n    }),\r\n    [getDelay]\r\n  )\r\n\r\n  return { getDelay, getChildProps, delays }\r\n}\r\n\r\n// ============ Motion Component Helper ============\r\n\r\nexport interface CreateMotionComponentOptions {\r\n  /** Default variants */\r\n  variants?: Variants\r\n  /** Default spring config */\r\n  spring?: { stiffness?: number; damping?: number; mass?: number }\r\n}\r\n\r\n/**\r\n * Create a motion-enabled component\r\n *\r\n * @example\r\n * ```tsx\r\n * const MotionDiv = createMotionComponent('div', {\r\n *   variants: {\r\n *     hidden: { opacity: 0 },\r\n *     visible: { opacity: 1 },\r\n *   },\r\n * })\r\n *\r\n * <MotionDiv animate=\"visible\" />\r\n * ```\r\n */\r\nexport function createMotionComponent<T extends keyof React.JSX.IntrinsicElements>(\r\n  _element: T,\r\n  _options: CreateMotionComponentOptions = {}\r\n) {\r\n  // This is a placeholder - the actual implementation would create\r\n  // a component that uses useVariants internally\r\n  // For now, users should use the Animated component or useVariants directly\r\n  throw new Error(\r\n    'createMotionComponent is not yet implemented. Use useVariants hook or Animated component instead.'\r\n  )\r\n}\r\n\r\n// ============ Export Context ============\r\n\r\nexport { VariantContext }\r\n","/**\n * Advanced Physics Hooks - SpringKit Exclusive\n *\n * These hooks provide advanced physics simulations that go beyond\n * simple spring animations.\n */\n\nimport { useRef, useEffect, useCallback, useState } from 'react'\nimport { createMotionValue, MotionValue } from '../../../core/MotionValue.js'\nimport { createSpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n// ============ useSpringState ============\n\nexport interface UseSpringStateOptions extends SpringConfig {\n  /** Initial value */\n  initial?: number\n  /** Callback on value change */\n  onChange?: (value: number) => void\n}\n\n/**\n * Spring-animated state that syncs with React state\n *\n * Unlike useMotionValue, this triggers React re-renders and can be\n * used directly in JSX. Best for values that need to be reactive.\n *\n * @example\n * ```tsx\n * function Counter() {\n *   const [count, setCount, springValue] = useSpringState(0)\n *\n *   return (\n *     <div>\n *       <span>{Math.round(count)}</span>\n *       <button onClick={() => setCount(count + 1)}>+</button>\n *     </div>\n *   )\n * }\n * ```\n *\n * @example With config\n * ```tsx\n * const [progress, setProgress] = useSpringState(0, {\n *   stiffness: 300,\n *   damping: 30,\n *   onChange: (v) => console.log('Progress:', v)\n * })\n * ```\n */\nexport function useSpringState(\n  initialValue: number = 0,\n  options: UseSpringStateOptions = {}\n): [number, (value: number) => void, MotionValue<number>] {\n  const { initial = initialValue, onChange, ...springConfig } = options\n\n  const [state, setState] = useState(initial)\n  const springRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n  const motionValueRef = useRef<MotionValue<number> | null>(null)\n\n  // Initialize spring\n  if (springRef.current === null) {\n    springRef.current = createSpringValue(initial, {\n      ...springConfig,\n      onUpdate: (value) => {\n        setState(value)\n        onChange?.(value)\n      },\n    })\n  }\n\n  // Create motion value wrapper\n  // Recreate if destroyed (happens with React StrictMode double-mount)\n  if (motionValueRef.current === null || motionValueRef.current.isDestroyed()) {\n    motionValueRef.current = createMotionValue(initial)\n  }\n\n  // Sync motion value with spring\n  useEffect(() => {\n    const unsub = springRef.current?.subscribe((v) => {\n      motionValueRef.current?.jump(v)\n    })\n    return () => unsub?.()\n  }, [])\n\n  // Cleanup: stop animations but don't destroy (reused across StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      springRef.current?.stop()\n    }\n  }, [])\n\n  const setValue = useCallback((value: number) => {\n    springRef.current?.set(value)\n  }, [])\n\n  return [state, setValue, motionValueRef.current]\n}\n\n// ============ useMomentum ============\n\nexport interface UseMomentumOptions {\n  /** Friction coefficient (0-1, lower = more friction) */\n  friction?: number\n  /** Minimum velocity before stopping */\n  minVelocity?: number\n  /** Bounds to clamp the value */\n  bounds?: { min?: number; max?: number }\n  /** Callback when momentum stops */\n  onRest?: () => void\n}\n\n/**\n * Physics-based momentum tracking\n *\n * Tracks velocity and applies momentum/friction physics. Great for\n * creating inertial scrolling, throwable elements, etc.\n *\n * @example\n * ```tsx\n * function ThrowableCard() {\n *   const { value, velocity, push, stop } = useMomentum({\n *     friction: 0.95,\n *     bounds: { min: 0, max: 500 }\n *   })\n *\n *   const handleDragEnd = (e) => {\n *     push(dragVelocity) // Apply velocity on release\n *   }\n *\n *   return <div style={{ x: value.get() }} />\n * }\n * ```\n */\nexport function useMomentum(options: UseMomentumOptions = {}) {\n  const {\n    friction = 0.95,\n    minVelocity = 0.01,\n    bounds,\n    onRest,\n  } = options\n\n  const valueRef = useRef<MotionValue<number> | null>(null)\n  const velocityRef = useRef<MotionValue<number> | null>(null)\n  const frameRef = useRef<number | null>(null)\n  const isActiveRef = useRef(false)\n\n  // Recreate if destroyed (happens with React StrictMode double-mount)\n  if (valueRef.current === null || valueRef.current.isDestroyed()) {\n    valueRef.current = createMotionValue(0)\n  }\n  if (velocityRef.current === null || velocityRef.current.isDestroyed()) {\n    velocityRef.current = createMotionValue(0)\n  }\n\n  const applyBounds = useCallback((val: number) => {\n    if (!bounds) return val\n    let result = val\n    if (bounds.min !== undefined) result = Math.max(bounds.min, result)\n    if (bounds.max !== undefined) result = Math.min(bounds.max, result)\n    return result\n  }, [bounds])\n\n  const tick = useCallback(() => {\n    if (!isActiveRef.current) return\n\n    const currentVelocity = velocityRef.current?.get() ?? 0\n    const currentValue = valueRef.current?.get() ?? 0\n\n    // Apply friction\n    const newVelocity = currentVelocity * friction\n\n    // Update value\n    const newValue = applyBounds(currentValue + newVelocity)\n    valueRef.current?.jump(newValue)\n    velocityRef.current?.jump(newVelocity)\n\n    // Check if should stop\n    if (Math.abs(newVelocity) < minVelocity) {\n      isActiveRef.current = false\n      velocityRef.current?.jump(0)\n      onRest?.()\n      return\n    }\n\n    // Check bounds collision\n    if (bounds) {\n      if (\n        (bounds.min !== undefined && newValue <= bounds.min) ||\n        (bounds.max !== undefined && newValue >= bounds.max)\n      ) {\n        isActiveRef.current = false\n        velocityRef.current?.jump(0)\n        onRest?.()\n        return\n      }\n    }\n\n    frameRef.current = requestAnimationFrame(tick)\n  }, [friction, minVelocity, bounds, applyBounds, onRest])\n\n  const push = useCallback((velocity: number) => {\n    // Validate velocity\n    if (!Number.isFinite(velocity)) return\n\n    velocityRef.current?.jump(velocity)\n    isActiveRef.current = true\n    // Cancel any existing frame before starting new one\n    if (frameRef.current) cancelAnimationFrame(frameRef.current)\n    frameRef.current = requestAnimationFrame(tick)\n  }, [tick])\n\n  const stop = useCallback(() => {\n    isActiveRef.current = false\n    if (frameRef.current) {\n      cancelAnimationFrame(frameRef.current)\n    }\n    velocityRef.current?.jump(0)\n  }, [])\n\n  const set = useCallback((value: number) => {\n    // Validate value\n    if (!Number.isFinite(value)) return\n    valueRef.current?.jump(applyBounds(value))\n  }, [applyBounds])\n\n  // Cleanup: cancel animations but don't destroy MotionValues\n  // (MotionValues are reused across React StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      if (frameRef.current) cancelAnimationFrame(frameRef.current)\n      isActiveRef.current = false\n    }\n  }, [])\n\n  return {\n    value: valueRef.current,\n    velocity: velocityRef.current,\n    push,\n    stop,\n    set,\n    isActive: () => isActiveRef.current,\n  }\n}\n\n// ============ useElastic ============\n\nexport interface UseElasticOptions {\n  /** Elasticity factor (0-1, higher = more stretch) */\n  elasticity?: number\n  /** Maximum stretch distance */\n  maxStretch?: number\n  /** Spring config for return animation */\n  spring?: SpringConfig\n}\n\n/**\n * Rubber band / elastic effect\n *\n * Creates an elastic resistance effect, like stretching a rubber band.\n * Perfect for over-scroll effects, pull-to-refresh, etc.\n *\n * @example\n * ```tsx\n * function PullToRefresh() {\n *   const { value, stretch, release } = useElastic({\n *     elasticity: 0.5,\n *     maxStretch: 100\n *   })\n *\n *   const handleDrag = (offset) => stretch(offset)\n *   const handleRelease = () => release()\n *\n *   return <div style={{ y: value.get() }} />\n * }\n * ```\n */\nexport function useElastic(options: UseElasticOptions = {}) {\n  const {\n    elasticity = 0.5,\n    maxStretch = 100,\n    spring = { stiffness: 300, damping: 30 },\n  } = options\n\n  // Use useRef for motion values to avoid hook order issues\n  const motionValueRef = useRef<MotionValue<number> | null>(null)\n  const springRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n\n  // Initialize refs only once\n  // Recreate if destroyed (happens with React StrictMode double-mount)\n  if (motionValueRef.current === null || motionValueRef.current.isDestroyed()) {\n    motionValueRef.current = createMotionValue(0)\n  }\n  if (springRef.current === null) {\n    springRef.current = createSpringValue(0, {\n      ...spring,\n      onUpdate: (v) => motionValueRef.current?.jump(v),\n    })\n  }\n  const rawValueRef = useRef(0)\n\n  // Rubber band formula: x * (1 - x / (maxStretch * 2))\n  const applyElasticity = useCallback((input: number) => {\n    const sign = input >= 0 ? 1 : -1\n    const absInput = Math.abs(input)\n    const factor = 1 - (absInput / (maxStretch * 2)) * (1 - elasticity)\n    return sign * absInput * Math.max(0.1, factor)\n  }, [elasticity, maxStretch])\n\n  const stretch = useCallback((amount: number) => {\n    // Validate amount\n    if (!Number.isFinite(amount)) return\n\n    rawValueRef.current = amount\n    const elasticValue = applyElasticity(amount)\n    motionValueRef.current?.jump(elasticValue)\n  }, [applyElasticity])\n\n  const release = useCallback(() => {\n    rawValueRef.current = 0\n    springRef.current?.set(0)\n  }, [])\n\n  const set = useCallback((value: number) => {\n    // Validate value\n    if (!Number.isFinite(value)) return\n\n    rawValueRef.current = value\n    springRef.current?.set(value)\n  }, [])\n\n  // Cleanup: don't destroy MotionValues/springs\n  // (They are reused across React StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      springRef.current?.stop()\n    }\n  }, [])\n\n  return {\n    value: motionValueRef.current,\n    stretch,\n    release,\n    set,\n    getRaw: () => rawValueRef.current,\n  }\n}\n\n// ============ useBounce ============\n\nexport interface UseBounceOptions {\n  /** Bounce dampening (0-1, lower = more bouncy) */\n  dampening?: number\n  /** Gravity strength */\n  gravity?: number\n  /** Ground level */\n  floor?: number\n  /** Ceiling level */\n  ceiling?: number\n  /** Coefficient of restitution (bounciness) */\n  restitution?: number\n}\n\n/**\n * Bounce physics simulation\n *\n * Simulates a bouncing ball with gravity, floor, and dampening.\n *\n * @example\n * ```tsx\n * function BouncingBall() {\n *   const { value, drop, bounce, stop } = useBounce({\n *     gravity: 0.5,\n *     floor: 300,\n *     restitution: 0.7\n *   })\n *\n *   return (\n *     <div\n *       style={{ y: value.get() }}\n *       onClick={() => drop(0)}\n *     />\n *   )\n * }\n * ```\n */\nexport function useBounce(options: UseBounceOptions = {}) {\n  const {\n    dampening = 0.02,\n    gravity = 0.5,\n    floor = 300,\n    ceiling = 0,\n    restitution = 0.7,\n  } = options\n\n  // Use useRef for motion value to avoid hook order issues\n  const motionValueRef = useRef<MotionValue<number> | null>(null)\n  if (motionValueRef.current === null) {\n    motionValueRef.current = createMotionValue(ceiling)\n  }\n  const motionValue = motionValueRef.current\n  const velocityRef = useRef(0)\n  const frameRef = useRef<number | null>(null)\n  const isActiveRef = useRef(false)\n\n  const tick = useCallback(() => {\n    if (!isActiveRef.current) return\n\n    const currentValue = motionValue.get()\n\n    // Apply gravity\n    velocityRef.current += gravity\n\n    // Apply air resistance\n    velocityRef.current *= (1 - dampening)\n\n    // Update position\n    let newValue = currentValue + velocityRef.current\n\n    // Check floor collision\n    if (newValue >= floor) {\n      newValue = floor\n      velocityRef.current = -velocityRef.current * restitution\n\n      // Stop if velocity is very low\n      if (Math.abs(velocityRef.current) < 0.5) {\n        isActiveRef.current = false\n        velocityRef.current = 0\n        motionValue.jump(floor)\n        return\n      }\n    }\n\n    // Check ceiling collision\n    if (newValue <= ceiling) {\n      newValue = ceiling\n      velocityRef.current = -velocityRef.current * restitution\n    }\n\n    motionValue.jump(newValue)\n    frameRef.current = requestAnimationFrame(tick)\n  }, [motionValue, gravity, dampening, floor, ceiling, restitution])\n\n  const drop = useCallback((fromY: number = ceiling, initialVelocity: number = 0) => {\n    // Validate inputs\n    const safeFromY = Number.isFinite(fromY) ? fromY : ceiling\n    const safeVelocity = Number.isFinite(initialVelocity) ? initialVelocity : 0\n\n    motionValue.jump(safeFromY)\n    velocityRef.current = safeVelocity\n    isActiveRef.current = true\n    // Cancel any existing frame before starting new one\n    if (frameRef.current) cancelAnimationFrame(frameRef.current)\n    frameRef.current = requestAnimationFrame(tick)\n  }, [motionValue, ceiling, tick])\n\n  const bounce = useCallback((velocity: number) => {\n    // Validate velocity\n    if (!Number.isFinite(velocity)) return\n\n    velocityRef.current = velocity\n    isActiveRef.current = true\n    // Cancel any existing frame before starting new one\n    if (frameRef.current) cancelAnimationFrame(frameRef.current)\n    frameRef.current = requestAnimationFrame(tick)\n  }, [tick])\n\n  const stop = useCallback(() => {\n    isActiveRef.current = false\n    if (frameRef.current) cancelAnimationFrame(frameRef.current)\n    velocityRef.current = 0\n  }, [])\n\n  // Cleanup: cancel animations but don't destroy MotionValue\n  // (MotionValue is reused across StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      if (frameRef.current) cancelAnimationFrame(frameRef.current)\n      isActiveRef.current = false\n    }\n  }, [])\n\n  return {\n    value: motionValue,\n    drop,\n    bounce,\n    stop,\n    isActive: () => isActiveRef.current,\n    getVelocity: () => velocityRef.current,\n  }\n}\n\n// ============ useGravity ============\n\nexport interface UseGravityOptions {\n  /** Gravity vector */\n  gravity?: { x: number; y: number }\n  /** Mass of the object */\n  mass?: number\n  /** Air resistance */\n  drag?: number\n  /** Bounds for the object */\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n  /** Bounciness when hitting bounds */\n  bounciness?: number\n}\n\n/**\n * 2D gravity simulation\n *\n * Simulates an object affected by gravity in 2D space with\n * optional bounds and bouncing.\n *\n * @example\n * ```tsx\n * function FallingObject() {\n *   const { x, y, launch, stop } = useGravity({\n *     gravity: { x: 0, y: 0.5 },\n *     bounds: { left: 0, right: 400, top: 0, bottom: 400 },\n *     bounciness: 0.6\n *   })\n *\n *   return (\n *     <div\n *       style={{ x: x.get(), y: y.get() }}\n *       onClick={() => launch({ x: 5, y: -10 })}\n *     />\n *   )\n * }\n * ```\n */\nexport function useGravity(options: UseGravityOptions = {}) {\n  const {\n    gravity = { x: 0, y: 0.5 },\n    // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    mass: _mass = 1,\n    drag = 0.01,\n    bounds,\n    bounciness = 0.7,\n  } = options\n\n  // Use useRef for motion values to avoid hook order issues\n  // Recreate if destroyed (happens with React StrictMode double-mount)\n  const xRef = useRef<MotionValue<number> | null>(null)\n  const yRef = useRef<MotionValue<number> | null>(null)\n  if (xRef.current === null || xRef.current.isDestroyed()) {\n    xRef.current = createMotionValue(0)\n  }\n  if (yRef.current === null || yRef.current.isDestroyed()) {\n    yRef.current = createMotionValue(0)\n  }\n  const xMotion = xRef.current\n  const yMotion = yRef.current\n  const velocityRef = useRef({ x: 0, y: 0 })\n  const frameRef = useRef<number | null>(null)\n  const isActiveRef = useRef(false)\n\n  const tick = useCallback(() => {\n    if (!isActiveRef.current) return\n\n    const currentX = xMotion.get()\n    const currentY = yMotion.get()\n\n    // Apply gravity (F = m * g, but we simplify to just g since mass affects velocity change)\n    velocityRef.current.x += gravity.x\n    velocityRef.current.y += gravity.y\n\n    // Apply drag\n    velocityRef.current.x *= (1 - drag)\n    velocityRef.current.y *= (1 - drag)\n\n    // Update position\n    let newX = currentX + velocityRef.current.x\n    let newY = currentY + velocityRef.current.y\n\n    // Check bounds\n    if (bounds) {\n      if (bounds.left !== undefined && newX <= bounds.left) {\n        newX = bounds.left\n        velocityRef.current.x = -velocityRef.current.x * bounciness\n      }\n      if (bounds.right !== undefined && newX >= bounds.right) {\n        newX = bounds.right\n        velocityRef.current.x = -velocityRef.current.x * bounciness\n      }\n      if (bounds.top !== undefined && newY <= bounds.top) {\n        newY = bounds.top\n        velocityRef.current.y = -velocityRef.current.y * bounciness\n      }\n      if (bounds.bottom !== undefined && newY >= bounds.bottom) {\n        newY = bounds.bottom\n        velocityRef.current.y = -velocityRef.current.y * bounciness\n\n        // Stop if velocity is very low at bottom\n        if (Math.abs(velocityRef.current.y) < 0.5 && Math.abs(velocityRef.current.x) < 0.1) {\n          velocityRef.current.y = 0\n        }\n      }\n    }\n\n    xMotion.jump(newX)\n    yMotion.jump(newY)\n\n    // Continue if there's still movement\n    const totalVelocity = Math.abs(velocityRef.current.x) + Math.abs(velocityRef.current.y)\n    if (totalVelocity > 0.01 || gravity.x !== 0 || gravity.y !== 0) {\n      frameRef.current = requestAnimationFrame(tick)\n    } else {\n      isActiveRef.current = false\n    }\n  }, [xMotion, yMotion, gravity, drag, bounds, bounciness])\n\n  const launch = useCallback((velocity: { x: number; y: number }) => {\n    // Validate velocities\n    const safeX = Number.isFinite(velocity.x) ? velocity.x : 0\n    const safeY = Number.isFinite(velocity.y) ? velocity.y : 0\n\n    velocityRef.current = { x: safeX, y: safeY }\n    isActiveRef.current = true\n    // Cancel any existing frame before starting new one\n    if (frameRef.current) cancelAnimationFrame(frameRef.current)\n    frameRef.current = requestAnimationFrame(tick)\n  }, [tick])\n\n  const setPosition = useCallback((pos: { x: number; y: number }) => {\n    // Validate positions\n    const safeX = Number.isFinite(pos.x) ? pos.x : xMotion.get()\n    const safeY = Number.isFinite(pos.y) ? pos.y : yMotion.get()\n\n    xMotion.jump(safeX)\n    yMotion.jump(safeY)\n  }, [xMotion, yMotion])\n\n  const stop = useCallback(() => {\n    isActiveRef.current = false\n    if (frameRef.current) cancelAnimationFrame(frameRef.current)\n    frameRef.current = null\n    velocityRef.current = { x: 0, y: 0 }\n  }, [])\n\n  const start = useCallback(() => {\n    if (!isActiveRef.current) {\n      isActiveRef.current = true\n      // Cancel any existing frame before starting new one\n      if (frameRef.current) cancelAnimationFrame(frameRef.current)\n      frameRef.current = requestAnimationFrame(tick)\n    }\n  }, [tick])\n\n  // Cleanup: cancel animations but don't destroy MotionValues\n  // (MotionValues are reused across React StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      if (frameRef.current) cancelAnimationFrame(frameRef.current)\n      isActiveRef.current = false\n    }\n  }, [])\n\n  return {\n    x: xMotion,\n    y: yMotion,\n    launch,\n    setPosition,\n    stop,\n    start,\n    isActive: () => isActiveRef.current,\n    getVelocity: () => ({ ...velocityRef.current }),\n  }\n}\n\n// ============ useChain ============\n\nexport interface ChainStep {\n  /** Target values */\n  to: Record<string, number>\n  /** Spring config for this step */\n  config?: SpringConfig\n  /** Delay before this step (ms) */\n  delay?: number\n}\n\n/**\n * Chain multiple animations in sequence\n *\n * Unlike sequence() which is for orchestrating separate springs,\n * useChain manages a single set of values through multiple steps.\n *\n * @example\n * ```tsx\n * function AnimatedElement() {\n *   const { values, play, reset, isPlaying } = useChain([\n *     { to: { opacity: 1, scale: 1.2 }, config: { stiffness: 300 } },\n *     { to: { scale: 1 }, delay: 100 },\n *     { to: { x: 100 }, config: { stiffness: 200, damping: 20 } },\n *   ])\n *\n *   return (\n *     <div\n *       style={{\n *         opacity: values.opacity?.get(),\n *         transform: `scale(${values.scale?.get()}) translateX(${values.x?.get()}px)`\n *       }}\n *       onClick={() => play()}\n *     />\n *   )\n * }\n * ```\n */\nexport function useChain(\n  steps: ChainStep[],\n  initialValues: Record<string, number> = {}\n) {\n  const valuesRef = useRef<Record<string, MotionValue<number>>>({})\n  const springsRef = useRef<Record<string, ReturnType<typeof createSpringValue>>>({})\n  const [currentStep, setCurrentStep] = useState(-1)\n  const [isPlaying, setIsPlaying] = useState(false)\n  const timeoutRef = useRef<number | null>(null)\n\n  // Initialize values from steps\n  useEffect(() => {\n    const allKeys = new Set<string>()\n    steps.forEach((step) => {\n      Object.keys(step.to).forEach((key) => allKeys.add(key))\n    })\n\n    allKeys.forEach((key) => {\n      // Recreate if destroyed (happens with React StrictMode double-mount)\n      if (!valuesRef.current[key] || valuesRef.current[key].isDestroyed()) {\n        const initial = initialValues[key] ?? 0\n        valuesRef.current[key] = createMotionValue(initial)\n        springsRef.current[key] = createSpringValue(initial, {\n          onUpdate: (v) => valuesRef.current[key]?.jump(v),\n        })\n      }\n    })\n\n    // Cleanup: stop springs but don't destroy MotionValues\n    // (They are reused across React StrictMode remounts)\n    return () => {\n      Object.values(springsRef.current).forEach((s) => s.stop())\n      if (timeoutRef.current) clearTimeout(timeoutRef.current)\n    }\n    // Mount only - steps and initialValues used for initialization\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  const runStep = useCallback((stepIndex: number) => {\n    if (stepIndex >= steps.length) {\n      setIsPlaying(false)\n      setCurrentStep(-1)\n      return\n    }\n\n    const step = steps[stepIndex]\n    if (!step) return\n\n    const execute = () => {\n      setCurrentStep(stepIndex)\n\n      // Animate to step values\n      Object.entries(step.to).forEach(([key, value]) => {\n        const spring = springsRef.current[key]\n        if (spring) {\n          if (step.config) {\n            spring.setConfig(step.config)\n          }\n          spring.set(value)\n        }\n      })\n\n      // Wait for animations to complete then run next step\n      // For simplicity, we estimate based on spring settings\n      const estimatedDuration = step.config?.stiffness\n        ? Math.max(300, 1000 / (step.config.stiffness / 100))\n        : 500\n\n      timeoutRef.current = window.setTimeout(() => {\n        runStep(stepIndex + 1)\n      }, estimatedDuration)\n    }\n\n    if (step.delay && step.delay > 0) {\n      timeoutRef.current = window.setTimeout(execute, step.delay)\n    } else {\n      execute()\n    }\n  }, [steps])\n\n  const play = useCallback(() => {\n    if (isPlaying) return\n    setIsPlaying(true)\n    runStep(0)\n  }, [isPlaying, runStep])\n\n  const reset = useCallback(() => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n    }\n    setIsPlaying(false)\n    setCurrentStep(-1)\n\n    // Reset all values to initial\n    Object.keys(valuesRef.current).forEach((key) => {\n      const initial = initialValues[key] ?? 0\n      springsRef.current[key]?.jump(initial)\n    })\n  }, [initialValues])\n\n  const stop = useCallback(() => {\n    if (timeoutRef.current) {\n      clearTimeout(timeoutRef.current)\n    }\n    setIsPlaying(false)\n  }, [])\n\n  useEffect(() => {\n    return () => {\n      if (timeoutRef.current) clearTimeout(timeoutRef.current)\n    }\n  }, [])\n\n  return {\n    values: valuesRef.current,\n    play,\n    reset,\n    stop,\n    isPlaying,\n    currentStep,\n  }\n}\n\n// ============ usePointer ============\n\nexport interface UsePointerOptions {\n  /** Target element ref (defaults to window) */\n  target?: React.RefObject<HTMLElement>\n  /** Smooth the pointer movement */\n  smooth?: number\n  /** Track while element is hovered only */\n  hoverOnly?: boolean\n}\n\n/**\n * Track pointer/mouse position as MotionValues\n *\n * @example\n * ```tsx\n * function FollowCursor() {\n *   const { x, y, isHovering } = usePointer({ smooth: 0.1 })\n *\n *   return (\n *     <div\n *       style={{\n *         position: 'fixed',\n *         left: x.get(),\n *         top: y.get(),\n *       }}\n *     />\n *   )\n * }\n * ```\n *\n * @example Relative to element\n * ```tsx\n * function HoverEffect() {\n *   const ref = useRef(null)\n *   const { x, y } = usePointer({ target: ref, hoverOnly: true })\n *\n *   // x, y are relative to element\n *   const rotateX = useTransform(y, [0, 300], [10, -10])\n *   const rotateY = useTransform(x, [0, 300], [-10, 10])\n *\n *   return <div ref={ref} style={{ rotateX, rotateY }} />\n * }\n * ```\n */\nexport function usePointer(options: UsePointerOptions = {}) {\n  const { target, smooth = 0, hoverOnly = false } = options\n\n  const xRef = useRef<MotionValue<number> | null>(null)\n  const yRef = useRef<MotionValue<number> | null>(null)\n  const rawXRef = useRef(0)\n  const rawYRef = useRef(0)\n  const [isHovering, setIsHovering] = useState(false)\n  const frameRef = useRef<number | null>(null)\n\n  // Recreate if destroyed (happens with React StrictMode double-mount)\n  if (xRef.current === null || xRef.current.isDestroyed()) xRef.current = createMotionValue(0)\n  if (yRef.current === null || yRef.current.isDestroyed()) yRef.current = createMotionValue(0)\n\n  useEffect(() => {\n    const element = target?.current ?? window\n\n    const handleMove = (e: MouseEvent | PointerEvent) => {\n      let newX: number\n      let newY: number\n\n      if (target?.current) {\n        const rect = target.current.getBoundingClientRect()\n        newX = e.clientX - rect.left\n        newY = e.clientY - rect.top\n      } else {\n        newX = e.clientX\n        newY = e.clientY\n      }\n\n      rawXRef.current = newX\n      rawYRef.current = newY\n\n      if (smooth === 0) {\n        xRef.current?.jump(newX)\n        yRef.current?.jump(newY)\n      }\n    }\n\n    const handleEnter = () => setIsHovering(true)\n    const handleLeave = () => setIsHovering(false)\n\n    // Smoothing loop\n    if (smooth > 0) {\n      const smoothLoop = () => {\n        const currentX = xRef.current?.get() ?? 0\n        const currentY = yRef.current?.get() ?? 0\n        const newX = currentX + (rawXRef.current - currentX) * smooth\n        const newY = currentY + (rawYRef.current - currentY) * smooth\n        xRef.current?.jump(newX)\n        yRef.current?.jump(newY)\n        frameRef.current = requestAnimationFrame(smoothLoop)\n      }\n      frameRef.current = requestAnimationFrame(smoothLoop)\n    }\n\n    if (hoverOnly && target?.current) {\n      target.current.addEventListener('pointermove', handleMove as EventListener)\n      target.current.addEventListener('pointerenter', handleEnter)\n      target.current.addEventListener('pointerleave', handleLeave)\n    } else {\n      (element as Window | HTMLElement).addEventListener('pointermove', handleMove as EventListener)\n      if (target?.current) {\n        target.current.addEventListener('pointerenter', handleEnter)\n        target.current.addEventListener('pointerleave', handleLeave)\n      }\n    }\n\n    // Capture target ref at effect creation time for cleanup\n    const targetElement = target?.current\n\n    return () => {\n      if (frameRef.current) cancelAnimationFrame(frameRef.current)\n      if (hoverOnly && targetElement) {\n        targetElement.removeEventListener('pointermove', handleMove as EventListener)\n        targetElement.removeEventListener('pointerenter', handleEnter)\n        targetElement.removeEventListener('pointerleave', handleLeave)\n      } else {\n        (element as Window | HTMLElement).removeEventListener('pointermove', handleMove as EventListener)\n        if (targetElement) {\n          targetElement.removeEventListener('pointerenter', handleEnter)\n          targetElement.removeEventListener('pointerleave', handleLeave)\n        }\n      }\n    }\n  }, [target, smooth, hoverOnly])\n\n  // Cleanup: don't destroy MotionValues\n  // (They are reused across React StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      xRef.current?.stop()\n      yRef.current?.stop()\n    }\n  }, [])\n\n  return {\n    x: xRef.current,\n    y: yRef.current,\n    isHovering,\n  }\n}\n\n// ============ useGyroscope ============\n\nexport interface UseGyroscopeOptions {\n  /** Multiply the tilt values */\n  multiplier?: number\n  /** Clamp tilt to this range */\n  clamp?: number\n  /** Smooth the values */\n  smooth?: number\n}\n\n/**\n * Track device orientation/gyroscope as MotionValues\n *\n * Falls back to pointer position on desktop.\n *\n * @example\n * ```tsx\n * function TiltCard() {\n *   const { tiltX, tiltY, isSupported } = useGyroscope({\n *     multiplier: 0.5,\n *     clamp: 15\n *   })\n *\n *   return (\n *     <div\n *       style={{\n *         transform: `perspective(1000px) rotateX(${tiltY.get()}deg) rotateY(${tiltX.get()}deg)`\n *       }}\n *     />\n *   )\n * }\n * ```\n */\nexport function useGyroscope(options: UseGyroscopeOptions = {}) {\n  const { multiplier = 1, clamp = 45, smooth = 0.1 } = options\n\n  const tiltXRef = useRef<MotionValue<number> | null>(null)\n  const tiltYRef = useRef<MotionValue<number> | null>(null)\n  const rawXRef = useRef(0)\n  const rawYRef = useRef(0)\n  const [isSupported, setIsSupported] = useState(false)\n  const frameRef = useRef<number | null>(null)\n\n  // Recreate if destroyed (happens with React StrictMode double-mount)\n  if (tiltXRef.current === null || tiltXRef.current.isDestroyed()) tiltXRef.current = createMotionValue(0)\n  if (tiltYRef.current === null || tiltYRef.current.isDestroyed()) tiltYRef.current = createMotionValue(0)\n\n  const clampValue = useCallback((value: number) => {\n    return Math.max(-clamp, Math.min(clamp, value * multiplier))\n  }, [clamp, multiplier])\n\n  useEffect(() => {\n    const hasOrientation = 'DeviceOrientationEvent' in window\n\n    // Smoothing loop\n    const smoothLoop = () => {\n      const currentX = tiltXRef.current?.get() ?? 0\n      const currentY = tiltYRef.current?.get() ?? 0\n      const newX = currentX + (rawXRef.current - currentX) * smooth\n      const newY = currentY + (rawYRef.current - currentY) * smooth\n      tiltXRef.current?.jump(newX)\n      tiltYRef.current?.jump(newY)\n      frameRef.current = requestAnimationFrame(smoothLoop)\n    }\n    frameRef.current = requestAnimationFrame(smoothLoop)\n\n    if (hasOrientation) {\n      const handleOrientation = (e: DeviceOrientationEvent) => {\n        setIsSupported(true)\n        // gamma: left/right tilt (-90 to 90)\n        // beta: front/back tilt (-180 to 180)\n        rawXRef.current = clampValue(e.gamma ?? 0)\n        rawYRef.current = clampValue(e.beta ?? 0)\n      }\n\n      window.addEventListener('deviceorientation', handleOrientation)\n\n      return () => {\n        if (frameRef.current) cancelAnimationFrame(frameRef.current)\n        window.removeEventListener('deviceorientation', handleOrientation)\n      }\n    } else {\n      // Fallback to mouse position\n      const handleMouse = (e: MouseEvent) => {\n        const centerX = window.innerWidth / 2\n        const centerY = window.innerHeight / 2\n        rawXRef.current = clampValue((e.clientX - centerX) / centerX * 45)\n        rawYRef.current = clampValue((e.clientY - centerY) / centerY * 45)\n      }\n\n      window.addEventListener('mousemove', handleMouse)\n\n      return () => {\n        if (frameRef.current) cancelAnimationFrame(frameRef.current)\n        window.removeEventListener('mousemove', handleMouse)\n      }\n    }\n  }, [clampValue, smooth])\n\n  // Cleanup: don't destroy MotionValues\n  // (They are reused across React StrictMode remounts)\n  useEffect(() => {\n    return () => {\n      tiltXRef.current?.stop()\n      tiltYRef.current?.stop()\n    }\n  }, [])\n\n  return {\n    tiltX: tiltXRef.current,\n    tiltY: tiltYRef.current,\n    isSupported,\n  }\n}\n","import React, { useEffect, useRef, useState } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Spring component props\n */\nexport interface SpringProps<T extends Record<string, number>> {\n  /** Starting values */\n  from: T\n  /** Target values */\n  to: T\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Callback when animation is at rest */\n  onRest?: () => void\n  /** Render function */\n  children: (values: T) => React.ReactNode\n}\n\n/**\n * Spring component for declarative animations\n *\n * @example\n * ```tsx\n * <Spring\n *   from={{ opacity: 0, y: 20 }}\n *   to={{ opacity: 1, y: 0 }}\n *   config={{ stiffness: 100, damping: 10 }}\n * >\n *   {(style) => (\n *     <div\n *       style={{\n *         opacity: style.opacity,\n *         transform: `translateY(${style.y}px)`,\n *       }}\n *     >\n *       Animated content\n *     </div>\n *   )}\n * </Spring>\n * ```\n */\nexport const Spring = <T extends Record<string, number>>({\n  from,\n  to,\n  config = {},\n  onRest,\n  children,\n}: SpringProps<T>) => {\n  const springRef = useRef<ReturnType<typeof createSpringGroup<T>> | null>(null)\n  const [values, setValues] = useState<T>(from)\n\n  // Initialize spring\n  useEffect(() => {\n    const spring = createSpringGroup(from, config)\n    spring.subscribe(setValues)\n    springRef.current = spring\n\n    // Start animation\n    requestAnimationFrame(() => {\n      spring.set(to, { ...config, onRest })\n    })\n\n    return () => spring.destroy()\n    // Intentionally only run on mount - updates handled in separate effect\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [])\n\n  // Update when props change\n  useEffect(() => {\n    springRef.current?.set(to, { ...config, onRest })\n  }, [to, config, onRest])\n\n  return <>{children(values)}</>}\n","import React, { useEffect, useRef, useState, useContext, useCallback, memo } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\nimport { PresenceContext } from '../context/PresenceContext.js'\nimport { isBrowser } from '../utils/ssr.js'\n\n/**\n * Animation state for Animated components\n */\nexport interface AnimatedStyle {\n  [key: string]: number | string\n}\n\n/**\n * Viewport options for whileInView\n */\nexport interface ViewportOptions {\n  /** Only trigger animation once */\n  once?: boolean\n  /** IntersectionObserver margin */\n  margin?: string\n  /** Amount of element that must be visible (0-1) */\n  amount?: number | 'some' | 'all'\n}\n\n/**\n * Props for animated elements\n */\nexport interface AnimatedElementProps extends Omit<React.HTMLAttributes<HTMLElement>, 'style'> {\n  /** Spring configuration */\n  config?: SpringConfig\n\n  /** Initial animation state (animates from this on mount) */\n  initial?: AnimatedStyle | false\n\n  /** Target animation state */\n  animate?: AnimatedStyle\n\n  /** Exit animation state (used with AnimatePresence) */\n  exit?: AnimatedStyle\n\n  /** Animation state while hovered */\n  whileHover?: AnimatedStyle\n\n  /** Animation state while pressed/tapped */\n  whileTap?: AnimatedStyle\n\n  /** Animation state while focused */\n  whileFocus?: AnimatedStyle\n\n  /** Animation state while dragging */\n  whileDrag?: AnimatedStyle\n\n  /** Animation state while in viewport */\n  whileInView?: AnimatedStyle\n\n  /** Viewport options for whileInView */\n  viewport?: ViewportOptions\n\n  /** Style object (static styles + animated values) */\n  style?: React.CSSProperties\n\n  /** Callback when animation completes */\n  onAnimationComplete?: () => void\n\n  /** Callback when hover starts */\n  onHoverStart?: (event: React.MouseEvent) => void\n\n  /** Callback when hover ends */\n  onHoverEnd?: (event: React.MouseEvent) => void\n\n  /** Callback when tap/press starts */\n  onTapStart?: (event: React.PointerEvent) => void\n\n  /** Callback when tap/press ends */\n  onTap?: (event: React.PointerEvent) => void\n\n  /** Callback when tap is cancelled */\n  onTapCancel?: (event: React.PointerEvent) => void\n\n  ref?: React.Ref<HTMLElement>\n}\n\n/**\n * Extract numeric values from a style object\n */\nfunction extractNumericValues(style: AnimatedStyle): Record<string, number> {\n  const result: Record<string, number> = {}\n  for (const key in style) {\n    if (typeof style[key] === 'number') {\n      result[key] = style[key] as number\n    }\n  }\n  return result\n}\n\n/**\n * Extract non-numeric (string) values from a style object\n */\nfunction extractStringValues(style: AnimatedStyle): Record<string, string> {\n  const result: Record<string, string> = {}\n  for (const key in style) {\n    if (typeof style[key] === 'string') {\n      result[key] = style[key] as string\n    }\n  }\n  return result\n}\n\n/**\n * Create an animated component for a given tag\n */\nfunction createAnimatedComponent<T extends React.ElementType>(\n  tag: T\n) {\n  const AnimatedComponent = React.forwardRef<HTMLElement, React.ComponentPropsWithoutRef<T> & AnimatedElementProps>(\n    (\n      {\n        children,\n        style = {},\n        config = {},\n        initial,\n        animate,\n        exit,\n        whileHover,\n        whileTap,\n        whileFocus,\n        whileDrag,\n        whileInView,\n        viewport,\n        onAnimationComplete,\n        onHoverStart,\n        onHoverEnd,\n        onTapStart,\n        onTap,\n        onTapCancel,\n        onMouseEnter: propsOnMouseEnter,\n        onMouseLeave: propsOnMouseLeave,\n        onPointerDown: propsOnPointerDown,\n        onPointerUp: propsOnPointerUp,\n        onPointerCancel: propsOnPointerCancel,\n        onFocus: propsOnFocus,\n        onBlur: propsOnBlur,\n        ...props\n      },\n      forwardedRef\n    ) => {\n      const springRef = useRef<ReturnType<typeof createSpringGroup> | null>(null)\n      const unsubscribeRef = useRef<(() => void) | null>(null)\n      const elementRef = useRef<HTMLElement | null>(null)\n      const [animatedStyle, setAnimatedStyle] = useState<React.CSSProperties>({})\n      const isFirstRender = useRef(true)\n      const hasCalledSafeToRemove = useRef(false)\n      const isDestroyedRef = useRef(false)\n\n      // Gesture states\n      const [isHovered, setIsHovered] = useState(false)\n      const [isPressed, setIsPressed] = useState(false)\n      const [isFocused, setIsFocused] = useState(false)\n      // eslint-disable-next-line @typescript-eslint/no-unused-vars\n      const [isDragging, _setIsDragging] = useState(false)\n      const [isInViewport, setIsInViewport] = useState(false)\n      const hasTriggeredInView = useRef(false)\n\n      // Get presence context for exit animations\n      const presenceContext = useContext(PresenceContext)\n      const isPresent = presenceContext?.isPresent ?? true\n      const safeToRemove = presenceContext?.safeToRemove\n\n      // Combine refs\n      const setRef = useCallback((node: HTMLElement | null) => {\n        elementRef.current = node\n        if (typeof forwardedRef === 'function') {\n          forwardedRef(node)\n        } else if (forwardedRef) {\n          (forwardedRef as React.MutableRefObject<HTMLElement | null>).current = node\n        }\n      }, [forwardedRef])\n\n      // IntersectionObserver for whileInView\n      useEffect(() => {\n        if (!whileInView || !isBrowser) return\n\n        // Capture element at effect creation time\n        const element = elementRef.current\n        if (!element) return\n\n        const threshold = viewport?.amount === 'all' ? 1 :\n                         viewport?.amount === 'some' ? 0 :\n                         typeof viewport?.amount === 'number' ? viewport.amount : 0.5\n\n        const observer = new IntersectionObserver(\n          (entries) => {\n            entries.forEach((entry) => {\n              if (entry.isIntersecting) {\n                if (viewport?.once && hasTriggeredInView.current) return\n                setIsInViewport(true)\n                hasTriggeredInView.current = true\n              } else if (!viewport?.once) {\n                setIsInViewport(false)\n              }\n            })\n          },\n          {\n            rootMargin: viewport?.margin ?? '0px',\n            threshold,\n          }\n        )\n\n        observer.observe(element)\n        return () => {\n          observer.unobserve(element)\n          observer.disconnect()\n        }\n      }, [whileInView, viewport?.once, viewport?.margin, viewport?.amount])\n\n      // Determine the target style based on presence and gesture states\n      const getTargetStyle = useCallback((): AnimatedStyle => {\n        // If exiting and we have exit styles\n        if (!isPresent && exit) {\n          return exit\n        }\n\n        // Start with base animate styles\n        let target: AnimatedStyle = animate ? { ...animate } : {}\n\n        // Layer gesture states (order matters - later ones override)\n        if (whileInView && isInViewport) {\n          target = { ...target, ...whileInView }\n        }\n\n        if (whileFocus && isFocused) {\n          target = { ...target, ...whileFocus }\n        }\n\n        if (whileHover && isHovered) {\n          target = { ...target, ...whileHover }\n        }\n\n        if (whileDrag && isDragging) {\n          target = { ...target, ...whileDrag }\n        }\n\n        if (whileTap && isPressed) {\n          target = { ...target, ...whileTap }\n        }\n\n        // If no target styles, fallback to numeric values from style prop\n        if (Object.keys(target).length === 0) {\n          return Object.fromEntries(\n            Object.entries(style).filter((entry): entry is [string, number] => typeof entry[1] === 'number')\n          ) as AnimatedStyle\n        }\n\n        return target\n      }, [isPresent, exit, animate, style, whileHover, whileTap, whileFocus, whileDrag, whileInView, isHovered, isPressed, isFocused, isDragging, isInViewport])\n\n      // Get initial style\n      const getInitialStyle = useCallback((): AnimatedStyle => {\n        // Skip initial animation\n        if (initial === false) {\n          return getTargetStyle()\n        }\n\n        // Use explicit initial values\n        if (initial) {\n          return initial\n        }\n\n        // Default to target for no animation on mount\n        return getTargetStyle()\n      }, [initial, getTargetStyle])\n\n      // Initialize spring and handle animations\n      useEffect(() => {\n        const initialStyle = getInitialStyle()\n        const numericInitial = extractNumericValues(initialStyle)\n\n        // Only create spring if there are numeric values to animate\n        if (Object.keys(numericInitial).length === 0) {\n          return\n        }\n\n        // Cleanup previous subscription if exists\n        if (unsubscribeRef.current) {\n          unsubscribeRef.current()\n          unsubscribeRef.current = null\n        }\n\n        // Destroy previous spring if exists\n        if (springRef.current) {\n          springRef.current.destroy()\n          springRef.current = null\n        }\n\n        isDestroyedRef.current = false\n        const spring = createSpringGroup(numericInitial, config)\n\n        // Subscribe with destroyed check\n        unsubscribeRef.current = spring.subscribe((values) => {\n          if (!isDestroyedRef.current) {\n            setAnimatedStyle(values as React.CSSProperties)\n          }\n        })\n\n        springRef.current = spring\n\n        // If initial is provided and different from animate, start animation immediately\n        if (initial && initial !== false && animate) {\n          const numericAnimate = extractNumericValues(animate)\n          const needsAnimation = Object.keys(numericAnimate).some(\n            (key) => numericInitial[key] !== numericAnimate[key]\n          )\n\n          if (needsAnimation) {\n            // Use requestAnimationFrame to ensure spring is ready\n            requestAnimationFrame(() => {\n              if (springRef.current && !isDestroyedRef.current) {\n                springRef.current.set(numericAnimate)\n              }\n            })\n          }\n        }\n\n        return () => {\n          isDestroyedRef.current = true\n          if (unsubscribeRef.current) {\n            unsubscribeRef.current()\n            unsubscribeRef.current = null\n          }\n          spring.destroy()\n        }\n      }, [config.stiffness, config.damping]) // eslint-disable-line react-hooks/exhaustive-deps\n\n      // Handle animation updates (after initial mount)\n      useEffect(() => {\n        if (!springRef.current) return\n\n        // Skip on first render - handled in spring initialization\n        if (isFirstRender.current) {\n          isFirstRender.current = false\n          return\n        }\n\n        const targetStyle = getTargetStyle()\n        const numericTarget = extractNumericValues(targetStyle)\n        springRef.current.set(numericTarget)\n      }, [isPresent, animate, exit, getTargetStyle, initial, isHovered, isPressed, isFocused, isInViewport])\n\n      // Handle exit animation completion\n      useEffect(() => {\n        if (!isPresent && exit && safeToRemove && !hasCalledSafeToRemove.current) {\n          let innerTimeout: ReturnType<typeof setTimeout> | null = null\n          let cancelled = false\n\n          const checkComplete = () => {\n            if (cancelled) return\n\n            // Simple velocity check - in a real implementation,\n            // we'd check the spring's isAtRest state\n            const values = springRef.current\n            if (values) {\n              // For now, use a timeout as a fallback\n              // The spring group doesn't expose isAtRest easily\n              innerTimeout = setTimeout(() => {\n                if (!cancelled && !hasCalledSafeToRemove.current) {\n                  hasCalledSafeToRemove.current = true\n                  safeToRemove()\n                  onAnimationComplete?.()\n                }\n              }, 500) // Reasonable default for spring animations\n            }\n          }\n\n          // Start checking for completion\n          const timeout = setTimeout(checkComplete, 50)\n\n          return () => {\n            cancelled = true\n            clearTimeout(timeout)\n            if (innerTimeout !== null) {\n              clearTimeout(innerTimeout)\n            }\n          }\n        }\n      }, [isPresent, exit, safeToRemove, onAnimationComplete])\n\n      // Reset flag when becoming present again\n      useEffect(() => {\n        if (isPresent) {\n          hasCalledSafeToRemove.current = false\n        }\n      }, [isPresent])\n\n      // Gesture event handlers\n      const handleMouseEnter = useCallback((e: React.MouseEvent) => {\n        if (whileHover) setIsHovered(true)\n        onHoverStart?.(e)\n        propsOnMouseEnter?.(e as React.MouseEvent<HTMLElement>)\n      }, [whileHover, onHoverStart, propsOnMouseEnter])\n\n      const handleMouseLeave = useCallback((e: React.MouseEvent) => {\n        if (whileHover) setIsHovered(false)\n        if (whileTap) setIsPressed(false)\n        onHoverEnd?.(e)\n        propsOnMouseLeave?.(e as React.MouseEvent<HTMLElement>)\n      }, [whileHover, whileTap, onHoverEnd, propsOnMouseLeave])\n\n      const handlePointerDown = useCallback((e: React.PointerEvent) => {\n        if (whileTap) setIsPressed(true)\n        onTapStart?.(e)\n        propsOnPointerDown?.(e as React.PointerEvent<HTMLElement>)\n      }, [whileTap, onTapStart, propsOnPointerDown])\n\n      const handlePointerUp = useCallback((e: React.PointerEvent) => {\n        if (whileTap && isPressed) {\n          setIsPressed(false)\n          onTap?.(e)\n        }\n        propsOnPointerUp?.(e as React.PointerEvent<HTMLElement>)\n      }, [whileTap, isPressed, onTap, propsOnPointerUp])\n\n      const handlePointerCancel = useCallback((e: React.PointerEvent) => {\n        if (whileTap && isPressed) {\n          setIsPressed(false)\n          onTapCancel?.(e)\n        }\n        propsOnPointerCancel?.(e as React.PointerEvent<HTMLElement>)\n      }, [whileTap, isPressed, onTapCancel, propsOnPointerCancel])\n\n      const handleFocus = useCallback((e: React.FocusEvent) => {\n        if (whileFocus) setIsFocused(true)\n        propsOnFocus?.(e as React.FocusEvent<HTMLElement>)\n      }, [whileFocus, propsOnFocus])\n\n      const handleBlur = useCallback((e: React.FocusEvent) => {\n        if (whileFocus) setIsFocused(false)\n        propsOnBlur?.(e as React.FocusEvent<HTMLElement>)\n      }, [whileFocus, propsOnBlur])\n\n      // Global pointer up listener for tap state\n      useEffect(() => {\n        if (!whileTap || !isPressed) return\n\n        const handleGlobalPointerUp = () => {\n          setIsPressed(false)\n        }\n\n        window.addEventListener('pointerup', handleGlobalPointerUp)\n        window.addEventListener('pointercancel', handleGlobalPointerUp)\n\n        return () => {\n          window.removeEventListener('pointerup', handleGlobalPointerUp)\n          window.removeEventListener('pointercancel', handleGlobalPointerUp)\n        }\n      }, [whileTap, isPressed])\n\n      // Combine static and animated styles\n      const staticStyle = Object.fromEntries(\n        Object.entries(style).filter(([_, v]) => typeof v !== 'number')\n      )\n\n      // Get string values from active gesture states (applied immediately, not animated)\n      const gestureStringStyles: React.CSSProperties = {}\n\n      // Layer gesture string styles in order (later ones override)\n      if (whileInView && isInViewport) {\n        Object.assign(gestureStringStyles, extractStringValues(whileInView))\n      }\n      if (whileFocus && isFocused) {\n        Object.assign(gestureStringStyles, extractStringValues(whileFocus))\n      }\n      if (whileHover && isHovered) {\n        Object.assign(gestureStringStyles, extractStringValues(whileHover))\n      }\n      if (whileDrag && isDragging) {\n        Object.assign(gestureStringStyles, extractStringValues(whileDrag))\n      }\n      if (whileTap && isPressed) {\n        Object.assign(gestureStringStyles, extractStringValues(whileTap))\n      }\n\n      // Build event handlers\n      const eventHandlers: Record<string, React.EventHandler<React.SyntheticEvent>> = {}\n\n      if (whileHover || onHoverStart || onHoverEnd) {\n        eventHandlers.onMouseEnter = handleMouseEnter as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onMouseLeave = handleMouseLeave as React.EventHandler<React.SyntheticEvent>\n      }\n\n      if (whileTap || onTapStart || onTap || onTapCancel) {\n        eventHandlers.onPointerDown = handlePointerDown as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onPointerUp = handlePointerUp as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onPointerCancel = handlePointerCancel as React.EventHandler<React.SyntheticEvent>\n      }\n\n      if (whileFocus) {\n        eventHandlers.onFocus = handleFocus as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onBlur = handleBlur as React.EventHandler<React.SyntheticEvent>\n      }\n\n      return React.createElement(\n        tag,\n        {\n          ...props,\n          ...eventHandlers,\n          ref: setRef,\n          style: { ...staticStyle, ...animatedStyle, ...gestureStringStyles },\n        },\n        children\n      )\n    }\n  )\n\n  AnimatedComponent.displayName = `Animated.${String(tag)}`\n  return memo(AnimatedComponent)\n}\n\n/**\n * Animated components with spring physics\n *\n * @example Basic animation\n * ```tsx\n * <Animated.div\n *   style={{\n *     opacity: isVisible ? 1 : 0,\n *     transform: `translateX(${isOpen ? 100 : 0}px)`,\n *   }}\n *   config={{ stiffness: 120, damping: 14 }}\n * >\n *   Content automatically animates\n * </Animated.div>\n * ```\n *\n * @example With AnimatePresence\n * ```tsx\n * <AnimatePresence>\n *   {isVisible && (\n *     <Animated.div\n *       key=\"modal\"\n *       initial={{ opacity: 0, scale: 0.9 }}\n *       animate={{ opacity: 1, scale: 1 }}\n *       exit={{ opacity: 0, scale: 0.9 }}\n *     >\n *       Modal content\n *     </Animated.div>\n *   )}\n * </AnimatePresence>\n * ```\n */\nexport const Animated = {\n  div: createAnimatedComponent('div'),\n  span: createAnimatedComponent('span'),\n  button: createAnimatedComponent('button'),\n  a: createAnimatedComponent('a'),\n  p: createAnimatedComponent('p'),\n  h1: createAnimatedComponent('h1'),\n  h2: createAnimatedComponent('h2'),\n  h3: createAnimatedComponent('h3'),\n  h4: createAnimatedComponent('h4'),\n  h5: createAnimatedComponent('h5'),\n  h6: createAnimatedComponent('h6'),\n  ul: createAnimatedComponent('ul'),\n  ol: createAnimatedComponent('ol'),\n  li: createAnimatedComponent('li'),\n  section: createAnimatedComponent('section'),\n  article: createAnimatedComponent('article'),\n  header: createAnimatedComponent('header'),\n  footer: createAnimatedComponent('footer'),\n  nav: createAnimatedComponent('nav'),\n  main: createAnimatedComponent('main'),\n  aside: createAnimatedComponent('aside'),\n  img: createAnimatedComponent('img'),\n  svg: createAnimatedComponent('svg'),\n  path: createAnimatedComponent('path'),\n  circle: createAnimatedComponent('circle'),\n  rect: createAnimatedComponent('rect'),\n  g: createAnimatedComponent('g'),\n}\n","import React, { useEffect, useRef, useState } from 'react'\nimport { createTrail } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Trail component props\n */\nexport interface TrailProps<T, V extends Record<string, number>> {\n  /** Array of items */\n  items: T[]\n  /** Key extractor for items */\n  keys: (item: T, index: number) => string | number\n  /** Starting values */\n  from: V\n  /** Target values */\n  to: V\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to reverse the trail */\n  reverse?: boolean\n  /** Render function */\n  children: (values: V, item: T, index: number) => React.ReactNode\n}\n\n/**\n * Trail component for staggered animations\n *\n * @example\n * ```tsx\n * <Trail\n *   items={items}\n *   keys={(item) => item.id}\n *   from={{ opacity: 0, x: -20 }}\n *   to={{ opacity: 1, x: 0 }}\n *   config={{ stiffness: 120, damping: 14 }}\n * >\n *   {(style, item, index) => (\n *     <div\n *       key={item.id}\n *       style={{\n *         opacity: style.opacity,\n *         transform: `translateX(${style.x}px)`,\n *       }}\n *     >\n *       {item.name}\n *     </div>\n *   )}\n * </Trail>\n * ```\n */\nexport const Trail = <T, V extends Record<string, number>>({\n  items,\n  keys,\n  from,\n  to,\n  config = {},\n  reverse = false,\n  children,\n}: TrailProps<T, V>) => {\n  const trailRef = useRef<ReturnType<typeof createTrail> | null>(null)\n  const [values, setValues] = useState<V[]>(() =>\n    items.map(() => ({ ...from }))\n  )\n\n  // Initialize trail\n  useEffect(() => {\n    const trail = createTrail(items.length, config)\n\n    const unsubscribe = trail.subscribe((vals) => {\n      setValues(vals.map((v) => ({ ...to, x: v })))\n    })\n\n    trailRef.current = trail\n\n    // Start animation\n    const firstValue = Object.values(to)[0] as number\n    trail.set(firstValue)\n\n    return () => {\n      unsubscribe()\n      trail.destroy()\n    }\n  }, [items.length, config.stiffness, config.damping]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Update when to values change\n  useEffect(() => {\n    const firstValue = Object.values(to)[0] as number\n    trailRef.current?.set(firstValue)\n  }, [to])\n\n  return (\n    <>\n      {items.map((item, index) => (\n        <React.Fragment key={keys(item, index)}>\n          {children(values[index]!, item, reverse ? items.length - 1 - index : index)}\n        </React.Fragment>\n      ))}\n    </>\n  )\n}\n","import React, { useMemo, useCallback, useRef, useEffect } from 'react'\nimport { PresenceContext, type PresenceContextValue } from '../context/PresenceContext.js'\n\n/** Default timeout for exit animations (10 seconds) */\nexport const DEFAULT_EXIT_TIMEOUT = 10000\n\nexport interface PresenceChildProps {\n  /** Unique identifier for this child */\n  id: string\n  /** The child element to render */\n  children: React.ReactElement\n  /** Whether this child is currently present in the tree */\n  isPresent: boolean\n  /** Callback when exit animation is complete and child can be removed */\n  onExitComplete: (id: string) => void\n  /** Custom data to pass to the child via context */\n  custom?: unknown\n  /** Maximum time to wait for exit animation before forcing removal (ms). Set to 0 to disable. Default: 10000 */\n  exitTimeout?: number\n}\n\n/**\n * Wrapper component that provides presence context to a child in AnimatePresence\n *\n * This component is internal and used by AnimatePresence to manage\n * the lifecycle of exiting children.\n */\nexport function PresenceChild({\n  id,\n  children,\n  isPresent,\n  onExitComplete,\n  custom,\n  exitTimeout = DEFAULT_EXIT_TIMEOUT,\n}: PresenceChildProps) {\n  const presenceIdRef = useRef(id)\n\n  // Update ref on id change (shouldn't happen but be safe)\n  presenceIdRef.current = id\n\n  // Memoized callback for safeToRemove\n  const safeToRemove = useCallback(() => {\n    onExitComplete(presenceIdRef.current)\n  }, [onExitComplete])\n\n  // Create stable context value\n  const contextValue = useMemo<PresenceContextValue>(\n    () => ({\n      id,\n      isPresent,\n      safeToRemove,\n      custom,\n    }),\n    [id, isPresent, safeToRemove, custom]\n  )\n\n  // Auto-call safeToRemove after a timeout if exit animation doesn't complete\n  // This prevents \"zombie\" children from staying in the tree forever\n  const hasExitedRef = useRef(false)\n  const hasCalledRemoveRef = useRef(false)\n\n  useEffect(() => {\n    // Reset when becoming present again\n    if (isPresent) {\n      hasExitedRef.current = false\n      hasCalledRemoveRef.current = false\n      return\n    }\n\n    // Already processed exit\n    if (hasExitedRef.current) return\n\n    hasExitedRef.current = true\n\n    // If exitTimeout is 0 or negative, don't set a timeout (rely on animation to call safeToRemove)\n    if (exitTimeout <= 0) return\n\n    // Set a configurable timeout for exit animations\n    // If the animation hasn't called safeToRemove by then, force removal\n    const timeout = setTimeout(() => {\n      // Only call if not already called\n      if (!hasCalledRemoveRef.current) {\n        hasCalledRemoveRef.current = true\n        safeToRemove()\n      }\n    }, exitTimeout)\n\n    return () => clearTimeout(timeout)\n  }, [isPresent, safeToRemove, exitTimeout])\n\n  return (\n    <PresenceContext.Provider value={contextValue}>\n      {children}\n    </PresenceContext.Provider>\n  )\n}\n","import React, {\n  useRef,\n  useState,\n  useLayoutEffect,\n  useEffect,\n  Children,\n  isValidElement,\n  cloneElement,\n} from 'react'\nimport { PresenceChild } from './PresenceChild.js'\n\n// SSR-safe useLayoutEffect\nconst useIsomorphicLayoutEffect =\n  typeof window !== 'undefined' ? useLayoutEffect : useEffect\n\nexport type AnimatePresenceMode = 'sync' | 'wait' | 'popLayout'\n\nexport interface AnimatePresenceProps {\n  /**\n   * Children to animate. Each direct child must have a unique key.\n   */\n  children?: React.ReactNode\n\n  /**\n   * Custom data passed to exit animations via usePresenceCustom()\n   * Useful for dynamic exit directions (e.g., slide left vs right)\n   */\n  custom?: unknown\n\n  /**\n   * Whether to animate the initial mount of children.\n   * Set to false to skip initial animations.\n   * @default true\n   */\n  initial?: boolean\n\n  /**\n   * Controls how children animate relative to each other:\n   * - 'sync': Exiting and entering children animate simultaneously (default)\n   * - 'wait': Wait for exiting children to finish before entering new children\n   * - 'popLayout': Like 'sync' but uses FLIP for position animations\n   * @default 'sync'\n   */\n  mode?: AnimatePresenceMode\n\n  /**\n   * Callback fired when all exiting children have finished animating\n   */\n  onExitComplete?: () => void\n}\n\ninterface ChildMap {\n  [key: string]: React.ReactElement\n}\n\n/**\n * Get unique key from React element\n */\nfunction getChildKey(child: React.ReactElement): string {\n  return child.key !== null ? String(child.key) : ''\n}\n\n/**\n * Convert children array to keyed map\n */\nfunction getChildrenMap(children: React.ReactNode): ChildMap {\n  const map: ChildMap = {}\n\n  Children.forEach(children, (child) => {\n    if (isValidElement(child)) {\n      const key = getChildKey(child)\n      if (key) {\n        map[key] = child\n      }\n    }\n  })\n\n  return map\n}\n\n/**\n * AnimatePresence enables exit animations for children when they're removed.\n *\n * Wrap any components that may be conditionally rendered. Each direct child\n * must have a unique `key` prop for AnimatePresence to track them.\n *\n * @example Basic usage\n * ```tsx\n * import { AnimatePresence, Animated } from '@oxog/springkit/react'\n *\n * function App() {\n *   const [isVisible, setIsVisible] = useState(true)\n *\n *   return (\n *     <AnimatePresence>\n *       {isVisible && (\n *         <Animated.div\n *           key=\"box\"\n *           initial={{ opacity: 0 }}\n *           animate={{ opacity: 1 }}\n *           exit={{ opacity: 0 }}\n *         >\n *           I fade in and out\n *         </Animated.div>\n *       )}\n *     </AnimatePresence>\n *   )\n * }\n * ```\n *\n * @example Wait mode\n * ```tsx\n * <AnimatePresence mode=\"wait\">\n *   <Page key={currentPage} />\n * </AnimatePresence>\n * ```\n *\n * @example Custom exit data\n * ```tsx\n * <AnimatePresence custom={direction}>\n *   <Slide key={index} />\n * </AnimatePresence>\n *\n * // In Slide component:\n * const direction = usePresenceCustom<number>()\n * ```\n */\nexport function AnimatePresence({\n  children,\n  custom,\n  initial = true,\n  mode = 'sync',\n  onExitComplete,\n}: AnimatePresenceProps) {\n  // Track whether this is the first render (for initial prop)\n  const isInitialMount = useRef(true)\n\n  // Track which children are exiting (keyed by child key)\n  const [exitingChildren, setExitingChildren] = useState<ChildMap>({})\n\n  // Previous children for comparison\n  const prevChildrenRef = useRef<ChildMap>({})\n\n  // Force update trigger for 'wait' mode\n  const [, forceUpdate] = useState(0)\n\n  // Track pending exits for onExitComplete callback\n  const pendingExitCount = useRef(0)\n\n  // Convert current children to map\n  const currentChildren = getChildrenMap(children)\n\n  // Detect removed children on each render\n  useIsomorphicLayoutEffect(() => {\n    const prevChildren = prevChildrenRef.current\n    const newExiting: ChildMap = {}\n\n    // Find children that were removed\n    for (const key in prevChildren) {\n      if (!(key in currentChildren)) {\n        const prevChild = prevChildren[key]\n        // Child was removed, keep it for exit animation\n        if (prevChild) {\n          newExiting[key] = prevChild\n        }\n      }\n    }\n\n    // Update exiting children if there are any\n    if (Object.keys(newExiting).length > 0) {\n      setExitingChildren((prev) => ({ ...prev, ...newExiting }))\n      pendingExitCount.current += Object.keys(newExiting).length\n    }\n\n    // Store current as previous for next render\n    prevChildrenRef.current = currentChildren\n\n    // After initial mount, unset the flag\n    if (isInitialMount.current) {\n      isInitialMount.current = false\n    }\n  })\n\n  // Handle exit completion\n  const handleExitComplete = (key: string) => {\n    setExitingChildren((prev) => {\n      const next = { ...prev }\n      delete next[key]\n      return next\n    })\n\n    pendingExitCount.current--\n\n    // Fire callback when all exits are complete\n    if (pendingExitCount.current === 0 && onExitComplete) {\n      onExitComplete()\n    }\n\n    // Force re-render for 'wait' mode\n    if (mode === 'wait') {\n      forceUpdate((n) => n + 1)\n    }\n  }\n\n  // In 'wait' mode, don't render entering children until exits complete\n  const showEntering = mode !== 'wait' || Object.keys(exitingChildren).length === 0\n\n  // Combine current and exiting children for rendering\n  const allChildren: React.ReactElement[] = []\n\n  // First, add exiting children (they animate out)\n  for (const key in exitingChildren) {\n    const exitingChild = exitingChildren[key]\n    if (!exitingChild) continue\n\n    allChildren.push(\n      <PresenceChild\n        key={`presence-${key}`}\n        id={key}\n        isPresent={false}\n        onExitComplete={handleExitComplete}\n        custom={custom}\n      >\n        {cloneElement(exitingChild, {\n          key,\n        })}\n      </PresenceChild>\n    )\n  }\n\n  // Then, add current children (if allowed by mode)\n  if (showEntering) {\n    Children.forEach(children, (child) => {\n      if (isValidElement(child)) {\n        const key = getChildKey(child)\n        if (!key) {\n          console.warn(\n            'AnimatePresence: Every child must have a unique \"key\" prop.'\n          )\n          return\n        }\n\n        // Skip initial animation if initial={false} and this is first mount\n        const shouldAnimate = !(isInitialMount.current && initial === false)\n\n        allChildren.push(\n          <PresenceChild\n            key={`presence-${key}`}\n            id={key}\n            isPresent={true}\n            onExitComplete={handleExitComplete}\n            custom={custom}\n          >\n            {cloneElement(child, {\n              key,\n              // Pass down animation state - child components can use this\n              ...(shouldAnimate ? {} : { 'data-initial-skip': true }),\n            })}\n          </PresenceChild>\n        )\n      }\n    })\n  }\n\n  return <>{allChildren}</>\n}\n","import React, { createContext, useContext, useMemo } from 'react'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Reduced motion preference\n */\nexport type ReducedMotionMode = 'user' | 'always' | 'never'\n\n/**\n * Motion configuration options\n */\nexport interface MotionConfigProps {\n  /** Default spring configuration for all children */\n  config?: SpringConfig\n  /** How to handle reduced motion preference */\n  reducedMotion?: ReducedMotionMode\n  /** Whether to skip initial animations */\n  initial?: boolean\n  /** Children components */\n  children: React.ReactNode\n}\n\n/**\n * Motion context value\n */\nexport interface MotionContextValue {\n  config: SpringConfig\n  reducedMotion: ReducedMotionMode\n  initial: boolean\n  isReducedMotion: boolean\n}\n\nconst defaultContext: MotionContextValue = {\n  config: {},\n  reducedMotion: 'user',\n  initial: true,\n  isReducedMotion: false,\n}\n\n/**\n * Context for sharing motion configuration\n */\nexport const MotionContext = createContext<MotionContextValue>(defaultContext)\n\n/**\n * Hook to access motion configuration\n */\nexport function useMotionConfig(): MotionContextValue {\n  return useContext(MotionContext)\n}\n\n/**\n * Check if user prefers reduced motion\n */\nfunction checkReducedMotion(): boolean {\n  if (typeof window === 'undefined') return false\n  return window.matchMedia?.('(prefers-reduced-motion: reduce)').matches ?? false\n}\n\n/**\n * Provides motion configuration to all children.\n * Supports reduced motion preferences and default spring config.\n *\n * @example Default spring config\n * ```tsx\n * <MotionConfig config={{ stiffness: 200, damping: 20 }}>\n *   <Animated.div animate={{ opacity: 1 }}>\n *     Uses parent config\n *   </Animated.div>\n * </MotionConfig>\n * ```\n *\n * @example Reduced motion\n * ```tsx\n * // Respect user's system preference\n * <MotionConfig reducedMotion=\"user\">\n *   <App />\n * </MotionConfig>\n *\n * // Force reduced motion (accessibility)\n * <MotionConfig reducedMotion=\"always\">\n *   <App />\n * </MotionConfig>\n * ```\n *\n * @example Skip initial animations\n * ```tsx\n * <MotionConfig initial={false}>\n *   <Animated.div initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\n *     No initial animation\n *   </Animated.div>\n * </MotionConfig>\n * ```\n */\nexport function MotionConfig({\n  config = {},\n  reducedMotion = 'user',\n  initial = true,\n  children,\n}: MotionConfigProps): React.ReactElement {\n  const parentContext = useContext(MotionContext)\n\n  const value = useMemo<MotionContextValue>(() => {\n    // Determine if reduced motion is active\n    let isReducedMotion = false\n    switch (reducedMotion) {\n      case 'always':\n        isReducedMotion = true\n        break\n      case 'never':\n        isReducedMotion = false\n        break\n      case 'user':\n      default:\n        isReducedMotion = checkReducedMotion()\n    }\n\n    // Merge with parent config\n    return {\n      config: { ...parentContext.config, ...config },\n      reducedMotion,\n      initial,\n      isReducedMotion,\n    }\n  }, [config, reducedMotion, initial, parentContext.config])\n\n  return (\n    <MotionContext.Provider value={value}>\n      {children}\n    </MotionContext.Provider>\n  )\n}\n","import React, {\n  createContext,\n  useContext,\n  useRef,\n  useState,\n  useEffect,\n  useCallback,\n  useMemo,\n} from 'react'\nimport { createSpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n// ============ Types ============\n\nexport interface ReorderGroupProps<T> {\n  /** The list of items to render */\n  values: T[]\n  /** Callback when items are reordered */\n  onReorder: (newOrder: T[]) => void\n  /** Axis of reordering */\n  axis?: 'x' | 'y'\n  /** Spring configuration for animations */\n  config?: SpringConfig\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n  /** Children (must be Reorder.Item components) */\n  children: React.ReactNode\n  /** Element type to render */\n  as?: keyof React.JSX.IntrinsicElements\n  /** Layout animation duration in ms (0 to disable) */\n  layoutDuration?: number\n}\n\nexport interface ReorderItemProps<T> {\n  /** The value this item represents */\n  value: T\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n  /** Children content */\n  children: React.ReactNode\n  /** Element type to render */\n  as?: keyof React.JSX.IntrinsicElements\n  /** Whether this item can be dragged */\n  dragEnabled?: boolean\n  /** Callback when drag starts */\n  onDragStart?: () => void\n  /** Callback when drag ends */\n  onDragEnd?: () => void\n}\n\ninterface ReorderContextValue<T = unknown> {\n  values: T[]\n  axis: 'x' | 'y'\n  config: SpringConfig\n  registerItem: (value: T, element: HTMLElement) => void\n  unregisterItem: (value: T) => void\n  onDragStart: (value: T) => void\n  onDrag: (value: T, offset: number) => void\n  onDragEnd: (value: T) => void\n  getDraggingValue: () => T | null\n  getItemOffset: (value: T) => number\n  layoutDuration: number\n}\n\n// ============ Context ============\n\nconst ReorderContext = createContext<ReorderContextValue | null>(null)\n\nfunction useReorderContext<T>(): ReorderContextValue<T> {\n  const context = useContext(ReorderContext)\n  if (!context) {\n    throw new Error('Reorder.Item must be used within a Reorder.Group')\n  }\n  return context as ReorderContextValue<T>\n}\n\n// ============ Reorder.Group ============\n\nfunction ReorderGroupComponent<T>(\n  {\n    values,\n    onReorder,\n    axis = 'y',\n    config = { stiffness: 300, damping: 30 },\n    className,\n    style,\n    children,\n    as: Component = 'ul',\n    layoutDuration = 200,\n  }: ReorderGroupProps<T>,\n  ref: React.Ref<HTMLElement>\n) {\n  const itemsRef = useRef<Map<T, HTMLElement>>(new Map())\n  const sizesRef = useRef<Map<T, number>>(new Map())\n  const [draggingValue, setDraggingValue] = useState<T | null>(null)\n  const [offsets, setOffsets] = useState<Map<T, number>>(new Map())\n  const dragStartIndexRef = useRef<number>(-1)\n  const currentOrderRef = useRef<T[]>(values)\n\n  // Keep order in sync with values\n  useEffect(() => {\n    currentOrderRef.current = values\n  }, [values])\n\n  // Register an item's element\n  const registerItem = useCallback((value: T, element: HTMLElement) => {\n    itemsRef.current.set(value, element)\n    const rect = element.getBoundingClientRect()\n    sizesRef.current.set(value, axis === 'y' ? rect.height : rect.width)\n  }, [axis])\n\n  // Unregister an item\n  const unregisterItem = useCallback((value: T) => {\n    itemsRef.current.delete(value)\n    sizesRef.current.delete(value)\n  }, [])\n\n  // Handle drag start\n  const handleDragStart = useCallback((value: T) => {\n    setDraggingValue(value)\n    dragStartIndexRef.current = currentOrderRef.current.indexOf(value)\n  }, [])\n\n  // Handle drag movement\n  const handleDrag = useCallback((value: T, offset: number) => {\n    const currentIndex = currentOrderRef.current.indexOf(value)\n    if (currentIndex === -1) return\n\n    const sizes = sizesRef.current\n    const order = [...currentOrderRef.current]\n\n    // Calculate which items need to shift\n    const newOffsets = new Map<T, number>()\n    let accumulatedOffset = 0\n\n    const itemSize = sizes.get(value) || 0\n\n    if (offset > 0) {\n      // Moving forward\n      for (let i = currentIndex + 1; i < order.length; i++) {\n        const otherValue = order[i]\n        if (!otherValue) continue\n        const otherSize = sizes.get(otherValue) || 0\n        accumulatedOffset += otherSize\n\n        if (offset > accumulatedOffset - otherSize / 2) {\n          newOffsets.set(otherValue, -itemSize)\n        } else {\n          newOffsets.set(otherValue, 0)\n        }\n      }\n    } else if (offset < 0) {\n      // Moving backward\n      for (let i = currentIndex - 1; i >= 0; i--) {\n        const otherValue = order[i]\n        if (!otherValue) continue\n        const otherSize = sizes.get(otherValue) || 0\n        accumulatedOffset -= otherSize\n\n        if (offset < accumulatedOffset + otherSize / 2) {\n          newOffsets.set(otherValue, itemSize)\n        } else {\n          newOffsets.set(otherValue, 0)\n        }\n      }\n    }\n\n    setOffsets(newOffsets)\n  }, [])\n\n  // Handle drag end\n  const handleDragEnd = useCallback((value: T) => {\n    const currentIndex = currentOrderRef.current.indexOf(value)\n    if (currentIndex === -1) {\n      setDraggingValue(null)\n      setOffsets(new Map())\n      return\n    }\n\n    // Calculate final order based on offsets\n    const order = [...currentOrderRef.current]\n\n    // Find items that were shifted\n    let targetIndex = currentIndex\n    offsets.forEach((offset, otherValue) => {\n      const otherIndex = order.indexOf(otherValue)\n      if (offset < 0 && otherIndex > currentIndex) {\n        // Item moved backward, we move forward\n        targetIndex = Math.max(targetIndex, otherIndex)\n      } else if (offset > 0 && otherIndex < currentIndex) {\n        // Item moved forward, we move backward\n        targetIndex = Math.min(targetIndex, otherIndex)\n      }\n    })\n\n    // Create new order if changed\n    if (targetIndex !== currentIndex) {\n      const newOrder = [...order]\n      const [removed] = newOrder.splice(currentIndex, 1)\n      if (removed !== undefined) {\n        newOrder.splice(targetIndex, 0, removed)\n        onReorder(newOrder)\n      }\n    }\n\n    setDraggingValue(null)\n    setOffsets(new Map())\n  }, [offsets, onReorder])\n\n  // Get dragging value\n  const getDraggingValue = useCallback(() => draggingValue, [draggingValue])\n\n  // Get item offset\n  const getItemOffset = useCallback((value: T) => offsets.get(value) || 0, [offsets])\n\n  const contextValue = useMemo<ReorderContextValue<T>>(() => ({\n    values,\n    axis,\n    config,\n    registerItem,\n    unregisterItem,\n    onDragStart: handleDragStart,\n    onDrag: handleDrag,\n    onDragEnd: handleDragEnd,\n    getDraggingValue,\n    getItemOffset,\n    layoutDuration,\n  }), [\n    values,\n    axis,\n    config,\n    registerItem,\n    unregisterItem,\n    handleDragStart,\n    handleDrag,\n    handleDragEnd,\n    getDraggingValue,\n    getItemOffset,\n    layoutDuration,\n  ])\n\n  return React.createElement(\n    ReorderContext.Provider,\n    { value: contextValue as ReorderContextValue },\n    React.createElement(\n      Component as string,\n      {\n        ref,\n        className,\n        role: 'listbox',\n        'aria-label': 'Reorderable list',\n        'aria-orientation': axis === 'x' ? 'horizontal' : 'vertical',\n        style: {\n          listStyle: 'none',\n          padding: 0,\n          margin: 0,\n          ...style,\n        },\n      },\n      children\n    )\n  )\n}\n\n// ============ Reorder.Item ============\n\nfunction ReorderItemComponent<T>(\n  {\n    value,\n    className,\n    style,\n    children,\n    as: Component = 'li',\n    dragEnabled = true,\n    onDragStart,\n    onDragEnd,\n  }: ReorderItemProps<T>,\n  ref: React.Ref<HTMLElement>\n) {\n  const context = useReorderContext<T>()\n  const elementRef = useRef<HTMLElement | null>(null)\n  const springRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n  const [offset, setOffset] = useState(0)\n  const [isDragging, setIsDragging] = useState(false)\n  const dragStartPos = useRef({ x: 0, y: 0 })\n  const dragOffset = useRef(0)\n\n  // Combine refs\n  const setRef = useCallback((node: HTMLElement | null) => {\n    elementRef.current = node\n    if (typeof ref === 'function') {\n      ref(node)\n    } else if (ref) {\n      (ref as React.MutableRefObject<HTMLElement | null>).current = node\n    }\n\n    if (node) {\n      context.registerItem(value, node)\n    }\n  }, [ref, context, value])\n\n  // Cleanup\n  useEffect(() => {\n    return () => {\n      context.unregisterItem(value)\n      springRef.current?.destroy()\n    }\n  }, [context, value])\n\n  // Animate offset changes from other items being dragged\n  useEffect(() => {\n    if (isDragging) return // Don't animate if we're the one dragging\n\n    const targetOffset = context.getItemOffset(value)\n\n    if (!springRef.current) {\n      springRef.current = createSpringValue(0, {\n        ...context.config,\n        onUpdate: setOffset,\n      })\n    }\n\n    springRef.current.set(targetOffset)\n  }, [context, value, isDragging])\n\n  // Handle pointer down\n  const handlePointerDown = useCallback((e: React.PointerEvent) => {\n    if (!dragEnabled) return\n\n    e.preventDefault()\n    e.stopPropagation()\n    setIsDragging(true)\n    onDragStart?.()\n    context.onDragStart(value)\n\n    const rect = elementRef.current?.getBoundingClientRect()\n    dragStartPos.current = {\n      x: e.clientX - (rect?.left ?? 0),\n      y: e.clientY - (rect?.top ?? 0),\n    }\n    dragOffset.current = 0\n\n    // Set pointer capture on the actual element ref for reliable drag tracking\n    if (elementRef.current) {\n      elementRef.current.setPointerCapture(e.pointerId)\n    }\n  }, [dragEnabled, context, value, onDragStart])\n\n  // Handle pointer move\n  const handlePointerMove = useCallback((e: React.PointerEvent) => {\n    if (!isDragging) return\n\n    const rect = elementRef.current?.getBoundingClientRect()\n    if (!rect) return\n\n    const currentPos = context.axis === 'y' ? e.clientY : e.clientX\n    const startPos = context.axis === 'y'\n      ? (elementRef.current?.offsetTop ?? 0) + dragStartPos.current.y\n      : (elementRef.current?.offsetLeft ?? 0) + dragStartPos.current.x\n\n    dragOffset.current = currentPos - startPos - (context.axis === 'y' ? rect.height / 2 : rect.width / 2)\n    context.onDrag(value, dragOffset.current)\n\n    // Update visual position\n    setOffset(dragOffset.current)\n  }, [isDragging, context, value])\n\n  // Handle pointer up\n  const handlePointerUp = useCallback((e: React.PointerEvent) => {\n    if (!isDragging) return\n\n    // Release pointer capture on the element ref\n    if (elementRef.current) {\n      elementRef.current.releasePointerCapture(e.pointerId)\n    }\n\n    setIsDragging(false)\n    onDragEnd?.()\n    context.onDragEnd(value)\n\n    // Animate back to final position\n    setOffset(0)\n    dragOffset.current = 0\n  }, [isDragging, context, value, onDragEnd])\n\n  const transformProp = context.axis === 'y'\n    ? `translateY(${offset}px)`\n    : `translateX(${offset}px)`\n\n  // Handle keyboard navigation for accessibility\n  const handleKeyDown = useCallback((e: React.KeyboardEvent) => {\n    if (!dragEnabled) return\n\n    const currentIndex = context.values.indexOf(value)\n    if (currentIndex === -1) return\n\n    let newIndex = currentIndex\n    const isVertical = context.axis === 'y'\n\n    switch (e.key) {\n      case 'ArrowUp':\n        if (isVertical && currentIndex > 0) {\n          newIndex = currentIndex - 1\n          e.preventDefault()\n        }\n        break\n      case 'ArrowDown':\n        if (isVertical && currentIndex < context.values.length - 1) {\n          newIndex = currentIndex + 1\n          e.preventDefault()\n        }\n        break\n      case 'ArrowLeft':\n        if (!isVertical && currentIndex > 0) {\n          newIndex = currentIndex - 1\n          e.preventDefault()\n        }\n        break\n      case 'ArrowRight':\n        if (!isVertical && currentIndex < context.values.length - 1) {\n          newIndex = currentIndex + 1\n          e.preventDefault()\n        }\n        break\n      case 'Home':\n        newIndex = 0\n        e.preventDefault()\n        break\n      case 'End':\n        newIndex = context.values.length - 1\n        e.preventDefault()\n        break\n    }\n\n    // Move item if index changed\n    if (newIndex !== currentIndex) {\n      context.onDragStart(value)\n      const offset = (newIndex - currentIndex) * 50 // Approximate offset\n      context.onDrag(value, offset)\n      context.onDragEnd(value)\n    }\n  }, [dragEnabled, context, value])\n\n  return React.createElement(\n    Component as string,\n    {\n      ref: setRef,\n      className,\n      role: 'option',\n      'aria-selected': isDragging,\n      'aria-grabbed': isDragging,\n      tabIndex: dragEnabled ? 0 : -1,\n      style: {\n        transform: transformProp,\n        transition: !isDragging && context.layoutDuration > 0\n          ? `transform ${context.layoutDuration}ms ease-out`\n          : undefined,\n        cursor: dragEnabled ? (isDragging ? 'grabbing' : 'grab') : undefined,\n        userSelect: 'none',\n        touchAction: 'none',\n        zIndex: isDragging ? 1 : 0,\n        position: 'relative',\n        ...style,\n      },\n      onPointerDown: dragEnabled ? handlePointerDown : undefined,\n      onPointerMove: dragEnabled ? handlePointerMove : undefined,\n      onPointerUp: dragEnabled ? handlePointerUp : undefined,\n      onPointerCancel: dragEnabled ? handlePointerUp : undefined,\n      onKeyDown: dragEnabled ? handleKeyDown : undefined,\n    },\n    children\n  )\n}\n\n// ============ Export ============\n\nconst ReorderGroup = React.forwardRef(ReorderGroupComponent) as <T>(\n  props: ReorderGroupProps<T> & { ref?: React.Ref<HTMLElement> }\n) => React.ReactElement\n\nconst ReorderItem = React.forwardRef(ReorderItemComponent) as <T>(\n  props: ReorderItemProps<T> & { ref?: React.Ref<HTMLElement> }\n) => React.ReactElement\n\n/**\n * Drag-to-reorder components\n *\n * @example Basic usage\n * ```tsx\n * function ReorderableList() {\n *   const [items, setItems] = useState(['A', 'B', 'C', 'D'])\n *\n *   return (\n *     <Reorder.Group values={items} onReorder={setItems}>\n *       {items.map((item) => (\n *         <Reorder.Item key={item} value={item}>\n *           {item}\n *         </Reorder.Item>\n *       ))}\n *     </Reorder.Group>\n *   )\n * }\n * ```\n *\n * @example Horizontal reordering\n * ```tsx\n * <Reorder.Group\n *   axis=\"x\"\n *   values={tabs}\n *   onReorder={setTabs}\n *   style={{ display: 'flex' }}\n * >\n *   {tabs.map((tab) => (\n *     <Reorder.Item key={tab.id} value={tab}>\n *       {tab.title}\n *     </Reorder.Item>\n *   ))}\n * </Reorder.Group>\n * ```\n *\n * @example With custom styling\n * ```tsx\n * <Reorder.Group\n *   values={items}\n *   onReorder={setItems}\n *   config={{ stiffness: 400, damping: 25 }}\n * >\n *   {items.map((item) => (\n *     <Reorder.Item\n *       key={item.id}\n *       value={item}\n *       className=\"reorder-item\"\n *       onDragStart={() => console.log('Started dragging', item)}\n *       onDragEnd={() => console.log('Stopped dragging', item)}\n *     >\n *       <GripIcon />\n *       <span>{item.name}</span>\n *     </Reorder.Item>\n *   ))}\n * </Reorder.Group>\n * ```\n */\nexport const Reorder = {\n  Group: ReorderGroup,\n  Item: ReorderItem,\n}\n","/**\n * SpringText - Animated Text Components\n *\n * Unique SpringKit components for text animations.\n */\n\nimport React, { useRef, useEffect, useState, useMemo, memo } from 'react'\nimport { createSpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n// ============ SpringText ============\n\nexport interface SpringTextProps {\n  /** The text to display */\n  children: string\n  /** Animation mode */\n  mode?: 'characters' | 'words' | 'lines'\n  /** Stagger delay between elements (ms) */\n  stagger?: number\n  /** Animation direction */\n  from?: 'left' | 'right' | 'top' | 'bottom' | 'center'\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Initial opacity */\n  initialOpacity?: number\n  /** Initial offset (px) */\n  initialOffset?: number\n  /** Whether to animate on mount */\n  animateOnMount?: boolean\n  /** Trigger animation (change to replay) */\n  trigger?: unknown\n  /** Callback when animation completes */\n  onComplete?: () => void\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Animated text with staggered character/word/line animations\n *\n * @example Character animation\n * ```tsx\n * <SpringText mode=\"characters\" stagger={30}>\n *   Hello World\n * </SpringText>\n * ```\n *\n * @example Word animation from bottom\n * ```tsx\n * <SpringText\n *   mode=\"words\"\n *   from=\"bottom\"\n *   stagger={100}\n *   config={{ stiffness: 200, damping: 20 }}\n * >\n *   Welcome to SpringKit\n * </SpringText>\n * ```\n *\n * @example Trigger on state change\n * ```tsx\n * const [key, setKey] = useState(0)\n *\n * <SpringText trigger={key} mode=\"characters\">\n *   {message}\n * </SpringText>\n *\n * <button onClick={() => setKey(k => k + 1)}>Replay</button>\n * ```\n */\nexport const SpringText = memo(function SpringText({\n  children,\n  mode = 'characters',\n  stagger = 30,\n  from = 'bottom',\n  config = { stiffness: 200, damping: 20 },\n  initialOpacity = 0,\n  initialOffset = 20,\n  animateOnMount = true,\n  trigger,\n  onComplete,\n  className,\n  style,\n}: SpringTextProps) {\n  const [elements, setElements] = useState<string[]>([])\n  const [animatedValues, setAnimatedValues] = useState<number[]>([])\n  const springsRef = useRef<ReturnType<typeof createSpringValue>[]>([])\n  const completedRef = useRef(0)\n\n  // Split text based on mode\n  useEffect(() => {\n    let parts: string[]\n    switch (mode) {\n      case 'words':\n        parts = children.split(/(\\s+)/)\n        break\n      case 'lines':\n        parts = children.split('\\n')\n        break\n      case 'characters':\n      default:\n        parts = children.split('')\n    }\n    setElements(parts)\n    setAnimatedValues(new Array(parts.length).fill(0))\n  }, [children, mode])\n\n  // Create and run animations\n  useEffect(() => {\n    if (elements.length === 0) return\n\n    // Cleanup old springs\n    springsRef.current.forEach((s) => s.destroy())\n    springsRef.current = []\n    completedRef.current = 0\n\n    // Create new springs\n    const springs = elements.map((_, index) => {\n      const spring = createSpringValue(0, {\n        ...config,\n        onUpdate: (value) => {\n          setAnimatedValues((prev) => {\n            const next = [...prev]\n            next[index] = value\n            return next\n          })\n        },\n      })\n      return spring\n    })\n    springsRef.current = springs\n\n    // Animate with stagger\n    if (animateOnMount || trigger !== undefined) {\n      springs.forEach((spring, index) => {\n        setTimeout(() => {\n          spring.set(1)\n\n          // Check completion\n          const checkComplete = () => {\n            if (!spring.isAnimating()) {\n              completedRef.current++\n              if (completedRef.current === elements.length) {\n                onComplete?.()\n              }\n            } else {\n              requestAnimationFrame(checkComplete)\n            }\n          }\n          setTimeout(checkComplete, 50)\n        }, index * stagger)\n      })\n    }\n\n    return () => {\n      springs.forEach((s) => s.destroy())\n    }\n  }, [elements, stagger, config, animateOnMount, trigger, onComplete])\n\n  // Calculate transform based on direction\n  const getTransform = (progress: number) => {\n    const offset = (1 - progress) * initialOffset\n    switch (from) {\n      case 'left':\n        return `translateX(${-offset}px)`\n      case 'right':\n        return `translateX(${offset}px)`\n      case 'top':\n        return `translateY(${-offset}px)`\n      case 'bottom':\n        return `translateY(${offset}px)`\n      case 'center':\n        return `scale(${0.5 + progress * 0.5})`\n      default:\n        return `translateY(${offset}px)`\n    }\n  }\n\n  return (\n    <span className={className} style={style}>\n      {elements.map((element, index) => {\n        const progress = animatedValues[index] ?? 0\n        const opacity = initialOpacity + (1 - initialOpacity) * progress\n\n        // Preserve whitespace\n        if (element.match(/^\\s+$/)) {\n          return <span key={index}>{element}</span>\n        }\n\n        return (\n          <span\n            key={index}\n            style={{\n              display: 'inline-block',\n              opacity,\n              transform: getTransform(progress),\n              whiteSpace: mode === 'lines' ? 'pre' : undefined,\n            }}\n          >\n            {element}\n          </span>\n        )\n      })}\n    </span>\n  )\n})\n\n// ============ SpringNumber ============\n\nexport interface SpringNumberProps {\n  /** The number to display */\n  value: number\n  /** Number of decimal places */\n  decimals?: number\n  /** Format function */\n  format?: (value: number) => string\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Prefix (e.g., \"$\") */\n  prefix?: string\n  /** Suffix (e.g., \"%\") */\n  suffix?: string\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Animated number counter with spring physics\n *\n * @example Basic counter\n * ```tsx\n * <SpringNumber value={1000} />\n * ```\n *\n * @example Currency\n * ```tsx\n * <SpringNumber\n *   value={99.99}\n *   prefix=\"$\"\n *   decimals={2}\n * />\n * ```\n *\n * @example Percentage with format\n * ```tsx\n * <SpringNumber\n *   value={0.75}\n *   format={(v) => `${(v * 100).toFixed(1)}%`}\n * />\n * ```\n *\n * @example Custom config\n * ```tsx\n * <SpringNumber\n *   value={score}\n *   config={{ stiffness: 50, damping: 10 }}\n *   suffix=\" points\"\n * />\n * ```\n */\nexport const SpringNumber = memo(function SpringNumber({\n  value,\n  decimals = 0,\n  format,\n  config = { stiffness: 100, damping: 20 },\n  prefix = '',\n  suffix = '',\n  className,\n  style,\n}: SpringNumberProps) {\n  const [displayValue, setDisplayValue] = useState(value)\n  const springRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n  const lastValueRef = useRef(value)\n\n  // Initialize spring once\n  useEffect(() => {\n    springRef.current = createSpringValue(value, {\n      ...config,\n      onUpdate: setDisplayValue,\n    })\n    return () => {\n      springRef.current?.destroy()\n      springRef.current = null\n    }\n  // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []) // Only run on mount\n\n  // Update spring when value changes\n  useEffect(() => {\n    if (springRef.current && value !== lastValueRef.current) {\n      springRef.current.set(value)\n      lastValueRef.current = value\n    }\n  }, [value])\n\n  const formattedValue = useMemo(() => {\n    if (format) {\n      return format(displayValue)\n    }\n    return displayValue.toFixed(decimals)\n  }, [displayValue, decimals, format])\n\n  return (\n    <span className={className} style={style}>\n      {prefix}{formattedValue}{suffix}\n    </span>\n  )\n})\n\n// ============ TypeWriter ============\n\nexport interface TypeWriterProps {\n  /** Text to type */\n  children: string\n  /** Typing speed (ms per character) */\n  speed?: number\n  /** Delay before starting (ms) */\n  delay?: number\n  /** Show cursor */\n  cursor?: boolean\n  /** Cursor character */\n  cursorChar?: string\n  /** Loop the animation */\n  loop?: boolean\n  /** Pause at end before looping (ms) */\n  pauseAtEnd?: number\n  /** Delete speed when looping (ms) */\n  deleteSpeed?: number\n  /** Callback when typing completes */\n  onComplete?: () => void\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Typewriter effect with optional cursor and looping\n *\n * @example Basic typewriter\n * ```tsx\n * <TypeWriter speed={50}>\n *   Hello, I'm a typewriter effect!\n * </TypeWriter>\n * ```\n *\n * @example With cursor and loop\n * ```tsx\n * <TypeWriter\n *   speed={100}\n *   cursor\n *   cursorChar=\"|\"\n *   loop\n *   pauseAtEnd={2000}\n * >\n *   Welcome to SpringKit\n * </TypeWriter>\n * ```\n */\nexport const TypeWriter = memo(function TypeWriter({\n  children,\n  speed = 50,\n  delay = 0,\n  cursor = true,\n  cursorChar = '|',\n  loop = false,\n  pauseAtEnd = 1000,\n  deleteSpeed = 30,\n  onComplete,\n  className,\n  style,\n}: TypeWriterProps) {\n  const [displayText, setDisplayText] = useState('')\n  const [showCursor, setShowCursor] = useState(cursor)\n  // eslint-disable-next-line @typescript-eslint/no-unused-vars\n  const [_isDeleting, setIsDeleting] = useState(false)\n  const timeoutRef = useRef<number | null>(null)\n\n  useEffect(() => {\n    let currentIndex = 0\n    let isDeleteMode = false\n\n    const tick = () => {\n      if (!isDeleteMode) {\n        // Typing\n        if (currentIndex <= children.length) {\n          setDisplayText(children.slice(0, currentIndex))\n          currentIndex++\n          timeoutRef.current = window.setTimeout(tick, speed)\n        } else {\n          // Finished typing\n          onComplete?.()\n          if (loop) {\n            timeoutRef.current = window.setTimeout(() => {\n              isDeleteMode = true\n              setIsDeleting(true)\n              tick()\n            }, pauseAtEnd)\n          }\n        }\n      } else {\n        // Deleting\n        if (currentIndex > 0) {\n          currentIndex--\n          setDisplayText(children.slice(0, currentIndex))\n          timeoutRef.current = window.setTimeout(tick, deleteSpeed)\n        } else {\n          // Finished deleting, start over\n          isDeleteMode = false\n          setIsDeleting(false)\n          timeoutRef.current = window.setTimeout(tick, speed)\n        }\n      }\n    }\n\n    // Start after delay\n    timeoutRef.current = window.setTimeout(tick, delay)\n\n    return () => {\n      if (timeoutRef.current) clearTimeout(timeoutRef.current)\n    }\n  }, [children, speed, delay, loop, pauseAtEnd, deleteSpeed, onComplete])\n\n  // Cursor blinking\n  useEffect(() => {\n    if (!cursor) return\n\n    const blink = setInterval(() => {\n      setShowCursor((prev) => !prev)\n    }, 500)\n\n    return () => clearInterval(blink)\n  }, [cursor])\n\n  return (\n    <span className={className} style={style}>\n      {displayText}\n      {cursor && (\n        <span style={{ opacity: showCursor ? 1 : 0 }}>{cursorChar}</span>\n      )}\n    </span>\n  )\n})\n\n// ============ SplitText ============\n\nexport interface SplitTextProps {\n  /** Text to split */\n  children: string\n  /** Split mode */\n  mode?: 'characters' | 'words' | 'lines'\n  /** Render function for each element */\n  render: (element: string, index: number, total: number) => React.ReactNode\n  /** CSS class name for wrapper */\n  className?: string\n  /** Inline styles for wrapper */\n  style?: React.CSSProperties\n}\n\n/**\n * Split text into individual elements for custom animations\n *\n * @example Custom character animation\n * ```tsx\n * <SplitText mode=\"characters\">\n *   {(char, index, total) => (\n *     <motion.span\n *       initial={{ opacity: 0, y: 20 }}\n *       animate={{ opacity: 1, y: 0 }}\n *       transition={{ delay: index * 0.05 }}\n *     >\n *       {char}\n *     </motion.span>\n *   )}\n * </SplitText>\n * ```\n *\n * @example Word wave animation\n * ```tsx\n * const { scrollY } = useScroll()\n *\n * <SplitText mode=\"words\">\n *   {(word, index) => {\n *     const y = useTransform(scrollY, [0, 500], [0, index * 10])\n *     return <span style={{ y: y.get() }}>{word} </span>\n *   }}\n * </SplitText>\n * ```\n */\nexport const SplitText = memo(function SplitText({\n  children,\n  mode = 'characters',\n  render,\n  className,\n  style,\n}: SplitTextProps) {\n  const elements = useMemo(() => {\n    switch (mode) {\n      case 'words':\n        return children.split(/(\\s+)/)\n      case 'lines':\n        return children.split('\\n')\n      case 'characters':\n      default:\n        return children.split('')\n    }\n  }, [children, mode])\n\n  return (\n    <span className={className} style={style}>\n      {elements.map((element, index) => (\n        <React.Fragment key={index}>\n          {render(element, index, elements.length)}\n        </React.Fragment>\n      ))}\n    </span>\n  )\n})\n","/**\n * Magnetic - Magnetic Attraction Components\n *\n * Unique SpringKit components for magnetic cursor effects.\n */\n\nimport React, {\n  useRef,\n  useEffect,\n  useState,\n  useCallback,\n  memo,\n  forwardRef,\n} from 'react'\nimport { createSpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n// ============ Magnetic ============\n\nexport interface MagneticProps {\n  /** Children to render */\n  children: React.ReactNode\n  /** Magnetic attraction strength (0-1) */\n  strength?: number\n  /** Distance from center to start attracting (px) */\n  range?: number\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether the magnetic effect is enabled */\n  enabled?: boolean\n  /** Scale up when attracted */\n  scaleOnHover?: number\n  /** Maximum offset in pixels */\n  maxOffset?: number\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n  /** Callback when attraction starts */\n  onAttract?: () => void\n  /** Callback when attraction ends */\n  onRelease?: () => void\n}\n\n/**\n * Magnetic attraction to cursor\n *\n * Creates an element that is attracted to the cursor when nearby,\n * like a magnet. Great for buttons, links, and interactive elements.\n *\n * @example Basic usage\n * ```tsx\n * <Magnetic>\n *   <button>Hover me!</button>\n * </Magnetic>\n * ```\n *\n * @example Strong attraction with scale\n * ```tsx\n * <Magnetic\n *   strength={0.8}\n *   range={150}\n *   scaleOnHover={1.1}\n *   config={{ stiffness: 400, damping: 25 }}\n * >\n *   <div className=\"card\">Pull me!</div>\n * </Magnetic>\n * ```\n *\n * @example With callbacks\n * ```tsx\n * <Magnetic\n *   onAttract={() => console.log('Attracted!')}\n *   onRelease={() => console.log('Released!')}\n * >\n *   <span>Interactive element</span>\n * </Magnetic>\n * ```\n */\nexport const Magnetic = memo(forwardRef<HTMLDivElement, MagneticProps>(\n  function Magnetic(\n    {\n      children,\n      strength = 0.3,\n      range = 100,\n      config = { stiffness: 200, damping: 20 },\n      enabled = true,\n      scaleOnHover = 1,\n      maxOffset = 50,\n      className,\n      style,\n      onAttract,\n      onRelease,\n    },\n    ref\n  ) {\n    const innerRef = useRef<HTMLDivElement>(null)\n    const combinedRef = (node: HTMLDivElement | null) => {\n      innerRef.current = node\n      if (typeof ref === 'function') {\n        ref(node)\n      } else if (ref) {\n        ref.current = node\n      }\n    }\n\n    const springXRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springYRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springScaleRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n\n    const [transform, setTransform] = useState({ x: 0, y: 0, scale: 1 })\n    const isAttractedRef = useRef(false)\n\n    // Initialize springs\n    useEffect(() => {\n      springXRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (x) => setTransform((t) => ({ ...t, x })),\n      })\n      springYRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (y) => setTransform((t) => ({ ...t, y })),\n      })\n      springScaleRef.current = createSpringValue(1, {\n        ...config,\n        onUpdate: (scale) => setTransform((t) => ({ ...t, scale })),\n      })\n\n      return () => {\n        springXRef.current?.destroy()\n        springYRef.current?.destroy()\n        springScaleRef.current?.destroy()\n      }\n    }, [config])\n\n    // Store callbacks in refs to avoid recreating handlers\n    const onAttractRef = useRef(onAttract)\n    const onReleaseRef = useRef(onRelease)\n    onAttractRef.current = onAttract\n    onReleaseRef.current = onRelease\n\n    const handleMouseMove = useCallback(\n      (e: MouseEvent) => {\n        if (!enabled || !innerRef.current) return\n\n        const rect = innerRef.current.getBoundingClientRect()\n        const centerX = rect.left + rect.width / 2\n        const centerY = rect.top + rect.height / 2\n\n        const distanceX = e.clientX - centerX\n        const distanceY = e.clientY - centerY\n        const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY)\n\n        if (distance < range) {\n          // Within range - apply magnetic attraction\n          const factor = 1 - distance / range\n          let offsetX = distanceX * strength * factor\n          let offsetY = distanceY * strength * factor\n\n          // Clamp offset\n          offsetX = Math.max(-maxOffset, Math.min(maxOffset, offsetX))\n          offsetY = Math.max(-maxOffset, Math.min(maxOffset, offsetY))\n\n          springXRef.current?.set(offsetX)\n          springYRef.current?.set(offsetY)\n\n          if (scaleOnHover !== 1) {\n            const scaleFactor = 1 + (scaleOnHover - 1) * factor\n            springScaleRef.current?.set(scaleFactor)\n          }\n\n          if (!isAttractedRef.current) {\n            isAttractedRef.current = true\n            onAttractRef.current?.()\n          }\n        } else {\n          // Outside range - return to center\n          springXRef.current?.set(0)\n          springYRef.current?.set(0)\n          springScaleRef.current?.set(1)\n\n          if (isAttractedRef.current) {\n            isAttractedRef.current = false\n            onReleaseRef.current?.()\n          }\n        }\n      },\n      [enabled, range, strength, maxOffset, scaleOnHover]\n    )\n\n    const handleMouseLeave = useCallback(() => {\n      springXRef.current?.set(0)\n      springYRef.current?.set(0)\n      springScaleRef.current?.set(1)\n\n      if (isAttractedRef.current) {\n        isAttractedRef.current = false\n        onReleaseRef.current?.()\n      }\n    }, [])\n\n    useEffect(() => {\n      if (!enabled) return\n\n      window.addEventListener('mousemove', handleMouseMove, { passive: true })\n      window.addEventListener('mouseleave', handleMouseLeave, { passive: true })\n\n      return () => {\n        window.removeEventListener('mousemove', handleMouseMove)\n        window.removeEventListener('mouseleave', handleMouseLeave)\n      }\n    }, [enabled, handleMouseMove, handleMouseLeave])\n\n    return (\n      <div\n        ref={combinedRef}\n        className={className}\n        style={{\n          display: 'inline-block',\n          transform: `translate(${transform.x}px, ${transform.y}px) scale(${transform.scale})`,\n          willChange: 'transform',\n          ...style,\n        }}\n      >\n        {children}\n      </div>\n    )\n  }\n))\n\n// ============ MagneticGroup ============\n\nexport interface MagneticGroupProps {\n  /** Children (should be Magnetic components) */\n  children: React.ReactNode\n  /** Repel other magnetics when one is attracted */\n  repel?: boolean\n  /** Repulsion strength */\n  repelStrength?: number\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Group of magnetic elements that can interact with each other\n *\n * @example\n * ```tsx\n * <MagneticGroup repel>\n *   <Magnetic><button>A</button></Magnetic>\n *   <Magnetic><button>B</button></Magnetic>\n *   <Magnetic><button>C</button></Magnetic>\n * </MagneticGroup>\n * ```\n */\nexport const MagneticGroup = memo(function MagneticGroup({\n  children,\n  repel: _repel = false,\n  repelStrength: _repelStrength = 0.2,\n  className,\n  style,\n}: MagneticGroupProps) {\n  // For now, just a wrapper - repulsion can be added later\n  return (\n    <div className={className} style={style}>\n      {children}\n    </div>\n  )\n})\n\n// ============ MagneticCursor ============\n\nexport interface MagneticCursorProps {\n  /** Cursor content */\n  children?: React.ReactNode\n  /** Cursor size (px) */\n  size?: number\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Offset from actual cursor position */\n  offset?: { x: number; y: number }\n  /** Whether to show the cursor */\n  visible?: boolean\n  /** Z-index of the cursor */\n  zIndex?: number\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Custom cursor that follows the mouse with spring physics\n *\n * @example Basic custom cursor\n * ```tsx\n * <MagneticCursor size={20}>\n *   <div className=\"cursor-dot\" />\n * </MagneticCursor>\n * ```\n *\n * @example Smooth trailing cursor\n * ```tsx\n * <MagneticCursor\n *   size={40}\n *   config={{ stiffness: 100, damping: 20 }}\n * >\n *   <div className=\"cursor-ring\" />\n * </MagneticCursor>\n * ```\n */\nexport const MagneticCursor = memo(function MagneticCursor({\n  children,\n  size = 30,\n  config = { stiffness: 150, damping: 15 },\n  offset = { x: 0, y: 0 },\n  visible = true,\n  zIndex = 9999,\n  className,\n  style,\n}: MagneticCursorProps) {\n  const [position, setPosition] = useState({ x: 0, y: 0 })\n  const springXRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n  const springYRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n\n  useEffect(() => {\n    springXRef.current = createSpringValue(0, {\n      ...config,\n      onUpdate: (x) => setPosition((p) => ({ ...p, x })),\n    })\n    springYRef.current = createSpringValue(0, {\n      ...config,\n      onUpdate: (y) => setPosition((p) => ({ ...p, y })),\n    })\n\n    return () => {\n      springXRef.current?.destroy()\n      springYRef.current?.destroy()\n    }\n  }, [config])\n\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      springXRef.current?.set(e.clientX + offset.x)\n      springYRef.current?.set(e.clientY + offset.y)\n    }\n\n    window.addEventListener('mousemove', handleMouseMove, { passive: true })\n    return () => window.removeEventListener('mousemove', handleMouseMove)\n  }, [offset])\n\n  if (!visible) return null\n\n  return (\n    <div\n      className={className}\n      style={{\n        position: 'fixed',\n        left: position.x - size / 2,\n        top: position.y - size / 2,\n        width: size,\n        height: size,\n        pointerEvents: 'none',\n        zIndex,\n        ...style,\n      }}\n    >\n      {children ?? (\n        <div\n          style={{\n            width: '100%',\n            height: '100%',\n            borderRadius: '50%',\n            border: '2px solid currentColor',\n            opacity: 0.5,\n          }}\n        />\n      )}\n    </div>\n  )\n})\n\n// ============ useMagnetic Hook ============\n\nexport interface UseMagneticOptions {\n  /** Magnetic attraction strength (0-1) */\n  strength?: number\n  /** Distance from center to start attracting (px) */\n  range?: number\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether the magnetic effect is enabled */\n  enabled?: boolean\n  /** Maximum offset in pixels */\n  maxOffset?: number\n}\n\nexport interface UseMagneticReturn {\n  /** Ref to attach to the element */\n  ref: React.RefObject<HTMLElement>\n  /** Current X offset */\n  x: number\n  /** Current Y offset */\n  y: number\n  /** Whether currently attracted */\n  isAttracted: boolean\n  /** Reset to center position */\n  reset: () => void\n}\n\n/**\n * Hook for custom magnetic behavior\n *\n * @example\n * ```tsx\n * function CustomMagnetic() {\n *   const { ref, x, y, isAttracted } = useMagnetic({\n *     strength: 0.5,\n *     range: 100\n *   })\n *\n *   return (\n *     <button\n *       ref={ref}\n *       style={{\n *         transform: `translate(${x}px, ${y}px)`,\n *         background: isAttracted ? 'blue' : 'gray'\n *       }}\n *     >\n *       Magnetic Button\n *     </button>\n *   )\n * }\n * ```\n */\nexport function useMagnetic(options: UseMagneticOptions = {}): UseMagneticReturn {\n  const {\n    strength = 0.3,\n    range = 100,\n    config = { stiffness: 200, damping: 20 },\n    enabled = true,\n    maxOffset = 50,\n  } = options\n\n  const ref = useRef<HTMLElement>(null)\n  const springXRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n  const springYRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n  const [position, setPosition] = useState({ x: 0, y: 0 })\n  const isAttractedRef = useRef(false)\n  // Keep a state version for external consumers who need to react to changes\n  const [isAttracted, setIsAttracted] = useState(false)\n\n  useEffect(() => {\n    springXRef.current = createSpringValue(0, {\n      ...config,\n      onUpdate: (x) => setPosition((p) => ({ ...p, x })),\n    })\n    springYRef.current = createSpringValue(0, {\n      ...config,\n      onUpdate: (y) => setPosition((p) => ({ ...p, y })),\n    })\n\n    return () => {\n      springXRef.current?.destroy()\n      springYRef.current?.destroy()\n    }\n  }, [config])\n\n  useEffect(() => {\n    if (!enabled) return\n\n    const handleMouseMove = (e: MouseEvent) => {\n      if (!ref.current) return\n\n      const rect = ref.current.getBoundingClientRect()\n      const centerX = rect.left + rect.width / 2\n      const centerY = rect.top + rect.height / 2\n\n      const distanceX = e.clientX - centerX\n      const distanceY = e.clientY - centerY\n      const distance = Math.sqrt(distanceX * distanceX + distanceY * distanceY)\n\n      if (distance < range) {\n        const factor = 1 - distance / range\n        let offsetX = distanceX * strength * factor\n        let offsetY = distanceY * strength * factor\n\n        offsetX = Math.max(-maxOffset, Math.min(maxOffset, offsetX))\n        offsetY = Math.max(-maxOffset, Math.min(maxOffset, offsetY))\n\n        springXRef.current?.set(offsetX)\n        springYRef.current?.set(offsetY)\n\n        if (!isAttractedRef.current) {\n          isAttractedRef.current = true\n          setIsAttracted(true)\n        }\n      } else {\n        springXRef.current?.set(0)\n        springYRef.current?.set(0)\n\n        if (isAttractedRef.current) {\n          isAttractedRef.current = false\n          setIsAttracted(false)\n        }\n      }\n    }\n\n    const handleMouseLeave = () => {\n      springXRef.current?.set(0)\n      springYRef.current?.set(0)\n\n      if (isAttractedRef.current) {\n        isAttractedRef.current = false\n        setIsAttracted(false)\n      }\n    }\n\n    window.addEventListener('mousemove', handleMouseMove, { passive: true })\n    window.addEventListener('mouseleave', handleMouseLeave, { passive: true })\n\n    return () => {\n      window.removeEventListener('mousemove', handleMouseMove)\n      window.removeEventListener('mouseleave', handleMouseLeave)\n    }\n  }, [enabled, range, strength, maxOffset])\n\n  const reset = useCallback(() => {\n    springXRef.current?.set(0)\n    springYRef.current?.set(0)\n    isAttractedRef.current = false\n    setIsAttracted(false)\n  }, [])\n\n  return {\n    ref: ref as React.RefObject<HTMLElement>,\n    x: position.x,\n    y: position.y,\n    isAttracted,\n    reset,\n  }\n}\n","/**\n * Parallax - Scroll & Mouse Parallax Components\n *\n * Unique SpringKit components for parallax effects with spring physics.\n */\n\nimport React, {\n  useRef,\n  useEffect,\n  useState,\n  useCallback,\n  useMemo,\n  memo,\n  forwardRef,\n  createContext,\n  useContext,\n} from 'react'\nimport { createSpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n// ============ Parallax (Scroll-based) ============\n\nexport interface ParallaxProps {\n  /** Children to render */\n  children: React.ReactNode\n  /** Parallax speed multiplier (-1 to 1, 0 = no effect, negative = opposite direction) */\n  speed?: number\n  /** Parallax direction */\n  direction?: 'vertical' | 'horizontal' | 'both'\n  /** Spring configuration for smooth scrolling */\n  config?: SpringConfig\n  /** Whether the parallax effect is enabled */\n  enabled?: boolean\n  /** Offset from center (px) */\n  offset?: { x?: number; y?: number }\n  /** Root margin for intersection observer */\n  rootMargin?: string\n  /** Element type to render */\n  as?: keyof React.JSX.IntrinsicElements\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Scroll-based parallax component with spring physics\n *\n * Creates smooth parallax effects that respond to scroll position.\n *\n * @example Basic vertical parallax\n * ```tsx\n * <Parallax speed={0.5}>\n *   <img src=\"background.jpg\" alt=\"Background\" />\n * </Parallax>\n * ```\n *\n * @example Slow background, fast foreground\n * ```tsx\n * <div className=\"scene\">\n *   <Parallax speed={-0.2}>\n *     <div className=\"background\" />\n *   </Parallax>\n *   <Parallax speed={0.3}>\n *     <div className=\"foreground\" />\n *   </Parallax>\n * </div>\n * ```\n *\n * @example Horizontal parallax\n * ```tsx\n * <Parallax speed={0.5} direction=\"horizontal\">\n *   <div className=\"sliding-element\" />\n * </Parallax>\n * ```\n */\nexport const Parallax = memo(forwardRef<HTMLDivElement, ParallaxProps>(\n  function Parallax(\n    {\n      children,\n      speed = 0.5,\n      direction = 'vertical',\n      config = { stiffness: 100, damping: 20 },\n      enabled = true,\n      offset = {},\n      rootMargin = '100px',\n      as: Component = 'div',\n      className,\n      style,\n    },\n    ref\n  ) {\n    const innerRef = useRef<HTMLDivElement>(null)\n    const combinedRef = (node: HTMLDivElement | null) => {\n      innerRef.current = node\n      if (typeof ref === 'function') {\n        ref(node)\n      } else if (ref) {\n        ref.current = node\n      }\n    }\n\n    const springXRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springYRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const [transform, setTransform] = useState({ x: offset.x ?? 0, y: offset.y ?? 0 })\n    const [isInView, setIsInView] = useState(false)\n\n    // Initialize springs\n    useEffect(() => {\n      springXRef.current = createSpringValue(offset.x ?? 0, {\n        ...config,\n        onUpdate: (x) => setTransform((t) => ({ ...t, x })),\n      })\n      springYRef.current = createSpringValue(offset.y ?? 0, {\n        ...config,\n        onUpdate: (y) => setTransform((t) => ({ ...t, y })),\n      })\n\n      return () => {\n        springXRef.current?.destroy()\n        springYRef.current?.destroy()\n      }\n    }, [config, offset.x, offset.y])\n\n    // Intersection observer\n    useEffect(() => {\n      if (!innerRef.current) return\n\n      const observer = new IntersectionObserver(\n        ([entry]) => {\n          setIsInView(entry?.isIntersecting ?? false)\n        },\n        { rootMargin }\n      )\n\n      observer.observe(innerRef.current)\n      return () => observer.disconnect()\n    }, [rootMargin])\n\n    // Scroll handler\n    useEffect(() => {\n      if (!enabled || !isInView) return\n\n      const handleScroll = () => {\n        if (!innerRef.current) return\n\n        const rect = innerRef.current.getBoundingClientRect()\n        const windowHeight = window.innerHeight\n        const windowWidth = window.innerWidth\n\n        // Calculate position relative to viewport center\n        const centerY = (rect.top + rect.height / 2 - windowHeight / 2) / windowHeight\n        const centerX = (rect.left + rect.width / 2 - windowWidth / 2) / windowWidth\n\n        if (direction === 'vertical' || direction === 'both') {\n          const yOffset = centerY * speed * 200 + (offset.y ?? 0)\n          springYRef.current?.set(yOffset)\n        }\n\n        if (direction === 'horizontal' || direction === 'both') {\n          const xOffset = centerX * speed * 200 + (offset.x ?? 0)\n          springXRef.current?.set(xOffset)\n        }\n      }\n\n      handleScroll() // Initial calculation\n      window.addEventListener('scroll', handleScroll, { passive: true })\n      window.addEventListener('resize', handleScroll, { passive: true })\n\n      return () => {\n        window.removeEventListener('scroll', handleScroll)\n        window.removeEventListener('resize', handleScroll)\n      }\n    }, [enabled, isInView, speed, direction, offset])\n\n    const transformStyle = useMemo(() => {\n      const parts: string[] = []\n      if (direction === 'vertical' || direction === 'both') {\n        parts.push(`translateY(${transform.y}px)`)\n      }\n      if (direction === 'horizontal' || direction === 'both') {\n        parts.push(`translateX(${transform.x}px)`)\n      }\n      return parts.join(' ') || 'none'\n    }, [direction, transform])\n\n    return React.createElement(\n      Component as string,\n      {\n        ref: combinedRef,\n        className,\n        style: {\n          transform: transformStyle,\n          willChange: 'transform',\n          ...style,\n        },\n      },\n      children\n    )\n  }\n))\n\n// ============ MouseParallax ============\n\nexport interface MouseParallaxProps {\n  /** Children to render */\n  children: React.ReactNode\n  /** Parallax strength (higher = more movement) */\n  strength?: number\n  /** Invert the effect */\n  inverted?: boolean\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether the parallax effect is enabled */\n  enabled?: boolean\n  /** Container to track mouse within (defaults to window) */\n  container?: React.RefObject<HTMLElement>\n  /** Reset position when mouse leaves */\n  resetOnLeave?: boolean\n  /** Element type to render */\n  as?: keyof React.JSX.IntrinsicElements\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Mouse-based parallax component\n *\n * Creates parallax effects that respond to mouse position.\n *\n * @example Basic mouse parallax\n * ```tsx\n * <MouseParallax strength={20}>\n *   <div className=\"floating-element\" />\n * </MouseParallax>\n * ```\n *\n * @example Layered parallax scene\n * ```tsx\n * <div className=\"scene\">\n *   <MouseParallax strength={10}>\n *     <div className=\"layer-back\" />\n *   </MouseParallax>\n *   <MouseParallax strength={30}>\n *     <div className=\"layer-front\" />\n *   </MouseParallax>\n * </div>\n * ```\n *\n * @example Inverted (opposite direction)\n * ```tsx\n * <MouseParallax strength={20} inverted>\n *   <div className=\"background\" />\n * </MouseParallax>\n * ```\n */\nexport const MouseParallax = memo(forwardRef<HTMLDivElement, MouseParallaxProps>(\n  function MouseParallax(\n    {\n      children,\n      strength = 20,\n      inverted = false,\n      config = { stiffness: 100, damping: 15 },\n      enabled = true,\n      container,\n      resetOnLeave = true,\n      as: Component = 'div',\n      className,\n      style,\n    },\n    ref\n  ) {\n    const springXRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springYRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const [transform, setTransform] = useState({ x: 0, y: 0 })\n\n    // Initialize springs\n    useEffect(() => {\n      springXRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (x) => setTransform((t) => ({ ...t, x })),\n      })\n      springYRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (y) => setTransform((t) => ({ ...t, y })),\n      })\n\n      return () => {\n        springXRef.current?.destroy()\n        springYRef.current?.destroy()\n      }\n    }, [config])\n\n    // Mouse handler\n    useEffect(() => {\n      if (!enabled) return\n\n      // Capture target at mount time to ensure cleanup uses same target\n      const target = container?.current ?? null\n      const useWindow = target === null\n\n      const handleMouseMove = (e: MouseEvent) => {\n        let centerX: number\n        let centerY: number\n        let width: number\n        let height: number\n\n        if (target) {\n          const rect = target.getBoundingClientRect()\n          centerX = e.clientX - rect.left - rect.width / 2\n          centerY = e.clientY - rect.top - rect.height / 2\n          width = rect.width\n          height = rect.height\n        } else {\n          centerX = e.clientX - window.innerWidth / 2\n          centerY = e.clientY - window.innerHeight / 2\n          width = window.innerWidth\n          height = window.innerHeight\n        }\n\n        // Normalize to -1 to 1 range\n        const normalizedX = (centerX / width) * 2\n        const normalizedY = (centerY / height) * 2\n\n        const factor = inverted ? -1 : 1\n        const offsetX = normalizedX * strength * factor\n        const offsetY = normalizedY * strength * factor\n\n        springXRef.current?.set(offsetX)\n        springYRef.current?.set(offsetY)\n      }\n\n      const handleMouseLeave = () => {\n        if (resetOnLeave) {\n          springXRef.current?.set(0)\n          springYRef.current?.set(0)\n        }\n      }\n\n      if (useWindow) {\n        window.addEventListener('mousemove', handleMouseMove, { passive: true })\n        window.addEventListener('mouseleave', handleMouseLeave, { passive: true })\n      } else {\n        target.addEventListener('mousemove', handleMouseMove, { passive: true })\n        target.addEventListener('mouseleave', handleMouseLeave, { passive: true })\n      }\n\n      return () => {\n        if (useWindow) {\n          window.removeEventListener('mousemove', handleMouseMove)\n          window.removeEventListener('mouseleave', handleMouseLeave)\n        } else {\n          target.removeEventListener('mousemove', handleMouseMove)\n          target.removeEventListener('mouseleave', handleMouseLeave)\n        }\n      }\n    }, [enabled, container, strength, inverted, resetOnLeave])\n\n    return React.createElement(\n      Component as string,\n      {\n        ref,\n        className,\n        style: {\n          transform: `translate(${transform.x}px, ${transform.y}px)`,\n          willChange: 'transform',\n          ...style,\n        },\n      },\n      children\n    )\n  }\n))\n\n// ============ TiltCard ============\n\nexport interface TiltCardProps {\n  /** Children to render */\n  children: React.ReactNode\n  /** Maximum tilt angle (degrees) */\n  maxTilt?: number\n  /** Perspective (px) */\n  perspective?: number\n  /** Scale on hover */\n  scale?: number\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether the tilt effect is enabled */\n  enabled?: boolean\n  /** Glare effect */\n  glare?: boolean\n  /** Maximum glare opacity */\n  glareOpacity?: number\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n  /** Callback when tilt changes */\n  onTilt?: (tiltX: number, tiltY: number) => void\n}\n\n/**\n * 3D tilt card component\n *\n * Creates a card that tilts based on mouse position.\n *\n * @example Basic tilt card\n * ```tsx\n * <TiltCard>\n *   <div className=\"card\">\n *     <h2>Hover me!</h2>\n *   </div>\n * </TiltCard>\n * ```\n *\n * @example With glare effect\n * ```tsx\n * <TiltCard maxTilt={15} scale={1.05} glare>\n *   <div className=\"premium-card\">\n *     Premium Content\n *   </div>\n * </TiltCard>\n * ```\n */\nexport const TiltCard = memo(forwardRef<HTMLDivElement, TiltCardProps>(\n  function TiltCard(\n    {\n      children,\n      maxTilt = 20,\n      perspective = 1000,\n      scale = 1,\n      config = { stiffness: 300, damping: 20 },\n      enabled = true,\n      glare = false,\n      glareOpacity = 0.2,\n      className,\n      style,\n      onTilt,\n    },\n    ref\n  ) {\n    const innerRef = useRef<HTMLDivElement>(null)\n    const combinedRef = (node: HTMLDivElement | null) => {\n      innerRef.current = node\n      if (typeof ref === 'function') {\n        ref(node)\n      } else if (ref) {\n        ref.current = node\n      }\n    }\n\n    const springTiltXRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springTiltYRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springScaleRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n    const springGlareRef = useRef<ReturnType<typeof createSpringValue> | null>(null)\n\n    const [tilt, setTilt] = useState({ x: 0, y: 0, scale: 1, glareX: 50, glareY: 50, glareOpacity: 0 })\n\n    // Initialize springs\n    useEffect(() => {\n      springTiltXRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (x) => setTilt((t) => ({ ...t, x })),\n      })\n      springTiltYRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (y) => setTilt((t) => ({ ...t, y })),\n      })\n      springScaleRef.current = createSpringValue(1, {\n        ...config,\n        onUpdate: (s) => setTilt((t) => ({ ...t, scale: s })),\n      })\n      springGlareRef.current = createSpringValue(0, {\n        ...config,\n        onUpdate: (o) => setTilt((t) => ({ ...t, glareOpacity: o })),\n      })\n\n      return () => {\n        springTiltXRef.current?.destroy()\n        springTiltYRef.current?.destroy()\n        springScaleRef.current?.destroy()\n        springGlareRef.current?.destroy()\n      }\n    }, [config])\n\n    const handleMouseMove = useCallback(\n      (e: React.MouseEvent) => {\n        if (!enabled || !innerRef.current) return\n\n        const rect = innerRef.current.getBoundingClientRect()\n        const centerX = (e.clientX - rect.left) / rect.width - 0.5\n        const centerY = (e.clientY - rect.top) / rect.height - 0.5\n\n        const tiltX = centerY * maxTilt * -1 // Invert for natural feel\n        const tiltY = centerX * maxTilt\n\n        springTiltXRef.current?.set(tiltX)\n        springTiltYRef.current?.set(tiltY)\n        springScaleRef.current?.set(scale)\n\n        if (glare) {\n          springGlareRef.current?.set(glareOpacity)\n          setTilt((t) => ({\n            ...t,\n            glareX: (centerX + 0.5) * 100,\n            glareY: (centerY + 0.5) * 100,\n          }))\n        }\n\n        onTilt?.(tiltX, tiltY)\n      },\n      [enabled, maxTilt, scale, glare, glareOpacity, onTilt]\n    )\n\n    const handleMouseLeave = useCallback(() => {\n      springTiltXRef.current?.set(0)\n      springTiltYRef.current?.set(0)\n      springScaleRef.current?.set(1)\n      springGlareRef.current?.set(0)\n    }, [])\n\n    return (\n      <div\n        ref={combinedRef}\n        className={className}\n        style={{\n          perspective: `${perspective}px`,\n          ...style,\n        }}\n        onMouseMove={handleMouseMove}\n        onMouseLeave={handleMouseLeave}\n      >\n        <div\n          style={{\n            transform: `rotateX(${tilt.x}deg) rotateY(${tilt.y}deg) scale(${tilt.scale})`,\n            transformStyle: 'preserve-3d',\n            width: '100%',\n            height: '100%',\n          }}\n        >\n          {children}\n          {glare && (\n            <div\n              style={{\n                position: 'absolute',\n                inset: 0,\n                pointerEvents: 'none',\n                background: `radial-gradient(circle at ${tilt.glareX}% ${tilt.glareY}%, white, transparent)`,\n                opacity: tilt.glareOpacity,\n                borderRadius: 'inherit',\n              }}\n            />\n          )}\n        </div>\n      </div>\n    )\n  }\n))\n\n// ============ ParallaxContainer ============\n\ninterface ParallaxContextValue {\n  scrollProgress: number\n  containerRef: React.RefObject<HTMLElement>\n}\n\nconst ParallaxContext = createContext<ParallaxContextValue | null>(null)\n\nexport interface ParallaxContainerProps {\n  /** Children to render */\n  children: React.ReactNode\n  /** Height multiplier for scroll (1 = viewport height) */\n  pages?: number\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Container for managing multiple parallax layers\n *\n * @example\n * ```tsx\n * <ParallaxContainer pages={3}>\n *   <ParallaxLayer offset={0} speed={0.5}>\n *     <div>Layer 1</div>\n *   </ParallaxLayer>\n *   <ParallaxLayer offset={1} speed={1}>\n *     <div>Layer 2</div>\n *   </ParallaxLayer>\n * </ParallaxContainer>\n * ```\n */\nexport const ParallaxContainer = memo(function ParallaxContainer({\n  children,\n  pages = 1,\n  className,\n  style,\n}: ParallaxContainerProps) {\n  const containerRef = useRef<HTMLDivElement>(null)\n  const [scrollProgress, setScrollProgress] = useState(0)\n\n  useEffect(() => {\n    const container = containerRef.current\n    if (!container) return\n\n    const handleScroll = () => {\n      const scrollTop = container.scrollTop\n      const maxScroll = container.scrollHeight - container.clientHeight\n      setScrollProgress(maxScroll > 0 ? scrollTop / maxScroll : 0)\n    }\n\n    container.addEventListener('scroll', handleScroll, { passive: true })\n    return () => container.removeEventListener('scroll', handleScroll)\n  }, [])\n\n  const contextValue = useMemo(\n    () => ({ scrollProgress, containerRef: containerRef as React.RefObject<HTMLElement> }),\n    [scrollProgress]\n  )\n\n  return (\n    <ParallaxContext.Provider value={contextValue}>\n      <div\n        ref={containerRef}\n        className={className}\n        style={{\n          height: '100vh',\n          overflow: 'auto',\n          position: 'relative',\n          ...style,\n        }}\n      >\n        <div style={{ height: `${pages * 100}vh`, position: 'relative' }}>\n          {children}\n        </div>\n      </div>\n    </ParallaxContext.Provider>\n  )\n})\n\nexport interface ParallaxLayerProps {\n  /** Children to render */\n  children: React.ReactNode\n  /** Page offset (0 = start, 1 = second page, etc.) */\n  offset?: number\n  /** Speed factor (0 = fixed, 1 = normal scroll, 2 = 2x scroll) */\n  speed?: number\n  /** Horizontal offset */\n  horizontal?: boolean\n  /** Sticky positioning within offset range */\n  sticky?: { start: number; end: number }\n  /** CSS class name */\n  className?: string\n  /** Inline styles */\n  style?: React.CSSProperties\n}\n\n/**\n * Layer within a ParallaxContainer\n */\nexport const ParallaxLayer = memo(function ParallaxLayer({\n  children,\n  offset = 0,\n  speed = 1,\n  horizontal = false,\n  sticky,\n  className,\n  style,\n}: ParallaxLayerProps) {\n  const context = useContext(ParallaxContext)\n  const [transform, setTransform] = useState({ x: 0, y: 0 })\n\n  useEffect(() => {\n    if (!context) return\n\n    const progress = context.scrollProgress\n    const pageHeight = 100 // vh\n\n    if (sticky) {\n      // Sticky positioning\n      const stickyRange = sticky.end - sticky.start\n      if (progress >= sticky.start && progress <= sticky.end) {\n        // stickyProgress is calculated but not used yet (reserved for sticky animations)\n        // eslint-disable-next-line @typescript-eslint/no-unused-vars\n        const _stickyProgress = (progress - sticky.start) / stickyRange\n        setTransform({\n          x: 0,\n          y: sticky.start * pageHeight,\n        })\n      } else if (progress < sticky.start) {\n        setTransform({ x: 0, y: offset * pageHeight })\n      } else {\n        setTransform({ x: 0, y: sticky.end * pageHeight })\n      }\n    } else {\n      // Normal parallax\n      const base = offset * pageHeight\n      const parallaxOffset = progress * pageHeight * (1 - speed)\n      if (horizontal) {\n        setTransform({ x: parallaxOffset, y: base })\n      } else {\n        setTransform({ x: 0, y: base + parallaxOffset })\n      }\n    }\n  }, [context?.scrollProgress, offset, speed, horizontal, sticky]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  return (\n    <div\n      className={className}\n      style={{\n        position: 'absolute',\n        top: 0,\n        left: 0,\n        width: '100%',\n        height: '100vh',\n        transform: `translate(${transform.x}vh, ${transform.y}vh)`,\n        willChange: 'transform',\n        ...style,\n      }}\n    >\n      {children}\n    </div>\n  )\n})\n\nexport function useParallaxContext() {\n  return useContext(ParallaxContext)\n}\n","import React, { createContext, useContext, useState, useEffect, useMemo } from 'react'\n\n// ============ Feature Definitions ============\n\n/**\n * Available feature sets for LazyMotion\n */\nexport interface MotionFeatures {\n  /** Basic animation features (animate, initial, exit) */\n  animations: boolean\n  /** Gesture features (whileHover, whileTap, drag) */\n  gestures: boolean\n  /** Layout animation features (layout, layoutId) */\n  layout: boolean\n  /** SVG animation features (path morphing, pathLength) */\n  svg: boolean\n  /** Scroll-linked animation features */\n  scroll: boolean\n}\n\nexport type FeatureBundle = Partial<MotionFeatures>\n\n/**\n * Pre-defined feature bundles\n */\nexport const domAnimation: FeatureBundle = {\n  animations: true,\n  gestures: true,\n}\n\nexport const domMax: FeatureBundle = {\n  animations: true,\n  gestures: true,\n  layout: true,\n  svg: true,\n  scroll: true,\n}\n\nexport const domMin: FeatureBundle = {\n  animations: true,\n}\n\n// ============ Context ============\n\ninterface LazyMotionContextValue {\n  features: FeatureBundle\n  isStrict: boolean\n  isLoaded: boolean\n}\n\nconst LazyMotionContext = createContext<LazyMotionContextValue>({\n  features: domMax,\n  isStrict: false,\n  isLoaded: true,\n})\n\n/**\n * Hook to access lazy motion features\n */\nexport function useLazyMotion(): LazyMotionContextValue {\n  return useContext(LazyMotionContext)\n}\n\n/**\n * Hook to check if a specific feature is available\n */\nexport function useMotionFeature(feature: keyof MotionFeatures): boolean {\n  const { features, isLoaded } = useLazyMotion()\n  return isLoaded && (features[feature] ?? false)\n}\n\n// ============ LazyMotion Component ============\n\nexport interface LazyMotionProps {\n  /**\n   * Feature bundle to load\n   *\n   * Can be:\n   * - An object with feature flags\n   * - A function that returns a promise (for async loading)\n   * - A pre-defined bundle (domAnimation, domMax, domMin)\n   */\n  features: FeatureBundle | (() => Promise<FeatureBundle>)\n\n  /**\n   * Whether to enforce that child motion components use the `m` component\n   * instead of `motion` for smaller bundle size.\n   *\n   * When true, using `motion.div` inside LazyMotion will throw an error.\n   */\n  strict?: boolean\n\n  /**\n   * Children to render\n   */\n  children: React.ReactNode\n}\n\n/**\n * LazyMotion - Optimize bundle size by lazy-loading motion features\n *\n * Wrap your app or a section of your app with LazyMotion to control\n * which animation features are loaded. This can significantly reduce\n * bundle size for simple use cases.\n *\n * @example Basic usage with domAnimation\n * ```tsx\n * import { LazyMotion, domAnimation, m } from '@oxog/springkit/react'\n *\n * function App() {\n *   return (\n *     <LazyMotion features={domAnimation}>\n *       <m.div animate={{ opacity: 1 }} />\n *     </LazyMotion>\n *   )\n * }\n * ```\n *\n * @example Async feature loading\n * ```tsx\n * import { LazyMotion, m } from '@oxog/springkit/react'\n *\n * const loadFeatures = () =>\n *   import('./features').then((mod) => mod.domMax)\n *\n * function App() {\n *   return (\n *     <LazyMotion features={loadFeatures}>\n *       <m.div animate={{ opacity: 1 }} />\n *     </LazyMotion>\n *   )\n * }\n * ```\n *\n * @example Strict mode (enforces m component usage)\n * ```tsx\n * <LazyMotion features={domAnimation} strict>\n *   <m.div /> {/* OK *\\/}\n *   <motion.div /> {/* Error in dev! *\\/}\n * </LazyMotion>\n * ```\n *\n * @example Custom feature set\n * ```tsx\n * <LazyMotion features={{\n *   animations: true,\n *   gestures: true,\n *   layout: false, // Skip layout animations to save bundle size\n * }}>\n *   <m.div whileHover={{ scale: 1.1 }} />\n * </LazyMotion>\n * ```\n */\nexport function LazyMotion({\n  features,\n  strict = false,\n  children,\n}: LazyMotionProps): React.ReactElement {\n  const [loadedFeatures, setLoadedFeatures] = useState<FeatureBundle | null>(\n    typeof features === 'function' ? null : features\n  )\n  const [isLoaded, setIsLoaded] = useState(typeof features !== 'function')\n\n  // Load async features\n  useEffect(() => {\n    if (typeof features === 'function') {\n      features().then((loaded) => {\n        setLoadedFeatures(loaded)\n        setIsLoaded(true)\n      })\n    } else {\n      setLoadedFeatures(features)\n      setIsLoaded(true)\n    }\n  }, [features])\n\n  const contextValue = useMemo<LazyMotionContextValue>(() => ({\n    features: loadedFeatures ?? {},\n    isStrict: strict,\n    isLoaded,\n  }), [loadedFeatures, strict, isLoaded])\n\n  // Show nothing or a fallback while loading\n  if (!isLoaded) {\n    return React.createElement(React.Fragment, null, null)\n  }\n\n  return React.createElement(\n    LazyMotionContext.Provider,\n    { value: contextValue },\n    children\n  )\n}\n\n// ============ MotionFeatureGuard ============\n\ninterface MotionFeatureGuardProps {\n  feature: keyof MotionFeatures\n  children: React.ReactNode\n  fallback?: React.ReactNode\n}\n\n/**\n * Conditionally render content based on feature availability\n *\n * @example\n * ```tsx\n * <LazyMotion features={domAnimation}>\n *   <MotionFeatureGuard feature=\"layout\" fallback={<StaticLayout />}>\n *     <AnimatedLayout />\n *   </MotionFeatureGuard>\n * </LazyMotion>\n * ```\n */\nexport function MotionFeatureGuard({\n  feature,\n  children,\n  fallback = null,\n}: MotionFeatureGuardProps): React.ReactElement {\n  const isAvailable = useMotionFeature(feature)\n\n  return React.createElement(\n    React.Fragment,\n    null,\n    isAvailable ? children : fallback\n  )\n}\n\n// ============ Feature Loading Utilities ============\n\n/**\n * Create an async feature loader\n *\n * @example\n * ```tsx\n * const loadFeatures = createAsyncFeatures({\n *   animations: true,\n *   gestures: true,\n *   layout: () => import('./layout-features'),\n * })\n *\n * <LazyMotion features={loadFeatures}>\n *   ...\n * </LazyMotion>\n * ```\n */\nexport function createAsyncFeatures(\n  config: {\n    [K in keyof MotionFeatures]?: boolean | (() => Promise<unknown>)\n  }\n): () => Promise<FeatureBundle> {\n  return async () => {\n    const result: FeatureBundle = {}\n\n    await Promise.all(\n      Object.entries(config).map(async ([key, value]) => {\n        const featureKey = key as keyof MotionFeatures\n        if (typeof value === 'function') {\n          await value()\n          result[featureKey] = true\n        } else {\n          result[featureKey] = value\n        }\n      })\n    )\n\n    return result\n  }\n}\n\n/**\n * Merge multiple feature bundles\n */\nexport function mergeFeatures(...bundles: FeatureBundle[]): FeatureBundle {\n  return bundles.reduce((acc, bundle) => ({\n    ...acc,\n    ...bundle,\n  }), {})\n}\n"]}