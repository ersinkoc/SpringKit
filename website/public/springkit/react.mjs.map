{"version":3,"sources":["../../src/core/config.ts","../../src/core/physics.ts","../../src/animation/loop.ts","../../src/utils/math.ts","../../src/utils/warnings.ts","../../src/core/spring.ts","../../src/core/spring-value.ts","../../src/core/spring-group.ts","../../src/core/variants.ts","../../src/animation/trail.ts","../../src/gesture/drag.ts","../../src/utils/color.ts","../../src/scroll/scroll-linked.ts","../../src/animation/timeline.ts","../../src/svg/morph.ts","../../src/layout/shared.ts","../../src/core/MotionValue.ts","../../src/layout/flip.ts","../../src/adapters/react/hooks/useSpring.ts","../../src/adapters/react/hooks/useSpringValue.ts","../../src/adapters/react/hooks/useSprings.ts","../../src/adapters/react/hooks/useTrail.ts","../../src/adapters/react/hooks/useDrag.ts","../../src/adapters/react/hooks/useGesture.ts","../../src/adapters/react/context/PresenceContext.ts","../../src/adapters/react/hooks/usePresence.ts","../../src/adapters/react/hooks/useAnimate.ts","../../src/adapters/react/hooks/useMotionValue.ts","../../src/adapters/react/hooks/useTransform.ts","../../src/adapters/react/utils/ssr.ts","../../src/adapters/react/hooks/useInView.ts","../../src/adapters/react/hooks/useScroll.ts","../../src/adapters/react/hooks/useGestureState.ts","../../src/adapters/react/hooks/useReducedMotion.ts","../../src/adapters/react/hooks/useScrollLinked.ts","../../src/adapters/react/hooks/useTimeline.ts","../../src/adapters/react/hooks/useMorph.ts","../../src/adapters/react/hooks/useLayoutAnimation.ts","../../src/adapters/react/hooks/useVariants.ts","../../src/adapters/react/components/Spring.tsx","../../src/adapters/react/components/Animated.tsx","../../src/adapters/react/components/Trail.tsx","../../src/adapters/react/components/PresenceChild.tsx","../../src/adapters/react/components/AnimatePresence.tsx","../../src/adapters/react/components/MotionConfig.tsx"],"names":["defaultConfig","simulateSpring","position","velocity","target","config","stiffness","damping","mass","restSpeed","restDelta","displacement","absDisplacement","absVelocity","dt","springForce","dampingForce","acceleration","newVelocity","newPosition","isRest","AnimationLoop","id","cb","now","rawDelta","clampedDelta","listener","toRemove","ref","animation","i","existingId","callback","count","delta","globalLoop","clamp","value","min","max","actualMin","actualMax","lerp","a","b","isDev","warnedMessages","warnOnce","message","validateSpringConfig","SpringAnimationImpl","from","to","resolve","temp","_now","result","spring","SpringValueImpl","initial","mergedConfig","originalOnUpdate","originalOnComplete","subscriber","createSpringValue","SpringGroupImpl","initialValues","key","springValue","values","promises","createSpringGroup","resolveVariant","variant","custom","resolved","transition","getVariant","variants","name","calculateStaggerDelays","options","staggerChildren","staggerDirection","delayChildren","delays","index","TrailImpl","followDelay","springConfig","targetValue","delayFrames","targetFrame","startFrame","framesToWait","delayMs","s","unsubscribers","unsubscribe","createTrail","defaultDragConfig","DragSpringImpl","element","newX","newY","snapPoint","factor","snap","gridX","gridY","velocityMagnitude","threshold","nearestPoint","nearestDistance","point","dx","dy","distance","radius","bounds","constraints","parentRect","elementRect","padding","constraintRect","offsetX","offsetY","x","y","velocityX","velocityY","left","right","top","bottom","targetX","targetY","decay","momentumX","momentumY","createDragSpring","parseColor","color","hexToRgb","rgbMatch","rgbaMatch","hslMatch","hslToRgb","rgbToHex","r","g","toHex","n","hex","cleanHex","h","l","gray","hue2rgb","p","q","t","lerpColor","colorA","colorB","createScrollProgress","offset","smooth","progress","smoothedProgress","lastScrollY","lastTime","direction","rafId","subscribers","calculateProgress","scrollY","windowHeight","newProgress","isInView","visibleRatio","rect","elementTop","elementHeight","startPoint","endPoint","scrollStart","scrollEnd","documentHeight","notify","info","onScroll","initialInfo","createParallax","speed","easing","rootMargin","observer","update","elementCenter","viewportCenter","normalizedDistance","entries","entry","createScrollTrigger","start","end","startOffset","endOffset","onEnter","onLeave","onProgress","once","scrub","isActive","hasEntered","getPosition","pos","startPos","endPos","triggerStart","triggerEnd","startProgress","endProgress","rawProgress","wasActive","createScrollLinkedValue","scrollProgress","inputRange","outputRange","shouldClamp","firstOutput","isColorOutput","currentValue","interpolate","firstInput","lastInput","segmentIndex","curr","next","segmentStart","segmentEnd","segmentProgress","startValue","endValue","timelineIdCounter","createTimeline","defaults","autoplay","repeat","yoyo","repeatDelay","onStart","onUpdate","onComplete","onRepeat","segments","labels","callbacks","pauses","currentTime","totalDuration","isPlaying","isReversed","isPaused","repeatCount","lastFrameTime","hasStarted","insertTime","parsePosition","lastSegment","labelMatch","labelName","labelTime","offsetValue","resolveTarget","extractNumericProps","props","applyPropsToElement","transforms","cssProps","prop","val","getCurrentElementValues","current","computed","tick","timestamp","deltaTime","callbacksAtTime","pauseCallback","segment","shouldBeActive","timeline","startTime","duration","endTime","numericProps","currentValues","originalOnStart","targetValues","fromProps","toProps","fromNumeric","toNumeric","label","time","parsePath","d","commands","regex","matches","matchItem","typeChar","valuesStr","type","v","toAbsolute","cmd","absValues","currentY","samplePath","samples","points","svgNS","svg","path","step","interpolatePoint","p1","p2","pointsToPath","firstPoint","createMorph","initialPath","currentPath","fromPoints","toPoints","currentPoints","initialCommands","progressSpring","targetCommands","targetPoints","createMorphSequence","paths","currentIndex","firstPath","morph","targetIndex","targetPath","measureElement","styles","applyTransform","scaleX","scaleY","compensatedRadius","resetTransform","createLayoutGroup","defaultSpring","onAnimationStart","onAnimationComplete","crossfade","elements","previousMeasurements","register","existing","e","measurement","unregister","group","animateElement","checkComplete","previousMeasurement","currentMeasurement","groupIdCounter","createSharedLayoutContext","groups","groupId","createAutoLayout","root","attribute","debounceTime","layoutConfig","resizeObserver","debounceTimer","scanAndRegister","el","debouncedUpdate","mutations","shouldUpdate","mutation","node","MotionValue","initialValue","newValue","animate","checkEnd","event","createMotionValue","transformValue","source","transform","derived","mapRange","inMin","inMax","outMin","outMax","normalized","createFlip","first","last","size","deltaX","deltaY","deltaWidth","deltaHeight","cancelled","originalTransform","originalTransformOrigin","invertedT","cleanup","flip","mutate","useSpring","springRef","useRef","forceUpdate","useState","isFirstRender","prevValuesStringRef","useEffect","currentValuesString","useSpringValue","useSprings","items","springsRef","item","useTrail","setCurrentValues","prevValuesRef","keys","springs","propSprings","unsub","prev","newItem","ps","k","staggerDelay","useDrag","dragSpringRef","positionRef","setElement","isDragging","setIsDragging","configRef","refCallback","set","reset","useGesture","handlers","stateRef","PresenceContext","createContext","usePresence","context","useContext","useIsPresent","usePresenceCustom","useAnimate","scopeRef","valuesRef","isAnimatingRef","cleanupRef","useCallback","property","applyStyles","delay","animationPromise","controls","useMotionValue","motionValueRef","useMotionValueState","motionValue","setValue","useMotionValueSync","externalValue","useMotionValues","motionValuesRef","useTransform","inputRangeOrTransform","derivedRef","unsubscribeRef","transformFn","useMemo","nextVal","inputMin","inputMax","outputMin","outputMax","inCurr","inNext","useCombinedTransform","sources","unsubscribesRef","getCurrentValues","useVelocityTransform","frameRef","useSpringTransform","outCurr","outNext","isBrowser","isServer","useIsomorphicLayoutEffect","useLayoutEffect","shouldSkipAnimation","safeRequestAnimationFrame","safeCancelAnimationFrame","useInView","amount","margin","inView","setInView","setEntry","hasTriggered","observerEntry","isIntersecting","useInViewCallback","callbackRef","useInViewMultiple","elementsRef","inViewMap","setInViewMap","observerRef","useScroll","container","axis","scrollXRef","scrollYRef","scrollXProgressRef","scrollYProgressRef","scrollX","scrollXProgress","scrollYProgress","scrollContainer","isWindow","getScrollPosition","getScrollSize","calculateTargetProgress","targetEl","viewportHeight","parseOffset","range","clampedProgress","handleScroll","scrollTarget","viewportWidth","parts","elementPart","viewportPart","elementPos","viewportPos","useScrollVelocity","velocityRef","lastScrollRef","lastTimeRef","currentScroll","deltaScroll","useGestureState","hover","press","focus","drag","state","setState","handleGlobalMouseUp","useHover","isHovered","setIsHovered","useTap","isPressed","setIsPressed","handleUp","useFocus","isFocused","setIsFocused","useInteractionState","useGestureAnimation","states","useReducedMotion","prefersReducedMotion","setPrefersReducedMotion","mediaQuery","handleChange","getReducedMotionPreference","useReducedMotionConfig","configs","useShouldAnimate","useReducedMotionValue","animatedValue","reducedValue","useScrollProgress","setProgress","setInfo","scrollProgressRef","scrollInfo","useParallax","setOffset","parallax","intervalId","useScrollTrigger","setIsActive","setHasEntered","trigger","useScrollLinkedValue","linkedValue","useTimeline","timelineRef","play","pause","resume","reverse","restart","seek","kill","useTimelineState","progressRef","isPlayingRef","isPausedRef","isReversedRef","updateState","useMorph","setPath","setProgressState","morphRef","newPath","morphTo","useMorphSequence","setCurrentIndex","sequenceRef","sequence","morphToIndex","morphToNext","morphToPrevious","useMorphRef","elementRef","pathRef","LayoutGroupContext","SharedLayoutContextReact","useLayoutGroup","layoutGroupRef","layoutGroup","useLayoutId","layoutId","localGroupRef","activeGroup","useFlip","lastMeasurementRef","flipFn","measure","useAutoLayout","autoLayoutRef","containerRef","LayoutGroupProvider","children","React","SharedLayoutProvider","sharedContextRef","VariantContext","useVariantContext","useVariants","inherit","parentContext","currentVariantRef","targetVariant","toNumber","fallback","parsed","springValues","timer","setVariant","VariantProvider","useStaggerChildren","getDelay","getChildProps","createMotionComponent","_element","_options","Spring","onRest","setValues","jsx","Fragment","extractNumericValues","style","createAnimatedComponent","tag","AnimatedComponent","exit","whileHover","whileTap","whileFocus","whileDrag","whileInView","viewport","onHoverStart","onHoverEnd","onTapStart","onTap","onTapCancel","forwardedRef","animatedStyle","setAnimatedStyle","hasCalledSafeToRemove","isInViewport","setIsInViewport","hasTriggeredInView","presenceContext","isPresent","safeToRemove","setRef","getTargetStyle","getInitialStyle","initialStyle","numericInitial","targetStyle","numericTarget","numericAnimate","timeout","handleMouseEnter","handleMouseLeave","handlePointerDown","handlePointerUp","handlePointerCancel","handleFocus","handleBlur","handleGlobalPointerUp","staticStyle","_","eventHandlers","memo","Animated","Trail","trailRef","trail","vals","firstValue","PresenceChild","onExitComplete","presenceIdRef","contextValue","hasExited","getChildKey","child","getChildrenMap","map","Children","isValidElement","AnimatePresence","mode","isInitialMount","exitingChildren","setExitingChildren","prevChildrenRef","pendingExitCount","currentChildren","prevChildren","newExiting","prevChild","handleExitComplete","showEntering","allChildren","exitingChild","cloneElement","shouldAnimate","defaultContext","MotionContext","useMotionConfig","checkReducedMotion","MotionConfig","reducedMotion","isReducedMotion"],"mappings":"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","file":"index.mjs","sourcesContent":["/**\n * Spring configuration interface\n */\nexport interface SpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Initial velocity */\n  velocity?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Callback called on each update */\n  onUpdate?: (value: number) => void\n  /** Callback called when animation starts */\n  onStart?: () => void\n  /** Callback called when animation reaches target */\n  onComplete?: () => void\n  /** Callback called when spring is at rest */\n  onRest?: () => void\n}\n\n/**\n * Default spring configuration\n */\nexport const defaultConfig: SpringConfig = {\n  stiffness: 100,\n  damping: 10,\n  mass: 1,\n  velocity: 0,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Spring presets interface\n */\nexport interface SpringPresets {\n  /** Default spring: { stiffness: 100, damping: 10 } */\n  default: SpringConfig\n  /** Gentle spring: { stiffness: 120, damping: 14 } */\n  gentle: SpringConfig\n  /** Wobbly spring: { stiffness: 180, damping: 12 } */\n  wobbly: SpringConfig\n  /** Stiff spring: { stiffness: 210, damping: 20 } */\n  stiff: SpringConfig\n  /** Slow spring: { stiffness: 280, damping: 60 } */\n  slow: SpringConfig\n  /** Molasses spring: { stiffness: 280, damping: 120 } */\n  molasses: SpringConfig\n  /** Bouncy spring: { stiffness: 200, damping: 8 } */\n  bounce: SpringConfig\n  /** No wobble spring: { stiffness: 170, damping: 26 } */\n  noWobble: SpringConfig\n}\n\n/**\n * Built-in spring presets\n */\nexport const springPresets: SpringPresets = {\n  default: { stiffness: 100, damping: 10 },\n  gentle: { stiffness: 120, damping: 14 },\n  wobbly: { stiffness: 180, damping: 12 },\n  stiff: { stiffness: 210, damping: 20 },\n  slow: { stiffness: 280, damping: 60 },\n  molasses: { stiffness: 280, damping: 120 },\n  bounce: { stiffness: 200, damping: 8 },\n  noWobble: { stiffness: 170, damping: 26 },\n}\n\n// ============ Semantic Physics Presets ============\n\n/**\n * Physics presets with semantic, use-case oriented names\n * These presets are designed for specific UI interactions and feel natural\n */\nexport const physicsPresets = {\n  // ---- UI Interactions ----\n\n  /** Button press/release - snappy response */\n  button: { stiffness: 400, damping: 30, mass: 1 },\n\n  /** Toggle switch - quick but smooth */\n  toggle: { stiffness: 500, damping: 35, mass: 0.8 },\n\n  /** Checkbox/Radio - instant feedback */\n  checkbox: { stiffness: 600, damping: 40, mass: 0.5 },\n\n  /** Hover state - subtle and responsive */\n  hover: { stiffness: 300, damping: 25, mass: 0.8 },\n\n  /** Focus ring - gentle attention */\n  focus: { stiffness: 200, damping: 20, mass: 1 },\n\n  // ---- Layout & Navigation ----\n\n  /** Page transitions - smooth and professional */\n  pageTransition: { stiffness: 100, damping: 20, mass: 1.5 },\n\n  /** Modal/Dialog entry - dramatic but controlled */\n  modalEnter: { stiffness: 300, damping: 25, mass: 1 },\n\n  /** Modal/Dialog exit - quick departure */\n  modalExit: { stiffness: 400, damping: 35, mass: 0.8 },\n\n  /** Sidebar slide - smooth glide */\n  sidebar: { stiffness: 200, damping: 28, mass: 1.2 },\n\n  /** Dropdown menu - snappy reveal */\n  dropdown: { stiffness: 400, damping: 30, mass: 0.8 },\n\n  /** Toast notification - attention-grabbing */\n  toast: { stiffness: 350, damping: 25, mass: 0.9 },\n\n  /** Tooltip - quick and subtle */\n  tooltip: { stiffness: 500, damping: 40, mass: 0.6 },\n\n  // ---- Gestures & Drag ----\n\n  /** Drag release - momentum with settle */\n  dragRelease: { stiffness: 150, damping: 20, mass: 1 },\n\n  /** Swipe action - decisive movement */\n  swipe: { stiffness: 250, damping: 22, mass: 0.9 },\n\n  /** Pull to refresh - elastic and responsive */\n  pullToRefresh: { stiffness: 180, damping: 18, mass: 1.2 },\n\n  /** Snap to position - magnetic feel */\n  snap: { stiffness: 400, damping: 35, mass: 0.8 },\n\n  /** Rubber band - iOS-style overscroll */\n  rubberBand: { stiffness: 300, damping: 15, mass: 0.8 },\n\n  // ---- Cards & Items ----\n\n  /** Card flip - dramatic reveal */\n  cardFlip: { stiffness: 150, damping: 18, mass: 1.5 },\n\n  /** Card hover lift - subtle elevation */\n  cardHover: { stiffness: 400, damping: 30, mass: 0.7 },\n\n  /** List item enter - staggered animation */\n  listItem: { stiffness: 300, damping: 28, mass: 0.9 },\n\n  /** Accordion expand - smooth reveal */\n  accordion: { stiffness: 200, damping: 25, mass: 1.1 },\n\n  // ---- Loading & Progress ----\n\n  /** Skeleton shimmer - continuous flow */\n  skeleton: { stiffness: 80, damping: 15, mass: 2 },\n\n  /** Progress bar - steady advancement */\n  progress: { stiffness: 150, damping: 25, mass: 1 },\n\n  /** Spinner rotation - smooth continuous */\n  spinner: { stiffness: 100, damping: 12, mass: 1.5 },\n\n  // ---- Emphasis & Attention ----\n\n  /** Pulse effect - gentle attention */\n  pulse: { stiffness: 120, damping: 10, mass: 1.2 },\n\n  /** Shake effect - error emphasis */\n  shake: { stiffness: 500, damping: 15, mass: 0.6 },\n\n  /** Bounce effect - playful emphasis */\n  bounceAttention: { stiffness: 400, damping: 10, mass: 0.7 },\n\n  /** Pop effect - sudden appearance */\n  pop: { stiffness: 500, damping: 20, mass: 0.6 },\n\n  /** Wiggle effect - playful motion */\n  wiggle: { stiffness: 300, damping: 8, mass: 0.8 },\n\n  // ---- Mobile-Specific ----\n\n  /** iOS spring - Apple-like feel */\n  ios: { stiffness: 300, damping: 20, mass: 1 },\n\n  /** Android spring - Material Design feel */\n  android: { stiffness: 350, damping: 25, mass: 0.9 },\n\n  /** Haptic feedback - quick micro-interaction */\n  haptic: { stiffness: 600, damping: 45, mass: 0.4 },\n\n  // ---- Natural Physics ----\n\n  /** Pendulum - gravity-like swing */\n  pendulum: { stiffness: 50, damping: 5, mass: 2 },\n\n  /** Jelly - soft and wobbly */\n  jelly: { stiffness: 150, damping: 8, mass: 1.5 },\n\n  /** Elastic - stretchy rubber */\n  elastic: { stiffness: 200, damping: 10, mass: 1.2 },\n\n  /** Heavy - weighted and deliberate */\n  heavy: { stiffness: 150, damping: 30, mass: 3 },\n\n  /** Light - airy and quick */\n  light: { stiffness: 400, damping: 25, mass: 0.5 },\n\n  /** Liquid - fluid motion */\n  liquid: { stiffness: 100, damping: 20, mass: 2 },\n\n} as const\n\nexport type PhysicsPresetName = keyof typeof physicsPresets\n\n/**\n * Get a physics preset by name\n */\nexport function getPhysicsPreset(name: PhysicsPresetName): SpringConfig {\n  return { ...physicsPresets[name] }\n}\n\n/**\n * Create a custom preset based on a semantic description\n * @param feeling - How the animation should feel\n */\nexport function createFeeling(feeling: 'snappy' | 'smooth' | 'bouncy' | 'heavy' | 'light' | 'elastic'): SpringConfig {\n  switch (feeling) {\n    case 'snappy':\n      return { stiffness: 400, damping: 30, mass: 0.8 }\n    case 'smooth':\n      return { stiffness: 150, damping: 25, mass: 1.2 }\n    case 'bouncy':\n      return { stiffness: 300, damping: 12, mass: 1 }\n    case 'heavy':\n      return { stiffness: 100, damping: 30, mass: 2.5 }\n    case 'light':\n      return { stiffness: 400, damping: 25, mass: 0.5 }\n    case 'elastic':\n      return { stiffness: 200, damping: 10, mass: 1.2 }\n    default:\n      return { stiffness: 100, damping: 10, mass: 1 }\n  }\n}\n\n/**\n * Adjust a preset for speed\n * @param preset - Base preset config\n * @param speed - Speed multiplier (0.5 = half speed, 2 = double speed)\n */\nexport function adjustSpeed(preset: SpringConfig, speed: number): SpringConfig {\n  const stiffness = (preset.stiffness ?? 100) * speed\n  const damping = (preset.damping ?? 10) * Math.sqrt(speed)\n  return { ...preset, stiffness, damping }\n}\n\n/**\n * Adjust a preset for bounciness\n * @param preset - Base preset config\n * @param bounce - Bounce factor (0 = no bounce, 1 = very bouncy)\n */\nexport function adjustBounce(preset: SpringConfig, bounce: number): SpringConfig {\n  const baseDamping = preset.damping ?? 10\n  const minDamping = 5\n  const maxDamping = 40\n  const damping = maxDamping - (bounce * (maxDamping - minDamping))\n  return { ...preset, damping: Math.max(minDamping, Math.min(maxDamping, damping)) }\n}\n\n/**\n * Create a spring config that settles in approximately the given duration\n * @param ms - Approximate settling time in milliseconds\n * @returns Spring config\n */\nexport function configFromDuration(ms: number): SpringConfig {\n  if (ms < 300) {\n    return { stiffness: 170, damping: 26 }\n  }\n  if (ms < 500) {\n    return { stiffness: 100, damping: 20 }\n  }\n  return { stiffness: 80, damping: 15 }\n}\n\n/**\n * Create a spring config with specific bounce amount\n * @param bounce - Bounce factor (0 = no bounce, 0.5 = 50% overshoot)\n * @returns Spring config\n */\nexport function configFromBounce(bounce: number): SpringConfig {\n  if (bounce <= 0) {\n    return { stiffness: 170, damping: 26 }\n  }\n  if (bounce <= 0.25) {\n    return { stiffness: 200, damping: 12 }\n  }\n  return { stiffness: 200, damping: 8 }\n}\n","import type { SpringConfig } from './config.js'\n\n/**\n * Result of a spring physics simulation step\n */\nexport interface SimulationResult {\n  /** New position */\n  position: number\n  /** New velocity */\n  velocity: number\n  /** Whether the spring is at rest */\n  isRest: boolean\n}\n\n/**\n * Simulate one step of spring physics using semi-implicit Euler integration\n *\n * The spring follows the damped harmonic oscillator equation:\n * F = -k * x - c * v\n * a = F / m\n *\n * Where:\n * - k = stiffness (spring constant)\n * - c = damping coefficient\n * - m = mass\n * - x = displacement from rest (target - position)\n * - v = velocity\n * - a = acceleration\n * - dt = time step (1/60 for 60fps animation)\n *\n * @param position - Current position\n * @param velocity - Current velocity\n * @param target - Target position (rest position)\n * @param config - Spring configuration\n * @returns Simulation result with new position, velocity, and rest state\n */\nexport function simulateSpring(\n  position: number,\n  velocity: number,\n  target: number,\n  config: SpringConfig\n): SimulationResult {\n  const {\n    stiffness = 100,\n    damping = 10,\n    mass = 1,\n    restSpeed = 0.01,\n    restDelta = 0.01,\n  } = config\n\n  // Calculate displacement from target (cached for reuse)\n  const displacement = target - position\n  const absDisplacement = Math.abs(displacement)\n  const absVelocity = Math.abs(velocity)\n\n  // Early exit optimization: if already at rest, skip expensive calculations\n  // This significantly improves performance for springs that have settled\n  if (absDisplacement <= restDelta && absVelocity <= restSpeed) {\n    return {\n      position: target, // Snap to exact target\n      velocity: 0,\n      isRest: true,\n    }\n  }\n\n  // Time step for 60fps animation\n  // This ensures the spring simulation is stable with typical stiffness values\n  const dt = 1 / 60\n\n  // Calculate spring force (Hooke's law: F = -k * x)\n  const springForce = stiffness * displacement\n\n  // Calculate damping force (opposes velocity: F = -c * v)\n  // Optimization: skip multiplication if velocity is negligible\n  const dampingForce = absVelocity > 0.0001 ? damping * velocity : 0\n\n  // Calculate total force and acceleration (Newton's second law: a = F/m)\n  const acceleration = (springForce - dampingForce) / mass\n\n  // Semi-implicit Euler integration\n  // Update velocity first, then use new velocity to update position\n  // This provides better energy conservation than standard Euler\n  const newVelocity = velocity + acceleration * dt\n  const newPosition = position + newVelocity * dt\n\n  // Check if spring is at rest\n  // Spring is at rest when:\n  // 1. Close to target position (displacement < restDelta)\n  // 2. Moving slowly (velocity < restSpeed)\n  const isRest =\n    absDisplacement <= restDelta &&\n    Math.abs(newVelocity) <= restSpeed\n\n  return {\n    position: newPosition,\n    velocity: newVelocity,\n    isRest,\n  }\n}\n\n/**\n * Calculate the period of oscillation for a spring\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Period in seconds\n */\nexport function calculatePeriod(stiffness: number, mass: number): number {\n  return 2 * Math.PI * Math.sqrt(mass / stiffness)\n}\n\n/**\n * Calculate the damping ratio for a spring\n * @param damping - Damping coefficient\n * @param stiffness - Spring stiffness\n * @param mass - Spring mass\n * @returns Damping ratio\n */\nexport function calculateDampingRatio(\n  damping: number,\n  stiffness: number,\n  mass: number\n): number {\n  return damping / (2 * Math.sqrt(stiffness * mass))\n}\n\n/**\n * Check if a spring is underdamped (will oscillate)\n * @param config - Spring configuration\n * @returns True if underdamped\n */\nexport function isUnderdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio < 1\n}\n\n/**\n * Check if a spring is critically damped (fastest return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if critically damped\n */\nexport function isCriticallyDamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return Math.abs(ratio - 1) < 0.001\n}\n\n/**\n * Check if a spring is overdamped (slow return to rest without oscillation)\n * @param config - Spring configuration\n * @returns True if overdamped\n */\nexport function isOverdamped(config: SpringConfig): boolean {\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n  const ratio = calculateDampingRatio(damping, stiffness, mass)\n  return ratio > 1\n}\n","/**\n * Animation state enum\n */\nexport enum AnimationState {\n  Idle = 'idle',\n  Running = 'running',\n  Paused = 'paused',\n  Complete = 'complete',\n}\n\n/**\n * Interface for objects that can be animated\n */\nexport interface Animatable {\n  /**\n   * Update the animation\n   * @param now - Current timestamp from performance.now()\n   */\n  update(now: number): void\n\n  /**\n   * Check if the animation is complete\n   */\n  isComplete(): boolean\n}\n\n/**\n * Callback type for cleanup notifications\n */\nexport type CleanupCallback = (id: number) => void\n\n/**\n * Maximum allowed delta time (ms) to prevent physics explosions after tab suspension\n * If more time has passed, we clamp to this value for stable simulation\n */\nconst MAX_DELTA_TIME = 64 // ~15fps minimum, prevents huge jumps\n\n/**\n * Global animation loop manager\n * Uses requestAnimationFrame to drive all animations\n * Features:\n * - WeakRef-based animation tracking for memory safety\n * - FinalizationRegistry for cleanup callbacks\n * - Frame-drop resilience with delta time clamping\n * - Single-pass update + cleanup for O(n) performance\n * - Frame event listeners for external monitoring\n */\nclass AnimationLoop {\n  private animations = new Set<WeakRef<Animatable>>()\n  private animationMap = new WeakMap<Animatable, WeakRef<Animatable>>()\n  private rafId: number | null = null\n  private isRunning = false\n  private lastTime: number = 0\n  private nextId = 1\n  private idMap = new WeakMap<Animatable, number>()\n  private frameListeners = new Set<(deltaTime: number) => void>()\n\n  // FinalizationRegistry for automatic cleanup notifications\n  private registry = new FinalizationRegistry<number>((id) => {\n    this.cleanupCallbacks.forEach((cb) => cb(id))\n  })\n  private cleanupCallbacks = new Set<CleanupCallback>()\n\n  /**\n   * Add an animation to the loop\n   * Uses WeakRef to prevent memory leaks if animation is garbage collected\n   * @returns Unique ID for this animation\n   */\n  add(animation: Animatable): number {\n    // Check if already added\n    const existingId = this.idMap.get(animation)\n    if (existingId !== undefined) return existingId\n\n    const id = this.nextId++\n    const ref = new WeakRef(animation)\n    this.animations.add(ref)\n    this.animationMap.set(animation, ref)\n    this.idMap.set(animation, id)\n\n    // Register for finalization callback\n    this.registry.register(animation, id)\n\n    this.start()\n    return id\n  }\n\n  /**\n   * Remove an animation from the loop\n   */\n  remove(animation: Animatable): void {\n    const ref = this.animationMap.get(animation)\n    if (ref) {\n      this.animations.delete(ref)\n      this.animationMap.delete(animation)\n      this.idMap.delete(animation)\n      // Note: unregister not strictly needed as registry uses weak refs\n    }\n    if (this.animations.size === 0) {\n      this.stop()\n    }\n  }\n\n  /**\n   * Register a callback for when animations are garbage collected\n   * Useful for debugging memory leaks\n   */\n  onCleanup(callback: CleanupCallback): () => void {\n    this.cleanupCallbacks.add(callback)\n    return () => this.cleanupCallbacks.delete(callback)\n  }\n\n  /**\n   * Register a callback for each frame\n   * Receives delta time in milliseconds\n   */\n  onFrame(callback: (deltaTime: number) => void): () => void {\n    this.frameListeners.add(callback)\n    return () => this.frameListeners.delete(callback)\n  }\n\n  /**\n   * Start the animation loop\n   */\n  private start(): void {\n    if (this.isRunning) return\n    this.isRunning = true\n    this.lastTime = performance.now()\n    this.tick()\n  }\n\n  /**\n   * Stop the animation loop\n   */\n  private stop(): void {\n    this.isRunning = false\n    if (this.rafId !== null) {\n      cancelAnimationFrame(this.rafId)\n      this.rafId = null\n    }\n  }\n\n  /**\n   * Single animation frame - optimized single-pass update + cleanup\n   * Features:\n   * - WeakRef dereferencing with automatic cleanup of dead refs\n   * - Delta time clamping for frame-drop resilience\n   * - O(n) single-pass performance\n   * - Frame listener notifications\n   */\n  private tick = (): void => {\n    const now = performance.now()\n\n    // Calculate and clamp delta time to prevent physics explosions\n    // This handles tab suspension, debugger pauses, etc.\n    const rawDelta = now - this.lastTime\n    const clampedDelta = Math.min(rawDelta, MAX_DELTA_TIME)\n    this.lastTime = now\n\n    // Notify frame listeners\n    for (const listener of this.frameListeners) {\n      listener(clampedDelta)\n    }\n\n    // Single pass: update all animations and collect refs to remove\n    const toRemove: WeakRef<Animatable>[] = []\n\n    for (const ref of this.animations) {\n      const animation = ref.deref()\n\n      // If WeakRef is dead (animation was garbage collected), mark for removal\n      if (!animation) {\n        toRemove.push(ref)\n        continue\n      }\n\n      animation.update(now)\n\n      if (animation.isComplete()) {\n        toRemove.push(ref)\n        this.animationMap.delete(animation)\n        this.idMap.delete(animation)\n      }\n    }\n\n    // Remove dead/completed refs\n    for (let i = 0; i < toRemove.length; i++) {\n      this.animations.delete(toRemove[i]!)\n    }\n\n    // Continue or stop loop\n    if (this.animations.size > 0) {\n      this.rafId = requestAnimationFrame(this.tick)\n    } else {\n      this.stop()\n    }\n  }\n\n  /**\n   * Get the number of active animations (including potentially dead refs)\n   */\n  get size(): number {\n    return this.animations.size\n  }\n\n  /**\n   * Get count of actually alive animations (for debugging/testing)\n   */\n  getAliveCount(): number {\n    let count = 0\n    for (const ref of this.animations) {\n      if (ref.deref()) count++\n    }\n    return count\n  }\n\n  /**\n   * Get current frame rate (based on last delta)\n   */\n  getFPS(): number {\n    const delta = performance.now() - this.lastTime\n    return delta > 0 ? Math.round(1000 / delta) : 60\n  }\n}\n\n/**\n * Global animation loop instance\n */\nexport const globalLoop = new AnimationLoop()\n","/**\n * Clamp a value between a minimum and maximum\n * @param value - The value to clamp\n * @param min - The minimum allowed value\n * @param max - The maximum allowed value\n * @returns The clamped value\n */\nexport function clamp(value: number, min: number, max: number): number {\n  // Handle inverted min/max (swap them)\n  const actualMin = Math.min(min, max)\n  const actualMax = Math.max(min, max)\n  return Math.max(actualMin, Math.min(actualMax, value))\n}\n\n/**\n * Linear interpolation between two values\n * @param a - The start value\n * @param b - The end value\n * @param t - The interpolation factor (0-1)\n * @returns The interpolated value\n */\nexport function lerp(a: number, b: number, t: number): number {\n  return a + (b - a) * t\n}\n\n/**\n * Map a value from one range to another\n * @param value - The value to map\n * @param inMin - The minimum of the input range\n * @param inMax - The maximum of the input range\n * @param outMin - The minimum of the output range\n * @param outMax - The maximum of the output range\n * @returns The mapped value\n */\nexport function mapRange(\n  value: number,\n  inMin: number,\n  inMax: number,\n  outMin: number,\n  outMax: number\n): number {\n  return ((value - inMin) * (outMax - outMin)) / (inMax - inMin) + outMin\n}\n\n/**\n * Convert degrees to radians\n * @param degrees - The angle in degrees\n * @returns The angle in radians\n */\nexport function degToRad(degrees: number): number {\n  return (degrees * Math.PI) / 180\n}\n\n/**\n * Convert radians to degrees\n * @param radians - The angle in radians\n * @returns The angle in degrees\n */\nexport function radToDeg(radians: number): number {\n  return (radians * 180) / Math.PI\n}\n","/**\n * Development mode warnings for SpringKit\n * These warnings help developers avoid common configuration mistakes\n */\n\nconst isDev = typeof process !== 'undefined' && process.env?.NODE_ENV !== 'production'\nconst warnedMessages = new Set<string>()\n\n/**\n * Log a warning message once (won't repeat the same message)\n */\nfunction warnOnce(message: string): void {\n  if (!isDev || warnedMessages.has(message)) return\n  warnedMessages.add(message)\n  console.warn(`[SpringKit] ${message}`)\n}\n\n/**\n * Validate spring configuration and warn about potential issues\n */\nexport function validateSpringConfig(config: {\n  stiffness?: number\n  damping?: number\n  mass?: number\n}): void {\n  if (!isDev) return\n\n  const { stiffness = 100, damping = 10, mass = 1 } = config\n\n  // Check for extreme stiffness with low damping (unstable oscillation)\n  if (stiffness > 400 && damping < 10) {\n    warnOnce(\n      `High stiffness (${stiffness}) with low damping (${damping}) may cause excessive oscillation. ` +\n      `Consider increasing damping to at least ${Math.round(stiffness / 20)} for smoother animation.`\n    )\n  }\n\n  // Check for very low stiffness (sluggish animation)\n  if (stiffness < 20) {\n    warnOnce(\n      `Very low stiffness (${stiffness}) will result in sluggish animation. ` +\n      `Consider using stiffness >= 50 for more responsive feel.`\n    )\n  }\n\n  // Check for very high damping (overdamped, no spring feel)\n  if (damping > stiffness) {\n    warnOnce(\n      `Damping (${damping}) is higher than stiffness (${stiffness}), ` +\n      `which removes the \"springy\" feel. Consider reducing damping for bouncier animation.`\n    )\n  }\n\n  // Check for zero or negative mass\n  if (mass <= 0) {\n    warnOnce(\n      `Mass must be positive. Got ${mass}. Using default mass of 1.`\n    )\n  }\n\n  // Check for very high mass (slow animation)\n  if (mass > 10) {\n    warnOnce(\n      `High mass (${mass}) will make the animation very slow. ` +\n      `Consider mass between 0.5 and 5 for typical use cases.`\n    )\n  }\n}\n\n/**\n * Validate drag configuration\n */\nexport function validateDragConfig(config: {\n  rubberBandFactor?: number\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n}): void {\n  if (!isDev) return\n\n  const { rubberBandFactor, bounds } = config\n\n  // Check rubber band factor range\n  if (rubberBandFactor !== undefined && (rubberBandFactor < 0 || rubberBandFactor > 1)) {\n    warnOnce(\n      `rubberBandFactor should be between 0 and 1. Got ${rubberBandFactor}. ` +\n      `Values outside this range may cause unexpected behavior.`\n    )\n  }\n\n  // Check for inverted bounds\n  if (bounds) {\n    if (bounds.left !== undefined && bounds.right !== undefined && bounds.left > bounds.right) {\n      warnOnce(\n        `Drag bounds are inverted: left (${bounds.left}) > right (${bounds.right}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n    if (bounds.top !== undefined && bounds.bottom !== undefined && bounds.top > bounds.bottom) {\n      warnOnce(\n        `Drag bounds are inverted: top (${bounds.top}) > bottom (${bounds.bottom}). ` +\n        `This may cause unexpected behavior.`\n      )\n    }\n  }\n}\n\n/**\n * Validate decay configuration\n */\nexport function validateDecayConfig(config: {\n  velocity: number\n  deceleration?: number\n}): void {\n  if (!isDev) return\n\n  const { velocity, deceleration = 0.998 } = config\n\n  // Check for zero velocity\n  if (velocity === 0) {\n    warnOnce(\n      `Decay animation started with zero velocity. ` +\n      `The animation will complete immediately.`\n    )\n  }\n\n  // Check deceleration range\n  if (deceleration <= 0 || deceleration >= 1) {\n    warnOnce(\n      `Deceleration should be between 0 and 1 (exclusive). Got ${deceleration}. ` +\n      `Typical values are 0.99-0.999.`\n    )\n  }\n}\n\n/**\n * Clear warned messages (useful for testing)\n */\nexport function clearWarnings(): void {\n  warnedMessages.clear()\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { simulateSpring } from './physics.js'\nimport { globalLoop, type Animatable, AnimationState } from '../animation/loop.js'\nimport { clamp } from '../utils/math.js'\nimport { validateSpringConfig } from '../utils/warnings.js'\n\n/**\n * Spring animation control interface\n */\nexport interface SpringAnimation {\n  /** Start the animation */\n  start(): SpringAnimation\n  /** Stop the animation immediately */\n  stop(): void\n  /** Pause the animation */\n  pause(): void\n  /** Resume the animation */\n  resume(): void\n  /** Reverse the animation direction */\n  reverse(): void\n  /** Update the target value */\n  set(to: number): void\n  /** Update target while preserving current velocity (for smooth interruptions) */\n  setWithVelocity(to: number, velocity?: number): void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Check if paused */\n  isPaused(): boolean\n  /** Check if complete */\n  isComplete(): boolean\n  /** Get current value */\n  getValue(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Promise that resolves when complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring animation implementation\n */\nclass SpringAnimationImpl implements SpringAnimation, Animatable {\n  private position: number\n  private velocity: number\n  private target: number\n  private config: SpringConfig & Required<Pick<SpringConfig, 'stiffness' | 'damping' | 'mass' | 'restSpeed' | 'restDelta'>>\n  private state: AnimationState = AnimationState.Idle\n  private resolveComplete: (() => void) | null = null\n  private from: number\n  private to: number\n  private clampedFrom: number\n  private clampedTo: number\n\n  finished: Promise<void>\n\n  constructor(\n    from: number,\n    to: number,\n    config: SpringConfig = {}\n  ) {\n    // Validate config in development mode\n    validateSpringConfig(config)\n\n    this.from = from\n    this.to = to\n    this.clampedFrom = from\n    this.clampedTo = to\n    this.position = from\n    this.velocity = config.velocity ?? 0\n    this.target = to\n    this.config = {\n      ...defaultConfig,\n      ...config,\n      stiffness: config.stiffness ?? defaultConfig.stiffness!,\n      damping: config.damping ?? defaultConfig.damping!,\n      mass: config.mass ?? defaultConfig.mass!,\n      restSpeed: config.restSpeed ?? defaultConfig.restSpeed!,\n      restDelta: config.restDelta ?? defaultConfig.restDelta!,\n    }\n\n    this.finished = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  start(): SpringAnimation {\n    if (this.state === AnimationState.Running) return this\n\n    this.state = AnimationState.Running\n    this.config.onStart?.()\n    globalLoop.add(this)\n    return this\n  }\n\n  stop(): void {\n    this.state = AnimationState.Idle\n    globalLoop.remove(this)\n  }\n\n  pause(): void {\n    if (this.state === AnimationState.Running) {\n      this.state = AnimationState.Paused\n      globalLoop.remove(this)\n    }\n  }\n\n  resume(): void {\n    if (this.state === AnimationState.Paused) {\n      this.state = AnimationState.Running\n      globalLoop.add(this)\n    }\n  }\n\n  reverse(): void {\n    const temp = this.from\n    this.from = this.to\n    this.to = temp\n    this.clampedFrom = this.from\n    this.clampedTo = this.to\n    this.target = this.to\n  }\n\n  set(to: number): void {\n    this.to = to\n    this.clampedTo = to\n    this.target = to\n  }\n\n  setWithVelocity(to: number, velocity?: number): void {\n    // Update from to current position for smooth continuation\n    this.from = this.position\n    this.clampedFrom = this.position\n    this.to = to\n    this.clampedTo = to\n    this.target = to\n\n    // Use provided velocity or preserve current velocity\n    if (velocity !== undefined) {\n      this.velocity = velocity\n    }\n    // If not running, start the animation\n    if (this.state !== AnimationState.Running) {\n      this.start()\n    }\n  }\n\n  update(_now: number): void {\n    if (this.state !== AnimationState.Running) return\n\n    const result = simulateSpring(\n      this.position,\n      this.velocity,\n      this.target,\n      this.config\n    )\n\n    this.position = result.position\n    this.velocity = result.velocity\n\n    // Handle clamping\n    if (this.config.clamp) {\n      const min = Math.min(this.clampedFrom, this.clampedTo)\n      const max = Math.max(this.clampedFrom, this.clampedTo)\n      this.position = clamp(this.position, min, max)\n    }\n\n    // Emit update\n    this.config.onUpdate?.(this.position)\n\n    // Check rest state\n    if (result.isRest) {\n      this.state = AnimationState.Complete\n      globalLoop.remove(this)\n      this.position = this.target // Ensure we end exactly at target\n      this.config.onUpdate?.(this.position)\n      this.config.onComplete?.()\n      this.config.onRest?.()\n      this.resolveComplete?.()\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.state === AnimationState.Running\n  }\n\n  isPaused(): boolean {\n    return this.state === AnimationState.Paused\n  }\n\n  isComplete(): boolean {\n    return this.state === AnimationState.Complete\n  }\n\n  getValue(): number {\n    return this.position\n  }\n\n  getVelocity(): number {\n    return this.velocity\n  }\n\n  destroy(): void {\n    this.stop()\n    this.config.onUpdate = undefined\n    this.config.onStart = undefined\n    this.config.onComplete = undefined\n    this.config.onRest = undefined\n  }\n}\n\n/**\n * Create a spring animation\n *\n * @param from - Starting value\n * @param to - Target value\n * @param config - Spring configuration\n * @returns Spring animation controller\n *\n * @example\n * ```ts\n * const anim = spring(0, 100, {\n *   onUpdate: (value) => {\n *     element.style.transform = `translateX(${value}px)`\n *   },\n * })\n *\n * anim.start()\n * ```\n */\nexport function spring(\n  from: number,\n  to: number,\n  config?: SpringConfig\n): SpringAnimation {\n  return new SpringAnimationImpl(from, to, config)\n}\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { spring, type SpringAnimation } from './spring.js'\n\n/**\n * Spring value interface\n */\nexport interface SpringValue {\n  /** Get current value */\n  get(): number\n  /** Get current velocity */\n  getVelocity(): number\n  /** Animate to a new value */\n  set(to: number, config?: Partial<SpringConfig>): void\n  /** Set value immediately without animation */\n  jump(to: number): void\n  /** Stop current animation at current position */\n  stop(): void\n  /** Update spring configuration */\n  setConfig(config: Partial<SpringConfig>): void\n  /** Subscribe to value changes */\n  subscribe(callback: (value: number) => void): () => void\n  /** Check if currently animating */\n  isAnimating(): boolean\n  /** Promise that resolves when current animation completes */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring value implementation\n */\nclass SpringValueImpl implements SpringValue {\n  private value: number\n  private config: SpringConfig\n  private currentAnimation: SpringAnimation | null = null\n  private subscribers = new Set<(value: number) => void>()\n  private resolveComplete: (() => void) | null = null\n  private finishedPromise: Promise<void>\n\n  constructor(initial: number, config: SpringConfig = {}) {\n    this.value = initial\n    this.config = { ...defaultConfig, ...config }\n\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  get(): number {\n    return this.value\n  }\n\n  getVelocity(): number {\n    return this.currentAnimation?.getVelocity() ?? 0\n  }\n\n  set(to: number, config: Partial<SpringConfig> = {}): void {\n    // Cancel existing animation\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n\n    // Create new promise for this animation\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n\n    // Create new animation\n    const mergedConfig = { ...this.config, ...config }\n    const originalOnUpdate = mergedConfig.onUpdate\n    const originalOnComplete = mergedConfig.onComplete\n\n    this.currentAnimation = spring(this.value, to, {\n      ...mergedConfig,\n      onUpdate: (value) => {\n        this.value = value\n        this.notify()\n        // Also call original onUpdate if provided\n        originalOnUpdate?.(value)\n      },\n      onComplete: () => {\n        originalOnComplete?.()\n        if (this.resolveComplete) {\n          this.resolveComplete()\n        }\n      },\n    })\n\n    this.currentAnimation.start()\n  }\n\n  jump(to: number): void {\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n    this.value = to\n    this.notify()\n  }\n\n  stop(): void {\n    if (this.currentAnimation) {\n      this.currentAnimation.destroy()\n      this.currentAnimation = null\n    }\n    if (this.resolveComplete) {\n      this.resolveComplete()\n    }\n  }\n\n  setConfig(config: Partial<SpringConfig>): void {\n    this.config = { ...this.config, ...config }\n  }\n\n  subscribe(callback: (value: number) => void): () => void {\n    this.subscribers.add(callback)\n\n    // Immediately call with current value\n    callback(this.value)\n\n    return () => {\n      this.subscribers.delete(callback)\n    }\n  }\n\n  isAnimating(): boolean {\n    return this.currentAnimation?.isAnimating() ?? false\n  }\n\n  get finished(): Promise<void> {\n    return this.finishedPromise\n  }\n\n  private notify(): void {\n    for (const subscriber of this.subscribers) {\n      subscriber(this.value)\n    }\n  }\n\n  destroy(): void {\n    this.currentAnimation?.destroy()\n    this.currentAnimation = null\n    this.subscribers.clear()\n  }\n}\n\n/**\n * Create a spring value\n *\n * @param initial - Initial value\n * @param config - Spring configuration\n * @returns Spring value controller\n *\n * @example\n * ```ts\n * const x = createSpringValue(0, { stiffness: 100, damping: 10 })\n *\n * x.subscribe((value) => {\n *   element.style.transform = `translateX(${value}px)`\n * })\n *\n * x.set(100) // Animates to 100\n * x.jump(0)  // Jumps to 0 immediately\n * ```\n */\nexport function createSpringValue(\n  initial: number,\n  config?: SpringConfig\n): SpringValue {\n  return new SpringValueImpl(initial, config)\n}\n\n// Re-export for type usage\nexport { SpringValueImpl as SpringValueClass }\n","import type { SpringConfig } from './config.js'\nimport { defaultConfig } from './config.js'\nimport { createSpringValue, type SpringValue } from './spring-value.js'\n\n/**\n * Spring group interface\n */\nexport interface SpringGroup<T extends Record<string, number>> {\n  /** Get all current values */\n  get(): T\n  /** Get a single value by key */\n  getValue(key: keyof T): number\n  /** Animate to new values (partial update) */\n  set(values: Partial<T>, config?: Partial<SpringConfig>): void\n  /** Set values immediately without animation */\n  jump(values: Partial<T>): void\n  /** Subscribe to value changes */\n  subscribe(callback: (values: T) => void): () => void\n  /** Check if any spring is animating */\n  isAnimating(): boolean\n  /** Promise that resolves when all animations complete */\n  finished: Promise<void>\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Spring group implementation\n */\nclass SpringGroupImpl<T extends Record<string, number>> implements SpringGroup<T> {\n  private values: Map<keyof T, SpringValue>\n  private config: SpringConfig\n  private subscribers = new Set<(values: T) => void>()\n  private resolveComplete: (() => void) | null = null\n  private finishedPromise: Promise<void>\n\n  constructor(initialValues: T, config: SpringConfig = {}) {\n    this.config = { ...defaultConfig, ...config }\n\n    // Create SpringValue for each key\n    this.values = new Map()\n    for (const [key, value] of Object.entries(initialValues)) {\n      const springValue = createSpringValue(value, this.config)\n      springValue.subscribe(() => this.notify())\n      this.values.set(key as keyof T, springValue)\n    }\n\n    this.finishedPromise = Promise.resolve()\n\n    // Initialize promise handler\n    this.resetPromise()\n  }\n\n  private resetPromise(): void {\n    this.finishedPromise = new Promise((resolve) => {\n      this.resolveComplete = resolve\n    })\n  }\n\n  get(): T {\n    const result = {} as T\n    for (const [key, springValue] of this.values) {\n      (result as Record<string, number>)[key as string] = springValue.get()\n    }\n    return result\n  }\n\n  getValue(key: keyof T): number {\n    return this.values.get(key)?.get() ?? 0\n  }\n\n  set(values: Partial<T>, config: Partial<SpringConfig> = {}): void {\n    // Reset promise for new batch of animations\n    this.resetPromise()\n\n    const promises: Promise<void>[] = []\n\n    for (const [key, value] of Object.entries(values)) {\n      const springValue = this.values.get(key as keyof T)\n      if (springValue) {\n        springValue.set(value, config)\n        promises.push(springValue.finished)\n      }\n    }\n\n    // Resolve when all animations complete\n    Promise.all(promises).then(() => {\n      if (this.resolveComplete) {\n        this.resolveComplete()\n      }\n    })\n  }\n\n  jump(values: Partial<T>): void {\n    for (const [key, value] of Object.entries(values)) {\n      const springValue = this.values.get(key as keyof T)\n      if (springValue) {\n        springValue.jump(value)\n      }\n    }\n    // Note: notify() is already called by the spring subscriptions, so we don't call it again\n  }\n\n  subscribe(callback: (values: T) => void): () => void {\n    this.subscribers.add(callback)\n    callback(this.get())\n    return () => this.subscribers.delete(callback)\n  }\n\n  isAnimating(): boolean {\n    for (const springValue of this.values.values()) {\n      if (springValue.isAnimating()) return true\n    }\n    return false\n  }\n\n  get finished(): Promise<void> {\n    return this.finishedPromise\n  }\n\n  private notify(): void {\n    const values = this.get()\n    for (const subscriber of this.subscribers) {\n      subscriber(values)\n    }\n  }\n\n  destroy(): void {\n    for (const springValue of this.values.values()) {\n      springValue.destroy()\n    }\n    this.subscribers.clear()\n  }\n}\n\n/**\n * Create a spring group for animating multiple values together\n *\n * @param initialValues - Initial values object\n * @param config - Spring configuration\n * @returns Spring group controller\n *\n * @example\n * ```ts\n * const group = createSpringGroup(\n *   { x: 0, y: 0, scale: 1 },\n *   { stiffness: 100, damping: 10 }\n * )\n *\n * group.subscribe((values) => {\n *   element.style.transform = `\n *     translate(${values.x}px, ${values.y}px)\n *     scale(${values.scale})\n *   `\n * })\n *\n * group.set({ x: 100, scale: 1.5 })\n * ```\n */\nexport function createSpringGroup<T extends Record<string, number>>(\n  initialValues: T,\n  config?: SpringConfig\n): SpringGroup<T> {\n  return new SpringGroupImpl(initialValues, config)\n}\n\n// Re-export for type usage\nexport { SpringGroupImpl as SpringGroupClass }\n","/**\n * Variants System - Named animation states with cascading support\n *\n * Provides a declarative way to define and orchestrate animations\n * across component hierarchies.\n */\n\nimport type { SpringConfig } from './config.js'\n\n// ============ Types ============\n\n/**\n * Animation values that can be animated\n */\nexport interface AnimationValues {\n  x?: number | string\n  y?: number | string\n  scale?: number\n  scaleX?: number\n  scaleY?: number\n  rotate?: number\n  rotateX?: number\n  rotateY?: number\n  rotateZ?: number\n  skewX?: number\n  skewY?: number\n  opacity?: number\n  width?: number | string\n  height?: number | string\n  backgroundColor?: string\n  borderRadius?: number | string\n  borderColor?: string\n  boxShadow?: string\n  color?: string\n  [key: string]: number | string | VariantTransition | undefined\n}\n\n/**\n * Transition configuration for a variant\n */\nexport interface VariantTransition {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Stagger children by this amount (ms) */\n  staggerChildren?: number\n  /** Delay children by this amount (ms) */\n  delayChildren?: number\n  /** Animate children before or after parent */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Custom stagger direction */\n  staggerDirection?: 1 | -1\n  /** Duration override for non-spring animations */\n  duration?: number\n  /** Easing function */\n  ease?: (t: number) => number\n}\n\n/**\n * A single variant definition\n */\nexport interface Variant extends AnimationValues {\n  transition?: VariantTransition\n}\n\n/**\n * Map of variant names to their definitions\n */\nexport interface Variants {\n  [key: string]: Variant | ((custom?: unknown) => Variant)\n}\n\n/**\n * Orchestration options for variant animations\n */\nexport interface OrchestrationOptions {\n  /** Delay before starting */\n  delay?: number\n  /** Animate children before or after */\n  when?: 'beforeChildren' | 'afterChildren' | false\n  /** Stagger children animations */\n  staggerChildren?: number\n  /** Delay before children start */\n  delayChildren?: number\n  /** Direction of stagger (-1 for reverse) */\n  staggerDirection?: 1 | -1\n}\n\n/**\n * Resolved variant with all values computed\n */\nexport interface ResolvedVariant {\n  values: AnimationValues\n  transition: VariantTransition\n}\n\n// ============ Variant Resolution ============\n\n/**\n * Resolve a variant definition to concrete values\n */\nexport function resolveVariant(\n  variant: Variant | ((custom?: unknown) => Variant) | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variant) {\n    return { values: {}, transition: {} }\n  }\n\n  // Handle function variants\n  const resolved = typeof variant === 'function' ? variant(custom) : variant\n\n  // Extract transition from values\n  const { transition = {}, ...values } = resolved\n\n  return { values, transition }\n}\n\n/**\n * Get variant from variants object by name\n */\nexport function getVariant(\n  variants: Variants | undefined,\n  name: string | undefined,\n  custom?: unknown\n): ResolvedVariant {\n  if (!variants || !name) {\n    return { values: {}, transition: {} }\n  }\n\n  return resolveVariant(variants[name], custom)\n}\n\n/**\n * Merge multiple variants together\n */\nexport function mergeVariants(...variants: (Variant | undefined)[]): Variant {\n  const merged: Variant = {}\n\n  for (const variant of variants) {\n    if (variant) {\n      Object.assign(merged, variant)\n      // Merge transitions\n      if (variant.transition) {\n        merged.transition = { ...merged.transition, ...variant.transition }\n      }\n    }\n  }\n\n  return merged\n}\n\n// ============ Animation Value Helpers ============\n\n/**\n * Check if a value is a transform property\n */\nexport function isTransformProperty(key: string): boolean {\n  return [\n    'x', 'y', 'z',\n    'scale', 'scaleX', 'scaleY', 'scaleZ',\n    'rotate', 'rotateX', 'rotateY', 'rotateZ',\n    'skew', 'skewX', 'skewY',\n    'perspective',\n    'transformOrigin',\n  ].includes(key)\n}\n\n/**\n * Check if a value is animatable\n */\nexport function isAnimatable(value: unknown): value is number | string {\n  return typeof value === 'number' || typeof value === 'string'\n}\n\n/**\n * Parse a value with unit (e.g., \"100px\" -> { value: 100, unit: \"px\" })\n */\nexport function parseValueWithUnit(value: string | number): { value: number; unit: string } {\n  if (typeof value === 'number') {\n    return { value, unit: '' }\n  }\n\n  const match = value.match(/^(-?[\\d.]+)(.*)$/)\n  if (match && match[1]) {\n    return { value: parseFloat(match[1]), unit: match[2] || '' }\n  }\n\n  return { value: 0, unit: '' }\n}\n\n/**\n * Build transform string from values\n */\nexport function buildTransformString(values: AnimationValues): string {\n  const transforms: string[] = []\n\n  if (values.x !== undefined || values.y !== undefined) {\n    const x = values.x ?? 0\n    const y = values.y ?? 0\n    transforms.push(`translate(${x}px, ${y}px)`)\n  }\n\n  if (values.scale !== undefined) {\n    transforms.push(`scale(${values.scale})`)\n  } else {\n    if (values.scaleX !== undefined) {\n      transforms.push(`scaleX(${values.scaleX})`)\n    }\n    if (values.scaleY !== undefined) {\n      transforms.push(`scaleY(${values.scaleY})`)\n    }\n  }\n\n  if (values.rotate !== undefined) {\n    transforms.push(`rotate(${values.rotate}deg)`)\n  }\n  if (values.rotateX !== undefined) {\n    transforms.push(`rotateX(${values.rotateX}deg)`)\n  }\n  if (values.rotateY !== undefined) {\n    transforms.push(`rotateY(${values.rotateY}deg)`)\n  }\n  if (values.rotateZ !== undefined) {\n    transforms.push(`rotateZ(${values.rotateZ}deg)`)\n  }\n\n  if (values.skewX !== undefined) {\n    transforms.push(`skewX(${values.skewX}deg)`)\n  }\n  if (values.skewY !== undefined) {\n    transforms.push(`skewY(${values.skewY}deg)`)\n  }\n\n  return transforms.join(' ')\n}\n\n/**\n * Apply animation values to an element's style\n */\nexport function applyValuesToElement(element: HTMLElement, values: AnimationValues): void {\n  const transform = buildTransformString(values)\n  if (transform) {\n    element.style.transform = transform\n  }\n\n  // Apply non-transform properties\n  if (values.opacity !== undefined) {\n    element.style.opacity = String(values.opacity)\n  }\n  if (values.backgroundColor !== undefined) {\n    element.style.backgroundColor = values.backgroundColor\n  }\n  if (values.borderRadius !== undefined) {\n    element.style.borderRadius =\n      typeof values.borderRadius === 'number' ? `${values.borderRadius}px` : values.borderRadius\n  }\n  if (values.borderColor !== undefined) {\n    element.style.borderColor = values.borderColor\n  }\n  if (values.boxShadow !== undefined) {\n    element.style.boxShadow = values.boxShadow\n  }\n  if (values.color !== undefined) {\n    element.style.color = values.color\n  }\n  if (values.width !== undefined) {\n    element.style.width =\n      typeof values.width === 'number' ? `${values.width}px` : values.width\n  }\n  if (values.height !== undefined) {\n    element.style.height =\n      typeof values.height === 'number' ? `${values.height}px` : values.height\n  }\n}\n\n// ============ Orchestration ============\n\n/**\n * Calculate stagger delays for children\n */\nexport function calculateStaggerDelays(\n  count: number,\n  options: OrchestrationOptions\n): number[] {\n  const { staggerChildren = 0, staggerDirection = 1, delayChildren = 0 } = options\n\n  const delays: number[] = []\n  for (let i = 0; i < count; i++) {\n    const index = staggerDirection === -1 ? count - 1 - i : i\n    delays.push(delayChildren + index * staggerChildren)\n  }\n\n  return delays\n}\n\n/**\n * Create an orchestrated animation sequence\n */\nexport interface OrchestrationSequence {\n  /** Execute parent animation */\n  parent: () => Promise<void>\n  /** Execute children animations */\n  children: () => Promise<void>\n  /** Execute all with proper ordering */\n  execute: () => Promise<void>\n}\n\nexport function createOrchestration(\n  parentAnim: () => Promise<void>,\n  childrenAnims: (() => Promise<void>)[],\n  options: OrchestrationOptions = {}\n): OrchestrationSequence {\n  const { when = false, delay = 0 } = options\n  const delays = calculateStaggerDelays(childrenAnims.length, options)\n\n  const parent = async () => {\n    if (delay > 0) {\n      await new Promise((resolve) => setTimeout(resolve, delay))\n    }\n    await parentAnim()\n  }\n\n  const children = async () => {\n    await Promise.all(\n      childrenAnims.map((anim, i) =>\n        new Promise<void>((resolve) => {\n          setTimeout(async () => {\n            await anim()\n            resolve()\n          }, delays[i])\n        })\n      )\n    )\n  }\n\n  const execute = async () => {\n    switch (when) {\n      case 'beforeChildren':\n        await parent()\n        await children()\n        break\n      case 'afterChildren':\n        await children()\n        await parent()\n        break\n      default:\n        // Run in parallel\n        await Promise.all([parent(), children()])\n    }\n  }\n\n  return { parent, children, execute }\n}\n\n// ============ Variant Presets ============\n\n/**\n * Common animation presets\n */\nexport const variantPresets: Record<string, { initial: Variant; animate: Variant; exit: Variant }> = {\n  /** Fade in from invisible */\n  fadeIn: {\n    initial: { opacity: 0 },\n    animate: { opacity: 1 },\n    exit: { opacity: 0 },\n  },\n\n  /** Fade in and slide up */\n  fadeInUp: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n\n  /** Fade in and slide down */\n  fadeInDown: {\n    initial: { opacity: 0, y: -20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: 20 },\n  },\n\n  /** Fade in and slide from left */\n  fadeInLeft: {\n    initial: { opacity: 0, x: -20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: 20 },\n  },\n\n  /** Fade in and slide from right */\n  fadeInRight: {\n    initial: { opacity: 0, x: 20 },\n    animate: { opacity: 1, x: 0 },\n    exit: { opacity: 0, x: -20 },\n  },\n\n  /** Scale up from small */\n  scaleIn: {\n    initial: { opacity: 0, scale: 0.8 },\n    animate: { opacity: 1, scale: 1 },\n    exit: { opacity: 0, scale: 0.8 },\n  },\n\n  /** Pop in with overshoot */\n  popIn: {\n    initial: { opacity: 0, scale: 0.5 },\n    animate: {\n      opacity: 1,\n      scale: 1,\n      transition: { spring: { stiffness: 400, damping: 15 } },\n    },\n    exit: { opacity: 0, scale: 0.5 },\n  },\n\n  /** Slide in from bottom (percentage-based) */\n  slideUp: {\n    initial: { y: 100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: 100, opacity: 0 },\n  },\n\n  /** Slide in from top */\n  slideDown: {\n    initial: { y: -100, opacity: 0 },\n    animate: { y: 0, opacity: 1 },\n    exit: { y: -100, opacity: 0 },\n  },\n\n  /** Slide in from left */\n  slideLeft: {\n    initial: { x: -100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: -100, opacity: 0 },\n  },\n\n  /** Slide in from right */\n  slideRight: {\n    initial: { x: 100, opacity: 0 },\n    animate: { x: 0, opacity: 1 },\n    exit: { x: 100, opacity: 0 },\n  },\n\n  /** Container with staggered children */\n  staggerContainer: {\n    initial: {},\n    animate: {\n      transition: {\n        staggerChildren: 0.1,\n        delayChildren: 0.1,\n      },\n    },\n    exit: {\n      transition: {\n        staggerChildren: 0.05,\n        staggerDirection: -1,\n      },\n    },\n  },\n\n  /** Item for staggered lists */\n  staggerItem: {\n    initial: { opacity: 0, y: 20 },\n    animate: { opacity: 1, y: 0 },\n    exit: { opacity: 0, y: -20 },\n  },\n}\n\n/**\n * Create a custom variant preset\n */\nexport function createVariantPreset(\n  initial: Variant,\n  animate: Variant,\n  exit?: Variant\n): { initial: Variant; animate: Variant; exit: Variant } {\n  return {\n    initial,\n    animate,\n    exit: exit || initial,\n  }\n}\n\n// ============ Type Guards ============\n\n/**\n * Check if a value is a Variants object\n */\nexport function isVariants(value: unknown): value is Variants {\n  return (\n    typeof value === 'object' &&\n    value !== null &&\n    !Array.isArray(value) &&\n    Object.values(value).every(\n      (v) => typeof v === 'object' || typeof v === 'function'\n    )\n  )\n}\n\n/**\n * Check if a value is a Variant\n */\nexport function isVariant(value: unknown): value is Variant {\n  return typeof value === 'object' && value !== null && !Array.isArray(value)\n}\n","import type { SpringConfig } from '../core/config.js'\nimport { defaultConfig } from '../core/config.js'\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\n\n/**\n * Trail configuration interface\n */\nexport interface TrailConfig extends SpringConfig {\n  /** Frames delay between items following each other */\n  followDelay?: number\n}\n\n/**\n * Trail interface\n */\nexport interface Trail {\n  /** Set the leader value (followers will follow with delay) */\n  set(value: number): void\n  /** Set all values immediately without animation */\n  jump(value: number): void\n  /** Get all current values */\n  getValues(): number[]\n  /** Subscribe to value changes */\n  subscribe(callback: (values: number[]) => void): () => void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Trail implementation\n * Creates a chain of springs where each spring follows the previous one\n */\nclass TrailImpl implements Trail {\n  private springs: SpringValue[]\n  private leader: SpringValue\n  private followDelay: number\n  private subscribers = new Set<(values: number[]) => void>()\n  private frameCount: number = 0\n  private pendingUpdates: Map<number, number> = new Map()\n\n  constructor(count: number, config: TrailConfig = {}) {\n    const { followDelay = 2, ...springConfig } = config\n\n    this.followDelay = followDelay\n\n    // Create leader spring\n    this.leader = createSpringValue(0, springConfig)\n\n    // Create follower springs\n    this.springs = []\n    for (let i = 0; i < count; i++) {\n      const spring = createSpringValue(0, springConfig)\n      this.springs.push(spring)\n    }\n\n    // Connect leader to followers with delay\n    this.leader.subscribe(() => {\n      this.frameCount++\n      this.scheduleFollowerUpdates()\n    })\n  }\n\n  private scheduleFollowerUpdates(): void {\n    const targetValue = this.leader.get()\n\n    for (let i = 0; i < this.springs.length; i++) {\n      const delayFrames = (i + 1) * this.followDelay\n      const targetFrame = this.frameCount + delayFrames\n\n      // Store the pending update\n      this.pendingUpdates.set(i, targetFrame)\n\n      // Schedule the update\n      this.scheduleFollowerUpdate(i, targetValue, targetFrame, delayFrames)\n    }\n  }\n\n  private scheduleFollowerUpdate(\n    index: number,\n    targetValue: number,\n    targetFrame: number,\n    delayFrames: number\n  ): void {\n    const startFrame = this.frameCount\n    const framesToWait = targetFrame - startFrame\n\n    if (framesToWait <= 0) {\n      // Update immediately if delay has passed\n      this.springs[index]!.set(targetValue)\n    } else {\n      // Use setTimeout for delay (approximately 16ms per frame at 60fps)\n      const delayMs = Math.max(framesToWait * 16, 0)\n\n      setTimeout(() => {\n        // Only update if this is still the current pending update\n        const currentTarget = this.pendingUpdates.get(index)\n        if (currentTarget === targetFrame) {\n          this.springs[index]!.set(targetValue)\n        }\n      }, delayMs)\n    }\n  }\n\n  set(value: number): void {\n    this.leader.set(value)\n  }\n\n  jump(value: number): void {\n    this.leader.jump(value)\n    for (const spring of this.springs) {\n      spring.jump(value)\n    }\n  }\n\n  getValues(): number[] {\n    return this.springs.map((s) => s.get())\n  }\n\n  subscribe(callback: (values: number[]) => void): () => void {\n    this.subscribers.add(callback)\n\n    // Subscribe to each follower spring\n    const unsubscribers: (() => void)[] = []\n    for (const spring of this.springs) {\n      unsubscribers.push(\n        spring.subscribe(() => {\n          this.notify()\n        })\n      )\n    }\n\n    // Immediately call with current values\n    callback(this.getValues())\n\n    // Return unsubscribe function\n    return () => {\n      this.subscribers.delete(callback)\n      for (const unsubscribe of unsubscribers) {\n        unsubscribe()\n      }\n    }\n  }\n\n  private notify(): void {\n    const values = this.getValues()\n    for (const subscriber of this.subscribers) {\n      subscriber(values)\n    }\n  }\n\n  destroy(): void {\n    this.leader.destroy()\n    for (const spring of this.springs) {\n      spring.destroy()\n    }\n    this.subscribers.clear()\n    this.pendingUpdates.clear()\n  }\n}\n\n/**\n * Create a trail animation\n *\n * @param count - Number of items in the trail\n * @param config - Trail configuration\n * @returns Trail controller\n *\n * @example\n * ```ts\n * const trail = createTrail(5, {\n *   stiffness: 200,\n *   damping: 25,\n *   followDelay: 3,\n * })\n *\n * trail.subscribe((values) => {\n *   elements.forEach((el, i) => {\n *     el.style.transform = `translateX(${values[i]}px)`\n *   })\n * })\n *\n * trail.set(100) // First item moves immediately, others follow\n * ```\n */\nexport function createTrail(count: number, config?: TrailConfig): Trail {\n  return new TrailImpl(count, config)\n}\n","import { defaultConfig } from '../core/config.js'\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { clamp } from '../utils/math.js'\n\n/**\n * Snap point configuration\n */\nexport interface SnapPoint {\n  x: number\n  y: number\n  /** Attraction radius (pixels) */\n  radius?: number\n}\n\n/**\n * Snap configuration\n */\nexport interface SnapConfig {\n  /** Array of snap points */\n  points?: SnapPoint[]\n  /** Snap to grid with given cell size */\n  grid?: { x: number; y: number }\n  /** Velocity threshold to snap (lower = snap more easily) */\n  velocityThreshold?: number\n  /** Whether to snap only on release */\n  snapOnRelease?: boolean\n}\n\n/**\n * Constraint configuration - supports multiple constraint types\n */\nexport interface DragConstraints {\n  /** Simple box bounds */\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n  /** Constrain to parent element */\n  constrainToParent?: boolean\n  /** Constrain to specific element */\n  constrainToElement?: HTMLElement\n  /** Padding when constrained to element */\n  constraintPadding?: number | { top?: number; right?: number; bottom?: number; left?: number }\n  /** Lock to specific axis */\n  lockAxis?: 'x' | 'y' | null\n  /** Lock to 45-degree diagonal lines */\n  lockToDiagonal?: boolean\n}\n\n/**\n * Drag spring configuration interface\n */\nexport interface DragSpringConfig {\n  /** Spring stiffness (default: 100) */\n  stiffness?: number\n  /** Damping ratio (default: 10) */\n  damping?: number\n  /** Mass (default: 1) */\n  mass?: number\n  /** Initial velocity */\n  velocity?: number\n  /** Speed threshold for considering spring at rest (default: 0.01) */\n  restSpeed?: number\n  /** Position threshold for considering spring at rest (default: 0.01) */\n  restDelta?: number\n  /** Clamp value to [from, to] range */\n  clamp?: boolean\n  /** Axis constraint (deprecated, use constraints.lockAxis) */\n  axis?: 'x' | 'y' | 'both'\n  /** Boundary constraints (deprecated, use constraints.bounds) */\n  bounds?: {\n    left?: number\n    right?: number\n    top?: number\n    bottom?: number\n  }\n  /** Enhanced constraint configuration */\n  constraints?: DragConstraints\n  /** Snap configuration */\n  snap?: SnapConfig\n  /** Enable rubber band effect at bounds */\n  rubberBand?: boolean\n  /** Rubber band stretch factor (0-1, default: 0.5) */\n  rubberBandFactor?: number\n  /** Elastic bounce power (0-1, default: 0.3) */\n  elasticBounce?: number\n  /** Momentum after release (true = continue with velocity) */\n  momentum?: boolean\n  /** Deceleration rate for momentum (0-1, default: 0.95) */\n  momentumDecay?: number\n  /** Callback called when drag starts */\n  onDragStart?: (event: PointerEvent) => void\n  /** Callback called during drag */\n  onDrag?: (x: number, y: number, event: PointerEvent) => void\n  /** Callback called when drag ends */\n  onDragEnd?: (x: number, y: number, velocity: { x: number; y: number }) => void\n  /** Callback called on position update */\n  onUpdate?: (x: number, y: number) => void\n  /** Callback when snapping to a point */\n  onSnapStart?: (point: SnapPoint) => void\n  /** Callback when snap animation completes */\n  onSnapComplete?: (point: SnapPoint) => void\n  /** Callback when hitting bounds */\n  onBoundsHit?: (edge: 'left' | 'right' | 'top' | 'bottom') => void\n}\n\n/**\n * Drag spring interface\n */\nexport interface DragSpring {\n  /** Enable drag interaction */\n  enable(): void\n  /** Disable drag interaction */\n  disable(): void\n  /** Check if currently enabled */\n  isEnabled(): boolean\n  /** Check if currently dragging */\n  isDragging(): boolean\n  /** Reset to initial position */\n  reset(): void\n  /** Get current position */\n  getPosition(): { x: number; y: number }\n  /** Get current velocity */\n  getVelocity(): { x: number; y: number }\n  /** Set position instantly */\n  setPosition(x: number, y: number): void\n  /** Jump to position (instant, alias for setPosition) */\n  jumpTo(x: number, y: number): void\n  /** Animate to position with spring physics */\n  animateTo(x: number, y: number): void\n  /** Release with velocity */\n  release(velocityX: number, velocityY: number): void\n  /** Snap to nearest point */\n  snapToNearest(): void\n  /** Snap to specific point */\n  snapTo(point: SnapPoint): void\n  /** Update constraints dynamically */\n  setConstraints(constraints: DragConstraints): void\n  /** Update snap configuration dynamically */\n  setSnap(snap: SnapConfig): void\n  /** Clean up resources */\n  destroy(): void\n}\n\n/**\n * Default drag spring configuration\n */\nconst defaultDragConfig = {\n  axis: 'both' as const,\n  rubberBand: false,\n  rubberBandFactor: 0.5,\n  elasticBounce: 0.3,\n  momentum: true,\n  momentumDecay: 0.95,\n  stiffness: 200,\n  damping: 20,\n  mass: 1,\n  restSpeed: 0.01,\n  restDelta: 0.01,\n  clamp: false,\n}\n\n/**\n * Drag spring implementation\n */\nclass DragSpringImpl implements DragSpring {\n  private element: HTMLElement\n  private config: DragSpringConfig\n  private enabled = true\n  private position = { x: 0, y: 0 }\n  private _isDragging = false\n  private startPosition = { x: 0, y: 0 }\n  private pointerStart = { x: 0, y: 0 }\n  private lastPosition = { x: 0, y: 0 }\n  private lastTime = 0\n  private velocity = { x: 0, y: 0 }\n  private currentSnap: SnapPoint | null = null\n\n  // Springs for each axis\n  private springX: SpringValue\n  private springY: SpringValue\n\n  constructor(element: HTMLElement, config: DragSpringConfig = {}) {\n    this.element = element\n    this.config = { ...defaultDragConfig, ...config }\n\n    // Extract only spring physics config for createSpringValue\n    const springConfig = {\n      stiffness: this.config.stiffness,\n      damping: this.config.damping,\n      mass: this.config.mass,\n      restSpeed: this.config.restSpeed,\n      restDelta: this.config.restDelta,\n      clamp: this.config.clamp,\n    }\n\n    this.springX = createSpringValue(0, springConfig)\n    this.springY = createSpringValue(0, springConfig)\n\n    // Subscribe to spring updates\n    this.springX.subscribe(() => {\n      if (!this._isDragging) {\n        this.position.x = this.springX.get()\n        if (this.config.onUpdate) {\n          this.config.onUpdate(this.position.x, this.position.y)\n        }\n      }\n    })\n\n    this.springY.subscribe(() => {\n      if (!this._isDragging) {\n        this.position.y = this.springY.get()\n        if (this.config.onUpdate) {\n          this.config.onUpdate(this.position.x, this.position.y)\n        }\n      }\n    })\n\n    this.setupPointerEvents()\n  }\n\n  private setupPointerEvents(): void {\n    this.element.addEventListener('pointerdown', this.onPointerDown)\n  }\n\n  private onPointerDown = (e: PointerEvent): void => {\n    if (!this.enabled || e.button !== 0) return\n\n    this._isDragging = true\n    this.startPosition = { ...this.position }\n    this.pointerStart = { x: e.clientX, y: e.clientY }\n    this.lastPosition = { x: e.clientX, y: e.clientY }\n    this.lastTime = performance.now()\n    this.velocity = { x: 0, y: 0 }\n\n    this.element.setPointerCapture(e.pointerId)\n    this.element.addEventListener('pointermove', this.onPointerMove)\n    this.element.addEventListener('pointerup', this.onPointerUp)\n    this.element.addEventListener('pointercancel', this.onPointerUp)\n\n    // Explicit if for better branch coverage\n    if (this.config.onDragStart) {\n      this.config.onDragStart(e)\n    }\n  }\n\n  private onPointerMove = (e: PointerEvent): void => {\n    const now = performance.now()\n    const dt = now - this.lastTime\n\n    // Calculate velocity (pixels per ms, scaled to pixels per second)\n    this.velocity = {\n      x: (e.clientX - this.lastPosition.x) / Math.max(dt, 1),\n      y: (e.clientY - this.lastPosition.y) / Math.max(dt, 1),\n    }\n\n    this.lastPosition = { x: e.clientX, y: e.clientY }\n    this.lastTime = now\n\n    // Calculate new position\n    let newX = this.startPosition.x + (e.clientX - this.pointerStart.x)\n    let newY = this.startPosition.y + (e.clientY - this.pointerStart.y)\n\n    // Apply bounds with rubber band\n    if (this.config.bounds) {\n      newX = this.applyBounds(\n        newX,\n        this.config.bounds.left ?? -Infinity,\n        this.config.bounds.right ?? Infinity\n      )\n      newY = this.applyBounds(\n        newY,\n        this.config.bounds.top ?? -Infinity,\n        this.config.bounds.bottom ?? Infinity\n      )\n    }\n\n    // Apply axis constraint\n    if (this.config.axis === 'x') {\n      newY = 0\n    } else if (this.config.axis === 'y') {\n      newX = 0\n    }\n\n    this.position = { x: newX, y: newY }\n    if (this.config.onDrag) {\n      this.config.onDrag(newX, newY, e)\n    }\n    if (this.config.onUpdate) {\n      this.config.onUpdate(newX, newY)\n    }\n  }\n\n  private applyBounds(value: number, min: number, max: number): number {\n    if (!isFinite(min) && !isFinite(max)) return value\n\n    const actualMin = isFinite(min) ? min : -Infinity\n    const actualMax = isFinite(max) ? max : Infinity\n\n    if (this.config.rubberBand) {\n      const factor = this.config.rubberBandFactor || 0.5\n      if (value < actualMin) {\n        return actualMin - (actualMin - value) * factor\n      }\n      if (value > actualMax) {\n        return actualMax + (value - actualMax) * factor\n      }\n    }\n\n    return clamp(value, actualMin, actualMax)\n  }\n\n  private onPointerUp = (e: PointerEvent): void => {\n    this._isDragging = false\n\n    this.element.releasePointerCapture(e.pointerId)\n    this.element.removeEventListener('pointermove', this.onPointerMove)\n    this.element.removeEventListener('pointerup', this.onPointerUp)\n    this.element.removeEventListener('pointercancel', this.onPointerUp)\n\n    // Check for snap points first\n    if (this.config.snap?.snapOnRelease !== false) {\n      const snapPoint = this.findNearestSnapPoint()\n      if (snapPoint) {\n        this.snapTo(snapPoint)\n        if (this.config.onDragEnd) {\n          this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\n        }\n        return\n      }\n    }\n\n    // Scale velocity for spring (convert from pixels/ms to more reasonable units)\n    this.release(this.velocity.x * 16, this.velocity.y * 16)\n\n    if (this.config.onDragEnd) {\n      this.config.onDragEnd(this.position.x, this.position.y, this.velocity)\n    }\n  }\n\n  private findNearestSnapPoint(): SnapPoint | null {\n    const snap = this.config.snap\n    if (!snap) return null\n\n    // Check grid snapping first\n    if (snap.grid) {\n      const gridX = Math.round(this.position.x / snap.grid.x) * snap.grid.x\n      const gridY = Math.round(this.position.y / snap.grid.y) * snap.grid.y\n      return { x: gridX, y: gridY }\n    }\n\n    // Check snap points\n    if (snap.points && snap.points.length > 0) {\n      const velocityMagnitude = Math.sqrt(this.velocity.x ** 2 + this.velocity.y ** 2)\n      const threshold = snap.velocityThreshold ?? 0.5\n\n      // Don't snap if moving too fast\n      if (velocityMagnitude > threshold) return null\n\n      let nearestPoint: SnapPoint | null = null\n      let nearestDistance = Infinity\n\n      for (const point of snap.points) {\n        const dx = this.position.x - point.x\n        const dy = this.position.y - point.y\n        const distance = Math.sqrt(dx * dx + dy * dy)\n        const radius = point.radius ?? 50\n\n        if (distance < radius && distance < nearestDistance) {\n          nearestDistance = distance\n          nearestPoint = point\n        }\n      }\n\n      return nearestPoint\n    }\n\n    return null\n  }\n\n  private getEffectiveBounds(): { left: number; right: number; top: number; bottom: number } {\n    // Start with explicit bounds\n    const bounds = {\n      left: this.config.bounds?.left ?? this.config.constraints?.bounds?.left ?? -Infinity,\n      right: this.config.bounds?.right ?? this.config.constraints?.bounds?.right ?? Infinity,\n      top: this.config.bounds?.top ?? this.config.constraints?.bounds?.top ?? -Infinity,\n      bottom: this.config.bounds?.bottom ?? this.config.constraints?.bounds?.bottom ?? Infinity,\n    }\n\n    const constraints = this.config.constraints\n\n    // Handle constrainToParent\n    if (constraints?.constrainToParent && this.element.parentElement) {\n      const parent = this.element.parentElement\n      const parentRect = parent.getBoundingClientRect()\n      const elementRect = this.element.getBoundingClientRect()\n\n      const padding = this.normalizePadding(constraints.constraintPadding)\n\n      bounds.left = Math.max(bounds.left, padding.left)\n      bounds.right = Math.min(bounds.right, parentRect.width - elementRect.width - padding.right)\n      bounds.top = Math.max(bounds.top, padding.top)\n      bounds.bottom = Math.min(bounds.bottom, parentRect.height - elementRect.height - padding.bottom)\n    }\n\n    // Handle constrainToElement\n    if (constraints?.constrainToElement) {\n      const constraintRect = constraints.constrainToElement.getBoundingClientRect()\n      const elementRect = this.element.getBoundingClientRect()\n      const parentRect = this.element.parentElement?.getBoundingClientRect() ?? { left: 0, top: 0 }\n\n      const padding = this.normalizePadding(constraints.constraintPadding)\n\n      const offsetX = constraintRect.left - parentRect.left\n      const offsetY = constraintRect.top - parentRect.top\n\n      bounds.left = Math.max(bounds.left, offsetX + padding.left)\n      bounds.right = Math.min(bounds.right, offsetX + constraintRect.width - elementRect.width - padding.right)\n      bounds.top = Math.max(bounds.top, offsetY + padding.top)\n      bounds.bottom = Math.min(bounds.bottom, offsetY + constraintRect.height - elementRect.height - padding.bottom)\n    }\n\n    return bounds\n  }\n\n  private normalizePadding(padding: number | { top?: number; right?: number; bottom?: number; left?: number } | undefined): { top: number; right: number; bottom: number; left: number } {\n    if (typeof padding === 'number') {\n      return { top: padding, right: padding, bottom: padding, left: padding }\n    }\n    return {\n      top: padding?.top ?? 0,\n      right: padding?.right ?? 0,\n      bottom: padding?.bottom ?? 0,\n      left: padding?.left ?? 0,\n    }\n  }\n\n  enable(): void {\n    this.enabled = true\n  }\n\n  disable(): void {\n    this.enabled = false\n    if (this._isDragging) {\n      this._isDragging = false\n    }\n  }\n\n  isEnabled(): boolean {\n    return this.enabled\n  }\n\n  isDragging(): boolean {\n    return this._isDragging\n  }\n\n  reset(): void {\n    this.springX.jump(0)\n    this.springY.jump(0)\n    this.position = { x: 0, y: 0 }\n    this.velocity = { x: 0, y: 0 }\n    this.currentSnap = null\n    // Explicit if for better branch coverage\n    if (this.config.onUpdate) {\n      this.config.onUpdate(0, 0)\n    }\n  }\n\n  getPosition(): { x: number; y: number } {\n    return { ...this.position }\n  }\n\n  getVelocity(): { x: number; y: number } {\n    return { ...this.velocity }\n  }\n\n  setPosition(x: number, y: number): void {\n    // Instant position change (same as jumpTo for backwards compatibility)\n    this.position = { x, y }\n    this.springX.jump(x)\n    this.springY.jump(y)\n  }\n\n  jumpTo(x: number, y: number): void {\n    // Update position immediately for synchronous access\n    this.position = { x, y }\n    this.springX.jump(x)\n    this.springY.jump(y)\n    if (this.config.onUpdate) {\n      this.config.onUpdate(x, y)\n    }\n  }\n\n  animateTo(x: number, y: number): void {\n    // Animate to the position with spring physics\n    this.springX.set(x)\n    this.springY.set(y)\n  }\n\n  release(velocityX: number, velocityY: number): void {\n    const bounds = this.getEffectiveBounds()\n    const { left, right, top, bottom } = bounds\n\n    let targetX = this.position.x\n    let targetY = this.position.y\n\n    // Apply momentum if enabled\n    if (this.config.momentum) {\n      const decay = this.config.momentumDecay ?? 0.95\n      const momentumX = velocityX * (1 / (1 - decay)) * 0.1\n      const momentumY = velocityY * (1 / (1 - decay)) * 0.1\n      targetX += momentumX\n      targetY += momentumY\n    }\n\n    // Clamp to bounds\n    targetX = clamp(targetX, left, right)\n    targetY = clamp(targetY, top, bottom)\n\n    // Notify bounds hit\n    if (this.config.onBoundsHit) {\n      if (this.position.x < left) this.config.onBoundsHit('left')\n      if (this.position.x > right) this.config.onBoundsHit('right')\n      if (this.position.y < top) this.config.onBoundsHit('top')\n      if (this.position.y > bottom) this.config.onBoundsHit('bottom')\n    }\n\n    // Animate to target with elastic bounce\n    if (targetX !== this.position.x || this.position.x < left || this.position.x > right) {\n      this.springX.set(targetX, { velocity: velocityX })\n    }\n    if (targetY !== this.position.y || this.position.y < top || this.position.y > bottom) {\n      this.springY.set(targetY, { velocity: velocityY })\n    }\n  }\n\n  snapToNearest(): void {\n    const snapPoint = this.findNearestSnapPoint()\n    if (snapPoint) {\n      this.snapTo(snapPoint)\n    }\n  }\n\n  snapTo(point: SnapPoint): void {\n    this.currentSnap = point\n    if (this.config.onSnapStart) {\n      this.config.onSnapStart(point)\n    }\n\n    this.springX.set(point.x)\n    this.springY.set(point.y)\n\n    // Simple completion detection\n    setTimeout(() => {\n      if (this.currentSnap === point && this.config.onSnapComplete) {\n        this.config.onSnapComplete(point)\n      }\n    }, 500)\n  }\n\n  setConstraints(constraints: DragConstraints): void {\n    this.config.constraints = constraints\n  }\n\n  setSnap(snap: SnapConfig): void {\n    this.config.snap = snap\n  }\n\n  destroy(): void {\n    this.element.removeEventListener('pointerdown', this.onPointerDown)\n    this.springX.destroy()\n    this.springY.destroy()\n  }\n}\n\n/**\n * Create a drag spring\n *\n * @param element - HTML element to make draggable\n * @param config - Drag spring configuration\n * @returns Drag spring controller\n *\n * @example\n * ```ts\n * const drag = createDragSpring(element, {\n *   onUpdate: (x, y) => {\n *     element.style.transform = `translate(${x}px, ${y}px)`\n *   },\n * })\n * ```\n */\nexport function createDragSpring(\n  element: HTMLElement,\n  config?: DragSpringConfig\n): DragSpring {\n  return new DragSpringImpl(element, config)\n}\n","import type { SpringValue } from '../core/spring-value.js'\n\n/**\n * RGB color representation\n */\nexport interface RGB {\n  r: number\n  g: number\n  b: number\n}\n\n/**\n * HSL color representation\n */\nexport interface HSL {\n  h: number\n  s: number\n  l: number\n}\n\n/**\n * Parse a color string to RGB\n * Supports hex (#rgb, #rrggbb), rgb(), and named colors\n * @param color - The color string to parse\n * @returns The RGB representation\n */\nexport function parseColor(color: string): RGB {\n  // Try hex format first\n  const hexMatch = color.match(/^#([0-9a-f]{3}|[0-9a-f]{6})$/i)\n  if (hexMatch) {\n    return hexToRgb(color)\n  }\n\n  // Try rgb() format\n  const rgbMatch = color.match(/rgb\\((\\d+),\\s*(\\d+),\\s*(\\d+)\\)/i)\n  if (rgbMatch) {\n    return {\n      r: parseInt(rgbMatch[1]!, 10),\n      g: parseInt(rgbMatch[2]!, 10),\n      b: parseInt(rgbMatch[3]!, 10),\n    }\n  }\n\n  // Try rgba() format\n  const rgbaMatch = color.match(/rgba\\((\\d+),\\s*(\\d+),\\s*(\\d+),\\s*[\\d.]+\\)/i)\n  if (rgbaMatch) {\n    return {\n      r: parseInt(rgbaMatch[1]!, 10),\n      g: parseInt(rgbaMatch[2]!, 10),\n      b: parseInt(rgbaMatch[3]!, 10),\n    }\n  }\n\n  // Try hsl() format\n  const hslMatch = color.match(/hsl\\((\\d+),\\s*(\\d+)%,\\s*(\\d+)%\\)/i)\n  if (hslMatch) {\n    return hslToRgb(\n      parseInt(hslMatch[1]!, 10),\n      parseInt(hslMatch[2]!, 10),\n      parseInt(hslMatch[3]!, 10)\n    )\n  }\n\n  // Default to black for unknown formats\n  return { r: 0, g: 0, b: 0 }\n}\n\n/**\n * Convert RGB to hex color string\n * @param r - Red component (0-255)\n * @param g - Green component (0-255)\n * @param b - Blue component (0-255)\n * @returns Hex color string\n */\nexport function rgbToHex(r: number, g: number, b: number): string {\n  const toHex = (n: number): string => {\n    const clamped = Math.round(Math.max(0, Math.min(255, n)))\n    return clamped.toString(16).padStart(2, '0')\n  }\n  return `#${toHex(r)}${toHex(g)}${toHex(b)}`\n}\n\n/**\n * Convert hex color string to RGB\n * @param hex - Hex color string (with or without #)\n * @returns RGB representation\n */\nexport function hexToRgb(hex: string): RGB {\n  const cleanHex = hex.replace('#', '')\n\n  if (cleanHex.length === 3) {\n    return {\n      r: parseInt(cleanHex.charAt(0) + cleanHex.charAt(0), 16),\n      g: parseInt(cleanHex.charAt(1) + cleanHex.charAt(1), 16),\n      b: parseInt(cleanHex.charAt(2) + cleanHex.charAt(2), 16),\n    }\n  }\n\n  return {\n    r: parseInt(cleanHex.slice(0, 2), 16),\n    g: parseInt(cleanHex.slice(2, 4), 16),\n    b: parseInt(cleanHex.slice(4, 6), 16),\n  }\n}\n\n/**\n * Convert HSL to RGB\n * @param h - Hue (0-360)\n * @param s - Saturation (0-100)\n * @param l - Lightness (0-100)\n * @returns RGB representation\n */\nexport function hslToRgb(h: number, s: number, l: number): RGB {\n  h = ((h % 360) + 360) % 360\n  s = Math.max(0, Math.min(100, s)) / 100\n  l = Math.max(0, Math.min(100, l)) / 100\n\n  if (s === 0) {\n    const gray = Math.round(l * 255)\n    return { r: gray, g: gray, b: gray }\n  }\n\n  const hue2rgb = (p: number, q: number, t: number): number => {\n    if (t < 0) t += 1\n    if (t > 1) t -= 1\n    if (t < 1 / 6) return p + (q - p) * 6 * t\n    if (t < 1 / 2) return q\n    if (t < 2 / 3) return p + (q - p) * (2 / 3 - t) * 6\n    return p\n  }\n\n  const q = l < 0.5 ? l * (1 + s) : l + s - l * s\n  const p = 2 * l - q\n\n  return {\n    r: Math.round(hue2rgb(p, q, h / 360 + 1 / 3) * 255),\n    g: Math.round(hue2rgb(p, q, h / 360) * 255),\n    b: Math.round(hue2rgb(p, q, h / 360 - 1 / 3) * 255),\n  }\n}\n\n/**\n * Convert RGB to HSL\n * @param r - Red component (0-255)\n * @param g - Green component (0-255)\n * @param b - Blue component (0-255)\n * @returns HSL representation\n */\nexport function rgbToHsl(r: number, g: number, b: number): HSL {\n  r = Math.max(0, Math.min(255, r)) / 255\n  g = Math.max(0, Math.min(255, g)) / 255\n  b = Math.max(0, Math.min(255, b)) / 255\n\n  const max = Math.max(r, g, b)\n  const min = Math.min(r, g, b)\n  const delta = max - min\n\n  let h = 0\n  let s = 0\n\n  if (delta !== 0) {\n    s = (max + min) / 2 > 0.5\n      ? delta / (2 - max - min)\n      : delta / (max + min)\n\n    if (max === r) {\n      h = ((g - b) / delta + (g < b ? 6 : 0)) / 6\n    } else if (max === g) {\n      h = ((b - r) / delta + 2) / 6\n    } else {\n      h = ((r - g) / delta + 4) / 6\n    }\n  }\n\n  return {\n    h: Math.round(h * 360),\n    s: Math.round(s * 100),\n    l: Math.round(((max + min) / 2) * 100),\n  }\n}\n","/**\n * Scroll-linked animations - Bind animations directly to scroll position\n *\n * Unlike spring-based scroll animations, these animations are directly\n * tied to scroll progress (0-1) for precise control.\n */\n\nimport { clamp, lerp } from '../utils/math.js'\nimport { parseColor, rgbToHex } from '../utils/color.js'\n\n/**\n * Simple color lerp for scroll-linked animations\n */\nfunction lerpColor(colorA: string, colorB: string, t: number): string {\n  const a = parseColor(colorA)\n  const b = parseColor(colorB)\n  return rgbToHex(\n    Math.round(lerp(a.r, b.r, t)),\n    Math.round(lerp(a.g, b.g, t)),\n    Math.round(lerp(a.b, b.b, t))\n  )\n}\n\n/**\n * Scroll progress info passed to callbacks\n */\nexport interface ScrollInfo {\n  /** Progress from 0 to 1 */\n  progress: number\n  /** Absolute scroll position in pixels */\n  scrollY: number\n  /** Scroll velocity in pixels per second */\n  velocity: number\n  /** Scroll direction: 1 = down, -1 = up, 0 = stationary */\n  direction: -1 | 0 | 1\n  /** Whether element is in viewport */\n  isInView: boolean\n  /** How much of the element is visible (0-1) */\n  visibleRatio: number\n}\n\n/**\n * Scroll trigger configuration\n */\nexport interface ScrollTriggerConfig {\n  /** Start trigger position: 'top', 'center', 'bottom', or pixel value */\n  start?: 'top' | 'center' | 'bottom' | number\n  /** End trigger position: 'top', 'center', 'bottom', or pixel value */\n  end?: 'top' | 'center' | 'bottom' | number\n  /** Offset from start position in pixels */\n  startOffset?: number\n  /** Offset from end position in pixels */\n  endOffset?: number\n  /** Callback when entering viewport */\n  onEnter?: (info: ScrollInfo) => void\n  /** Callback when leaving viewport */\n  onLeave?: (info: ScrollInfo) => void\n  /** Callback on progress update */\n  onProgress?: (info: ScrollInfo) => void\n  /** Only trigger once */\n  once?: boolean\n  /** Scrub animation to scroll (true = instant, number = smoothing factor) */\n  scrub?: boolean | number\n}\n\n/**\n * Parallax configuration\n */\nexport interface ParallaxConfig {\n  /** Speed multiplier (negative = opposite direction) */\n  speed?: number\n  /** Direction of parallax effect */\n  direction?: 'vertical' | 'horizontal'\n  /** Easing function */\n  easing?: (t: number) => number\n  /** Root margin for intersection observer */\n  rootMargin?: string\n}\n\n/**\n * Scroll-linked value configuration\n */\nexport interface ScrollLinkedConfig {\n  /** Input range (scroll positions or progress values) */\n  inputRange: number[]\n  /** Output range (values to interpolate between) */\n  outputRange: (number | string)[]\n  /** Clamp output to range */\n  clamp?: boolean\n  /** Use smooth interpolation */\n  smooth?: number\n  /** Easing function */\n  easing?: (t: number) => number\n}\n\n/**\n * Scroll progress tracker\n */\nexport interface ScrollProgress {\n  /** Get current progress (0-1) */\n  get(): number\n  /** Get current scroll info */\n  getInfo(): ScrollInfo\n  /** Subscribe to progress changes */\n  subscribe(callback: (info: ScrollInfo) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Parallax controller\n */\nexport interface Parallax {\n  /** Get current offset */\n  getOffset(): number\n  /** Update parallax (call on scroll) */\n  update(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Scroll trigger controller\n */\nexport interface ScrollTrigger {\n  /** Check if currently active */\n  isActive(): boolean\n  /** Get current progress within trigger range */\n  getProgress(): number\n  /** Refresh trigger calculations */\n  refresh(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Scroll-linked value controller\n */\nexport interface ScrollLinkedValue {\n  /** Get current interpolated value */\n  get(): number | string\n  /** Subscribe to value changes */\n  subscribe(callback: (value: number | string) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Implementation ============\n\n/**\n * Create scroll progress tracker for an element\n */\nexport function createScrollProgress(\n  element?: HTMLElement | null,\n  options: {\n    offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\n    smooth?: number\n  } = {}\n): ScrollProgress {\n  const { offset = ['start', 'end'], smooth = 0 } = options\n\n  let progress = 0\n  let smoothedProgress = 0\n  let lastScrollY = 0\n  let lastTime = performance.now()\n  let velocity = 0\n  let direction: -1 | 0 | 1 = 0\n  let rafId: number | null = null\n  const subscribers = new Set<(info: ScrollInfo) => void>()\n\n  const calculateProgress = (): ScrollInfo => {\n    const scrollY = window.scrollY\n    const windowHeight = window.innerHeight\n    const now = performance.now()\n    const dt = Math.max(now - lastTime, 1)\n\n    // Calculate velocity and direction\n    velocity = ((scrollY - lastScrollY) / dt) * 1000\n    direction = scrollY > lastScrollY ? 1 : scrollY < lastScrollY ? -1 : 0\n    lastScrollY = scrollY\n    lastTime = now\n\n    let newProgress: number\n    let isInView = true\n    let visibleRatio = 1\n\n    if (element) {\n      const rect = element.getBoundingClientRect()\n      const elementTop = rect.top + scrollY\n      const elementHeight = rect.height\n\n      // Calculate start and end points based on offset\n      const startPoint = offset[0] === 'start' ? elementTop :\n                        offset[0] === 'center' ? elementTop + elementHeight / 2 :\n                        elementTop + elementHeight\n\n      const endPoint = offset[1] === 'start' ? windowHeight :\n                      offset[1] === 'center' ? windowHeight / 2 :\n                      0\n\n      const scrollStart = startPoint - windowHeight\n      const scrollEnd = startPoint - endPoint\n\n      newProgress = clamp((scrollY - scrollStart) / (scrollEnd - scrollStart), 0, 1)\n\n      // Check if in view\n      isInView = rect.top < windowHeight && rect.bottom > 0\n      visibleRatio = isInView ?\n        clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0\n    } else {\n      // Track overall page scroll\n      const documentHeight = document.documentElement.scrollHeight - windowHeight\n      newProgress = documentHeight > 0 ? clamp(scrollY / documentHeight, 0, 1) : 0\n    }\n\n    // Apply smoothing\n    if (smooth > 0) {\n      smoothedProgress = lerp(smoothedProgress, newProgress, 1 - smooth)\n      progress = smoothedProgress\n    } else {\n      progress = newProgress\n    }\n\n    return {\n      progress,\n      scrollY,\n      velocity,\n      direction,\n      isInView,\n      visibleRatio,\n    }\n  }\n\n  const notify = (info: ScrollInfo) => {\n    subscribers.forEach(cb => cb(info))\n  }\n\n  const onScroll = () => {\n    if (rafId) return\n    rafId = requestAnimationFrame(() => {\n      rafId = null\n      const info = calculateProgress()\n      notify(info)\n    })\n  }\n\n  // Initial calculation\n  const initialInfo = calculateProgress()\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n  window.addEventListener('resize', onScroll, { passive: true })\n\n  return {\n    get: () => progress,\n    getInfo: () => calculateProgress(),\n    subscribe: (callback) => {\n      subscribers.add(callback)\n      callback(initialInfo)\n      return () => subscribers.delete(callback)\n    },\n    destroy: () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      window.removeEventListener('scroll', onScroll)\n      window.removeEventListener('resize', onScroll)\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Create parallax effect for an element\n *\n * @example\n * ```ts\n * const parallax = createParallax(element, { speed: 0.5 })\n * // Element moves at 50% scroll speed\n * ```\n */\nexport function createParallax(\n  element: HTMLElement,\n  config: ParallaxConfig = {}\n): Parallax {\n  const {\n    speed = 0.5,\n    direction = 'vertical',\n    easing = (t: number) => t,\n    rootMargin = '0px',\n  } = config\n\n  let offset = 0\n  let isInView = false\n  let observer: IntersectionObserver | null = null\n\n  const update = () => {\n    if (!isInView) return\n\n    const rect = element.getBoundingClientRect()\n    const windowHeight = window.innerHeight\n\n    // Calculate how far through the viewport the element is\n    const elementCenter = rect.top + rect.height / 2\n    const viewportCenter = windowHeight / 2\n    const distanceFromCenter = elementCenter - viewportCenter\n\n    // Apply speed and easing\n    const normalizedDistance = distanceFromCenter / windowHeight\n    const easedDistance = easing(Math.abs(normalizedDistance)) * Math.sign(normalizedDistance)\n    offset = easedDistance * speed * 100\n\n    // Apply transform\n    if (direction === 'vertical') {\n      element.style.transform = `translate3d(0, ${offset}px, 0)`\n    } else {\n      element.style.transform = `translate3d(${offset}px, 0, 0)`\n    }\n  }\n\n  // Use IntersectionObserver for performance\n  observer = new IntersectionObserver(\n    (entries) => {\n      const entry = entries[0]\n      if (entry) {\n        isInView = entry.isIntersecting\n        if (isInView) update()\n      }\n    },\n    { rootMargin }\n  )\n  observer.observe(element)\n\n  const onScroll = () => {\n    if (isInView) {\n      requestAnimationFrame(update)\n    }\n  }\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n\n  return {\n    getOffset: () => offset,\n    update,\n    destroy: () => {\n      observer?.disconnect()\n      window.removeEventListener('scroll', onScroll)\n      element.style.transform = ''\n    },\n  }\n}\n\n/**\n * Create scroll trigger for precise scroll-based animations\n *\n * @example\n * ```ts\n * const trigger = createScrollTrigger(element, {\n *   start: 'top',\n *   end: 'bottom',\n *   onProgress: (info) => {\n *     element.style.opacity = String(info.progress)\n *   },\n * })\n * ```\n */\nexport function createScrollTrigger(\n  element: HTMLElement,\n  config: ScrollTriggerConfig = {}\n): ScrollTrigger {\n  const {\n    start = 'top',\n    end = 'bottom',\n    startOffset = 0,\n    endOffset = 0,\n    onEnter,\n    onLeave,\n    onProgress,\n    once = false,\n    scrub = false,\n  } = config\n\n  let isActive = false\n  let progress = 0\n  let hasEntered = false\n  let smoothedProgress = 0\n  let rafId: number | null = null\n\n  const getPosition = (pos: 'top' | 'center' | 'bottom' | number, rect: DOMRect): number => {\n    if (typeof pos === 'number') return pos\n    switch (pos) {\n      case 'top': return rect.top\n      case 'center': return rect.top + rect.height / 2\n      case 'bottom': return rect.bottom\n    }\n  }\n\n  const calculateProgress = (): ScrollInfo => {\n    const rect = element.getBoundingClientRect()\n    const windowHeight = window.innerHeight\n\n    const startPos = getPosition(start, rect) + startOffset\n    const endPos = getPosition(end, rect) + endOffset\n\n    // Calculate progress based on viewport position\n    const triggerStart = windowHeight\n    const triggerEnd = 0\n\n    const startProgress = (triggerStart - startPos) / (triggerStart - triggerEnd)\n    const endProgress = (triggerStart - endPos) / (triggerStart - triggerEnd)\n\n    const rawProgress = clamp(startProgress / (endProgress || 1), 0, 1)\n\n    // Apply scrub smoothing\n    if (typeof scrub === 'number' && scrub > 0) {\n      smoothedProgress = lerp(smoothedProgress, rawProgress, 1 - scrub)\n      progress = smoothedProgress\n    } else {\n      progress = rawProgress\n    }\n\n    const isInView = rect.top < windowHeight && rect.bottom > 0\n    const nowActive = progress > 0 && progress < 1\n\n    return {\n      progress,\n      scrollY: window.scrollY,\n      velocity: 0,\n      direction: 0,\n      isInView,\n      visibleRatio: isInView ? clamp((Math.min(rect.bottom, windowHeight) - Math.max(rect.top, 0)) / rect.height, 0, 1) : 0,\n    }\n  }\n\n  const onScroll = () => {\n    if (rafId) return\n    rafId = requestAnimationFrame(() => {\n      rafId = null\n      const info = calculateProgress()\n\n      // Check for enter/leave\n      const wasActive = isActive\n      isActive = info.progress > 0 && info.progress < 1\n\n      if (!wasActive && isActive && (!once || !hasEntered)) {\n        hasEntered = true\n        onEnter?.(info)\n      }\n\n      if (wasActive && !isActive) {\n        onLeave?.(info)\n      }\n\n      if (isActive || scrub) {\n        onProgress?.(info)\n      }\n    })\n  }\n\n  window.addEventListener('scroll', onScroll, { passive: true })\n  window.addEventListener('resize', onScroll, { passive: true })\n\n  // Initial check\n  onScroll()\n\n  return {\n    isActive: () => isActive,\n    getProgress: () => progress,\n    refresh: () => {\n      calculateProgress()\n    },\n    destroy: () => {\n      if (rafId) cancelAnimationFrame(rafId)\n      window.removeEventListener('scroll', onScroll)\n      window.removeEventListener('resize', onScroll)\n    },\n  }\n}\n\n/**\n * Create a scroll-linked interpolated value\n *\n * @example\n * ```ts\n * const opacity = createScrollLinkedValue(scrollProgress, {\n *   inputRange: [0, 0.5, 1],\n *   outputRange: [0, 1, 0],\n * })\n *\n * opacity.subscribe((value) => {\n *   element.style.opacity = String(value)\n * })\n * ```\n */\nexport function createScrollLinkedValue(\n  scrollProgress: ScrollProgress,\n  config: ScrollLinkedConfig\n): ScrollLinkedValue {\n  const { inputRange, outputRange, clamp: shouldClamp = true, easing } = config\n\n  if (inputRange.length !== outputRange.length) {\n    throw new Error('inputRange and outputRange must have the same length')\n  }\n\n  const firstOutput = outputRange[0]\n  const isColorOutput = typeof firstOutput === 'string' &&\n    (firstOutput.startsWith('#') || firstOutput.startsWith('rgb') || firstOutput.startsWith('hsl'))\n\n  let currentValue: number | string = firstOutput ?? 0\n  const subscribers = new Set<(value: number | string) => void>()\n\n  const interpolate = (progress: number): number | string => {\n    let p = progress\n    if (easing) p = easing(p)\n    const firstInput = inputRange[0] ?? 0\n    const lastInput = inputRange[inputRange.length - 1] ?? 1\n    if (shouldClamp) p = clamp(p, firstInput, lastInput)\n\n    // Find the segment\n    let segmentIndex = 0\n    for (let i = 0; i < inputRange.length - 1; i++) {\n      const curr = inputRange[i] ?? 0\n      const next = inputRange[i + 1] ?? 1\n      if (p >= curr && p <= next) {\n        segmentIndex = i\n        break\n      }\n      if (p > next) {\n        segmentIndex = i + 1\n      }\n    }\n\n    const segmentStart = inputRange[segmentIndex] ?? 0\n    const segmentEnd = inputRange[segmentIndex + 1] ?? segmentStart\n    const segmentProgress = segmentEnd !== segmentStart\n      ? (p - segmentStart) / (segmentEnd - segmentStart)\n      : 0\n\n    const startValue = outputRange[segmentIndex] ?? 0\n    const endValue = outputRange[segmentIndex + 1] ?? startValue\n\n    if (isColorOutput && typeof startValue === 'string' && typeof endValue === 'string') {\n      return lerpColor(startValue, endValue, segmentProgress)\n    }\n\n    return lerp(startValue as number, endValue as number, segmentProgress)\n  }\n\n  const unsubscribe = scrollProgress.subscribe((info) => {\n    currentValue = interpolate(info.progress)\n    subscribers.forEach(cb => cb(currentValue))\n  })\n\n  return {\n    get: () => currentValue,\n    subscribe: (callback) => {\n      subscribers.add(callback)\n      callback(currentValue)\n      return () => subscribers.delete(callback)\n    },\n    destroy: () => {\n      unsubscribe()\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Easing functions for scroll-linked animations\n */\nexport const scrollEasings = {\n  linear: (t: number) => t,\n  easeIn: (t: number) => t * t,\n  easeOut: (t: number) => t * (2 - t),\n  easeInOut: (t: number) => t < 0.5 ? 2 * t * t : -1 + (4 - 2 * t) * t,\n  easeInCubic: (t: number) => t * t * t,\n  easeOutCubic: (t: number) => (--t) * t * t + 1,\n  easeInOutCubic: (t: number) => t < 0.5 ? 4 * t * t * t : (t - 1) * (2 * t - 2) * (2 * t - 2) + 1,\n  easeInQuart: (t: number) => t * t * t * t,\n  easeOutQuart: (t: number) => 1 - (--t) * t * t * t,\n  easeInOutQuart: (t: number) => t < 0.5 ? 8 * t * t * t * t : 1 - 8 * (--t) * t * t * t,\n}\n","/**\n * Timeline API - GSAP-inspired animation sequencing with spring physics\n *\n * Create complex, coordinated animations with precise control over\n * timing, sequencing, and playback.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Animation target - can be element, selector, or values object\n */\nexport type TimelineTarget = HTMLElement | string | Record<string, number>\n\n/**\n * Animation values (numeric properties to animate)\n */\nexport interface TimelineValues {\n  [key: string]: number | undefined\n}\n\n/**\n * Timeline animation options\n */\nexport interface TimelineOptions {\n  /** Animation duration override (not used with springs, but for timing) */\n  duration?: number\n  /** Delay before animation starts */\n  delay?: number\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Easing function (for non-spring animations) */\n  ease?: (t: number) => number\n  /** Callback when animation starts */\n  onStart?: () => void\n  /** Callback on each update */\n  onUpdate?: (progress: number) => void\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Animation properties - combines values with options\n */\nexport type TimelineProps = TimelineValues & TimelineOptions\n\n/**\n * Position in timeline - can be absolute, relative, or label\n */\nexport type TimelinePosition = number | string | `+=${number}` | `-=${number}` | `<` | `>`\n\n/**\n * Timeline segment representing a single animation\n */\ninterface TimelineSegment {\n  id: string\n  target: TimelineTarget\n  props: TimelineProps\n  startTime: number\n  endTime: number\n  spring: SpringGroup<Record<string, number>> | null\n  isActive: boolean\n  isComplete: boolean\n}\n\n/**\n * Timeline configuration\n */\nexport interface TimelineConfig {\n  /** Default spring configuration for all animations */\n  defaults?: SpringConfig\n  /** Whether to autoplay on creation */\n  autoplay?: boolean\n  /** Repeat count (-1 = infinite) */\n  repeat?: number\n  /** Yoyo (reverse on repeat) */\n  yoyo?: boolean\n  /** Delay between repeats */\n  repeatDelay?: number\n  /** Callback when timeline starts */\n  onStart?: () => void\n  /** Callback on each frame */\n  onUpdate?: (progress: number) => void\n  /** Callback when timeline completes */\n  onComplete?: () => void\n  /** Callback on repeat */\n  onRepeat?: (iteration: number) => void\n}\n\n/**\n * Timeline controller interface\n */\nexport interface Timeline {\n  /** Add animation to end of timeline */\n  to(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add animation from initial values */\n  from(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add animation from/to values */\n  fromTo(target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add a label at current position */\n  addLabel(label: string, position?: TimelinePosition): Timeline\n  /** Add a callback at position */\n  call(callback: () => void, position?: TimelinePosition): Timeline\n  /** Set properties instantly (no animation) */\n  set(target: TimelineTarget, props: TimelineProps, position?: TimelinePosition): Timeline\n  /** Add pause at position */\n  addPause(position?: TimelinePosition, callback?: () => void): Timeline\n\n  /** Play timeline */\n  play(): Timeline\n  /** Pause timeline */\n  pause(): Timeline\n  /** Resume from pause */\n  resume(): Timeline\n  /** Reverse timeline */\n  reverse(): Timeline\n  /** Restart timeline */\n  restart(): Timeline\n  /** Seek to position */\n  seek(position: number | string): Timeline\n  /** Kill timeline and cleanup */\n  kill(): void\n\n  /** Get current time */\n  time(): number\n  /** Get total duration */\n  duration(): number\n  /** Get current progress (0-1) */\n  progress(): number\n  /** Check if playing */\n  isPlaying(): boolean\n  /** Check if reversed */\n  isReversed(): boolean\n\n  /** Get timeline by ID */\n  getById(id: string): TimelineSegment | undefined\n}\n\n// ============ Implementation ============\n\nlet timelineIdCounter = 0\n\n/**\n * Create a new timeline\n *\n * @example\n * ```ts\n * const tl = createTimeline()\n *   .to(element, { x: 100, opacity: 1 })\n *   .to(element, { y: 50 }, '+=0.2')\n *   .to(element, { scale: 1.2 }, '<')\n *\n * tl.play()\n * ```\n */\nexport function createTimeline(config: TimelineConfig = {}): Timeline {\n  const {\n    defaults = {},\n    autoplay = false,\n    repeat = 0,\n    yoyo = false,\n    repeatDelay = 0,\n    onStart,\n    onUpdate,\n    onComplete,\n    onRepeat,\n  } = config\n\n  const segments: TimelineSegment[] = []\n  const labels = new Map<string, number>()\n  const callbacks = new Map<number, (() => void)[]>()\n  const pauses = new Map<number, (() => void) | undefined>()\n\n  let currentTime = 0\n  let totalDuration = 0\n  let isPlaying = false\n  let isReversed = false\n  let isPaused = false\n  let repeatCount = 0\n  let rafId: number | null = null\n  let lastFrameTime = 0\n  let hasStarted = false\n  let insertTime = 0\n\n  // ============ Utility Functions ============\n\n  const parsePosition = (position?: TimelinePosition): number => {\n    if (position === undefined) {\n      return insertTime\n    }\n\n    if (typeof position === 'number') {\n      return position\n    }\n\n    // Relative to previous animation\n    if (position === '<') {\n      const lastSegment = segments[segments.length - 1]\n      return lastSegment ? lastSegment.startTime : 0\n    }\n\n    if (position === '>') {\n      return insertTime\n    }\n\n    // Relative offset\n    if (position.startsWith('+=')) {\n      return insertTime + parseFloat(position.slice(2))\n    }\n\n    if (position.startsWith('-=')) {\n      return insertTime - parseFloat(position.slice(2))\n    }\n\n    // Label reference\n    if (labels.has(position)) {\n      return labels.get(position)!\n    }\n\n    // Label with offset\n    const labelMatch = position.match(/^([a-zA-Z_]\\w*)([+-]=?\\d*\\.?\\d+)?$/)\n    if (labelMatch) {\n      const labelName = labelMatch[1]\n      const offset = labelMatch[2]\n      const labelTime = labelName ? (labels.get(labelName) ?? 0) : 0\n      if (offset) {\n        const offsetValue = parseFloat(offset.replace('=', ''))\n        return labelTime + offsetValue\n      }\n      return labelTime\n    }\n\n    return insertTime\n  }\n\n  const resolveTarget = (target: TimelineTarget): HTMLElement | null => {\n    if (typeof target === 'string') {\n      return document.querySelector(target)\n    }\n    if (target instanceof HTMLElement) {\n      return target\n    }\n    return null\n  }\n\n  const extractNumericProps = (props: TimelineProps): Record<string, number> => {\n    const result: Record<string, number> = {}\n    for (const [key, value] of Object.entries(props)) {\n      if (typeof value === 'number' && !['duration', 'delay'].includes(key)) {\n        result[key] = value\n      }\n    }\n    return result\n  }\n\n  const applyPropsToElement = (element: HTMLElement, props: Record<string, number>) => {\n    const transforms: string[] = []\n    const cssProps: Record<string, string> = {}\n\n    for (const [key, value] of Object.entries(props)) {\n      switch (key) {\n        case 'x':\n          transforms.push(`translateX(${value}px)`)\n          break\n        case 'y':\n          transforms.push(`translateY(${value}px)`)\n          break\n        case 'z':\n          transforms.push(`translateZ(${value}px)`)\n          break\n        case 'scale':\n          transforms.push(`scale(${value})`)\n          break\n        case 'scaleX':\n          transforms.push(`scaleX(${value})`)\n          break\n        case 'scaleY':\n          transforms.push(`scaleY(${value})`)\n          break\n        case 'rotate':\n        case 'rotation':\n          transforms.push(`rotate(${value}deg)`)\n          break\n        case 'rotateX':\n          transforms.push(`rotateX(${value}deg)`)\n          break\n        case 'rotateY':\n          transforms.push(`rotateY(${value}deg)`)\n          break\n        case 'rotateZ':\n          transforms.push(`rotateZ(${value}deg)`)\n          break\n        case 'skewX':\n          transforms.push(`skewX(${value}deg)`)\n          break\n        case 'skewY':\n          transforms.push(`skewY(${value}deg)`)\n          break\n        case 'opacity':\n          cssProps.opacity = String(value)\n          break\n        default:\n          // Assume pixels for numeric values\n          cssProps[key] = typeof value === 'number' ? `${value}px` : String(value)\n      }\n    }\n\n    if (transforms.length > 0) {\n      element.style.transform = transforms.join(' ')\n    }\n\n    for (const [prop, val] of Object.entries(cssProps)) {\n      ;(element.style as unknown as Record<string, string>)[prop] = val\n    }\n  }\n\n  const getCurrentElementValues = (element: HTMLElement, props: Record<string, number>): Record<string, number> => {\n    const current: Record<string, number> = {}\n    const computed = getComputedStyle(element)\n\n    for (const key of Object.keys(props)) {\n      switch (key) {\n        case 'opacity':\n          current[key] = parseFloat(computed.opacity) || 1\n          break\n        case 'x':\n        case 'y':\n        case 'z':\n        case 'scale':\n        case 'scaleX':\n        case 'scaleY':\n        case 'rotate':\n        case 'rotation':\n        case 'rotateX':\n        case 'rotateY':\n        case 'rotateZ':\n        case 'skewX':\n        case 'skewY':\n          // Parse from transform matrix - simplified, defaults to 0 or 1\n          current[key] = key.startsWith('scale') ? 1 : 0\n          break\n        default:\n          current[key] = parseFloat(computed.getPropertyValue(key)) || 0\n      }\n    }\n\n    return current\n  }\n\n  // ============ Animation Loop ============\n\n  const tick = (timestamp: number) => {\n    if (!isPlaying || isPaused) return\n\n    const deltaTime = lastFrameTime ? (timestamp - lastFrameTime) / 1000 : 0\n    lastFrameTime = timestamp\n\n    // Update time\n    currentTime += isReversed ? -deltaTime : deltaTime\n    currentTime = clamp(currentTime, 0, totalDuration)\n\n    // Check for callbacks\n    const callbacksAtTime = callbacks.get(Math.floor(currentTime * 1000))\n    if (callbacksAtTime) {\n      callbacksAtTime.forEach(cb => cb())\n    }\n\n    // Check for pauses\n    const pauseCallback = pauses.get(Math.floor(currentTime * 1000))\n    if (pauseCallback !== undefined) {\n      isPaused = true\n      pauseCallback?.()\n      return\n    }\n\n    // Update segments\n    for (const segment of segments) {\n      const segmentProgress = clamp(\n        (currentTime - segment.startTime) / (segment.endTime - segment.startTime),\n        0,\n        1\n      )\n\n      const shouldBeActive = currentTime >= segment.startTime && currentTime <= segment.endTime\n\n      if (shouldBeActive && !segment.isActive) {\n        segment.isActive = true\n        segment.props.onStart?.()\n      }\n\n      if (segment.isActive && segment.spring) {\n        segment.props.onUpdate?.(segmentProgress)\n      }\n\n      if (shouldBeActive && segmentProgress >= 1 && !segment.isComplete) {\n        segment.isComplete = true\n        segment.props.onComplete?.()\n      }\n    }\n\n    onUpdate?.(currentTime / totalDuration)\n\n    // Check for completion\n    if ((isReversed && currentTime <= 0) || (!isReversed && currentTime >= totalDuration)) {\n      if (repeat === -1 || repeatCount < repeat) {\n        repeatCount++\n        onRepeat?.(repeatCount)\n\n        if (yoyo) {\n          isReversed = !isReversed\n        } else {\n          currentTime = 0\n          segments.forEach(s => {\n            s.isActive = false\n            s.isComplete = false\n          })\n        }\n\n        if (repeatDelay > 0) {\n          setTimeout(() => {\n            rafId = requestAnimationFrame(tick)\n          }, repeatDelay * 1000)\n          return\n        }\n      } else {\n        isPlaying = false\n        onComplete?.()\n        return\n      }\n    }\n\n    rafId = requestAnimationFrame(tick)\n  }\n\n  // ============ Public API ============\n\n  const timeline: Timeline = {\n    to(target, props, position) {\n      const startTime = parsePosition(position) + (props.delay || 0)\n      const duration = props.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const numericProps = extractNumericProps(props)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(numericProps).length > 0) {\n        const currentValues = getCurrentElementValues(element, numericProps)\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\n\n        segment.spring = createSpringGroup(currentValues, springConfig)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        // Set target values when segment becomes active\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(numericProps)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    from(target, props, position) {\n      const startTime = parsePosition(position) + (props.delay || 0)\n      const duration = props.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const numericProps = extractNumericProps(props)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(numericProps).length > 0) {\n        const targetValues = getCurrentElementValues(element, numericProps)\n        const springConfig: SpringConfig = { ...defaults, ...props.spring }\n\n        // Start from props, animate to current\n        segment.spring = createSpringGroup(numericProps, springConfig)\n        applyPropsToElement(element, numericProps)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(targetValues)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    fromTo(target, fromProps, toProps, position) {\n      const startTime = parsePosition(position) + (toProps.delay || 0)\n      const duration = toProps.duration || 0.5\n      const endTime = startTime + duration\n\n      const element = resolveTarget(target)\n      const fromNumeric = extractNumericProps(fromProps)\n      const toNumeric = extractNumericProps(toProps)\n\n      const segment: TimelineSegment = {\n        id: `segment_${timelineIdCounter++}`,\n        target,\n        props: toProps,\n        startTime,\n        endTime,\n        spring: null,\n        isActive: false,\n        isComplete: false,\n      }\n\n      if (element && Object.keys(toNumeric).length > 0) {\n        const springConfig: SpringConfig = { ...defaults, ...toProps.spring }\n\n        segment.spring = createSpringGroup(fromNumeric, springConfig)\n        applyPropsToElement(element, fromNumeric)\n\n        segment.spring.subscribe((values: Record<string, number>) => {\n          applyPropsToElement(element, values)\n        })\n\n        const originalOnStart = segment.props.onStart\n        segment.props.onStart = () => {\n          segment.spring?.set(toNumeric)\n          originalOnStart?.()\n        }\n      }\n\n      segments.push(segment)\n      insertTime = endTime\n      totalDuration = Math.max(totalDuration, endTime)\n\n      return timeline\n    },\n\n    addLabel(label, position) {\n      const time = parsePosition(position)\n      labels.set(label, time)\n      return timeline\n    },\n\n    call(callback, position) {\n      const time = Math.floor(parsePosition(position) * 1000)\n      if (!callbacks.has(time)) {\n        callbacks.set(time, [])\n      }\n      callbacks.get(time)!.push(callback)\n      return timeline\n    },\n\n    set(target, props, position) {\n      const element = resolveTarget(target)\n      if (element) {\n        const time = parsePosition(position)\n        this.call(() => {\n          applyPropsToElement(element, extractNumericProps(props))\n        }, time)\n      }\n      return timeline\n    },\n\n    addPause(position, callback) {\n      const time = Math.floor(parsePosition(position) * 1000)\n      pauses.set(time, callback)\n      return timeline\n    },\n\n    play() {\n      if (!hasStarted) {\n        hasStarted = true\n        onStart?.()\n      }\n      isPlaying = true\n      isPaused = false\n      lastFrameTime = 0\n      rafId = requestAnimationFrame(tick)\n      return timeline\n    },\n\n    pause() {\n      isPaused = true\n      if (rafId) {\n        cancelAnimationFrame(rafId)\n        rafId = null\n      }\n      return timeline\n    },\n\n    resume() {\n      if (isPaused) {\n        isPaused = false\n        lastFrameTime = 0\n        rafId = requestAnimationFrame(tick)\n      }\n      return timeline\n    },\n\n    reverse() {\n      isReversed = !isReversed\n      return timeline\n    },\n\n    restart() {\n      currentTime = isReversed ? totalDuration : 0\n      repeatCount = 0\n      hasStarted = false\n      segments.forEach(s => {\n        s.isActive = false\n        s.isComplete = false\n      })\n      return this.play()\n    },\n\n    seek(position) {\n      if (typeof position === 'string') {\n        currentTime = labels.get(position) ?? 0\n      } else {\n        currentTime = clamp(position, 0, totalDuration)\n      }\n      return timeline\n    },\n\n    kill() {\n      isPlaying = false\n      if (rafId) {\n        cancelAnimationFrame(rafId)\n        rafId = null\n      }\n      segments.forEach(s => s.spring?.destroy())\n      segments.length = 0\n      labels.clear()\n      callbacks.clear()\n      pauses.clear()\n    },\n\n    time: () => currentTime,\n    duration: () => totalDuration,\n    progress: () => totalDuration > 0 ? currentTime / totalDuration : 0,\n    isPlaying: () => isPlaying && !isPaused,\n    isReversed: () => isReversed,\n\n    getById(id) {\n      return segments.find(s => s.id === id)\n    },\n  }\n\n  if (autoplay) {\n    timeline.play()\n  }\n\n  return timeline\n}\n\n/**\n * Create a simple tween (single animation)\n */\nexport function tween(\n  target: TimelineTarget,\n  props: TimelineProps\n): Timeline {\n  return createTimeline().to(target, props).play()\n}\n\n/**\n * Create a timeline that animates all targets simultaneously\n */\nexport function allTo(\n  targets: TimelineTarget[],\n  props: TimelineProps\n): Timeline {\n  const tl = createTimeline()\n  targets.forEach((target, i) => {\n    tl.to(target, props, i === 0 ? 0 : '<')\n  })\n  return tl.play()\n}\n","/**\n * SVG Morphing - Smooth path shape interpolation with spring physics\n *\n * Enables morphing between SVG paths with automatic path normalization\n * and spring-based animation.\n */\n\nimport { createSpringValue, type SpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { lerp, clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * SVG path command types\n */\ntype CommandType = 'M' | 'L' | 'C' | 'Q' | 'A' | 'Z' | 'H' | 'V' | 'S' | 'T'\n\n/**\n * Parsed path command\n */\ninterface PathCommand {\n  type: CommandType\n  values: number[]\n}\n\n/**\n * Normalized point with control points\n */\ninterface NormalizedPoint {\n  x: number\n  y: number\n  cp1x?: number\n  cp1y?: number\n  cp2x?: number\n  cp2y?: number\n}\n\n/**\n * Morph configuration\n */\nexport interface MorphConfig {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Number of samples for path normalization (higher = smoother) */\n  samples?: number\n  /** Callback on progress update */\n  onProgress?: (progress: number) => void\n  /** Callback when morph completes */\n  onComplete?: () => void\n}\n\n/**\n * Morph controller interface\n */\nexport interface MorphController {\n  /** Get current morphed path */\n  getPath(): string\n  /** Get current progress (0-1) */\n  getProgress(): number\n  /** Morph to a new path */\n  morphTo(path: string): void\n  /** Set progress directly (0-1) */\n  setProgress(progress: number): void\n  /** Subscribe to path changes */\n  subscribe(callback: (path: string) => void): () => void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n// ============ Path Parsing ============\n\n/**\n * Parse SVG path string into commands\n */\nfunction parsePath(d: string): PathCommand[] {\n  const commands: PathCommand[] = []\n  const regex = /([MLCQAZHVST])([^MLCQAZHVST]*)/gi\n\n  let match: RegExpMatchArray | null\n  // Use matchAll instead of regex.exec for safer iteration\n  const matches = d.matchAll(regex)\n\n  for (const matchItem of matches) {\n    const typeChar = matchItem[1]\n    const valuesStr = matchItem[2]\n    if (!typeChar || valuesStr === undefined) continue\n\n    const type = typeChar.toUpperCase() as CommandType\n    const values = valuesStr\n      .trim()\n      .split(/[\\s,]+/)\n      .filter(v => v !== '')\n      .map(parseFloat)\n      .filter(v => !isNaN(v))\n\n    commands.push({ type, values })\n  }\n\n  return commands\n}\n\n/**\n * Convert path commands to absolute coordinates\n */\nfunction toAbsolute(commands: PathCommand[]): PathCommand[] {\n  let currentX = 0\n  let currentY = 0\n  let startX = 0\n  let startY = 0\n\n  return commands.map(cmd => {\n    const { type, values } = cmd\n    const absValues = [...values]\n\n    switch (type) {\n      case 'M':\n        currentX = values[0] ?? 0\n        currentY = values[1] ?? 0\n        startX = currentX\n        startY = currentY\n        break\n\n      case 'L':\n        currentX = values[0] ?? 0\n        currentY = values[1] ?? 0\n        break\n\n      case 'H':\n        absValues[0] = values[0] ?? 0\n        currentX = values[0] ?? 0\n        break\n\n      case 'V':\n        absValues[0] = values[0] ?? 0\n        currentY = values[0] ?? 0\n        break\n\n      case 'C':\n        currentX = values[4] ?? 0\n        currentY = values[5] ?? 0\n        break\n\n      case 'Q':\n        currentX = values[2] ?? 0\n        currentY = values[3] ?? 0\n        break\n\n      case 'A':\n        currentX = values[5] ?? 0\n        currentY = values[6] ?? 0\n        break\n\n      case 'Z':\n        currentX = startX\n        currentY = startY\n        break\n    }\n\n    return { type, values: absValues }\n  })\n}\n\n/**\n * Sample points along a path at regular intervals\n */\nfunction samplePath(commands: PathCommand[], samples: number): NormalizedPoint[] {\n  const points: NormalizedPoint[] = []\n\n  // Check if we're in browser\n  if (typeof document === 'undefined') {\n    // Server-side fallback - simple linear sampling\n    for (const cmd of commands) {\n      if (cmd.type === 'M' || cmd.type === 'L') {\n        points.push({ x: cmd.values[0] ?? 0, y: cmd.values[1] ?? 0 })\n      } else if (cmd.type === 'C') {\n        points.push({\n          x: cmd.values[4] ?? 0,\n          y: cmd.values[5] ?? 0,\n          cp1x: cmd.values[0] ?? 0,\n          cp1y: cmd.values[1] ?? 0,\n          cp2x: cmd.values[2] ?? 0,\n          cp2y: cmd.values[3] ?? 0,\n        })\n      }\n    }\n    return points\n  }\n\n  const svgNS = 'http://www.w3.org/2000/svg'\n  const svg = document.createElementNS(svgNS, 'svg')\n  const path = document.createElementNS(svgNS, 'path')\n\n  // Build path string\n  let d = ''\n  for (const cmd of commands) {\n    d += cmd.type + cmd.values.join(' ')\n  }\n  path.setAttribute('d', d)\n  svg.appendChild(path)\n  document.body.appendChild(svg)\n\n  try {\n    const totalLength = path.getTotalLength()\n    const step = totalLength / (samples - 1)\n\n    for (let i = 0; i < samples; i++) {\n      const point = path.getPointAtLength(i * step)\n      points.push({ x: point.x, y: point.y })\n    }\n  } finally {\n    document.body.removeChild(svg)\n  }\n\n  return points\n}\n\n/**\n * Interpolate between two points\n */\nfunction interpolatePoint(p1: NormalizedPoint, p2: NormalizedPoint, t: number): NormalizedPoint {\n  return {\n    x: lerp(p1.x, p2.x, t),\n    y: lerp(p1.y, p2.y, t),\n  }\n}\n\n/**\n * Convert normalized points back to path string\n */\nfunction pointsToPath(points: NormalizedPoint[]): string {\n  if (points.length === 0) return ''\n\n  const firstPoint = points[0]!\n  let d = `M ${firstPoint.x} ${firstPoint.y}`\n\n  for (let i = 1; i < points.length; i++) {\n    const point = points[i]!\n    d += ` L ${point.x} ${point.y}`\n  }\n\n  return d\n}\n\n// ============ Morph Implementation ============\n\n/**\n * Create SVG path morph controller\n *\n * @example\n * ```ts\n * const morph = createMorph(circlePath, {\n *   spring: { stiffness: 120, damping: 14 },\n *   onProgress: (p) => console.log('Progress:', p),\n * })\n *\n * morph.subscribe((path) => {\n *   element.setAttribute('d', path)\n * })\n *\n * morph.morphTo(starPath)\n * ```\n */\nexport function createMorph(\n  initialPath: string,\n  config: MorphConfig = {}\n): MorphController {\n  const {\n    spring: springConfig = { stiffness: 120, damping: 14 },\n    samples = 100,\n    onProgress,\n    onComplete,\n  } = config\n\n  let currentPath = initialPath\n  let fromPoints: NormalizedPoint[] = []\n  let toPoints: NormalizedPoint[] = []\n  let currentPoints: NormalizedPoint[] = []\n\n  const subscribers = new Set<(path: string) => void>()\n\n  // Parse initial path\n  const initialCommands = parsePath(initialPath)\n  fromPoints = samplePath(toAbsolute(initialCommands), samples)\n  currentPoints = [...fromPoints]\n  toPoints = [...fromPoints]\n\n  // Create spring for progress\n  const progressSpring = createSpringValue(0, springConfig)\n\n  progressSpring.subscribe(() => {\n    const progress = progressSpring.get()\n    onProgress?.(progress)\n\n    // Interpolate points\n    currentPoints = fromPoints.map((from, i) =>\n      interpolatePoint(from, toPoints[i] ?? from, progress)\n    )\n\n    currentPath = pointsToPath(currentPoints)\n    subscribers.forEach(cb => cb(currentPath))\n\n    if (progress >= 0.999) {\n      onComplete?.()\n    }\n  })\n\n  return {\n    getPath: () => currentPath,\n    getProgress: () => progressSpring.get(),\n\n    morphTo(path: string) {\n      // Normalize paths\n      const targetCommands = parsePath(path)\n      const targetPoints = samplePath(toAbsolute(targetCommands), samples)\n\n      fromPoints = [...currentPoints]\n      toPoints = targetPoints\n\n      // Ensure same number of points\n      while (fromPoints.length < toPoints.length) {\n        fromPoints.push(fromPoints[fromPoints.length - 1] || { x: 0, y: 0 })\n      }\n      while (toPoints.length < fromPoints.length) {\n        toPoints.push(toPoints[toPoints.length - 1] || { x: 0, y: 0 })\n      }\n\n      // Reset and animate\n      progressSpring.jump(0)\n      progressSpring.set(1)\n    },\n\n    setProgress(progress: number) {\n      const p = clamp(progress, 0, 1)\n      progressSpring.jump(p)\n\n      currentPoints = fromPoints.map((from, i) =>\n        interpolatePoint(from, toPoints[i] ?? from, p)\n      )\n\n      currentPath = pointsToPath(currentPoints)\n      subscribers.forEach(cb => cb(currentPath))\n    },\n\n    subscribe(callback) {\n      subscribers.add(callback)\n      callback(currentPath)\n      return () => subscribers.delete(callback)\n    },\n\n    destroy() {\n      progressSpring.destroy()\n      subscribers.clear()\n    },\n  }\n}\n\n/**\n * Create a morph between multiple paths (morphing sequence)\n *\n * @example\n * ```ts\n * const sequence = createMorphSequence([\n *   circlePath,\n *   squarePath,\n *   starPath,\n * ])\n *\n * sequence.subscribe((path) => {\n *   element.setAttribute('d', path)\n * })\n *\n * sequence.morphToIndex(2) // Morph to star\n * ```\n */\nexport function createMorphSequence(\n  paths: string[],\n  config: MorphConfig = {}\n): {\n  getPath(): string\n  getCurrentIndex(): number\n  morphToIndex(index: number): void\n  morphToNext(): void\n  morphToPrevious(): void\n  subscribe(callback: (path: string) => void): () => void\n  destroy(): void\n} {\n  if (paths.length === 0) {\n    throw new Error('At least one path is required')\n  }\n\n  let currentIndex = 0\n  const firstPath = paths[0]!\n  const morph = createMorph(firstPath, config)\n\n  return {\n    getPath: () => morph.getPath(),\n    getCurrentIndex: () => currentIndex,\n\n    morphToIndex(index: number) {\n      const targetIndex = clamp(index, 0, paths.length - 1)\n      if (targetIndex !== currentIndex) {\n        currentIndex = targetIndex\n        const targetPath = paths[targetIndex]!\n        morph.morphTo(targetPath)\n      }\n    },\n\n    morphToNext() {\n      this.morphToIndex((currentIndex + 1) % paths.length)\n    },\n\n    morphToPrevious() {\n      this.morphToIndex((currentIndex - 1 + paths.length) % paths.length)\n    },\n\n    subscribe: (callback) => morph.subscribe(callback),\n    destroy: () => morph.destroy(),\n  }\n}\n\n// ============ Preset Shapes ============\n\n/**\n * Generate common SVG shape paths\n */\nexport const shapes = {\n  /**\n   * Generate circle path\n   */\n  circle(cx: number, cy: number, r: number): string {\n    return `M ${cx - r} ${cy}\n            A ${r} ${r} 0 1 1 ${cx + r} ${cy}\n            A ${r} ${r} 0 1 1 ${cx - r} ${cy}`\n  },\n\n  /**\n   * Generate rectangle path\n   */\n  rect(x: number, y: number, width: number, height: number, rx = 0): string {\n    if (rx === 0) {\n      return `M ${x} ${y}\n              L ${x + width} ${y}\n              L ${x + width} ${y + height}\n              L ${x} ${y + height}\n              Z`\n    }\n\n    return `M ${x + rx} ${y}\n            L ${x + width - rx} ${y}\n            Q ${x + width} ${y} ${x + width} ${y + rx}\n            L ${x + width} ${y + height - rx}\n            Q ${x + width} ${y + height} ${x + width - rx} ${y + height}\n            L ${x + rx} ${y + height}\n            Q ${x} ${y + height} ${x} ${y + height - rx}\n            L ${x} ${y + rx}\n            Q ${x} ${y} ${x + rx} ${y}\n            Z`\n  },\n\n  /**\n   * Generate polygon path\n   */\n  polygon(cx: number, cy: number, r: number, sides: number): string {\n    const points: string[] = []\n\n    for (let i = 0; i < sides; i++) {\n      const angle = (i / sides) * Math.PI * 2 - Math.PI / 2\n      const x = cx + r * Math.cos(angle)\n      const y = cy + r * Math.sin(angle)\n      points.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\n    }\n\n    return points.join(' ') + ' Z'\n  },\n\n  /**\n   * Generate star path\n   */\n  star(cx: number, cy: number, outerR: number, innerR: number, points: number): string {\n    const path: string[] = []\n    const step = Math.PI / points\n\n    for (let i = 0; i < points * 2; i++) {\n      const r = i % 2 === 0 ? outerR : innerR\n      const angle = i * step - Math.PI / 2\n      const x = cx + r * Math.cos(angle)\n      const y = cy + r * Math.sin(angle)\n      path.push(`${i === 0 ? 'M' : 'L'} ${x} ${y}`)\n    }\n\n    return path.join(' ') + ' Z'\n  },\n\n  /**\n   * Generate heart path\n   */\n  heart(cx: number, cy: number, size: number): string {\n    const d = size / 4\n    return `M ${cx} ${cy + d}\n            C ${cx} ${cy} ${cx - 2 * d} ${cy} ${cx - 2 * d} ${cy - d}\n            C ${cx - 2 * d} ${cy - 2 * d} ${cx} ${cy - 2 * d} ${cx} ${cy - d}\n            C ${cx} ${cy - 2 * d} ${cx + 2 * d} ${cy - 2 * d} ${cx + 2 * d} ${cy - d}\n            C ${cx + 2 * d} ${cy} ${cx} ${cy} ${cx} ${cy + d}\n            Z`\n  },\n\n  /**\n   * Generate arrow path\n   */\n  arrow(x: number, y: number, width: number, height: number, direction: 'up' | 'down' | 'left' | 'right' = 'right'): string {\n    const hw = width / 2\n    const hh = height / 2\n\n    switch (direction) {\n      case 'right':\n        return `M ${x} ${y - hh} L ${x + width} ${y} L ${x} ${y + hh} Z`\n      case 'left':\n        return `M ${x + width} ${y - hh} L ${x} ${y} L ${x + width} ${y + hh} Z`\n      case 'up':\n        return `M ${x - hw} ${y + height} L ${x} ${y} L ${x + hw} ${y + height} Z`\n      case 'down':\n        return `M ${x - hw} ${y} L ${x} ${y + height} L ${x + hw} ${y} Z`\n    }\n  },\n}\n","/**\n * Shared Layout Animations - Cross-component FLIP animations with layoutId\n *\n * Enables smooth transitions between components that share the same layoutId,\n * similar to Framer Motion's layout animations.\n */\n\nimport { createSpringGroup, type SpringGroup } from '../core/spring-group.js'\nimport type { SpringConfig } from '../core/config.js'\nimport { clamp } from '../utils/math.js'\n\n// ============ Types ============\n\n/**\n * Element measurement for FLIP\n */\nexport interface LayoutMeasurement {\n  x: number\n  y: number\n  width: number\n  height: number\n  opacity?: number\n  borderRadius?: number\n  scaleX?: number\n  scaleY?: number\n}\n\n/**\n * Shared layout element info\n */\ninterface SharedLayoutElement {\n  id: string\n  element: HTMLElement\n  measurement: LayoutMeasurement\n  spring: SpringGroup<Record<string, number>> | null\n  isAnimating: boolean\n}\n\n/**\n * Layout animation configuration\n */\nexport interface LayoutAnimationConfig {\n  /** Spring configuration */\n  spring?: SpringConfig\n  /** Duration hint for spring (optional) */\n  duration?: number\n  /** Callback when animation starts */\n  onAnimationStart?: (id: string) => void\n  /** Callback when animation completes */\n  onAnimationComplete?: (id: string) => void\n  /** Enable crossfade during transition */\n  crossfade?: boolean\n  /** Custom transition properties */\n  transition?: {\n    x?: SpringConfig\n    y?: SpringConfig\n    width?: SpringConfig\n    height?: SpringConfig\n    opacity?: SpringConfig\n    borderRadius?: SpringConfig\n  }\n}\n\n/**\n * Layout group for managing shared elements\n */\nexport interface LayoutGroup {\n  /** Register element with layoutId */\n  register(id: string, element: HTMLElement): void\n  /** Unregister element */\n  unregister(id: string, element: HTMLElement): void\n  /** Update layout (call after DOM changes) */\n  update(): void\n  /** Force re-measure all elements */\n  forceUpdate(): void\n  /** Destroy and cleanup */\n  destroy(): void\n}\n\n/**\n * Shared layout context for cross-component animations\n */\nexport interface SharedLayoutContext {\n  /** Register a layout group */\n  createGroup(id?: string): LayoutGroup\n  /** Get group by id */\n  getGroup(id: string): LayoutGroup | undefined\n  /** Update all groups */\n  updateAll(): void\n  /** Destroy all groups */\n  destroy(): void\n}\n\n// ============ Measurement Utilities ============\n\n/**\n * Measure element position and size\n */\nfunction measureElement(element: HTMLElement): LayoutMeasurement {\n  const rect = element.getBoundingClientRect()\n  const styles = getComputedStyle(element)\n\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n    opacity: parseFloat(styles.opacity) || 1,\n    borderRadius: parseFloat(styles.borderRadius) || 0,\n    scaleX: 1,\n    scaleY: 1,\n  }\n}\n\n/**\n * Apply FLIP transform to element\n */\nfunction applyTransform(\n  element: HTMLElement,\n  from: LayoutMeasurement,\n  to: LayoutMeasurement,\n  current: Record<string, number>\n): void {\n  // Calculate deltas\n  const dx = current.x !== undefined ? from.x - to.x + (current.x - from.x) : 0\n  const dy = current.y !== undefined ? from.y - to.y + (current.y - from.y) : 0\n  const scaleX = current.width !== undefined ? current.width / to.width : 1\n  const scaleY = current.height !== undefined ? current.height / to.height : 1\n\n  // Apply transform\n  element.style.transform = `translate(${dx}px, ${dy}px) scale(${scaleX}, ${scaleY})`\n  element.style.transformOrigin = 'top left'\n\n  // Apply opacity if transitioning\n  if (current.opacity !== undefined) {\n    element.style.opacity = String(current.opacity)\n  }\n\n  // Apply border radius (scale-compensated)\n  if (current.borderRadius !== undefined) {\n    const compensatedRadius = current.borderRadius / Math.max(scaleX, scaleY)\n    element.style.borderRadius = `${compensatedRadius}px`\n  }\n}\n\n/**\n * Reset element transform\n */\nfunction resetTransform(element: HTMLElement): void {\n  element.style.transform = ''\n  element.style.transformOrigin = ''\n  element.style.opacity = ''\n  element.style.borderRadius = ''\n}\n\n// ============ Layout Group Implementation ============\n\n/**\n * Create a layout group for managing shared layout elements\n *\n * @example\n * ```ts\n * const group = createLayoutGroup({\n *   spring: { stiffness: 300, damping: 30 },\n * })\n *\n * // Register elements with same layoutId\n * group.register('card-1', cardElement)\n *\n * // After DOM changes\n * group.update()\n * ```\n */\nexport function createLayoutGroup(config: LayoutAnimationConfig = {}): LayoutGroup {\n  const {\n    spring: defaultSpring = { stiffness: 300, damping: 30 },\n    onAnimationStart,\n    onAnimationComplete,\n    crossfade = false,\n    transition = {},\n  } = config\n\n  const elements = new Map<string, SharedLayoutElement[]>()\n  const previousMeasurements = new Map<string, LayoutMeasurement>()\n\n  const register = (id: string, element: HTMLElement): void => {\n    if (!elements.has(id)) {\n      elements.set(id, [])\n    }\n\n    const existing = elements.get(id)!\n    const alreadyRegistered = existing.some(e => e.element === element)\n\n    if (!alreadyRegistered) {\n      const measurement = measureElement(element)\n      existing.push({\n        id,\n        element,\n        measurement,\n        spring: null,\n        isAnimating: false,\n      })\n\n      // Store measurement for future animations\n      if (!previousMeasurements.has(id)) {\n        previousMeasurements.set(id, measurement)\n      }\n    }\n  }\n\n  const unregister = (id: string, element: HTMLElement): void => {\n    const group = elements.get(id)\n    if (!group) return\n\n    const index = group.findIndex(e => e.element === element)\n    if (index !== -1) {\n      const entry = group[index]!\n\n      // Store final measurement before removal\n      previousMeasurements.set(id, measureElement(element))\n\n      // Cleanup spring\n      entry.spring?.destroy()\n      group.splice(index, 1)\n\n      if (group.length === 0) {\n        elements.delete(id)\n      }\n    }\n  }\n\n  const animateElement = (\n    entry: SharedLayoutElement,\n    from: LayoutMeasurement,\n    to: LayoutMeasurement\n  ): void => {\n    // Cleanup previous animation\n    entry.spring?.destroy()\n\n    const springConfig = {\n      x: transition.x || defaultSpring,\n      y: transition.y || defaultSpring,\n      width: transition.width || defaultSpring,\n      height: transition.height || defaultSpring,\n      opacity: transition.opacity || defaultSpring,\n      borderRadius: transition.borderRadius || defaultSpring,\n    }\n\n    // Create spring with initial values\n    const initialValues: Record<string, number> = {\n      x: from.x,\n      y: from.y,\n      width: from.width,\n      height: from.height,\n    }\n\n    if (crossfade) {\n      initialValues.opacity = from.opacity ?? 1\n    }\n\n    if (from.borderRadius !== undefined) {\n      initialValues.borderRadius = from.borderRadius\n    }\n\n    entry.spring = createSpringGroup(initialValues, defaultSpring)\n    entry.isAnimating = true\n\n    onAnimationStart?.(entry.id)\n\n    entry.spring.subscribe((values: Record<string, number>) => {\n      applyTransform(entry.element, from, to, values)\n    })\n\n    // Set target values\n    const targetValues: Record<string, number> = {\n      x: to.x,\n      y: to.y,\n      width: to.width,\n      height: to.height,\n    }\n\n    if (crossfade) {\n      targetValues.opacity = to.opacity ?? 1\n    }\n\n    if (to.borderRadius !== undefined) {\n      targetValues.borderRadius = to.borderRadius\n    }\n\n    entry.spring.set(targetValues)\n\n    // Check for animation completion\n    const checkComplete = () => {\n      if (entry.spring && !entry.spring.isAnimating()) {\n        entry.isAnimating = false\n        resetTransform(entry.element)\n        onAnimationComplete?.(entry.id)\n      } else if (entry.isAnimating) {\n        requestAnimationFrame(checkComplete)\n      }\n    }\n\n    requestAnimationFrame(checkComplete)\n  }\n\n  const update = (): void => {\n    for (const [id, group] of elements) {\n      for (const entry of group) {\n        const previousMeasurement = previousMeasurements.get(id)\n        const currentMeasurement = measureElement(entry.element)\n\n        // Check if position/size changed\n        if (previousMeasurement) {\n          const hasChanged =\n            previousMeasurement.x !== currentMeasurement.x ||\n            previousMeasurement.y !== currentMeasurement.y ||\n            previousMeasurement.width !== currentMeasurement.width ||\n            previousMeasurement.height !== currentMeasurement.height\n\n          if (hasChanged) {\n            animateElement(entry, previousMeasurement, currentMeasurement)\n          }\n        }\n\n        // Update stored measurement\n        entry.measurement = currentMeasurement\n        previousMeasurements.set(id, currentMeasurement)\n      }\n    }\n  }\n\n  const forceUpdate = (): void => {\n    // Re-measure all elements\n    for (const [id, group] of elements) {\n      for (const entry of group) {\n        entry.measurement = measureElement(entry.element)\n        previousMeasurements.set(id, entry.measurement)\n      }\n    }\n  }\n\n  const destroy = (): void => {\n    for (const group of elements.values()) {\n      for (const entry of group) {\n        entry.spring?.destroy()\n        resetTransform(entry.element)\n      }\n    }\n    elements.clear()\n    previousMeasurements.clear()\n  }\n\n  return {\n    register,\n    unregister,\n    update,\n    forceUpdate,\n    destroy,\n  }\n}\n\n// ============ Shared Layout Context ============\n\nlet groupIdCounter = 0\n\n/**\n * Create a shared layout context for managing multiple layout groups\n *\n * @example\n * ```ts\n * const context = createSharedLayoutContext()\n *\n * // Create groups for different animation contexts\n * const listGroup = context.createGroup('list')\n * const cardGroup = context.createGroup('cards')\n *\n * // Register elements\n * listGroup.register('item-1', element1)\n * cardGroup.register('card-1', element2)\n *\n * // After route change or DOM update\n * context.updateAll()\n * ```\n */\nexport function createSharedLayoutContext(): SharedLayoutContext {\n  const groups = new Map<string, LayoutGroup>()\n\n  return {\n    createGroup(id?: string) {\n      const groupId = id ?? `layout-group-${groupIdCounter++}`\n      const group = createLayoutGroup()\n      groups.set(groupId, group)\n      return group\n    },\n\n    getGroup(id: string) {\n      return groups.get(id)\n    },\n\n    updateAll() {\n      for (const group of groups.values()) {\n        group.update()\n      }\n    },\n\n    destroy() {\n      for (const group of groups.values()) {\n        group.destroy()\n      }\n      groups.clear()\n    },\n  }\n}\n\n// ============ Auto Layout Observer ============\n\n/**\n * Configuration for auto layout observer\n */\nexport interface AutoLayoutConfig extends LayoutAnimationConfig {\n  /** Root element to observe (default: document.body) */\n  root?: HTMLElement\n  /** Attribute name for layout ID (default: 'data-layout-id') */\n  attribute?: string\n  /** Debounce time for mutations (ms) */\n  debounce?: number\n}\n\n/**\n * Create auto layout observer that automatically animates\n * elements with layoutId attribute\n *\n * @example\n * ```html\n * <div data-layout-id=\"card-1\">Content</div>\n * ```\n *\n * ```ts\n * const observer = createAutoLayout({\n *   spring: { stiffness: 200, damping: 20 },\n * })\n *\n * // Elements with data-layout-id will automatically animate\n * // when their position changes\n *\n * observer.destroy() // Cleanup when done\n * ```\n */\nexport function createAutoLayout(config: AutoLayoutConfig = {}): {\n  update(): void\n  forceUpdate(): void\n  destroy(): void\n} {\n  const {\n    root = typeof document !== 'undefined' ? document.body : null,\n    attribute = 'data-layout-id',\n    debounce: debounceTime = 0,\n    ...layoutConfig\n  } = config\n\n  if (!root) {\n    return {\n      update: () => {},\n      forceUpdate: () => {},\n      destroy: () => {},\n    }\n  }\n\n  const group = createLayoutGroup(layoutConfig)\n  let observer: MutationObserver | null = null\n  let resizeObserver: ResizeObserver | null = null\n  let debounceTimer: ReturnType<typeof setTimeout> | null = null\n\n  const scanAndRegister = () => {\n    const elements = root.querySelectorAll(`[${attribute}]`)\n    elements.forEach((el) => {\n      const id = el.getAttribute(attribute)\n      if (id && el instanceof HTMLElement) {\n        group.register(id, el)\n      }\n    })\n  }\n\n  const debouncedUpdate = () => {\n    if (debounceTimer) {\n      clearTimeout(debounceTimer)\n    }\n\n    if (debounceTime > 0) {\n      debounceTimer = setTimeout(() => {\n        scanAndRegister()\n        group.update()\n      }, debounceTime)\n    } else {\n      scanAndRegister()\n      group.update()\n    }\n  }\n\n  // Initial scan\n  scanAndRegister()\n\n  // Observe DOM changes\n  observer = new MutationObserver((mutations) => {\n    let shouldUpdate = false\n\n    for (const mutation of mutations) {\n      if (mutation.type === 'childList') {\n        // Check added nodes\n        mutation.addedNodes.forEach((node) => {\n          if (node instanceof HTMLElement) {\n            if (node.hasAttribute(attribute)) {\n              shouldUpdate = true\n            }\n            // Check descendants\n            if (node.querySelector(`[${attribute}]`)) {\n              shouldUpdate = true\n            }\n          }\n        })\n\n        // Check removed nodes\n        mutation.removedNodes.forEach((node) => {\n          if (node instanceof HTMLElement) {\n            const id = node.getAttribute(attribute)\n            if (id) {\n              group.unregister(id, node)\n            }\n          }\n        })\n      }\n\n      if (mutation.type === 'attributes' && mutation.attributeName === attribute) {\n        shouldUpdate = true\n      }\n    }\n\n    if (shouldUpdate) {\n      debouncedUpdate()\n    }\n  })\n\n  observer.observe(root, {\n    childList: true,\n    subtree: true,\n    attributes: true,\n    attributeFilter: [attribute],\n  })\n\n  // Observe resize changes\n  resizeObserver = new ResizeObserver(() => {\n    debouncedUpdate()\n  })\n\n  resizeObserver.observe(root)\n\n  return {\n    update: () => {\n      scanAndRegister()\n      group.update()\n    },\n\n    forceUpdate: () => {\n      scanAndRegister()\n      group.forceUpdate()\n    },\n\n    destroy: () => {\n      if (debounceTimer) {\n        clearTimeout(debounceTimer)\n      }\n      observer?.disconnect()\n      resizeObserver?.disconnect()\n      group.destroy()\n    },\n  }\n}\n","/**\n * MotionValue - High-performance animated value without React re-renders\n *\n * Unlike React state, MotionValue updates don't trigger component re-renders.\n * This makes it ideal for high-frequency animations like drag, scroll, and gestures.\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n *\n * // Subscribe to changes (no React re-render)\n * x.on('change', (value) => {\n *   element.style.transform = `translateX(${value}px)`\n * })\n *\n * // Update value\n * x.set(100)  // Triggers spring animation\n * x.jump(100) // Instant update, no animation\n * ```\n */\n\nimport { createSpringValue } from './spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\nexport type MotionValueSubscriber<T> = (value: T) => void\nexport type MotionValueEvent = 'change' | 'animationStart' | 'animationEnd'\n\nexport interface MotionValueOptions {\n  /** Spring configuration for animated transitions */\n  spring?: SpringConfig\n}\n\n/**\n * MotionValue class - Performant animated values\n *\n * Key advantages over React state:\n * - No re-renders on value change\n * - Direct DOM manipulation for 60fps animations\n * - Chainable with useTransform\n * - Memory efficient with automatic cleanup\n */\nexport class MotionValue<T = number> {\n  private _value: T\n  private _velocity: number = 0\n  private _subscribers: Set<MotionValueSubscriber<T>> = new Set()\n  private _eventListeners: Map<MotionValueEvent, Set<() => void>> = new Map()\n  private _springValue: ReturnType<typeof createSpringValue> | null = null\n  private _springConfig: SpringConfig\n  private _isAnimating: boolean = false\n  private _destroyed: boolean = false\n\n  constructor(initialValue: T, options: MotionValueOptions = {}) {\n    this._value = initialValue\n    this._springConfig = options.spring ?? { stiffness: 100, damping: 15 }\n\n    // Initialize spring for numeric values\n    if (typeof initialValue === 'number') {\n      this._springValue = createSpringValue(initialValue as number, {\n        ...this._springConfig,\n        onUpdate: (v: number) => {\n          if (this._destroyed) return\n          this._value = v as T\n          this._velocity = this._springValue?.getVelocity() ?? 0\n          this._notify()\n        },\n      })\n    }\n  }\n\n  /**\n   * Get current value synchronously\n   */\n  get(): T {\n    return this._value\n  }\n\n  /**\n   * Get current velocity (for numeric values)\n   */\n  getVelocity(): number {\n    return this._velocity\n  }\n\n  /**\n   * Check if currently animating\n   */\n  isAnimating(): boolean {\n    return this._isAnimating\n  }\n\n  /**\n   * Set value with spring animation\n   */\n  set(newValue: T, animate: boolean = true): void {\n    if (this._destroyed) return\n\n    if (typeof newValue === 'number' && this._springValue && animate) {\n      this._isAnimating = true\n      this._emit('animationStart')\n\n      this._springValue.set(newValue as number)\n\n      // Check for animation end\n      const checkEnd = () => {\n        if (this._springValue && Math.abs(this._springValue.getVelocity()) < 0.01) {\n          this._isAnimating = false\n          this._emit('animationEnd')\n        } else if (this._isAnimating) {\n          requestAnimationFrame(checkEnd)\n        }\n      }\n      requestAnimationFrame(checkEnd)\n    } else {\n      this._value = newValue\n      this._velocity = 0\n      this._notify()\n    }\n  }\n\n  /**\n   * Instantly set value without animation\n   */\n  jump(newValue: T): void {\n    if (this._destroyed) return\n\n    this._value = newValue\n    this._velocity = 0\n\n    if (typeof newValue === 'number' && this._springValue) {\n      this._springValue.jump(newValue as number)\n    }\n\n    this._isAnimating = false\n    this._notify()\n  }\n\n  /**\n   * Stop any running animation\n   */\n  stop(): void {\n    // SpringValue doesn't have stop(), so we jump to current value\n    if (this._springValue) {\n      this._springValue.jump(this._springValue.get())\n    }\n    this._isAnimating = false\n    this._emit('animationEnd')\n  }\n\n  /**\n   * Subscribe to value changes\n   * Returns unsubscribe function\n   */\n  subscribe(callback: MotionValueSubscriber<T>): () => void {\n    this._subscribers.add(callback)\n\n    // Immediately call with current value\n    callback(this._value)\n\n    return () => {\n      this._subscribers.delete(callback)\n    }\n  }\n\n  /**\n   * Add event listener\n   */\n  on(event: MotionValueEvent, callback: () => void): () => void {\n    if (!this._eventListeners.has(event)) {\n      this._eventListeners.set(event, new Set())\n    }\n    this._eventListeners.get(event)!.add(callback)\n\n    return () => {\n      this._eventListeners.get(event)?.delete(callback)\n    }\n  }\n\n  /**\n   * Update spring configuration\n   */\n  setConfig(config: Partial<SpringConfig>): void {\n    this._springConfig = { ...this._springConfig, ...config }\n    // Note: Config change takes effect on next animation\n  }\n\n  /**\n   * Destroy and cleanup\n   */\n  destroy(): void {\n    this._destroyed = true\n    this._subscribers.clear()\n    this._eventListeners.clear()\n\n    if (this._springValue) {\n      this._springValue.destroy()\n      this._springValue = null\n    }\n  }\n\n  private _notify(): void {\n    this._subscribers.forEach((callback) => {\n      try {\n        callback(this._value)\n      } catch (e) {\n        console.error('MotionValue subscriber error:', e)\n      }\n    })\n    this._emit('change')\n  }\n\n  private _emit(event: MotionValueEvent): void {\n    this._eventListeners.get(event)?.forEach((callback) => {\n      try {\n        callback()\n      } catch (e) {\n        console.error(`MotionValue ${event} listener error:`, e)\n      }\n    })\n  }\n}\n\n/**\n * Create a new MotionValue\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * const opacity = createMotionValue(1)\n * const scale = createMotionValue(1, { spring: { stiffness: 300, damping: 30 } })\n * ```\n */\nexport function createMotionValue<T = number>(\n  initialValue: T,\n  options?: MotionValueOptions\n): MotionValue<T> {\n  return new MotionValue(initialValue, options)\n}\n\n/**\n * Transform a MotionValue using a mapping function\n *\n * Creates a derived MotionValue that automatically updates\n * when the source value changes.\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * const opacity = transformValue(x, (v) => 1 - v / 100)\n * const inverted = transformValue(x, (v) => -v)\n * ```\n */\nexport function transformValue<T, U>(\n  source: MotionValue<T>,\n  transform: (value: T) => U\n): MotionValue<U> {\n  const derived = new MotionValue<U>(transform(source.get()))\n\n  source.subscribe((value) => {\n    derived.jump(transform(value))\n  })\n\n  return derived\n}\n\n/**\n * Map a MotionValue from one range to another\n *\n * @example\n * ```ts\n * const x = createMotionValue(0)\n * // Map 0-100 to 0-1\n * const progress = mapRange(x, [0, 100], [0, 1])\n * // Map with extrapolation clamped\n * const clamped = mapRange(x, [0, 100], [0, 1], { clamp: true })\n * ```\n */\nexport function mapRange(\n  source: MotionValue<number>,\n  inputRange: [number, number],\n  outputRange: [number, number],\n  options: { clamp?: boolean } = {}\n): MotionValue<number> {\n  const [inMin, inMax] = inputRange\n  const [outMin, outMax] = outputRange\n\n  return transformValue(source, (value) => {\n    let normalized = (value - inMin) / (inMax - inMin)\n\n    if (options.clamp) {\n      normalized = Math.max(0, Math.min(1, normalized))\n    }\n\n    return outMin + normalized * (outMax - outMin)\n  })\n}\n","import { createSpringValue } from '../core/spring-value.js'\nimport type { SpringConfig } from '../types.js'\n\n/**\n * Measured box dimensions\n */\nexport interface MeasuredBox {\n  x: number\n  y: number\n  width: number\n  height: number\n}\n\n/**\n * FLIP animation options\n */\nexport interface FlipOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to animate position */\n  position?: boolean\n  /** Whether to animate size */\n  size?: boolean\n  /** Callback when animation completes */\n  onComplete?: () => void\n  /** Callback for value updates */\n  onUpdate?: (progress: number) => void\n}\n\n/**\n * FLIP animation controller\n */\nexport interface FlipAnimation {\n  /** Play the FLIP animation */\n  play: () => Promise<void>\n  /** Get current progress (0-1) */\n  getProgress: () => number\n  /** Cancel the animation */\n  cancel: () => void\n  /** Check if animating */\n  isAnimating: () => boolean\n}\n\n/**\n * Measure the bounding box of an element\n */\nexport function measureElement(element: HTMLElement): MeasuredBox {\n  const rect = element.getBoundingClientRect()\n  return {\n    x: rect.left + window.scrollX,\n    y: rect.top + window.scrollY,\n    width: rect.width,\n    height: rect.height,\n  }\n}\n\n/**\n * Create a FLIP (First, Last, Invert, Play) animation.\n *\n * FLIP is a technique for animating layout changes performantly:\n * 1. First: Measure the element's initial position\n * 2. Last: Apply the change and measure final position\n * 3. Invert: Apply transforms to make it look like it's still in the first position\n * 4. Play: Animate the transforms to zero\n *\n * @example Basic FLIP\n * ```ts\n * // Measure first position\n * const first = measureElement(element)\n *\n * // Make layout change\n * element.classList.toggle('expanded')\n *\n * // Measure last position\n * const last = measureElement(element)\n *\n * // Create and play FLIP animation\n * const flip = createFlip(element, first, last)\n * await flip.play()\n * ```\n *\n * @example With options\n * ```ts\n * const flip = createFlip(element, first, last, {\n *   config: { stiffness: 300, damping: 30 },\n *   position: true,  // Animate position\n *   size: true,      // Animate size\n *   onComplete: () => console.log('Done!'),\n * })\n * ```\n */\nexport function createFlip(\n  element: HTMLElement,\n  first: MeasuredBox,\n  last: MeasuredBox,\n  options: FlipOptions = {}\n): FlipAnimation {\n  const {\n    config = {},\n    position = true,\n    size = true,\n    onComplete,\n    onUpdate,\n  } = options\n\n  // Calculate the inversion (how much to transform to get back to \"first\")\n  const deltaX = first.x - last.x\n  const deltaY = first.y - last.y\n  const deltaWidth = first.width / last.width\n  const deltaHeight = first.height / last.height\n\n  let progress = 0\n  let isPlaying = false\n  let cancelled = false\n\n  const spring = createSpringValue(0, config)\n\n  // Store original transform\n  const originalTransform = element.style.transform\n  const originalTransformOrigin = element.style.transformOrigin\n\n  // Set transform origin to top-left for size animations\n  if (size) {\n    element.style.transformOrigin = '0 0'\n  }\n\n  const applyTransform = (t: number) => {\n    progress = t\n    const invertedT = 1 - t\n\n    const transforms: string[] = []\n\n    if (position) {\n      transforms.push(`translate(${deltaX * invertedT}px, ${deltaY * invertedT}px)`)\n    }\n\n    if (size && (deltaWidth !== 1 || deltaHeight !== 1)) {\n      const scaleX = 1 + (deltaWidth - 1) * invertedT\n      const scaleY = 1 + (deltaHeight - 1) * invertedT\n      transforms.push(`scale(${scaleX}, ${scaleY})`)\n    }\n\n    element.style.transform = transforms.length > 0 ? transforms.join(' ') : ''\n    onUpdate?.(t)\n  }\n\n  // Apply initial inversion\n  applyTransform(0)\n\n  const cleanup = () => {\n    // Restore original styles\n    element.style.transform = originalTransform\n    element.style.transformOrigin = originalTransformOrigin\n  }\n\n  return {\n    play: async () => {\n      if (cancelled) return\n\n      isPlaying = true\n\n      return new Promise<void>((resolve) => {\n        const unsubscribe = spring.subscribe((value) => {\n          if (cancelled) {\n            unsubscribe()\n            resolve()\n            return\n          }\n          applyTransform(value)\n        })\n\n        spring.set(1)\n\n        // Wait for animation to complete\n        const checkComplete = () => {\n          if (cancelled) {\n            unsubscribe()\n            cleanup()\n            resolve()\n            return\n          }\n\n          if (!spring.isAnimating()) {\n            isPlaying = false\n            unsubscribe()\n            cleanup()\n            onComplete?.()\n            resolve()\n          } else {\n            requestAnimationFrame(checkComplete)\n          }\n        }\n\n        setTimeout(checkComplete, 16)\n      })\n    },\n\n    getProgress: () => progress,\n\n    cancel: () => {\n      cancelled = true\n      isPlaying = false\n      spring.stop()\n      cleanup()\n    },\n\n    isAnimating: () => isPlaying,\n  }\n}\n\n/**\n * Higher-level helper that handles the full FLIP flow.\n * Automatically measures before/after states.\n *\n * @example\n * ```ts\n * await flip(element, () => {\n *   element.classList.toggle('expanded')\n * }, { config: { stiffness: 200 } })\n * ```\n */\nexport async function flip(\n  element: HTMLElement,\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure initial state\n  const first = measureElement(element)\n\n  // Last: apply mutation and measure final state\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  element.offsetHeight\n\n  const last = measureElement(element)\n\n  // Invert & Play\n  const animation = createFlip(element, first, last, options)\n  await animation.play()\n}\n\n/**\n * Batch FLIP animations for multiple elements.\n * Useful when multiple elements change position together.\n *\n * @example\n * ```ts\n * await flipBatch(\n *   [card1, card2, card3],\n *   () => container.classList.toggle('grid'),\n *   { config: { stiffness: 150 } }\n * )\n * ```\n */\nexport async function flipBatch(\n  elements: HTMLElement[],\n  mutate: () => void | Promise<void>,\n  options: FlipOptions = {}\n): Promise<void> {\n  // First: measure all elements\n  const firstStates = elements.map((el) => measureElement(el))\n\n  // Last: apply mutation\n  await mutate()\n\n  // Force layout recalculation\n  // eslint-disable-next-line @typescript-eslint/no-unused-expressions\n  document.body.offsetHeight\n\n  // Measure all final states and create animations\n  const animations = elements.map((element, i) => {\n    const last = measureElement(element)\n    return createFlip(element, firstStates[i]!, last, options)\n  })\n\n  // Play all animations\n  await Promise.all(animations.map((anim) => anim.play()))\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig, SpringGroup } from '../../../types.js'\n\n/**\n * Animated values type\n */\nexport type AnimatedValues<T extends Record<string, number>> = {\n  [K in keyof T]: number\n}\n\n/**\n * Hook for animating multiple values with springs\n *\n * @param values - Target values object\n * @param config - Spring configuration\n * @returns Current animated values\n *\n * @example\n * ```tsx\n * function Box() {\n *   const [isOpen, setIsOpen] = useState(false)\n *\n *   const style = useSpring({\n *     width: isOpen ? 300 : 100,\n *     height: isOpen ? 200 : 100,\n *     opacity: isOpen ? 1 : 0.5,\n *   }, {\n *     stiffness: 100,\n *     damping: 10,\n *   })\n *\n *   return (\n *     <div\n *       onClick={() => setIsOpen(!isOpen)}\n *       style={{\n *         width: style.width,\n *         height: style.height,\n *         opacity: style.opacity,\n *       }}\n *     />\n *   )\n * }\n * ```\n */\nexport function useSpring<T extends Record<string, number>>(\n  values: T,\n  config: Partial<SpringConfig> = {}\n): AnimatedValues<T> {\n  const springRef = useRef<SpringGroup<T> | null>(null)\n  const [, forceUpdate] = useState({})\n  const isFirstRender = useRef(true)\n  const prevValuesStringRef = useRef<string>(JSON.stringify(values))\n\n  // Initialize spring group with ACTUAL initial values (not 0)\n  if (!springRef.current) {\n    springRef.current = createSpringGroup(values, config)\n    springRef.current.subscribe(() => forceUpdate({}))\n  }\n\n  // Update when values change (skip first render since we initialized with values)\n  useEffect(() => {\n    if (isFirstRender.current) {\n      isFirstRender.current = false\n      return\n    }\n\n    // Compare using JSON string to detect actual value changes\n    const currentValuesString = JSON.stringify(values)\n    if (currentValuesString !== prevValuesStringRef.current) {\n      springRef.current?.set(values, config)\n      prevValuesStringRef.current = currentValuesString\n    }\n  }, [JSON.stringify(values)]) // eslint-disable-line react-hooks/exhaustive-deps\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => springRef.current?.destroy()\n  }, [])\n\n  return springRef.current.get()\n}\n","import { useEffect, useRef } from 'react'\nimport { createSpringValue } from '../../../index.js'\nimport type { SpringConfig, SpringValue } from '../../../types.js'\n\n/**\n * Hook for creating a spring value\n *\n * @param initial - Initial value\n * @param config - Spring configuration\n * @returns Spring value controller\n *\n * @example\n * ```tsx\n * function ProgressBar({ value }) {\n *   const progress = useSpringValue(value, {\n *     stiffness: 100,\n *     damping: 20,\n *   })\n *\n *   useEffect(() => {\n *     progress.set(value)\n *   }, [value])\n *\n *   return (\n *     <div className=\"progress-container\">\n *       <div\n *         className=\"progress-bar\"\n *         style={{ width: `${progress.get()}%` }}\n *       />\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useSpringValue(\n  initial: number,\n  config: SpringConfig = {}\n): SpringValue {\n  const springRef = useRef<SpringValue | null>(null)\n\n  if (!springRef.current) {\n    springRef.current = createSpringValue(initial, config)\n  }\n\n  useEffect(() => {\n    return () => springRef.current?.destroy()\n  }, [])\n\n  return springRef.current\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Spring item configuration\n */\nexport interface SpringItem<T> {\n  values: T\n  from?: Partial<T>\n  delay?: number\n  config?: Partial<SpringConfig>\n}\n\n/**\n * Hook for managing multiple spring animations\n *\n * @param count - Number of springs\n * @param items - Function that returns spring config for each index\n * @param defaultConfig - Default spring configuration\n * @returns Array of animated values\n *\n * @example\n * ```tsx\n * function AnimatedList({ items }) {\n *   const springs = useSprings(\n *     items.length,\n *     (index) => ({\n *       opacity: 1,\n *       y: 0,\n *       from: { opacity: 0, y: 20 },\n *       delay: index * 50,\n *     })\n *   )\n *\n *   return (\n *     <ul>\n *       {items.map((item, index) => (\n *         <li\n *           key={item.id}\n *           style={{\n *             opacity: springs[index].opacity,\n *             transform: `translateY(${springs[index].y}px)`,\n *           }}\n *         >\n *           {item.name}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useSprings<T extends Record<string, number>>(\n  count: number,\n  items: (index: number) => SpringItem<T>,\n  defaultConfig: Partial<SpringConfig> = {}\n): Array<{ [K in keyof T]: number }> {\n  const springsRef = useRef<Array<ReturnType<typeof createSpringGroup<T>>>>([])\n  const [, forceUpdate] = useState({})\n\n  // Initialize springs\n  useEffect(() => {\n    // Clean up old springs\n    springsRef.current.forEach((s) => s?.destroy())\n    springsRef.current = []\n\n    // Create new springs\n    for (let i = 0; i < count; i++) {\n      const item = items(i)\n      const initialValues = (item.from ?? item.values) as T\n      const spring = createSpringGroup(initialValues, {\n        ...defaultConfig,\n        ...item.config,\n      })\n\n      spring.subscribe(() => forceUpdate({}))\n      springsRef.current.push(spring)\n\n      // Start animation with delay\n      setTimeout(() => {\n        spring.set(item.values as Partial<T>)\n      }, item.delay ?? 0)\n    }\n\n    return () => {\n      springsRef.current.forEach((s) => s?.destroy())\n    }\n  }, [count, defaultConfig])\n\n  // Get current values\n  return springsRef.current.map((spring) => spring?.get() ?? ({} as T))\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { createSpringValue, type SpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Hook for creating trail animations with staggered delays\n *\n * @param count - Number of items in the trail\n * @param values - Target values object (all numeric properties will be animated)\n * @param config - Spring configuration\n * @returns Array of animated value objects\n *\n * @example\n * ```tsx\n * function TrailList({ items, isVisible }) {\n *   const trail = useTrail(items.length, {\n *     opacity: isVisible ? 1 : 0,\n *     x: isVisible ? 0 : -20,\n *   }, { stiffness: 120, damping: 14 })\n *\n *   return (\n *     <ul>\n *       {trail.map((style, index) => (\n *         <li\n *           key={items[index].id}\n *           style={{\n *             opacity: style.opacity,\n *             transform: `translateX(${style.x}px)`,\n *           }}\n *         >\n *           {items[index].name}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useTrail<T extends Record<string, number>>(\n  count: number,\n  values: T,\n  config: SpringConfig = {}\n): Array<T> {\n  // Store springs for each item and each property\n  const springsRef = useRef<Map<string, SpringValue[]> | null>(null)\n  const [currentValues, setCurrentValues] = useState<T[]>(() =>\n    Array.from({ length: count }, () => ({ ...values }))\n  )\n  const isFirstRender = useRef(true)\n  const prevValuesRef = useRef<string>(JSON.stringify(values))\n\n  // Initialize springs\n  useEffect(() => {\n    const keys = Object.keys(values)\n    const springs = new Map<string, SpringValue[]>()\n\n    // Create springs for each property and each item\n    keys.forEach(key => {\n      const propSprings: SpringValue[] = []\n      const initialValue = values[key] as number\n      for (let i = 0; i < count; i++) {\n        const spring = createSpringValue(initialValue, config)\n        propSprings.push(spring)\n      }\n      springs.set(key, propSprings)\n    })\n\n    springsRef.current = springs\n\n    // Subscribe to all springs and update state\n    const unsubscribers: (() => void)[] = []\n\n    springs.forEach((propSprings, key) => {\n      propSprings.forEach((spring, index) => {\n        const unsub = spring.subscribe(() => {\n          setCurrentValues(prev => {\n            const next = [...prev]\n            if (!next[index]) {\n              next[index] = { ...values }\n            }\n            // Get current values from all springs for this index\n            const newItem = { ...next[index] } as T\n            springs.forEach((ps, k) => {\n              (newItem as Record<string, number>)[k] = ps[index]!.get()\n            })\n            next[index] = newItem\n            return next\n          })\n        })\n        unsubscribers.push(unsub)\n      })\n    })\n\n    return () => {\n      unsubscribers.forEach(unsub => unsub())\n      springs.forEach(propSprings => {\n        propSprings.forEach(spring => spring.destroy())\n      })\n      springsRef.current = null\n    }\n  }, [count])\n\n  // Update springs when values change with staggered delay\n  useEffect(() => {\n    if (!springsRef.current) return\n\n    const currentValuesString = JSON.stringify(values)\n    if (isFirstRender.current) {\n      isFirstRender.current = false\n      prevValuesRef.current = currentValuesString\n      return\n    }\n\n    if (currentValuesString === prevValuesRef.current) return\n    prevValuesRef.current = currentValuesString\n\n    const keys = Object.keys(values)\n    const staggerDelay = 50 // ms between each item\n\n    keys.forEach(key => {\n      const propSprings = springsRef.current?.get(key)\n      if (!propSprings) return\n\n      const targetValue = values[key] as number\n      propSprings.forEach((spring, index) => {\n        setTimeout(() => {\n          spring.set(targetValue, config)\n        }, index * staggerDelay)\n      })\n    })\n  }, [JSON.stringify(values), config.stiffness, config.damping])\n\n  return currentValues\n}\n","import { useEffect, useRef, useState } from 'react'\nimport { createDragSpring } from '../../../index.js'\nimport type { DragSpring, DragSpringConfig } from '../../../types.js'\n\n/**\n * Drag API interface\n */\nexport interface DragAPI {\n  /** Ref callback to attach to your draggable element */\n  ref: (el: HTMLElement | null) => void\n  /** Set position */\n  set(values: { x?: number; y?: number }): void\n  /** Reset to initial position */\n  reset(): void\n  /** Whether currently dragging */\n  isDragging: boolean\n}\n\n/**\n * Hook for creating drag interactions\n *\n * @param config - Drag spring configuration\n * @returns Tuple of [position, api]\n *\n * @example\n * ```tsx\n * function DraggableCard() {\n *   const [{ x, y }, api] = useDrag({\n *     bounds: { left: 0, right: 300, top: 0, bottom: 200 },\n *     rubberBand: true,\n *     stiffness: 200,\n *     damping: 20,\n *   })\n *\n *   return (\n *     <div\n *       ref={api.ref}\n *       style={{\n *         transform: `translate(${x}px, ${y}px)`,\n *         width: 100,\n *         height: 100,\n *         background: '#3b82f6',\n *       }}\n *     >\n *       Drag me!\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useDrag(config: DragSpringConfig = {}): [\n  { x: number; y: number },\n  DragAPI\n] {\n  const dragSpringRef = useRef<DragSpring | null>(null)\n  const positionRef = useRef({ x: 0, y: 0 })\n  const [element, setElement] = useState<HTMLElement | null>(null)\n  const [isDragging, setIsDragging] = useState(false)\n  const [, forceUpdate] = useState({})\n  const configRef = useRef(config)\n\n  // Keep config ref updated\n  configRef.current = config\n\n  // Ref callback - triggers re-render when element changes\n  const refCallback = (el: HTMLElement | null) => {\n    setElement(el)\n  }\n\n  // Setup/cleanup drag spring when element changes\n  useEffect(() => {\n    // Cleanup previous instance\n    if (dragSpringRef.current) {\n      dragSpringRef.current.destroy()\n      dragSpringRef.current = null\n    }\n\n    if (element) {\n      // Create drag spring with the element\n      dragSpringRef.current = createDragSpring(element, {\n        ...configRef.current,\n        onDragStart: (e) => {\n          setIsDragging(true)\n          configRef.current.onDragStart?.(e)\n        },\n        onDragEnd: (x, y, velocity) => {\n          setIsDragging(false)\n          configRef.current.onDragEnd?.(x, y, velocity)\n        },\n        onUpdate: (x, y) => {\n          positionRef.current = { x, y }\n          forceUpdate({})\n          configRef.current.onUpdate?.(x, y)\n        },\n      })\n    }\n\n    return () => {\n      dragSpringRef.current?.destroy()\n      dragSpringRef.current = null\n    }\n  }, [element])\n\n  // API methods\n  const set = (values: { x?: number; y?: number }) => {\n    const x = values.x ?? positionRef.current.x\n    const y = values.y ?? positionRef.current.y\n    dragSpringRef.current?.setPosition(x, y)\n  }\n\n  const reset = () => {\n    dragSpringRef.current?.reset()\n    positionRef.current = { x: 0, y: 0 }\n    forceUpdate({})\n  }\n\n  return [positionRef.current, { ref: refCallback, set, reset, isDragging }]\n}\n","import { useEffect, useRef, useState } from 'react'\n\n/**\n * Gesture state\n */\nexport interface GestureState {\n  x: number\n  y: number\n  scale?: number\n  angle?: number\n}\n\n/**\n * Gesture handlers\n */\nexport interface GestureHandlers {\n  onDrag?: (state: GestureState) => void\n  onPinch?: (state: GestureState) => void\n  onRotate?: (state: GestureState) => void\n}\n\n/**\n * Gesture bind function return type\n */\nexport interface GestureBind {\n  onPointerDown: (e: React.PointerEvent) => void\n  onPointerMove: (e: React.PointerEvent) => void\n  onPointerUp: (e: React.PointerEvent) => void\n  onPointerCancel: (e: React.PointerEvent) => void\n}\n\n/**\n * Hook for gesture interactions\n *\n * @param handlers - Gesture event handlers\n * @returns Bind function for attaching to elements\n *\n * @example\n * ```tsx\n * function GestureCard() {\n *   const [style, setStyle] = useState({\n *     x: 0,\n *     y: 0,\n *     scale: 1,\n *     rotation: 0,\n *   })\n *\n *   const bind = useGesture({\n *     onDrag: ({ x, y }) => {\n *       setStyle(s => ({ ...s, x, y }))\n *     },\n *     onPinch: ({ scale }) => {\n *       setStyle(s => ({ ...s, scale }))\n *     },\n *   })\n *\n *   return (\n *     <div\n *       {...bind()}\n *       style={{\n *         transform: `translate(${style.x}px, ${style.y}px) scale(${style.scale})`,\n *       }}\n *     >\n *       Gesture enabled card\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useGesture(handlers: GestureHandlers): GestureBind {\n  const stateRef = useRef({\n    isDragging: false,\n    startX: 0,\n    startY: 0,\n    currentX: 0,\n    currentY: 0,\n  })\n\n  const onPointerDown = (e: React.PointerEvent) => {\n    stateRef.current = {\n      isDragging: true,\n      startX: e.clientX,\n      startY: e.clientY,\n      currentX: e.clientX,\n      currentY: e.clientY,\n    }\n  }\n\n  const onPointerMove = (e: React.PointerEvent) => {\n    if (!stateRef.current.isDragging) return\n\n    const deltaX = e.clientX - stateRef.current.startX\n    const deltaY = e.clientY - stateRef.current.startY\n\n    handlers.onDrag?.({ x: deltaX, y: deltaY })\n\n    stateRef.current.currentX = e.clientX\n    stateRef.current.currentY = e.clientY\n  }\n\n  const onPointerUp = () => {\n    stateRef.current.isDragging = false\n  }\n\n  const onPointerCancel = () => {\n    stateRef.current.isDragging = false\n  }\n\n  return {\n    onPointerDown,\n    onPointerMove,\n    onPointerUp,\n    onPointerCancel,\n  }\n}\n","import { createContext } from 'react'\n\n/**\n * Context value for presence state in AnimatePresence\n */\nexport interface PresenceContextValue {\n  /** Unique ID for this presence instance */\n  id: string\n  /** Whether the component is present in the tree */\n  isPresent: boolean\n  /** Call this when exit animation is complete to allow unmounting */\n  safeToRemove: () => void\n  /** Custom data passed from AnimatePresence */\n  custom?: unknown\n}\n\n/**\n * Context for managing presence state in AnimatePresence\n *\n * When a child is removed from AnimatePresence, it stays mounted\n * while its exit animation plays. This context provides:\n * - isPresent: false when the child should animate out\n * - safeToRemove: callback to signal animation completion\n */\nexport const PresenceContext = createContext<PresenceContextValue | null>(null)\n\nPresenceContext.displayName = 'PresenceContext'\n","import { useContext, useCallback, useEffect } from 'react'\nimport { PresenceContext } from '../context/PresenceContext.js'\n\n/**\n * Hook for custom exit animation control in AnimatePresence\n *\n * Returns a tuple of [isPresent, safeToRemove]:\n * - isPresent: true when component should be visible, false when exiting\n * - safeToRemove: call this when your exit animation is complete\n *\n * @example\n * ```tsx\n * function Modal() {\n *   const [isPresent, safeToRemove] = usePresence()\n *\n *   useEffect(() => {\n *     if (!isPresent) {\n *       // Animate out, then call safeToRemove\n *       animate(element, { opacity: 0 }).then(safeToRemove)\n *     }\n *   }, [isPresent])\n *\n *   return <div>Modal content</div>\n * }\n *\n * // In parent:\n * <AnimatePresence>\n *   {showModal && <Modal key=\"modal\" />}\n * </AnimatePresence>\n * ```\n */\nexport function usePresence(): [boolean, () => void] {\n  const context = useContext(PresenceContext)\n\n  // If not inside AnimatePresence, always present\n  if (context === null) {\n    return [true, () => {}]\n  }\n\n  return [context.isPresent, context.safeToRemove]\n}\n\n/**\n * Hook that returns whether the component is present\n *\n * Simpler alternative to usePresence when you only need the presence state\n * and are using built-in exit animations (via exit prop).\n *\n * @example\n * ```tsx\n * function Item() {\n *   const isPresent = useIsPresent()\n *   return <div style={{ opacity: isPresent ? 1 : 0 }}>Item</div>\n * }\n * ```\n */\nexport function useIsPresent(): boolean {\n  const context = useContext(PresenceContext)\n  return context === null ? true : context.isPresent\n}\n\n/**\n * Hook that returns custom data passed from AnimatePresence\n *\n * Useful for passing dynamic values to exit animations\n *\n * @example\n * ```tsx\n * <AnimatePresence custom={direction}>\n *   <Slide key={index} />\n * </AnimatePresence>\n *\n * function Slide() {\n *   const custom = usePresenceCustom<number>()\n *   const exitX = custom > 0 ? 100 : -100\n *   return <Animated.div exit={{ x: exitX }} />\n * }\n * ```\n */\nexport function usePresenceCustom<T = unknown>(): T | undefined {\n  const context = useContext(PresenceContext)\n  return context?.custom as T | undefined\n}\n","import { useRef, useCallback, useEffect } from 'react'\nimport { createSpringValue } from '../../../core/spring-value.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Animation target - either a CSS property object or a keyframe array\n */\nexport interface AnimationTarget {\n  [property: string]: number | number[]\n}\n\n/**\n * Animation options for useAnimate\n */\nexport interface AnimateOptions {\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Delay before animation starts (ms) */\n  delay?: number\n  /** Callback when animation completes */\n  onComplete?: () => void\n}\n\n/**\n * Animate function returned by useAnimate\n */\nexport type AnimateFunction = (\n  target: AnimationTarget,\n  options?: AnimateOptions\n) => Promise<void>\n\n/**\n * Animation controls for managing animations\n */\nexport interface AnimationControls {\n  /** Stop all running animations */\n  stop: () => void\n  /** Get current value of a property */\n  get: (property: string) => number | undefined\n  /** Check if any animation is running */\n  isAnimating: () => boolean\n}\n\n/**\n * Return type of useAnimate hook\n */\nexport type UseAnimateReturn = [\n  React.RefObject<HTMLElement | null>,\n  AnimateFunction,\n  AnimationControls\n]\n\n/**\n * Imperative animation hook for programmatic control.\n * Returns a ref to attach to elements and an animate function.\n *\n * @example Basic usage\n * ```tsx\n * function Component() {\n *   const [scope, animate, controls] = useAnimate()\n *\n *   const handleClick = async () => {\n *     await animate({ opacity: 1, x: 100 })\n *     await animate({ scale: 1.2 })\n *     await animate({ scale: 1, opacity: 0.5 })\n *   }\n *\n *   return (\n *     <div ref={scope} onClick={handleClick}>\n *       Animate me\n *     </div>\n *   )\n * }\n * ```\n *\n * @example With options\n * ```tsx\n * const [scope, animate] = useAnimate()\n *\n * await animate(\n *   { x: 200, rotation: 45 },\n *   { config: { stiffness: 300, damping: 20 }, delay: 100 }\n * )\n * ```\n *\n * @example Keyframe animation\n * ```tsx\n * const [scope, animate] = useAnimate()\n *\n * // Animate through multiple values\n * await animate({ opacity: [0, 1, 0.5, 1] })\n * ```\n */\nexport function useAnimate(): UseAnimateReturn {\n  const scopeRef = useRef<HTMLElement | null>(null)\n  const springsRef = useRef<Map<string, ReturnType<typeof createSpringValue>>>(new Map())\n  const valuesRef = useRef<Map<string, number>>(new Map())\n  const isAnimatingRef = useRef(false)\n  const cleanupRef = useRef<(() => void)[]>([])\n\n  // Map CSS property names to transform functions\n  const getPropertyStyle = useCallback((property: string, value: number): string | null => {\n    const transforms = ['x', 'y', 'z', 'scale', 'scaleX', 'scaleY', 'rotate', 'rotateX', 'rotateY', 'rotateZ']\n\n    if (transforms.includes(property)) {\n      return null // Handle transforms separately\n    }\n\n    return null // Direct style property\n  }, [])\n\n  const applyStyles = useCallback(() => {\n    const element = scopeRef.current\n    if (!element) return\n\n    const transforms: string[] = []\n    const styles: Record<string, string> = {}\n\n    valuesRef.current.forEach((value, property) => {\n      switch (property) {\n        case 'x':\n          transforms.push(`translateX(${value}px)`)\n          break\n        case 'y':\n          transforms.push(`translateY(${value}px)`)\n          break\n        case 'z':\n          transforms.push(`translateZ(${value}px)`)\n          break\n        case 'scale':\n          transforms.push(`scale(${value})`)\n          break\n        case 'scaleX':\n          transforms.push(`scaleX(${value})`)\n          break\n        case 'scaleY':\n          transforms.push(`scaleY(${value})`)\n          break\n        case 'rotate':\n        case 'rotateZ':\n          transforms.push(`rotate(${value}deg)`)\n          break\n        case 'rotateX':\n          transforms.push(`rotateX(${value}deg)`)\n          break\n        case 'rotateY':\n          transforms.push(`rotateY(${value}deg)`)\n          break\n        case 'opacity':\n          styles.opacity = String(value)\n          break\n        default:\n          // Assume pixel values for other properties\n          styles[property] = `${value}px`\n      }\n    })\n\n    if (transforms.length > 0) {\n      element.style.transform = transforms.join(' ')\n    }\n\n    Object.entries(styles).forEach(([prop, val]) => {\n      element.style.setProperty(prop, val)\n    })\n  }, [])\n\n  const animate: AnimateFunction = useCallback(async (target, options = {}) => {\n    const { config = {}, delay = 0, onComplete } = options\n\n    if (delay > 0) {\n      await new Promise((resolve) => setTimeout(resolve, delay))\n    }\n\n    isAnimatingRef.current = true\n\n    const promises: Promise<void>[] = []\n\n    for (const [property, value] of Object.entries(target)) {\n      const targetValues = Array.isArray(value) ? value : [value]\n      const currentValue = valuesRef.current.get(property) ?? 0\n\n      // Animate through each value in sequence\n      let animationPromise = Promise.resolve()\n\n      for (const targetValue of targetValues) {\n        animationPromise = animationPromise.then(() => {\n          return new Promise<void>((resolve) => {\n            // Get or create spring for this property\n            let spring = springsRef.current.get(property)\n\n            if (!spring) {\n              spring = createSpringValue(valuesRef.current.get(property) ?? 0, config)\n              springsRef.current.set(property, spring)\n\n              const unsubscribe = spring.subscribe((v) => {\n                valuesRef.current.set(property, v)\n                applyStyles()\n              })\n\n              cleanupRef.current.push(unsubscribe)\n            }\n\n            // Update config if provided\n            if (config.stiffness || config.damping || config.mass) {\n              spring.setConfig(config)\n            }\n\n            spring.set(targetValue)\n\n            // Wait for animation to complete\n            const checkComplete = () => {\n              if (spring && !spring.isAnimating()) {\n                resolve()\n              } else {\n                requestAnimationFrame(checkComplete)\n              }\n            }\n\n            setTimeout(checkComplete, 16)\n          })\n        })\n      }\n\n      promises.push(animationPromise)\n    }\n\n    await Promise.all(promises)\n\n    isAnimatingRef.current = false\n    onComplete?.()\n  }, [applyStyles])\n\n  const controls: AnimationControls = {\n    stop: useCallback(() => {\n      springsRef.current.forEach((spring) => {\n        spring.stop()\n      })\n      isAnimatingRef.current = false\n    }, []),\n\n    get: useCallback((property: string) => {\n      return valuesRef.current.get(property)\n    }, []),\n\n    isAnimating: useCallback(() => {\n      return isAnimatingRef.current\n    }, []),\n  }\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      cleanupRef.current.forEach((cleanup) => cleanup())\n      springsRef.current.forEach((spring) => spring.destroy())\n      springsRef.current.clear()\n    }\n  }, [])\n\n  return [scopeRef, animate, controls]\n}\n","import { useRef, useEffect, useState, useCallback } from 'react'\nimport { MotionValue, createMotionValue, type MotionValueOptions } from '../../../core/MotionValue.js'\n\n/**\n * Create a MotionValue that persists across renders\n *\n * Unlike useState, updating a MotionValue doesn't trigger re-renders.\n * This makes it perfect for high-frequency animations.\n *\n * @example\n * ```tsx\n * function DragBox() {\n *   const x = useMotionValue(0)\n *   const y = useMotionValue(0)\n *\n *   return (\n *     <div\n *       ref={(el) => {\n *         if (!el) return\n *         x.subscribe((v) => el.style.transform = `translateX(${v}px)`)\n *       }}\n *       onMouseMove={(e) => {\n *         x.set(e.clientX)\n *         y.set(e.clientY)\n *       }}\n *     />\n *   )\n * }\n * ```\n */\nexport function useMotionValue<T = number>(\n  initialValue: T,\n  options?: MotionValueOptions\n): MotionValue<T> {\n  const motionValueRef = useRef<MotionValue<T> | null>(null)\n\n  // Create on first render only\n  if (motionValueRef.current === null) {\n    motionValueRef.current = createMotionValue(initialValue, options)\n  }\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      motionValueRef.current?.destroy()\n    }\n  }, [])\n\n  return motionValueRef.current\n}\n\n/**\n * Subscribe to a MotionValue and trigger re-renders\n *\n * Use this when you need the value in render.\n * For most cases, prefer direct DOM updates via subscribe.\n *\n * @example\n * ```tsx\n * function ValueDisplay({ motionValue }) {\n *   const value = useMotionValueState(motionValue)\n *   return <span>{value.toFixed(2)}</span>\n * }\n * ```\n */\nexport function useMotionValueState<T>(motionValue: MotionValue<T>): T {\n  const [value, setValue] = useState<T>(motionValue.get())\n\n  useEffect(() => {\n    const unsubscribe = motionValue.subscribe((newValue) => {\n      setValue(newValue)\n    })\n\n    return unsubscribe\n  }, [motionValue])\n\n  return value\n}\n\n/**\n * Create a MotionValue that syncs with an external value\n *\n * Useful when you need a MotionValue that tracks a prop or state.\n *\n * @example\n * ```tsx\n * function AnimatedProgress({ progress }) {\n *   const motionProgress = useMotionValueSync(progress)\n *\n *   // motionProgress animates smoothly when progress prop changes\n *   return <ProgressBar motionValue={motionProgress} />\n * }\n * ```\n */\nexport function useMotionValueSync(\n  externalValue: number,\n  options?: MotionValueOptions\n): MotionValue<number> {\n  const motionValue = useMotionValue(externalValue, options)\n\n  useEffect(() => {\n    motionValue.set(externalValue)\n  }, [externalValue, motionValue])\n\n  return motionValue\n}\n\n/**\n * Create multiple MotionValues at once\n *\n * @example\n * ```tsx\n * function TransformBox() {\n *   const { x, y, scale, rotate } = useMotionValues({\n *     x: 0,\n *     y: 0,\n *     scale: 1,\n *     rotate: 0,\n *   })\n *\n *   // Each is an independent MotionValue\n *   x.set(100)\n *   scale.set(1.5)\n * }\n * ```\n */\nexport function useMotionValues<T extends Record<string, number>>(\n  initialValues: T,\n  options?: MotionValueOptions\n): { [K in keyof T]: MotionValue<number> } {\n  type ResultType = { [K in keyof T]: MotionValue<number> }\n  const motionValuesRef = useRef<ResultType | null>(null)\n\n  if (motionValuesRef.current === null) {\n    const values: Record<string, MotionValue<number>> = {}\n\n    for (const key in initialValues) {\n      if (Object.prototype.hasOwnProperty.call(initialValues, key)) {\n        const value = initialValues[key]\n        values[key] = createMotionValue(value as number, options)\n      }\n    }\n\n    motionValuesRef.current = values as ResultType\n  }\n\n  useEffect(() => {\n    return () => {\n      if (motionValuesRef.current) {\n        const current = motionValuesRef.current\n        for (const key in current) {\n          if (Object.prototype.hasOwnProperty.call(current, key)) {\n            current[key].destroy()\n          }\n        }\n      }\n    }\n  }, [])\n\n  return motionValuesRef.current\n}\n","import { useRef, useEffect, useMemo } from 'react'\nimport { MotionValue, createMotionValue } from '../../../core/MotionValue.js'\nimport { interpolate as coreInterpolate } from '../../../interpolation/interpolate.js'\n\ntype InputRange = number[]\ntype OutputRange = number[] | string[]\n\nexport interface UseTransformOptions {\n  /** Clamp output to the output range bounds */\n  clamp?: boolean\n  /** Custom easing function for the interpolation */\n  ease?: (t: number) => number\n}\n\n/**\n * Transform a MotionValue to a new derived value\n *\n * Supports two forms:\n * 1. Range mapping: useTransform(value, [0, 100], [0, 1])\n * 2. Function: useTransform(value, (v) => v * 2)\n *\n * @example Range mapping\n * ```tsx\n * const x = useMotionValue(0)\n * const opacity = useTransform(x, [0, 100], [1, 0])\n * const scale = useTransform(x, [-100, 0, 100], [0.5, 1, 1.5])\n * ```\n *\n * @example Function transform\n * ```tsx\n * const x = useMotionValue(0)\n * const inverted = useTransform(x, (v) => -v)\n * const clamped = useTransform(x, (v) => Math.max(0, Math.min(100, v)))\n * ```\n *\n * @example Chaining transforms\n * ```tsx\n * const x = useMotionValue(0)\n * const scale = useTransform(x, [0, 100], [1, 2])\n * const opacity = useTransform(scale, [1, 2], [0.5, 1])\n * ```\n */\nexport function useTransform<O = number>(\n  source: MotionValue<number>,\n  inputRangeOrTransform: InputRange | ((value: number) => O),\n  outputRange?: OutputRange,\n  options?: UseTransformOptions\n): MotionValue<O> {\n  const derivedRef = useRef<MotionValue<O> | null>(null)\n  const unsubscribeRef = useRef<(() => void) | null>(null)\n\n  // Determine transform function\n  const transformFn = useMemo(() => {\n    if (typeof inputRangeOrTransform === 'function') {\n      return inputRangeOrTransform\n    }\n\n    if (!outputRange) {\n      throw new Error('useTransform: outputRange is required when using range mapping')\n    }\n\n    const inputRange = inputRangeOrTransform\n\n    // Use core interpolate for numeric outputs\n    if (typeof outputRange[0] === 'number') {\n      return (value: number): O => {\n        // Find the segment\n        let i = 0\n        for (; i < inputRange.length - 1; i++) {\n          const nextVal = inputRange[i + 1]\n          if (nextVal !== undefined && value <= nextVal) break\n        }\n\n        const inputMin = inputRange[i] ?? 0\n        const inputMax = inputRange[Math.min(i + 1, inputRange.length - 1)] ?? 1\n        const outputMin = (outputRange[i] ?? 0) as number\n        const outputMax = (outputRange[Math.min(i + 1, outputRange.length - 1)] ?? 1) as number\n\n        // Normalize to 0-1\n        let t = inputMax !== inputMin\n          ? (value - inputMin) / (inputMax - inputMin)\n          : 0\n\n        // Apply easing if provided\n        if (options?.ease) {\n          t = options.ease(t)\n        }\n\n        // Clamp if requested\n        if (options?.clamp) {\n          t = Math.max(0, Math.min(1, t))\n        }\n\n        // Interpolate\n        return (outputMin + t * (outputMax - outputMin)) as O\n      }\n    }\n\n    // String interpolation (colors, etc.)\n    return (value: number): O => {\n      // Simple string interpolation - find nearest\n      let i = 0\n      for (; i < inputRange.length - 1; i++) {\n        const nextVal = inputRange[i + 1]\n        if (nextVal !== undefined && value <= nextVal) break\n      }\n\n      const inCurr = inputRange[i] ?? 0\n      const inNext = inputRange[i + 1] ?? 1\n\n      const t = inNext !== inCurr\n        ? (value - inCurr) / (inNext - inCurr)\n        : 0\n\n      // For strings, just return the nearest one\n      // (full color interpolation would require parsing)\n      return (t < 0.5 ? outputRange[i] : outputRange[i + 1]) as O\n    }\n  }, [inputRangeOrTransform, outputRange, options?.clamp, options?.ease])\n\n  // Create derived value on first render\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transformFn(source.get()))\n  }\n\n  // Subscribe to source changes\n  useEffect(() => {\n    unsubscribeRef.current = source.subscribe((value) => {\n      derivedRef.current?.jump(transformFn(value))\n    })\n\n    return () => {\n      unsubscribeRef.current?.()\n    }\n  }, [source, transformFn])\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n/**\n * Combine multiple MotionValues into one\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const y = useMotionValue(0)\n *\n * const distance = useCombinedTransform(\n *   [x, y],\n *   ([xVal, yVal]) => Math.sqrt(xVal ** 2 + yVal ** 2)\n * )\n * ```\n */\nexport function useCombinedTransform<T extends number[], O = number>(\n  sources: { [K in keyof T]: MotionValue<T[K]> },\n  transform: (values: T) => O\n): MotionValue<O> {\n  const derivedRef = useRef<MotionValue<O> | null>(null)\n  const unsubscribesRef = useRef<Array<() => void>>([])\n\n  // Get current values\n  const getCurrentValues = (): T => {\n    return sources.map((source) => source.get()) as T\n  }\n\n  // Create on first render\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transform(getCurrentValues()))\n  }\n\n  useEffect(() => {\n    // Subscribe to all sources\n    unsubscribesRef.current = sources.map((source) =>\n      source.subscribe(() => {\n        derivedRef.current?.jump(transform(getCurrentValues()))\n      })\n    )\n\n    return () => {\n      unsubscribesRef.current.forEach((unsub) => unsub())\n    }\n  }, [sources, transform])\n\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n/**\n * Apply velocity-based transform\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const skewX = useVelocityTransform(x, (velocity) => velocity * 0.1)\n * ```\n */\nexport function useVelocityTransform(\n  source: MotionValue<number>,\n  transform: (velocity: number) => number\n): MotionValue<number> {\n  const derivedRef = useRef<MotionValue<number> | null>(null)\n  const frameRef = useRef<number | null>(null)\n\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transform(source.getVelocity()))\n  }\n\n  useEffect(() => {\n    const update = () => {\n      derivedRef.current?.jump(transform(source.getVelocity()))\n      frameRef.current = requestAnimationFrame(update)\n    }\n\n    frameRef.current = requestAnimationFrame(update)\n\n    return () => {\n      if (frameRef.current) {\n        cancelAnimationFrame(frameRef.current)\n      }\n    }\n  }, [source, transform])\n\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n\n/**\n * Spring-based transform that animates to the transformed value\n *\n * Unlike useTransform which instantly updates, this animates smoothly.\n *\n * @example\n * ```tsx\n * const x = useMotionValue(0)\n * const smoothScale = useSpringTransform(x, [0, 100], [1, 2], {\n *   stiffness: 300,\n *   damping: 30\n * })\n * ```\n */\nexport function useSpringTransform(\n  source: MotionValue<number>,\n  inputRange: InputRange,\n  outputRange: number[],\n  springConfig?: { stiffness?: number; damping?: number }\n): MotionValue<number> {\n  const derivedRef = useRef<MotionValue<number> | null>(null)\n  const unsubscribeRef = useRef<(() => void) | null>(null)\n\n  const transform = useMemo(() => {\n    return (value: number): number => {\n      let i = 0\n      for (; i < inputRange.length - 1; i++) {\n        const nextVal = inputRange[i + 1]\n        if (nextVal !== undefined && value <= nextVal) break\n      }\n\n      const inCurr = inputRange[i] ?? 0\n      const inNext = inputRange[i + 1] ?? 1\n      const outCurr = outputRange[i] ?? 0\n      const outNext = outputRange[i + 1] ?? 1\n\n      const t = (value - inCurr) / (inNext - inCurr)\n      return outCurr + t * (outNext - outCurr)\n    }\n  }, [inputRange, outputRange])\n\n  if (derivedRef.current === null) {\n    derivedRef.current = createMotionValue(transform(source.get()), {\n      spring: springConfig,\n    })\n  }\n\n  useEffect(() => {\n    unsubscribeRef.current = source.subscribe((value) => {\n      // Use set (animated) instead of jump\n      derivedRef.current?.set(transform(value))\n    })\n\n    return () => {\n      unsubscribeRef.current?.()\n    }\n  }, [source, transform])\n\n  useEffect(() => {\n    return () => {\n      derivedRef.current?.destroy()\n    }\n  }, [])\n\n  return derivedRef.current\n}\n","import { useLayoutEffect, useEffect } from 'react'\n\n/**\n * Whether we're running in a browser environment\n */\nexport const isBrowser = typeof window !== 'undefined'\n\n/**\n * Whether we're running in a server environment (SSR)\n */\nexport const isServer = !isBrowser\n\n/**\n * SSR-safe version of useLayoutEffect\n *\n * Uses useLayoutEffect in the browser and useEffect on the server\n * to avoid React SSR warnings about useLayoutEffect.\n */\nexport const useIsomorphicLayoutEffect = isBrowser ? useLayoutEffect : useEffect\n\n/**\n * Check if we should skip animations (e.g., during SSR or initial hydration)\n */\nexport function shouldSkipAnimation(): boolean {\n  // Skip on server\n  if (isServer) return true\n\n  // Could add hydration detection here if needed\n  return false\n}\n\n/**\n * Safe requestAnimationFrame that works on server\n */\nexport function safeRequestAnimationFrame(callback: FrameRequestCallback): number {\n  if (isBrowser && typeof requestAnimationFrame !== 'undefined') {\n    return requestAnimationFrame(callback)\n  }\n  // Return a dummy ID on server\n  return 0\n}\n\n/**\n * Safe cancelAnimationFrame that works on server\n */\nexport function safeCancelAnimationFrame(id: number): void {\n  if (isBrowser && typeof cancelAnimationFrame !== 'undefined') {\n    cancelAnimationFrame(id)\n  }\n}\n","import { useState, useRef, useEffect, type RefObject } from 'react'\nimport { isBrowser } from '../utils/ssr.js'\n\nexport interface UseInViewOptions {\n  /**\n   * Only trigger once when element enters viewport\n   * @default false\n   */\n  once?: boolean\n\n  /**\n   * How much of the element should be visible\n   * - 'some': Any part visible (default)\n   * - 'all': Entire element visible\n   * - number: Percentage (0-1)\n   * @default 'some'\n   */\n  amount?: 'some' | 'all' | number\n\n  /**\n   * Margin around the root (viewport)\n   * Same format as CSS margin: \"10px\" or \"10px 20px\" etc.\n   * @default \"0px\"\n   */\n  margin?: string\n\n  /**\n   * Root element for intersection (null = viewport)\n   */\n  root?: RefObject<Element | null>\n}\n\nexport interface UseInViewReturn {\n  /** Ref to attach to the target element */\n  ref: RefObject<HTMLElement | null>\n  /** Whether the element is currently in view */\n  inView: boolean\n  /** IntersectionObserverEntry for advanced usage */\n  entry?: IntersectionObserverEntry\n}\n\n/**\n * Detect when an element enters/exits the viewport\n *\n * SSR-safe: Returns false on server, activates on client.\n *\n * @example Basic usage\n * ```tsx\n * function AnimatedBox() {\n *   const { ref, inView } = useInView()\n *\n *   return (\n *     <div\n *       ref={ref}\n *       style={{ opacity: inView ? 1 : 0 }}\n *     >\n *       I fade in when visible\n *     </div>\n *   )\n * }\n * ```\n *\n * @example Trigger once\n * ```tsx\n * function LazyLoad() {\n *   const { ref, inView } = useInView({ once: true })\n *\n *   return (\n *     <div ref={ref}>\n *       {inView && <ExpensiveComponent />}\n *     </div>\n *   )\n * }\n * ```\n *\n * @example With amount threshold\n * ```tsx\n * function FullyVisible() {\n *   const { ref, inView } = useInView({ amount: 'all' })\n *   // or amount: 0.5 for 50% visible\n * }\n * ```\n */\nexport function useInView(options: UseInViewOptions = {}): UseInViewReturn {\n  const {\n    once = false,\n    amount = 'some',\n    margin = '0px',\n    root,\n  } = options\n\n  const ref = useRef<HTMLElement | null>(null)\n  const [inView, setInView] = useState(false)\n  const [entry, setEntry] = useState<IntersectionObserverEntry | undefined>()\n  const hasTriggered = useRef(false)\n\n  useEffect(() => {\n    // SSR safety\n    if (!isBrowser) return\n\n    const element = ref.current\n    if (!element) return\n\n    // Skip if already triggered with once option\n    if (once && hasTriggered.current) return\n\n    // Calculate threshold\n    let threshold: number | number[]\n    if (amount === 'some') {\n      threshold = 0\n    } else if (amount === 'all') {\n      threshold = 1\n    } else {\n      threshold = amount\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const [observerEntry] = entries\n\n        if (observerEntry) {\n          const isIntersecting = observerEntry.isIntersecting\n\n          setEntry(observerEntry)\n          setInView(isIntersecting)\n\n          if (isIntersecting && once) {\n            hasTriggered.current = true\n            observer.disconnect()\n          }\n        }\n      },\n      {\n        root: root?.current ?? null,\n        rootMargin: margin,\n        threshold,\n      }\n    )\n\n    observer.observe(element)\n\n    return () => {\n      observer.disconnect()\n    }\n  }, [once, amount, margin, root])\n\n  return { ref, inView, entry }\n}\n\n/**\n * Create an InView trigger with a callback\n *\n * @example\n * ```tsx\n * function LazyImage({ src }) {\n *   const [loaded, setLoaded] = useState(false)\n *   const ref = useInViewCallback(() => setLoaded(true), { once: true })\n *\n *   return (\n *     <div ref={ref}>\n *       {loaded ? <img src={src} /> : <Placeholder />}\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useInViewCallback(\n  callback: (entry: IntersectionObserverEntry) => void,\n  options: UseInViewOptions = {}\n): RefObject<HTMLElement | null> {\n  const ref = useRef<HTMLElement | null>(null)\n  const callbackRef = useRef(callback)\n  const hasTriggered = useRef(false)\n\n  // Keep callback ref updated\n  callbackRef.current = callback\n\n  const { once = false, amount = 'some', margin = '0px', root } = options\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    const element = ref.current\n    if (!element) return\n\n    if (once && hasTriggered.current) return\n\n    let threshold: number\n    if (amount === 'some') {\n      threshold = 0\n    } else if (amount === 'all') {\n      threshold = 1\n    } else {\n      threshold = amount\n    }\n\n    const observer = new IntersectionObserver(\n      (entries) => {\n        const [entry] = entries\n\n        if (entry?.isIntersecting) {\n          callbackRef.current(entry)\n\n          if (once) {\n            hasTriggered.current = true\n            observer.disconnect()\n          }\n        }\n      },\n      {\n        root: root?.current ?? null,\n        rootMargin: margin,\n        threshold,\n      }\n    )\n\n    observer.observe(element)\n\n    return () => observer.disconnect()\n  }, [once, amount, margin, root])\n\n  return ref\n}\n\n/**\n * Track multiple elements' visibility\n *\n * @example\n * ```tsx\n * function AnimatedList({ items }) {\n *   const { setRef, getInView } = useInViewMultiple({ stagger: 100 })\n *\n *   return (\n *     <ul>\n *       {items.map((item, i) => (\n *         <li\n *           key={item.id}\n *           ref={(el) => setRef(item.id, el)}\n *           style={{ opacity: getInView(item.id) ? 1 : 0 }}\n *         >\n *           {item.text}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useInViewMultiple(options: UseInViewOptions = {}) {\n  const elementsRef = useRef<Map<string, HTMLElement>>(new Map())\n  const [inViewMap, setInViewMap] = useState<Map<string, boolean>>(new Map())\n  const observerRef = useRef<IntersectionObserver | null>(null)\n\n  const { once = false, amount = 'some', margin = '0px', root } = options\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    let threshold: number\n    if (amount === 'some') {\n      threshold = 0\n    } else if (amount === 'all') {\n      threshold = 1\n    } else {\n      threshold = amount\n    }\n\n    observerRef.current = new IntersectionObserver(\n      (entries) => {\n        setInViewMap((prev) => {\n          const next = new Map(prev)\n\n          entries.forEach((entry) => {\n            const id = (entry.target as HTMLElement).dataset.inviewId\n            if (id) {\n              next.set(id, entry.isIntersecting)\n\n              if (entry.isIntersecting && once) {\n                observerRef.current?.unobserve(entry.target)\n              }\n            }\n          })\n\n          return next\n        })\n      },\n      {\n        root: root?.current ?? null,\n        rootMargin: margin,\n        threshold,\n      }\n    )\n\n    // Observe all registered elements\n    elementsRef.current.forEach((element) => {\n      observerRef.current?.observe(element)\n    })\n\n    return () => {\n      observerRef.current?.disconnect()\n    }\n  }, [once, amount, margin, root])\n\n  const setRef = (id: string, element: HTMLElement | null) => {\n    if (element) {\n      element.dataset.inviewId = id\n      elementsRef.current.set(id, element)\n      observerRef.current?.observe(element)\n    } else {\n      const existing = elementsRef.current.get(id)\n      if (existing) {\n        observerRef.current?.unobserve(existing)\n        elementsRef.current.delete(id)\n      }\n    }\n  }\n\n  const getInView = (id: string): boolean => {\n    return inViewMap.get(id) ?? false\n  }\n\n  return { setRef, getInView, inViewMap }\n}\n","import { useRef, useEffect, type RefObject } from 'react'\nimport { MotionValue, createMotionValue } from '../../../core/MotionValue.js'\nimport { isBrowser } from '../utils/ssr.js'\n\nexport interface UseScrollOptions {\n  /**\n   * Target element to track scroll of\n   * If not provided, tracks window/document scroll\n   */\n  target?: RefObject<HTMLElement | null>\n\n  /**\n   * Container element for scroll tracking\n   * Used for calculating progress of target within container\n   */\n  container?: RefObject<HTMLElement | null>\n\n  /**\n   * Offset for start/end of scroll tracking\n   * Format: [\"start end\", \"end start\"]\n   *\n   * Values can be:\n   * - \"start\", \"center\", \"end\" (of element)\n   * - Pixels: \"100px\"\n   * - Percentage: \"50%\"\n   *\n   * @default [\"start start\", \"end end\"]\n   */\n  offset?: [string, string]\n\n  /**\n   * Axis to track\n   * @default \"y\"\n   */\n  axis?: 'x' | 'y'\n}\n\nexport interface UseScrollReturn {\n  /** Absolute scroll position X */\n  scrollX: MotionValue<number>\n  /** Absolute scroll position Y */\n  scrollY: MotionValue<number>\n  /** Scroll progress X (0-1) */\n  scrollXProgress: MotionValue<number>\n  /** Scroll progress Y (0-1) */\n  scrollYProgress: MotionValue<number>\n}\n\n/**\n * Track scroll position and progress with MotionValues\n *\n * Returns MotionValues that update without React re-renders,\n * making it perfect for scroll-linked animations.\n *\n * @example Window scroll\n * ```tsx\n * function ScrollProgress() {\n *   const { scrollYProgress } = useScroll()\n *\n *   useEffect(() => {\n *     return scrollYProgress.subscribe((progress) => {\n *       progressBar.style.scaleX = progress\n *     })\n *   }, [scrollYProgress])\n * }\n * ```\n *\n * @example Element scroll\n * ```tsx\n * function ScrollableContainer() {\n *   const containerRef = useRef(null)\n *   const { scrollY } = useScroll({ target: containerRef })\n *\n *   return (\n *     <div ref={containerRef} style={{ overflow: 'auto' }}>\n *       ...\n *     </div>\n *   )\n * }\n * ```\n *\n * @example Scroll-linked animation\n * ```tsx\n * function ParallaxImage() {\n *   const ref = useRef(null)\n *   const { scrollYProgress } = useScroll({\n *     target: ref,\n *     offset: [\"start end\", \"end start\"]\n *   })\n *   const y = useTransform(scrollYProgress, [0, 1], [\"-50%\", \"50%\"])\n *\n *   return (\n *     <div ref={ref}>\n *       <img style={{ transform: `translateY(${y.get()})` }} />\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useScroll(options: UseScrollOptions = {}): UseScrollReturn {\n  const { target, container, offset = ['start start', 'end end'], axis = 'y' } = options\n\n  // Create MotionValues\n  const scrollXRef = useRef<MotionValue<number> | null>(null)\n  const scrollYRef = useRef<MotionValue<number> | null>(null)\n  const scrollXProgressRef = useRef<MotionValue<number> | null>(null)\n  const scrollYProgressRef = useRef<MotionValue<number> | null>(null)\n\n  if (scrollXRef.current === null) {\n    scrollXRef.current = createMotionValue(0)\n    scrollYRef.current = createMotionValue(0)\n    scrollXProgressRef.current = createMotionValue(0)\n    scrollYProgressRef.current = createMotionValue(0)\n  }\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    const scrollX = scrollXRef.current!\n    const scrollY = scrollYRef.current!\n    const scrollXProgress = scrollXProgressRef.current!\n    const scrollYProgress = scrollYProgressRef.current!\n\n    // Determine scroll container\n    const scrollContainer = container?.current ?? (target?.current ?? window)\n    const isWindow = scrollContainer === window\n\n    const getScrollPosition = () => {\n      if (isWindow) {\n        return {\n          x: window.scrollX || window.pageXOffset,\n          y: window.scrollY || window.pageYOffset,\n        }\n      }\n      const el = scrollContainer as HTMLElement\n      return {\n        x: el.scrollLeft,\n        y: el.scrollTop,\n      }\n    }\n\n    const getScrollSize = () => {\n      if (isWindow) {\n        return {\n          width: document.documentElement.scrollWidth - window.innerWidth,\n          height: document.documentElement.scrollHeight - window.innerHeight,\n        }\n      }\n      const el = scrollContainer as HTMLElement\n      return {\n        width: el.scrollWidth - el.clientWidth,\n        height: el.scrollHeight - el.clientHeight,\n      }\n    }\n\n    const calculateProgress = () => {\n      const position = getScrollPosition()\n      const size = getScrollSize()\n\n      // Update absolute positions\n      scrollX.jump(position.x)\n      scrollY.jump(position.y)\n\n      // Update progress (0-1)\n      scrollXProgress.jump(size.width > 0 ? position.x / size.width : 0)\n      scrollYProgress.jump(size.height > 0 ? position.y / size.height : 0)\n    }\n\n    // Target element progress (element visibility in viewport)\n    const calculateTargetProgress = () => {\n      const targetEl = target?.current\n      if (!targetEl) {\n        calculateProgress()\n        return\n      }\n\n      const position = getScrollPosition()\n      scrollX.jump(position.x)\n      scrollY.jump(position.y)\n\n      // Get target bounds\n      const rect = targetEl.getBoundingClientRect()\n      const viewportHeight = window.innerHeight\n      const viewportWidth = window.innerWidth\n\n      // Parse offsets\n      const [startOffset, endOffset] = offset\n\n      // Calculate start and end points\n      // \"start end\" = when target top hits viewport bottom\n      // \"end start\" = when target bottom hits viewport top\n      const startPoint = parseOffset(startOffset, rect, viewportHeight, viewportWidth, 'start')\n      const endPoint = parseOffset(endOffset, rect, viewportHeight, viewportWidth, 'end')\n\n      // Current position in the range\n      const current = axis === 'y' ? rect.top : rect.left\n      const range = endPoint - startPoint\n\n      const progress = range !== 0 ? (startPoint - current) / range : 0\n      const clampedProgress = Math.max(0, Math.min(1, progress))\n\n      if (axis === 'y') {\n        scrollYProgress.jump(clampedProgress)\n      } else {\n        scrollXProgress.jump(clampedProgress)\n      }\n    }\n\n    // Use RAF for smooth updates\n    let rafId: number | null = null\n    const handleScroll = () => {\n      if (rafId !== null) return\n\n      rafId = requestAnimationFrame(() => {\n        if (target?.current) {\n          calculateTargetProgress()\n        } else {\n          calculateProgress()\n        }\n        rafId = null\n      })\n    }\n\n    // Initial calculation\n    handleScroll()\n\n    // Add scroll listener\n    const scrollTarget = isWindow ? window : scrollContainer\n    scrollTarget.addEventListener('scroll', handleScroll, { passive: true })\n\n    // Also listen to resize for progress recalculation\n    window.addEventListener('resize', handleScroll, { passive: true })\n\n    return () => {\n      scrollTarget.removeEventListener('scroll', handleScroll)\n      window.removeEventListener('resize', handleScroll)\n      if (rafId !== null) {\n        cancelAnimationFrame(rafId)\n      }\n    }\n  }, [target, container, offset, axis])\n\n  // Cleanup on unmount\n  useEffect(() => {\n    return () => {\n      scrollXRef.current?.destroy()\n      scrollYRef.current?.destroy()\n      scrollXProgressRef.current?.destroy()\n      scrollYProgressRef.current?.destroy()\n    }\n  }, [])\n\n  return {\n    scrollX: scrollXRef.current!,\n    scrollY: scrollYRef.current!,\n    scrollXProgress: scrollXProgressRef.current!,\n    scrollYProgress: scrollYProgressRef.current!,\n  }\n}\n\n/**\n * Parse offset string like \"start end\" or \"100px\"\n */\nfunction parseOffset(\n  offset: string,\n  rect: DOMRect,\n  viewportHeight: number,\n  viewportWidth: number,\n  type: 'start' | 'end'\n): number {\n  const parts = offset.split(' ')\n  const elementPart = parts[0] || 'start'\n  const viewportPart = parts[1] || 'start'\n\n  // Element position\n  let elementPos: number\n  if (elementPart === 'start') {\n    elementPos = type === 'start' ? rect.top : rect.top\n  } else if (elementPart === 'center') {\n    elementPos = rect.top + rect.height / 2\n  } else if (elementPart === 'end') {\n    elementPos = rect.bottom\n  } else if (elementPart.endsWith('px')) {\n    elementPos = rect.top + parseFloat(elementPart)\n  } else if (elementPart.endsWith('%')) {\n    elementPos = rect.top + (rect.height * parseFloat(elementPart)) / 100\n  } else {\n    elementPos = rect.top\n  }\n\n  // Viewport position\n  let viewportPos: number\n  if (viewportPart === 'start') {\n    viewportPos = 0\n  } else if (viewportPart === 'center') {\n    viewportPos = viewportHeight / 2\n  } else if (viewportPart === 'end') {\n    viewportPos = viewportHeight\n  } else if (viewportPart.endsWith('px')) {\n    viewportPos = parseFloat(viewportPart)\n  } else if (viewportPart.endsWith('%')) {\n    viewportPos = (viewportHeight * parseFloat(viewportPart)) / 100\n  } else {\n    viewportPos = 0\n  }\n\n  return viewportPos - elementPos\n}\n\n/**\n * Simple scroll velocity tracking\n *\n * @example\n * ```tsx\n * function ScrollVelocityText() {\n *   const velocity = useScrollVelocity()\n *\n *   return (\n *     <div style={{\n *       transform: `skewY(${velocity.get() * 0.01}deg)`\n *     }}>\n *       Skews based on scroll speed\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useScrollVelocity(axis: 'x' | 'y' = 'y'): MotionValue<number> {\n  const velocityRef = useRef<MotionValue<number> | null>(null)\n  const lastScrollRef = useRef(0)\n  const lastTimeRef = useRef(Date.now())\n\n  if (velocityRef.current === null) {\n    velocityRef.current = createMotionValue(0)\n  }\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    const velocity = velocityRef.current!\n\n    const handleScroll = () => {\n      const now = Date.now()\n      const currentScroll = axis === 'y'\n        ? (window.scrollY || window.pageYOffset)\n        : (window.scrollX || window.pageXOffset)\n\n      const deltaTime = now - lastTimeRef.current\n      const deltaScroll = currentScroll - lastScrollRef.current\n\n      if (deltaTime > 0) {\n        velocity.jump(deltaScroll / deltaTime * 1000) // pixels per second\n      }\n\n      lastScrollRef.current = currentScroll\n      lastTimeRef.current = now\n    }\n\n    window.addEventListener('scroll', handleScroll, { passive: true })\n\n    return () => {\n      window.removeEventListener('scroll', handleScroll)\n    }\n  }, [axis])\n\n  useEffect(() => {\n    return () => {\n      velocityRef.current?.destroy()\n    }\n  }, [])\n\n  return velocityRef.current!\n}\n","import { useState, useRef, useEffect, useCallback, type RefObject } from 'react'\nimport { isBrowser } from '../utils/ssr.js'\n\nexport interface GestureState {\n  /** Is the element being hovered */\n  isHovered: boolean\n  /** Is the element being pressed/tapped */\n  isPressed: boolean\n  /** Is the element focused */\n  isFocused: boolean\n  /** Is the element being dragged */\n  isDragging: boolean\n}\n\nexport interface UseGestureStateOptions {\n  /** Enable hover tracking */\n  hover?: boolean\n  /** Enable press/tap tracking */\n  press?: boolean\n  /** Enable focus tracking */\n  focus?: boolean\n  /** Enable drag tracking */\n  drag?: boolean\n}\n\nexport interface UseGestureStateReturn extends GestureState {\n  /** Ref to attach to the target element */\n  ref: RefObject<HTMLElement | null>\n  /** Handlers to spread on the element */\n  handlers: {\n    onMouseEnter?: () => void\n    onMouseLeave?: () => void\n    onMouseDown?: () => void\n    onMouseUp?: () => void\n    onTouchStart?: () => void\n    onTouchEnd?: () => void\n    onFocus?: () => void\n    onBlur?: () => void\n    onDragStart?: () => void\n    onDragEnd?: () => void\n  }\n}\n\n/**\n * Track gesture states for an element\n *\n * @example\n * ```tsx\n * function InteractiveButton() {\n *   const { ref, isHovered, isPressed, handlers } = useGestureState({\n *     hover: true,\n *     press: true,\n *   })\n *\n *   const scale = isPressed ? 0.95 : isHovered ? 1.05 : 1\n *\n *   return (\n *     <button\n *       ref={ref}\n *       {...handlers}\n *       style={{ transform: `scale(${scale})` }}\n *     >\n *       Click me\n *     </button>\n *   )\n * }\n * ```\n */\nexport function useGestureState(\n  options: UseGestureStateOptions = {}\n): UseGestureStateReturn {\n  const {\n    hover = true,\n    press = true,\n    focus = true,\n    drag = false,\n  } = options\n\n  const ref = useRef<HTMLElement | null>(null)\n  const [state, setState] = useState<GestureState>({\n    isHovered: false,\n    isPressed: false,\n    isFocused: false,\n    isDragging: false,\n  })\n\n  // Memoized handlers\n  const handlers = {\n    ...(hover && {\n      onMouseEnter: () => setState((s) => ({ ...s, isHovered: true })),\n      onMouseLeave: () => setState((s) => ({ ...s, isHovered: false, isPressed: false })),\n    }),\n    ...(press && {\n      onMouseDown: () => setState((s) => ({ ...s, isPressed: true })),\n      onMouseUp: () => setState((s) => ({ ...s, isPressed: false })),\n      onTouchStart: () => setState((s) => ({ ...s, isPressed: true })),\n      onTouchEnd: () => setState((s) => ({ ...s, isPressed: false })),\n    }),\n    ...(focus && {\n      onFocus: () => setState((s) => ({ ...s, isFocused: true })),\n      onBlur: () => setState((s) => ({ ...s, isFocused: false })),\n    }),\n    ...(drag && {\n      onDragStart: () => setState((s) => ({ ...s, isDragging: true })),\n      onDragEnd: () => setState((s) => ({ ...s, isDragging: false })),\n    }),\n  }\n\n  // Global mouseup listener for press\n  useEffect(() => {\n    if (!press || !isBrowser) return\n\n    const handleGlobalMouseUp = () => {\n      setState((s) => (s.isPressed ? { ...s, isPressed: false } : s))\n    }\n\n    window.addEventListener('mouseup', handleGlobalMouseUp)\n    window.addEventListener('touchend', handleGlobalMouseUp)\n\n    return () => {\n      window.removeEventListener('mouseup', handleGlobalMouseUp)\n      window.removeEventListener('touchend', handleGlobalMouseUp)\n    }\n  }, [press])\n\n  return {\n    ref,\n    ...state,\n    handlers,\n  }\n}\n\n/**\n * Hook for hover state only\n *\n * @example\n * ```tsx\n * function HoverCard() {\n *   const { ref, isHovered, handlers } = useHover()\n *\n *   return (\n *     <div\n *       ref={ref}\n *       {...handlers}\n *       style={{ opacity: isHovered ? 1 : 0.7 }}\n *     >\n *       Hover me\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useHover() {\n  const ref = useRef<HTMLElement | null>(null)\n  const [isHovered, setIsHovered] = useState(false)\n\n  const handlers = {\n    onMouseEnter: () => setIsHovered(true),\n    onMouseLeave: () => setIsHovered(false),\n  }\n\n  return { ref, isHovered, handlers }\n}\n\n/**\n * Hook for tap/press state\n *\n * @example\n * ```tsx\n * function TapButton() {\n *   const { ref, isPressed, handlers } = useTap()\n *\n *   return (\n *     <button\n *       ref={ref}\n *       {...handlers}\n *       style={{ transform: `scale(${isPressed ? 0.95 : 1})` }}\n *     >\n *       Press me\n *     </button>\n *   )\n * }\n * ```\n */\nexport function useTap() {\n  const ref = useRef<HTMLElement | null>(null)\n  const [isPressed, setIsPressed] = useState(false)\n\n  const handlers = {\n    onMouseDown: () => setIsPressed(true),\n    onMouseUp: () => setIsPressed(false),\n    onMouseLeave: () => setIsPressed(false),\n    onTouchStart: () => setIsPressed(true),\n    onTouchEnd: () => setIsPressed(false),\n  }\n\n  // Global release\n  useEffect(() => {\n    if (!isBrowser) return\n\n    const handleUp = () => setIsPressed(false)\n    window.addEventListener('mouseup', handleUp)\n    window.addEventListener('touchend', handleUp)\n\n    return () => {\n      window.removeEventListener('mouseup', handleUp)\n      window.removeEventListener('touchend', handleUp)\n    }\n  }, [])\n\n  return { ref, isPressed, handlers }\n}\n\n/**\n * Hook for focus state\n *\n * @example\n * ```tsx\n * function FocusInput() {\n *   const { ref, isFocused, handlers } = useFocus()\n *\n *   return (\n *     <input\n *       ref={ref}\n *       {...handlers}\n *       style={{ borderColor: isFocused ? 'blue' : 'gray' }}\n *     />\n *   )\n * }\n * ```\n */\nexport function useFocus() {\n  const ref = useRef<HTMLElement | null>(null)\n  const [isFocused, setIsFocused] = useState(false)\n\n  const handlers = {\n    onFocus: () => setIsFocused(true),\n    onBlur: () => setIsFocused(false),\n  }\n\n  return { ref, isFocused, handlers }\n}\n\n/**\n * Combined hook for common interaction states\n *\n * Returns the current \"active\" state based on priority:\n * pressed > hovered > focused > default\n *\n * @example\n * ```tsx\n * function InteractiveElement() {\n *   const { ref, activeState, handlers } = useInteractionState()\n *\n *   const styles = {\n *     default: { scale: 1, opacity: 0.7 },\n *     hovered: { scale: 1.05, opacity: 0.9 },\n *     pressed: { scale: 0.95, opacity: 1 },\n *     focused: { scale: 1, opacity: 1 },\n *   }\n *\n *   const current = styles[activeState]\n *\n *   return (\n *     <div ref={ref} {...handlers} style={{ transform: `scale(${current.scale})` }}>\n *       Interact with me\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useInteractionState() {\n  const { ref, isHovered, isPressed, isFocused, handlers } = useGestureState({\n    hover: true,\n    press: true,\n    focus: true,\n  })\n\n  const activeState: 'default' | 'hovered' | 'pressed' | 'focused' =\n    isPressed ? 'pressed' :\n    isHovered ? 'hovered' :\n    isFocused ? 'focused' :\n    'default'\n\n  return { ref, isHovered, isPressed, isFocused, activeState, handlers }\n}\n\n/**\n * Hook that returns animated values for gesture states\n *\n * @example\n * ```tsx\n * function AnimatedButton() {\n *   const { ref, scale, opacity, handlers } = useGestureAnimation({\n *     default: { scale: 1, opacity: 0.8 },\n *     hover: { scale: 1.05, opacity: 1 },\n *     press: { scale: 0.95, opacity: 1 },\n *   })\n *\n *   return (\n *     <button\n *       ref={ref}\n *       {...handlers}\n *       style={{ transform: `scale(${scale})`, opacity }}\n *     >\n *       Animated Button\n *     </button>\n *   )\n * }\n * ```\n */\nexport function useGestureAnimation<T extends Record<string, number>>(\n  states: {\n    default: T\n    hover?: Partial<T>\n    press?: Partial<T>\n    focus?: Partial<T>\n  }\n) {\n  const { ref, isHovered, isPressed, isFocused, handlers } = useGestureState({\n    hover: !!states.hover,\n    press: !!states.press,\n    focus: !!states.focus,\n  })\n\n  // Merge states based on priority\n  const currentValues = { ...states.default }\n\n  if (isFocused && states.focus) {\n    Object.assign(currentValues, states.focus)\n  }\n  if (isHovered && states.hover) {\n    Object.assign(currentValues, states.hover)\n  }\n  if (isPressed && states.press) {\n    Object.assign(currentValues, states.press)\n  }\n\n  return {\n    ref,\n    handlers,\n    isHovered,\n    isPressed,\n    isFocused,\n    ...currentValues,\n  }\n}\n","import { useState, useEffect } from 'react'\nimport { isBrowser } from '../utils/ssr.js'\n\n/**\n * Detect user's reduced motion preference\n *\n * Respects the `prefers-reduced-motion` media query.\n * Returns true when the user has requested reduced motion.\n *\n * @example\n * ```tsx\n * function AnimatedComponent() {\n *   const prefersReducedMotion = useReducedMotion()\n *\n *   const config = prefersReducedMotion\n *     ? { duration: 0 } // Instant\n *     : { stiffness: 100, damping: 15 } // Spring\n *\n *   return <Animated.div config={config}>...</Animated.div>\n * }\n * ```\n *\n * @example With fallback animation\n * ```tsx\n * function FadeIn({ children }) {\n *   const prefersReducedMotion = useReducedMotion()\n *\n *   return (\n *     <Animated.div\n *       initial={{ opacity: prefersReducedMotion ? 1 : 0 }}\n *       animate={{ opacity: 1 }}\n *     >\n *       {children}\n *     </Animated.div>\n *   )\n * }\n * ```\n */\nexport function useReducedMotion(): boolean {\n  const [prefersReducedMotion, setPrefersReducedMotion] = useState(() => {\n    // SSR-safe: assume no preference on server\n    if (!isBrowser) return false\n\n    // Check initial value\n    return window.matchMedia('(prefers-reduced-motion: reduce)').matches\n  })\n\n  useEffect(() => {\n    if (!isBrowser) return\n\n    const mediaQuery = window.matchMedia('(prefers-reduced-motion: reduce)')\n\n    // Update state when preference changes\n    const handleChange = (event: MediaQueryListEvent) => {\n      setPrefersReducedMotion(event.matches)\n    }\n\n    // Modern API\n    if (mediaQuery.addEventListener) {\n      mediaQuery.addEventListener('change', handleChange)\n      return () => mediaQuery.removeEventListener('change', handleChange)\n    }\n\n    // Legacy API (Safari < 14)\n    mediaQuery.addListener(handleChange)\n    return () => mediaQuery.removeListener(handleChange)\n  }, [])\n\n  return prefersReducedMotion\n}\n\n/**\n * Get reduced motion preference synchronously (for SSR)\n *\n * @returns false on server, actual value on client\n */\nexport function getReducedMotionPreference(): boolean {\n  if (!isBrowser) return false\n  return window.matchMedia('(prefers-reduced-motion: reduce)').matches\n}\n\n/**\n * Create animation config based on reduced motion preference\n *\n * @example\n * ```tsx\n * function AnimatedBox() {\n *   const config = useReducedMotionConfig({\n *     default: { stiffness: 100, damping: 15 },\n *     reduced: { stiffness: 500, damping: 50 }, // Much stiffer = faster\n *   })\n *\n *   return <Animated.div config={config}>...</Animated.div>\n * }\n * ```\n */\nexport function useReducedMotionConfig<T>(configs: {\n  default: T\n  reduced: T\n}): T {\n  const prefersReducedMotion = useReducedMotion()\n  return prefersReducedMotion ? configs.reduced : configs.default\n}\n\n/**\n * Skip animations entirely when reduced motion is preferred\n *\n * @example\n * ```tsx\n * function AnimatedList() {\n *   const shouldAnimate = useShouldAnimate()\n *\n *   return items.map((item, i) => (\n *     <Animated.li\n *       initial={shouldAnimate ? { opacity: 0 } : false}\n *       animate={{ opacity: 1 }}\n *       transition={shouldAnimate ? { delay: i * 0.1 } : { duration: 0 }}\n *     >\n *       {item}\n *     </Animated.li>\n *   ))\n * }\n * ```\n */\nexport function useShouldAnimate(): boolean {\n  return !useReducedMotion()\n}\n\n/**\n * Create an animation value that respects reduced motion\n *\n * Returns the full animation when motion is allowed,\n * or the final value immediately when reduced motion is preferred.\n *\n * @example\n * ```tsx\n * function SlideIn() {\n *   const x = useReducedMotionValue(0, 100)\n *   // Returns 0  100 normally\n *   // Returns 100 immediately with reduced motion\n *\n *   return <Animated.div animate={{ x }}>...</Animated.div>\n * }\n * ```\n */\nexport function useReducedMotionValue<T>(\n  animatedValue: T,\n  reducedValue: T\n): T {\n  const prefersReducedMotion = useReducedMotion()\n  return prefersReducedMotion ? reducedValue : animatedValue\n}\n","/**\n * React hooks for scroll-linked animations\n */\nimport { useEffect, useRef, useState, useCallback } from 'react'\nimport {\n  createScrollProgress,\n  createParallax,\n  createScrollTrigger,\n  createScrollLinkedValue,\n  type ScrollInfo,\n  type ScrollProgress,\n  type ParallaxConfig,\n  type ScrollTriggerConfig,\n  type ScrollLinkedConfig,\n} from '../../../index.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ useScrollProgress ============\n\nexport interface UseScrollProgressOptions {\n  /** Target element ref (uses page scroll if not provided) */\n  target?: React.RefObject<HTMLElement>\n  /** Scroll offset configuration */\n  offset?: ['start' | 'center' | 'end', 'start' | 'center' | 'end']\n  /** Smoothing factor (0-1, higher = smoother) */\n  smooth?: number\n}\n\nexport interface UseScrollProgressReturn {\n  /** Current scroll progress (0-1) */\n  progress: number\n  /** Full scroll info object */\n  info: ScrollInfo\n  /** The scroll progress controller */\n  scrollProgress: ScrollProgress | null\n}\n\n/**\n * Track scroll progress for an element or the page\n *\n * @example\n * ```tsx\n * function ScrollIndicator() {\n *   const { progress } = useScrollProgress()\n *   return <div style={{ width: `${progress * 100}%` }} />\n * }\n *\n * function SectionProgress() {\n *   const ref = useRef<HTMLDivElement>(null)\n *   const { progress } = useScrollProgress({ target: ref })\n *   return <div ref={ref}>{Math.round(progress * 100)}%</div>\n * }\n * ```\n */\nexport function useScrollProgress(\n  options: UseScrollProgressOptions = {}\n): UseScrollProgressReturn {\n  const { target, offset, smooth } = options\n\n  const [progress, setProgress] = useState(0)\n  const [info, setInfo] = useState<ScrollInfo>({\n    progress: 0,\n    scrollY: 0,\n    velocity: 0,\n    direction: 0,\n    isInView: true,\n    visibleRatio: 1,\n  })\n  const scrollProgressRef = useRef<ScrollProgress | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    const element = target?.current ?? null\n    const scrollProgress = createScrollProgress(element, { offset, smooth })\n    scrollProgressRef.current = scrollProgress\n\n    const unsubscribe = scrollProgress.subscribe((scrollInfo) => {\n      setProgress(scrollInfo.progress)\n      setInfo(scrollInfo)\n    })\n\n    return () => {\n      unsubscribe()\n      scrollProgress.destroy()\n    }\n  }, [target?.current, offset?.[0], offset?.[1], smooth])\n\n  return {\n    progress,\n    info,\n    scrollProgress: scrollProgressRef.current,\n  }\n}\n\n// ============ useParallax ============\n\nexport interface UseParallaxOptions extends Omit<ParallaxConfig, 'easing'> {\n  /** Easing function */\n  easing?: (t: number) => number\n}\n\nexport interface UseParallaxReturn {\n  /** Ref to attach to the element */\n  ref: React.RefObject<HTMLElement>\n  /** Current offset value */\n  offset: number\n}\n\n/**\n * Create a parallax effect for an element\n *\n * @example\n * ```tsx\n * function ParallaxImage() {\n *   const { ref } = useParallax({ speed: 0.5 })\n *   return <img ref={ref} src=\"...\" />\n * }\n * ```\n */\nexport function useParallax(\n  options: UseParallaxOptions = {}\n): UseParallaxReturn {\n  const ref = useRef<HTMLElement>(null)\n  const [offset, setOffset] = useState(0)\n\n  useIsomorphicLayoutEffect(() => {\n    if (!ref.current) return\n\n    const parallax = createParallax(ref.current, options)\n\n    // Update offset periodically\n    const intervalId = setInterval(() => {\n      setOffset(parallax.getOffset())\n    }, 16) // ~60fps\n\n    return () => {\n      clearInterval(intervalId)\n      parallax.destroy()\n    }\n  }, [options.speed, options.direction, options.rootMargin])\n\n  return { ref: ref as React.RefObject<HTMLElement>, offset }\n}\n\n// ============ useScrollTrigger ============\n\nexport interface UseScrollTriggerOptions\n  extends Omit<ScrollTriggerConfig, 'onEnter' | 'onLeave' | 'onProgress'> {}\n\nexport interface UseScrollTriggerReturn {\n  /** Ref to attach to the element */\n  ref: React.RefObject<HTMLElement>\n  /** Whether the trigger is currently active */\n  isActive: boolean\n  /** Current progress within the trigger range */\n  progress: number\n  /** Whether element has entered the trigger zone */\n  hasEntered: boolean\n}\n\n/**\n * Create a scroll trigger for animations\n *\n * @example\n * ```tsx\n * function FadeInSection() {\n *   const { ref, isActive, progress } = useScrollTrigger({\n *     start: 'top',\n *     end: 'center',\n *   })\n *\n *   return (\n *     <div ref={ref} style={{ opacity: progress }}>\n *       Content fades in as you scroll\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useScrollTrigger(\n  options: UseScrollTriggerOptions = {}\n): UseScrollTriggerReturn {\n  const ref = useRef<HTMLElement>(null)\n  const [isActive, setIsActive] = useState(false)\n  const [progress, setProgress] = useState(0)\n  const [hasEntered, setHasEntered] = useState(false)\n\n  useIsomorphicLayoutEffect(() => {\n    if (!ref.current) return\n\n    const trigger = createScrollTrigger(ref.current, {\n      ...options,\n      onEnter: () => setHasEntered(true),\n      onProgress: (info) => {\n        setIsActive(info.progress > 0 && info.progress < 1)\n        setProgress(info.progress)\n      },\n    })\n\n    return () => trigger.destroy()\n  }, [\n    options.start,\n    options.end,\n    options.startOffset,\n    options.endOffset,\n    options.once,\n    options.scrub,\n  ])\n\n  return { ref: ref as React.RefObject<HTMLElement>, isActive, progress, hasEntered }\n}\n\n// ============ useScrollLinkedValue ============\n\nexport interface UseScrollLinkedValueOptions extends ScrollLinkedConfig {}\n\n/**\n * Create a scroll-linked interpolated value\n *\n * @example\n * ```tsx\n * function ColorTransition() {\n *   const { progress } = useScrollProgress()\n *   const color = useScrollLinkedValue(progress, {\n *     inputRange: [0, 0.5, 1],\n *     outputRange: ['#ff0000', '#00ff00', '#0000ff'],\n *   })\n *\n *   return <div style={{ backgroundColor: color }}>...</div>\n * }\n * ```\n */\nexport function useScrollLinkedValue(\n  scrollProgress: ScrollProgress | null,\n  config: UseScrollLinkedValueOptions\n): number | string {\n  const [value, setValue] = useState<number | string>(config.outputRange[0] ?? 0)\n\n  useIsomorphicLayoutEffect(() => {\n    if (!scrollProgress) return\n\n    const linkedValue = createScrollLinkedValue(scrollProgress, config)\n\n    const unsubscribe = linkedValue.subscribe((newValue) => {\n      setValue(newValue)\n    })\n\n    return () => {\n      unsubscribe()\n      linkedValue.destroy()\n    }\n  }, [scrollProgress, config.inputRange, config.outputRange, config.clamp, config.smooth])\n\n  return value\n}\n","/**\n * React hook for Timeline API\n */\nimport { useRef, useCallback, useMemo } from 'react'\nimport {\n  createTimeline,\n  type TimelineConfig,\n  type Timeline,\n  type TimelineTarget,\n  type TimelineProps,\n  type TimelinePosition,\n} from '../../../index.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ Types ============\n\nexport interface UseTimelineOptions extends TimelineConfig {}\n\nexport interface UseTimelineReturn {\n  /** The timeline instance */\n  timeline: Timeline | null\n  /** Play the timeline */\n  play: () => void\n  /** Pause the timeline */\n  pause: () => void\n  /** Resume from paused state */\n  resume: () => void\n  /** Reverse the timeline */\n  reverse: () => void\n  /** Restart from beginning */\n  restart: () => void\n  /** Seek to a specific progress (0-1) or time */\n  seek: (progress: number) => void\n  /** Add a .to() animation */\n  to: (target: TimelineTarget, props: TimelineProps, position?: TimelinePosition) => UseTimelineReturn\n  /** Add a .from() animation */\n  from: (target: TimelineTarget, props: TimelineProps, position?: TimelinePosition) => UseTimelineReturn\n  /** Add a .fromTo() animation */\n  fromTo: (target: TimelineTarget, fromProps: TimelineProps, toProps: TimelineProps, position?: TimelinePosition) => UseTimelineReturn\n  /** Add a label */\n  addLabel: (label: string, position?: TimelinePosition) => UseTimelineReturn\n  /** Kill the timeline */\n  kill: () => void\n  /** Check if playing */\n  isPlaying: boolean\n  /** Check if paused */\n  isPaused: boolean\n  /** Current progress (0-1) */\n  progress: number\n}\n\n/**\n * Create and control a timeline animation\n *\n * @example Basic usage\n * ```tsx\n * function AnimatedSequence() {\n *   const box1 = useRef<HTMLDivElement>(null)\n *   const box2 = useRef<HTMLDivElement>(null)\n *\n *   const { timeline, play } = useTimeline({\n *     paused: true,\n *     onComplete: () => console.log('Done!'),\n *   })\n *\n *   useEffect(() => {\n *     if (timeline && box1.current && box2.current) {\n *       timeline\n *         .to(box1.current, { x: 100, opacity: 1 })\n *         .to(box2.current, { x: 100, opacity: 1 }, '-=200')\n *     }\n *   }, [timeline])\n *\n *   return (\n *     <>\n *       <button onClick={play}>Play</button>\n *       <div ref={box1} style={{ opacity: 0 }}>Box 1</div>\n *       <div ref={box2} style={{ opacity: 0 }}>Box 2</div>\n *     </>\n *   )\n * }\n * ```\n *\n * @example With labels\n * ```tsx\n * const { timeline } = useTimeline()\n *\n * timeline\n *   .addLabel('start')\n *   .to(element, { x: 100 })\n *   .addLabel('middle')\n *   .to(element, { y: 100 })\n *   .to(otherElement, { opacity: 1 }, 'start') // Jump back to start label\n * ```\n */\nexport function useTimeline(\n  options: UseTimelineOptions = {}\n): UseTimelineReturn {\n  const timelineRef = useRef<Timeline | null>(null)\n\n  // Create timeline on mount\n  useIsomorphicLayoutEffect(() => {\n    const timeline = createTimeline(options)\n    timelineRef.current = timeline\n\n    return () => {\n      timeline.kill()\n    }\n  }, [])\n\n  const play = useCallback(() => {\n    timelineRef.current?.play()\n  }, [])\n\n  const pause = useCallback(() => {\n    timelineRef.current?.pause()\n  }, [])\n\n  const resume = useCallback(() => {\n    timelineRef.current?.resume()\n  }, [])\n\n  const reverse = useCallback(() => {\n    timelineRef.current?.reverse()\n  }, [])\n\n  const restart = useCallback(() => {\n    timelineRef.current?.restart()\n  }, [])\n\n  const seek = useCallback((progress: number) => {\n    timelineRef.current?.seek(progress)\n  }, [])\n\n  const kill = useCallback(() => {\n    timelineRef.current?.kill()\n  }, [])\n\n  // Chainable methods that return the hook result\n  const returnValue = useMemo(() => {\n    const result: UseTimelineReturn = {\n      timeline: timelineRef.current,\n      play,\n      pause,\n      resume,\n      reverse,\n      restart,\n      seek,\n      kill,\n      get isPlaying() {\n        return timelineRef.current?.isPlaying() ?? false\n      },\n      get isPaused() {\n        // Timeline doesn't expose isPaused directly, derive from isPlaying\n        return !(timelineRef.current?.isPlaying() ?? false)\n      },\n      get progress() {\n        return timelineRef.current?.progress() ?? 0\n      },\n      to: (target, props, position) => {\n        timelineRef.current?.to(target, props, position)\n        return result\n      },\n      from: (target, props, position) => {\n        timelineRef.current?.from(target, props, position)\n        return result\n      },\n      fromTo: (target, fromProps, toProps, position) => {\n        timelineRef.current?.fromTo(target, fromProps, toProps, position)\n        return result\n      },\n      addLabel: (label, position) => {\n        timelineRef.current?.addLabel(label, position)\n        return result\n      },\n    }\n    return result\n  }, [play, pause, resume, reverse, restart, seek, kill])\n\n  return returnValue\n}\n\n// ============ useTimelineState ============\n\nexport interface UseTimelineStateReturn {\n  /** Current progress (0-1) */\n  progress: number\n  /** Is the timeline playing */\n  isPlaying: boolean\n  /** Is the timeline paused */\n  isPaused: boolean\n  /** Is the timeline reversed */\n  isReversed: boolean\n}\n\n/**\n * Subscribe to timeline state changes\n *\n * @example\n * ```tsx\n * function TimelineProgress({ timeline }: { timeline: Timeline }) {\n *   const { progress, isPlaying } = useTimelineState(timeline)\n *\n *   return (\n *     <div>\n *       <progress value={progress} max={1} />\n *       <span>{isPlaying ? 'Playing' : 'Paused'}</span>\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useTimelineState(\n  timeline: Timeline | null\n): UseTimelineStateReturn {\n  const progressRef = useRef(0)\n  const isPlayingRef = useRef(false)\n  const isPausedRef = useRef(true)\n  const isReversedRef = useRef(false)\n\n  useIsomorphicLayoutEffect(() => {\n    if (!timeline) return\n\n    const updateState = () => {\n      progressRef.current = timeline.progress()\n      isPlayingRef.current = timeline.isPlaying()\n      isPausedRef.current = !timeline.isPlaying()\n      isReversedRef.current = timeline.isReversed()\n    }\n\n    // Update initially\n    updateState()\n\n    // Update on animation frame while timeline exists\n    let rafId: number | null = null\n    const tick = () => {\n      updateState()\n      rafId = requestAnimationFrame(tick)\n    }\n    rafId = requestAnimationFrame(tick)\n\n    return () => {\n      if (rafId) cancelAnimationFrame(rafId)\n    }\n  }, [timeline])\n\n  return {\n    get progress() {\n      return progressRef.current\n    },\n    get isPlaying() {\n      return isPlayingRef.current\n    },\n    get isPaused() {\n      return isPausedRef.current\n    },\n    get isReversed() {\n      return isReversedRef.current\n    },\n  }\n}\n","/**\n * React hooks for SVG morphing\n */\nimport { useState, useRef, useCallback } from 'react'\nimport {\n  createMorph,\n  createMorphSequence,\n  type MorphConfig,\n  type MorphController,\n} from '../../../index.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ useMorph ============\n\nexport interface UseMorphOptions extends MorphConfig {}\n\nexport interface UseMorphReturn {\n  /** Current morphed path string */\n  path: string\n  /** Current morph progress (0-1) */\n  progress: number\n  /** Morph to a new path */\n  morphTo: (path: string) => void\n  /** Set progress directly */\n  setProgress: (progress: number) => void\n  /** The morph controller instance */\n  controller: MorphController | null\n}\n\n/**\n * Create an SVG path morph animation\n *\n * @example\n * ```tsx\n * const circlePath = 'M50,50 m-25,0 a25,25 0 1,0 50,0 a25,25 0 1,0 -50,0'\n * const starPath = 'M50,25 L58,42 L75,42 L62,52 L67,70 L50,60 L33,70 L38,52 L25,42 L42,42 Z'\n *\n * function MorphingShape() {\n *   const { path, morphTo } = useMorph(circlePath, {\n *     spring: { stiffness: 120, damping: 14 },\n *   })\n *\n *   return (\n *     <svg onClick={() => morphTo(starPath)}>\n *       <path d={path} fill=\"blue\" />\n *     </svg>\n *   )\n * }\n * ```\n */\nexport function useMorph(\n  initialPath: string,\n  options: UseMorphOptions = {}\n): UseMorphReturn {\n  const [path, setPath] = useState(initialPath)\n  const [progress, setProgressState] = useState(0)\n  const morphRef = useRef<MorphController | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    const morph = createMorph(initialPath, {\n      ...options,\n      onProgress: (p) => {\n        setProgressState(p)\n        options.onProgress?.(p)\n      },\n    })\n\n    morph.subscribe((newPath) => {\n      setPath(newPath)\n    })\n\n    morphRef.current = morph\n\n    return () => {\n      morph.destroy()\n    }\n  }, [initialPath])\n\n  const morphTo = useCallback((targetPath: string) => {\n    morphRef.current?.morphTo(targetPath)\n  }, [])\n\n  const setProgress = useCallback((p: number) => {\n    morphRef.current?.setProgress(p)\n  }, [])\n\n  return {\n    path,\n    progress,\n    morphTo,\n    setProgress,\n    controller: morphRef.current,\n  }\n}\n\n// ============ useMorphSequence ============\n\nexport interface UseMorphSequenceOptions extends MorphConfig {}\n\nexport interface UseMorphSequenceReturn {\n  /** Current morphed path string */\n  path: string\n  /** Current path index */\n  currentIndex: number\n  /** Morph to a specific index */\n  morphToIndex: (index: number) => void\n  /** Morph to the next path */\n  morphToNext: () => void\n  /** Morph to the previous path */\n  morphToPrevious: () => void\n}\n\n/**\n * Create a morphing sequence between multiple paths\n *\n * @example\n * ```tsx\n * const paths = [circlePath, squarePath, trianglePath, starPath]\n *\n * function MorphSequence() {\n *   const { path, currentIndex, morphToNext } = useMorphSequence(paths, {\n *     spring: { stiffness: 100, damping: 12 },\n *   })\n *\n *   return (\n *     <svg onClick={morphToNext}>\n *       <path d={path} fill=\"purple\" />\n *       <text>Shape {currentIndex + 1}</text>\n *     </svg>\n *   )\n * }\n * ```\n */\nexport function useMorphSequence(\n  paths: string[],\n  options: UseMorphSequenceOptions = {}\n): UseMorphSequenceReturn {\n  const [path, setPath] = useState(paths[0] ?? '')\n  const [currentIndex, setCurrentIndex] = useState(0)\n\n  const sequenceRef = useRef<ReturnType<typeof createMorphSequence> | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    if (paths.length === 0) return\n\n    const sequence = createMorphSequence(paths, options)\n\n    sequence.subscribe((newPath) => {\n      setPath(newPath)\n      setCurrentIndex(sequence.getCurrentIndex())\n    })\n\n    sequenceRef.current = sequence\n\n    return () => {\n      sequence.destroy()\n    }\n  }, [paths.length])\n\n  const morphToIndex = useCallback((index: number) => {\n    sequenceRef.current?.morphToIndex(index)\n  }, [])\n\n  const morphToNext = useCallback(() => {\n    sequenceRef.current?.morphToNext()\n  }, [])\n\n  const morphToPrevious = useCallback(() => {\n    sequenceRef.current?.morphToPrevious()\n  }, [])\n\n  return {\n    path,\n    currentIndex,\n    morphToIndex,\n    morphToNext,\n    morphToPrevious,\n  }\n}\n\n// ============ useMorphRef ============\n\n/**\n * Create a ref callback that automatically updates path on SVG elements\n *\n * @example\n * ```tsx\n * function AutoMorphPath() {\n *   const { pathRef, morphTo } = useMorphRef(circlePath)\n *\n *   return (\n *     <svg>\n *       <path ref={pathRef} fill=\"green\" />\n *       <button onClick={() => morphTo(starPath)}>Morph</button>\n *     </svg>\n *   )\n * }\n * ```\n */\nexport function useMorphRef(\n  initialPath: string,\n  options: UseMorphOptions = {}\n): {\n  pathRef: React.RefCallback<SVGPathElement>\n  morphTo: (path: string) => void\n  setProgress: (progress: number) => void\n  progress: number\n} {\n  const [progress, setProgressState] = useState(0)\n  const morphRef = useRef<MorphController | null>(null)\n  const elementRef = useRef<SVGPathElement | null>(null)\n\n  const pathRef = useCallback(\n    (element: SVGPathElement | null) => {\n      if (!element) {\n        morphRef.current?.destroy()\n        morphRef.current = null\n        elementRef.current = null\n        return\n      }\n\n      elementRef.current = element\n\n      const morph = createMorph(initialPath, {\n        ...options,\n        onProgress: (p) => {\n          setProgressState(p)\n          options.onProgress?.(p)\n        },\n      })\n\n      morph.subscribe((path) => {\n        element.setAttribute('d', path)\n      })\n\n      morphRef.current = morph\n    },\n    [initialPath]\n  )\n\n  const morphTo = useCallback((targetPath: string) => {\n    morphRef.current?.morphTo(targetPath)\n  }, [])\n\n  const setProgress = useCallback((p: number) => {\n    morphRef.current?.setProgress(p)\n  }, [])\n\n  return {\n    pathRef,\n    morphTo,\n    setProgress,\n    progress,\n  }\n}\n","/**\n * React hooks for layout animations (FLIP)\n */\nimport { useRef, useCallback, createContext, type ReactNode, type RefCallback } from 'react'\nimport React from 'react'\nimport {\n  createLayoutGroup,\n  createSharedLayoutContext,\n  createAutoLayout,\n  measureElement,\n  flip,\n  type LayoutAnimationConfig,\n  type LayoutGroup,\n  type SharedLayoutContext,\n  type AutoLayoutConfig,\n  type LayoutMeasurement,\n  type FlipOptions,\n} from '../../../index.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ Context ============\n\nconst LayoutGroupContext = createContext<LayoutGroup | null>(null)\nconst SharedLayoutContextReact = createContext<SharedLayoutContext | null>(null)\n\n// ============ useLayoutGroup ============\n\nexport interface UseLayoutGroupOptions extends LayoutAnimationConfig {}\n\nexport interface UseLayoutGroupReturn {\n  /** Register an element with a layoutId */\n  register: (id: string, element: HTMLElement) => void\n  /** Unregister an element */\n  unregister: (id: string, element: HTMLElement) => void\n  /** Trigger layout update */\n  update: () => void\n  /** Force re-measure all elements */\n  forceUpdate: () => void\n  /** The layout group controller */\n  layoutGroup: LayoutGroup | null\n}\n\n/**\n * Create a layout animation group\n *\n * @example\n * ```tsx\n * function ReorderableList({ items }) {\n *   const { register, unregister, update } = useLayoutGroup()\n *\n *   const handleReorder = () => {\n *     // Reorder items...\n *     update()\n *   }\n *\n *   return (\n *     <ul>\n *       {items.map((item) => (\n *         <li\n *           key={item.id}\n *           ref={(el) => {\n *             if (el) register(item.id, el)\n *           }}\n *         >\n *           {item.name}\n *         </li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useLayoutGroup(\n  options: UseLayoutGroupOptions = {}\n): UseLayoutGroupReturn {\n  const layoutGroupRef = useRef<LayoutGroup | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    const layoutGroup = createLayoutGroup(options)\n    layoutGroupRef.current = layoutGroup\n\n    return () => {\n      layoutGroup.destroy()\n    }\n  }, [])\n\n  const register = useCallback((id: string, element: HTMLElement) => {\n    layoutGroupRef.current?.register(id, element)\n  }, [])\n\n  const unregister = useCallback((id: string, element: HTMLElement) => {\n    layoutGroupRef.current?.unregister(id, element)\n  }, [])\n\n  const update = useCallback(() => {\n    layoutGroupRef.current?.update()\n  }, [])\n\n  const forceUpdate = useCallback(() => {\n    layoutGroupRef.current?.forceUpdate()\n  }, [])\n\n  return {\n    register,\n    unregister,\n    update,\n    forceUpdate,\n    layoutGroup: layoutGroupRef.current,\n  }\n}\n\n// ============ useLayoutId ============\n\nexport interface UseLayoutIdOptions extends LayoutAnimationConfig {\n  /** The layout group to use (from useLayoutGroup) */\n  group?: LayoutGroup | null\n}\n\nexport interface UseLayoutIdReturn {\n  /** Ref callback to attach to the element */\n  ref: RefCallback<HTMLElement>\n  /** Manually trigger layout update */\n  update: () => void\n}\n\n/**\n * Register an element with a layout ID for shared animations\n *\n * @example\n * ```tsx\n * function Card({ id, layoutGroup }) {\n *   const { ref } = useLayoutId(id, { group: layoutGroup })\n *\n *   return <div ref={ref}>Card {id}</div>\n * }\n * ```\n */\nexport function useLayoutId(\n  layoutId: string,\n  options: UseLayoutIdOptions = {}\n): UseLayoutIdReturn {\n  const { group, ...config } = options\n  const elementRef = useRef<HTMLElement | null>(null)\n  const localGroupRef = useRef<LayoutGroup | null>(null)\n\n  // Create local group if none provided\n  useIsomorphicLayoutEffect(() => {\n    if (!group) {\n      localGroupRef.current = createLayoutGroup(config)\n      return () => {\n        localGroupRef.current?.destroy()\n      }\n    }\n  }, [group])\n\n  const ref = useCallback(\n    (element: HTMLElement | null) => {\n      const activeGroup = group ?? localGroupRef.current\n\n      if (elementRef.current && activeGroup) {\n        activeGroup.unregister(layoutId, elementRef.current)\n      }\n\n      elementRef.current = element\n\n      if (element && activeGroup) {\n        activeGroup.register(layoutId, element)\n      }\n    },\n    [layoutId, group]\n  )\n\n  const update = useCallback(() => {\n    const activeGroup = group ?? localGroupRef.current\n    activeGroup?.update()\n  }, [group])\n\n  return { ref, update }\n}\n\n// ============ useFlip ============\n\nexport interface UseFlipOptions extends FlipOptions {}\n\nexport interface UseFlipReturn {\n  /** Ref callback to attach to the element */\n  ref: RefCallback<HTMLElement>\n  /** Animate the element from its last position */\n  flip: (mutate?: () => void) => Promise<void>\n  /** Get current measurement */\n  measure: () => LayoutMeasurement | null\n}\n\n/**\n * Create a FLIP animation for an element\n *\n * @example\n * ```tsx\n * function ExpandingCard({ isExpanded }) {\n *   const { ref, flip: flipAnim } = useFlip()\n *\n *   useEffect(() => {\n *     flipAnim()\n *   }, [isExpanded, flipAnim])\n *\n *   return (\n *     <div\n *       ref={ref}\n *       className={isExpanded ? 'expanded' : 'collapsed'}\n *     >\n *       Content\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useFlip(options: UseFlipOptions = {}): UseFlipReturn {\n  const elementRef = useRef<HTMLElement | null>(null)\n  const lastMeasurementRef = useRef<LayoutMeasurement | null>(null)\n\n  const ref = useCallback((element: HTMLElement | null) => {\n    if (element) {\n      lastMeasurementRef.current = measureElement(element)\n    }\n    elementRef.current = element\n  }, [])\n\n  const flipFn = useCallback(async (mutate?: () => void) => {\n    if (!elementRef.current) return\n\n    await flip(elementRef.current, mutate ?? (() => {}), options)\n\n    lastMeasurementRef.current = measureElement(elementRef.current)\n  }, [options])\n\n  const measure = useCallback(() => {\n    if (!elementRef.current) return null\n    return measureElement(elementRef.current)\n  }, [])\n\n  return { ref, flip: flipFn, measure }\n}\n\n// ============ useAutoLayout ============\n\nexport interface UseAutoLayoutOptions extends AutoLayoutConfig {}\n\nexport interface UseAutoLayoutReturn {\n  /** Ref callback to attach to the container */\n  containerRef: RefCallback<HTMLElement>\n  /** Trigger layout update */\n  update: () => void\n  /** Force re-measure and animate */\n  forceUpdate: () => void\n}\n\n/**\n * Automatically animate layout changes for child elements\n *\n * @example\n * ```tsx\n * function AutoAnimatedList({ items }) {\n *   const { containerRef, update } = useAutoLayout({\n *     spring: { stiffness: 150, damping: 15 },\n *   })\n *\n *   return (\n *     <ul ref={containerRef}>\n *       {items.map((item) => (\n *         <li key={item.id}>{item.name}</li>\n *       ))}\n *     </ul>\n *   )\n * }\n * ```\n */\nexport function useAutoLayout(\n  options: UseAutoLayoutOptions = {}\n): UseAutoLayoutReturn {\n  const autoLayoutRef = useRef<ReturnType<typeof createAutoLayout> | null>(null)\n\n  const containerRef = useCallback((element: HTMLElement | null) => {\n    if (autoLayoutRef.current) {\n      autoLayoutRef.current.destroy()\n      autoLayoutRef.current = null\n    }\n\n    if (element) {\n      autoLayoutRef.current = createAutoLayout(options)\n    }\n  }, [])\n\n  const update = useCallback(() => {\n    autoLayoutRef.current?.update()\n  }, [])\n\n  const forceUpdate = useCallback(() => {\n    autoLayoutRef.current?.forceUpdate()\n  }, [])\n\n  return { containerRef, update, forceUpdate }\n}\n\n// ============ LayoutGroup Provider ============\n\nexport interface LayoutGroupProviderProps {\n  children: ReactNode\n  config?: LayoutAnimationConfig\n}\n\n/**\n * Provider for layout group context\n */\nexport function LayoutGroupProvider({\n  children,\n  config,\n}: LayoutGroupProviderProps): React.ReactElement {\n  const layoutGroupRef = useRef<LayoutGroup | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    layoutGroupRef.current = createLayoutGroup(config)\n\n    return () => {\n      layoutGroupRef.current?.destroy()\n    }\n  }, [])\n\n  return React.createElement(\n    LayoutGroupContext.Provider,\n    { value: layoutGroupRef.current },\n    children\n  )\n}\n\n// ============ SharedLayout Provider ============\n\nexport interface SharedLayoutProviderProps {\n  children: ReactNode\n  config?: LayoutAnimationConfig\n}\n\n/**\n * Provider for shared layout context\n */\nexport function SharedLayoutProvider({\n  children,\n}: SharedLayoutProviderProps): React.ReactElement {\n  const sharedContextRef = useRef<SharedLayoutContext | null>(null)\n\n  useIsomorphicLayoutEffect(() => {\n    sharedContextRef.current = createSharedLayoutContext()\n\n    return () => {\n      sharedContextRef.current?.destroy()\n    }\n  }, [])\n\n  return React.createElement(\n    SharedLayoutContextReact.Provider,\n    { value: sharedContextRef.current },\n    children\n  )\n}\n\n// ============ Export context for advanced use ============\n\nexport { LayoutGroupContext, SharedLayoutContextReact }\n","/**\n * React hooks for Variants System\n */\nimport { useRef, useCallback, useMemo, createContext, useContext, type ReactNode } from 'react'\nimport React from 'react'\nimport {\n  resolveVariant,\n  getVariant,\n  calculateStaggerDelays,\n  buildTransformString,\n  type Variants,\n  type Variant,\n  type AnimationValues,\n  type VariantTransition,\n  type OrchestrationOptions,\n} from '../../../index.js'\nimport { useSpring } from './useSpring.js'\nimport { useIsomorphicLayoutEffect } from '../utils/ssr.js'\n\n// ============ Context ============\n\ninterface VariantContextValue {\n  /** Current variant name */\n  variant: string | undefined\n  /** Custom data passed to variant functions */\n  custom?: unknown\n  /** Inherited transition settings */\n  transition?: VariantTransition\n  /** Stagger index for children */\n  staggerIndex?: number\n  /** Total stagger count */\n  staggerCount?: number\n}\n\nconst VariantContext = createContext<VariantContextValue>({\n  variant: undefined,\n})\n\n// ============ useVariantContext ============\n\n/**\n * Get the current variant context\n */\nexport function useVariantContext(): VariantContextValue {\n  return useContext(VariantContext)\n}\n\n// ============ useVariants ============\n\nexport interface UseVariantsOptions {\n  /** Named animation states */\n  variants?: Variants\n  /** Current animation state */\n  animate?: string | AnimationValues\n  /** Initial animation state */\n  initial?: string | AnimationValues | false\n  /** Custom data for variant functions */\n  custom?: unknown\n  /** Inherit variant from parent */\n  inherit?: boolean\n  /** Spring configuration override */\n  spring?: { stiffness?: number; damping?: number; mass?: number }\n  /** Callback when animation completes */\n  onAnimationComplete?: (variant: string) => void\n}\n\nexport interface UseVariantsReturn {\n  /** Current animation values */\n  values: AnimationValues\n  /** Trigger a specific variant */\n  setVariant: (name: string) => void\n  /** Current variant name */\n  currentVariant: string | undefined\n  /** Whether animation is in progress */\n  isAnimating: boolean\n}\n\n/**\n * Use variants for declarative animation states\n *\n * @example\n * ```tsx\n * const variants = {\n *   hidden: { opacity: 0, y: 20 },\n *   visible: {\n *     opacity: 1,\n *     y: 0,\n *     transition: { staggerChildren: 0.1 }\n *   },\n * }\n *\n * function MyComponent() {\n *   const { values, setVariant } = useVariants({\n *     variants,\n *     initial: 'hidden',\n *     animate: 'visible',\n *   })\n *\n *   return (\n *     <div style={{\n *       opacity: values.opacity,\n *       transform: `translateY(${values.y}px)`,\n *     }}>\n *       Content\n *     </div>\n *   )\n * }\n * ```\n */\nexport function useVariants(options: UseVariantsOptions): UseVariantsReturn {\n  const {\n    variants,\n    animate,\n    initial,\n    custom,\n    inherit = true,\n    spring: springConfig,\n    onAnimationComplete,\n  } = options\n\n  const parentContext = useVariantContext()\n  const currentVariantRef = useRef<string | undefined>(undefined)\n  const isAnimatingRef = useRef<boolean>(false)\n\n  // Determine the target variant\n  const targetVariant = useMemo(() => {\n    // If animate is a string, use it\n    if (typeof animate === 'string') {\n      return animate\n    }\n    // If inherit and parent has a variant, use that\n    if (inherit && parentContext.variant) {\n      return parentContext.variant\n    }\n    return undefined\n  }, [animate, inherit, parentContext.variant])\n\n  // Resolve initial values\n  const initialValues = useMemo(() => {\n    if (initial === false) {\n      // Skip initial animation\n      return getVariant(variants, targetVariant, custom).values\n    }\n    if (typeof initial === 'string') {\n      return getVariant(variants, initial, custom).values\n    }\n    if (typeof initial === 'object') {\n      return initial\n    }\n    return {}\n  }, [initial, variants, targetVariant, custom])\n\n  // Resolve target values\n  const targetValues = useMemo(() => {\n    if (typeof animate === 'object') {\n      return animate\n    }\n    if (targetVariant && variants) {\n      return getVariant(variants, targetVariant, custom).values\n    }\n    return initialValues\n  }, [animate, targetVariant, variants, custom, initialValues])\n\n  // Get transition settings\n  const transition = useMemo(() => {\n    if (targetVariant && variants) {\n      return getVariant(variants, targetVariant, custom).transition\n    }\n    return parentContext.transition || {}\n  }, [targetVariant, variants, custom, parentContext.transition])\n\n  // Calculate delay from stagger\n  const staggerDelay = useMemo(() => {\n    if (parentContext.staggerIndex !== undefined && transition.staggerChildren) {\n      return (\n        (parentContext.staggerIndex * transition.staggerChildren) +\n        (transition.delayChildren || 0)\n      )\n    }\n    return transition.delay || 0\n  }, [parentContext.staggerIndex, transition])\n\n  // Helper to convert string/number values to numbers for spring\n  const toNumber = (val: string | number | undefined, fallback: number): number => {\n    if (val === undefined) return fallback\n    if (typeof val === 'number') return val\n    // Parse numeric strings (e.g., \"100px\" -> 100, \"50%\" -> 50)\n    const parsed = parseFloat(val)\n    return isNaN(parsed) ? fallback : parsed\n  }\n\n  // Spring values for animation\n  const springValues = useSpring(\n    {\n      x: toNumber(targetValues.x ?? initialValues.x, 0),\n      y: toNumber(targetValues.y ?? initialValues.y, 0),\n      scale: targetValues.scale ?? initialValues.scale ?? 1,\n      scaleX: targetValues.scaleX ?? initialValues.scaleX ?? 1,\n      scaleY: targetValues.scaleY ?? initialValues.scaleY ?? 1,\n      rotate: targetValues.rotate ?? initialValues.rotate ?? 0,\n      opacity: targetValues.opacity ?? initialValues.opacity ?? 1,\n    },\n    {\n      stiffness: springConfig?.stiffness ?? transition.spring?.stiffness ?? 100,\n      damping: springConfig?.damping ?? transition.spring?.damping ?? 15,\n      mass: springConfig?.mass ?? transition.spring?.mass ?? 1,\n    }\n  )\n\n  // Track variant changes\n  useIsomorphicLayoutEffect(() => {\n    if (targetVariant && targetVariant !== currentVariantRef.current) {\n      currentVariantRef.current = targetVariant\n      isAnimatingRef.current = true\n\n      // Delay animation if needed\n      if (staggerDelay > 0) {\n        const timer = setTimeout(() => {\n          isAnimatingRef.current = false\n          onAnimationComplete?.(targetVariant)\n        }, staggerDelay + 500) // Approximate spring duration\n\n        return () => clearTimeout(timer)\n      }\n\n      // Approximate completion\n      const timer = setTimeout(() => {\n        isAnimatingRef.current = false\n        onAnimationComplete?.(targetVariant)\n      }, 500)\n\n      return () => clearTimeout(timer)\n    }\n  }, [targetVariant, staggerDelay, onAnimationComplete])\n\n  const setVariant = useCallback((name: string) => {\n    currentVariantRef.current = name\n  }, [])\n\n  return {\n    values: {\n      ...targetValues,\n      ...springValues,\n    },\n    setVariant,\n    currentVariant: currentVariantRef.current,\n    isAnimating: isAnimatingRef.current,\n  }\n}\n\n// ============ VariantProvider ============\n\nexport interface VariantProviderProps {\n  children: ReactNode\n  /** Current variant for all children */\n  variant?: string\n  /** Custom data for variant functions */\n  custom?: unknown\n  /** Transition settings for children */\n  transition?: VariantTransition\n}\n\n/**\n * Provide variant context to children\n */\nexport function VariantProvider({\n  children,\n  variant,\n  custom,\n  transition,\n}: VariantProviderProps): React.ReactElement {\n  const value = useMemo(\n    () => ({ variant, custom, transition }),\n    [variant, custom, transition]\n  )\n\n  return React.createElement(VariantContext.Provider, { value }, children)\n}\n\n// ============ useStaggerChildren ============\n\nexport interface UseStaggerChildrenOptions {\n  /** Number of children to stagger */\n  count: number\n  /** Stagger delay between children (ms) */\n  staggerChildren?: number\n  /** Initial delay before first child (ms) */\n  delayChildren?: number\n  /** Direction of stagger */\n  staggerDirection?: 1 | -1\n}\n\nexport interface UseStaggerChildrenReturn {\n  /** Get delay for a specific child index */\n  getDelay: (index: number) => number\n  /** Get props to pass to a child */\n  getChildProps: (index: number) => { style: { transitionDelay: string } }\n  /** All delays */\n  delays: number[]\n}\n\n/**\n * Calculate stagger delays for children\n */\nexport function useStaggerChildren(options: UseStaggerChildrenOptions): UseStaggerChildrenReturn {\n  const {\n    count,\n    staggerChildren = 100,\n    delayChildren = 0,\n    staggerDirection = 1,\n  } = options\n\n  const delays = useMemo(() => {\n    return calculateStaggerDelays(count, {\n      staggerChildren,\n      delayChildren,\n      staggerDirection,\n    })\n  }, [count, staggerChildren, delayChildren, staggerDirection])\n\n  const getDelay = useCallback(\n    (index: number) => delays[index] || 0,\n    [delays]\n  )\n\n  const getChildProps = useCallback(\n    (index: number) => ({\n      style: { transitionDelay: `${getDelay(index)}ms` },\n    }),\n    [getDelay]\n  )\n\n  return { getDelay, getChildProps, delays }\n}\n\n// ============ Motion Component Helper ============\n\nexport interface CreateMotionComponentOptions {\n  /** Default variants */\n  variants?: Variants\n  /** Default spring config */\n  spring?: { stiffness?: number; damping?: number; mass?: number }\n}\n\n/**\n * Create a motion-enabled component\n *\n * @example\n * ```tsx\n * const MotionDiv = createMotionComponent('div', {\n *   variants: {\n *     hidden: { opacity: 0 },\n *     visible: { opacity: 1 },\n *   },\n * })\n *\n * <MotionDiv animate=\"visible\" />\n * ```\n */\nexport function createMotionComponent<T extends keyof React.JSX.IntrinsicElements>(\n  _element: T,\n  _options: CreateMotionComponentOptions = {}\n) {\n  // This is a placeholder - the actual implementation would create\n  // a component that uses useVariants internally\n  // For now, users should use the Animated component or useVariants directly\n  throw new Error(\n    'createMotionComponent is not yet implemented. Use useVariants hook or Animated component instead.'\n  )\n}\n\n// ============ Export Context ============\n\nexport { VariantContext }\n","import React, { useEffect, useRef, useState } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Spring component props\n */\nexport interface SpringProps<T extends Record<string, number>> {\n  /** Starting values */\n  from: T\n  /** Target values */\n  to: T\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Callback when animation is at rest */\n  onRest?: () => void\n  /** Render function */\n  children: (values: T) => React.ReactNode\n}\n\n/**\n * Spring component for declarative animations\n *\n * @example\n * ```tsx\n * <Spring\n *   from={{ opacity: 0, y: 20 }}\n *   to={{ opacity: 1, y: 0 }}\n *   config={{ stiffness: 100, damping: 10 }}\n * >\n *   {(style) => (\n *     <div\n *       style={{\n *         opacity: style.opacity,\n *         transform: `translateY(${style.y}px)`,\n *       }}\n *     >\n *       Animated content\n *     </div>\n *   )}\n * </Spring>\n * ```\n */\nexport const Spring = <T extends Record<string, number>>({\n  from,\n  to,\n  config = {},\n  onRest,\n  children,\n}: SpringProps<T>) => {\n  const springRef = useRef<ReturnType<typeof createSpringGroup<T>> | null>(null)\n  const [values, setValues] = useState<T>(from)\n\n  // Initialize spring\n  useEffect(() => {\n    const spring = createSpringGroup(from, config)\n    spring.subscribe(setValues)\n    springRef.current = spring\n\n    // Start animation\n    requestAnimationFrame(() => {\n      spring.set(to, { ...config, onRest })\n    })\n\n    return () => spring.destroy()\n  }, [])\n\n  // Update when props change\n  useEffect(() => {\n    springRef.current?.set(to, { ...config, onRest })\n  }, [to, config, onRest])\n\n  return <>{children(values)}</>}\n","import React, { useEffect, useRef, useState, useContext, useCallback, memo } from 'react'\nimport { createSpringGroup } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\nimport { PresenceContext } from '../context/PresenceContext.js'\nimport { isBrowser } from '../utils/ssr.js'\n\n/**\n * Animation state for Animated components\n */\nexport interface AnimatedStyle {\n  [key: string]: number | string\n}\n\n/**\n * Viewport options for whileInView\n */\nexport interface ViewportOptions {\n  /** Only trigger animation once */\n  once?: boolean\n  /** IntersectionObserver margin */\n  margin?: string\n  /** Amount of element that must be visible (0-1) */\n  amount?: number | 'some' | 'all'\n}\n\n/**\n * Props for animated elements\n */\nexport interface AnimatedElementProps extends Omit<React.HTMLAttributes<HTMLElement>, 'style'> {\n  /** Spring configuration */\n  config?: SpringConfig\n\n  /** Initial animation state (animates from this on mount) */\n  initial?: AnimatedStyle | false\n\n  /** Target animation state */\n  animate?: AnimatedStyle\n\n  /** Exit animation state (used with AnimatePresence) */\n  exit?: AnimatedStyle\n\n  /** Animation state while hovered */\n  whileHover?: AnimatedStyle\n\n  /** Animation state while pressed/tapped */\n  whileTap?: AnimatedStyle\n\n  /** Animation state while focused */\n  whileFocus?: AnimatedStyle\n\n  /** Animation state while dragging */\n  whileDrag?: AnimatedStyle\n\n  /** Animation state while in viewport */\n  whileInView?: AnimatedStyle\n\n  /** Viewport options for whileInView */\n  viewport?: ViewportOptions\n\n  /** Style object (static styles + animated values) */\n  style?: React.CSSProperties\n\n  /** Callback when animation completes */\n  onAnimationComplete?: () => void\n\n  /** Callback when hover starts */\n  onHoverStart?: (event: React.MouseEvent) => void\n\n  /** Callback when hover ends */\n  onHoverEnd?: (event: React.MouseEvent) => void\n\n  /** Callback when tap/press starts */\n  onTapStart?: (event: React.PointerEvent) => void\n\n  /** Callback when tap/press ends */\n  onTap?: (event: React.PointerEvent) => void\n\n  /** Callback when tap is cancelled */\n  onTapCancel?: (event: React.PointerEvent) => void\n\n  ref?: React.Ref<HTMLElement>\n}\n\n/**\n * Extract numeric values from a style object\n */\nfunction extractNumericValues(style: AnimatedStyle): Record<string, number> {\n  const result: Record<string, number> = {}\n  for (const key in style) {\n    if (typeof style[key] === 'number') {\n      result[key] = style[key] as number\n    }\n  }\n  return result\n}\n\n/**\n * Create an animated component for a given tag\n */\nfunction createAnimatedComponent<T extends React.ElementType>(\n  tag: T\n) {\n  const AnimatedComponent = React.forwardRef<HTMLElement, React.ComponentPropsWithoutRef<T> & AnimatedElementProps>(\n    (\n      {\n        children,\n        style = {},\n        config = {},\n        initial,\n        animate,\n        exit,\n        whileHover,\n        whileTap,\n        whileFocus,\n        whileDrag,\n        whileInView,\n        viewport,\n        onAnimationComplete,\n        onHoverStart,\n        onHoverEnd,\n        onTapStart,\n        onTap,\n        onTapCancel,\n        ...props\n      },\n      forwardedRef\n    ) => {\n      const springRef = useRef<ReturnType<typeof createSpringGroup> | null>(null)\n      const elementRef = useRef<HTMLElement | null>(null)\n      const [animatedStyle, setAnimatedStyle] = useState<React.CSSProperties>({})\n      const isFirstRender = useRef(true)\n      const hasCalledSafeToRemove = useRef(false)\n\n      // Gesture states\n      const [isHovered, setIsHovered] = useState(false)\n      const [isPressed, setIsPressed] = useState(false)\n      const [isFocused, setIsFocused] = useState(false)\n      const [isDragging, setIsDragging] = useState(false)\n      const [isInViewport, setIsInViewport] = useState(false)\n      const hasTriggeredInView = useRef(false)\n\n      // Get presence context for exit animations\n      const presenceContext = useContext(PresenceContext)\n      const isPresent = presenceContext?.isPresent ?? true\n      const safeToRemove = presenceContext?.safeToRemove\n\n      // Combine refs\n      const setRef = useCallback((node: HTMLElement | null) => {\n        elementRef.current = node\n        if (typeof forwardedRef === 'function') {\n          forwardedRef(node)\n        } else if (forwardedRef) {\n          (forwardedRef as React.MutableRefObject<HTMLElement | null>).current = node\n        }\n      }, [forwardedRef])\n\n      // IntersectionObserver for whileInView\n      useEffect(() => {\n        if (!whileInView || !elementRef.current || !isBrowser) return\n\n        const threshold = viewport?.amount === 'all' ? 1 :\n                         viewport?.amount === 'some' ? 0 :\n                         typeof viewport?.amount === 'number' ? viewport.amount : 0.5\n\n        const observer = new IntersectionObserver(\n          (entries) => {\n            entries.forEach((entry) => {\n              if (entry.isIntersecting) {\n                if (viewport?.once && hasTriggeredInView.current) return\n                setIsInViewport(true)\n                hasTriggeredInView.current = true\n              } else if (!viewport?.once) {\n                setIsInViewport(false)\n              }\n            })\n          },\n          {\n            rootMargin: viewport?.margin ?? '0px',\n            threshold,\n          }\n        )\n\n        observer.observe(elementRef.current)\n        return () => observer.disconnect()\n      }, [whileInView, viewport?.once, viewport?.margin, viewport?.amount])\n\n      // Determine the target style based on presence and gesture states\n      const getTargetStyle = useCallback((): AnimatedStyle => {\n        // If exiting and we have exit styles\n        if (!isPresent && exit) {\n          return exit\n        }\n\n        // Start with base animate styles\n        let target: AnimatedStyle = animate ? { ...animate } : {}\n\n        // Layer gesture states (order matters - later ones override)\n        if (whileInView && isInViewport) {\n          target = { ...target, ...whileInView }\n        }\n\n        if (whileFocus && isFocused) {\n          target = { ...target, ...whileFocus }\n        }\n\n        if (whileHover && isHovered) {\n          target = { ...target, ...whileHover }\n        }\n\n        if (whileDrag && isDragging) {\n          target = { ...target, ...whileDrag }\n        }\n\n        if (whileTap && isPressed) {\n          target = { ...target, ...whileTap }\n        }\n\n        // If no target styles, fallback to numeric values from style prop\n        if (Object.keys(target).length === 0) {\n          return Object.fromEntries(\n            Object.entries(style).filter((entry): entry is [string, number] => typeof entry[1] === 'number')\n          ) as AnimatedStyle\n        }\n\n        return target\n      }, [isPresent, exit, animate, style, whileHover, whileTap, whileFocus, whileDrag, whileInView, isHovered, isPressed, isFocused, isDragging, isInViewport])\n\n      // Get initial style\n      const getInitialStyle = useCallback((): AnimatedStyle => {\n        // Skip initial animation\n        if (initial === false) {\n          return getTargetStyle()\n        }\n\n        // Use explicit initial values\n        if (initial) {\n          return initial\n        }\n\n        // Default to target for no animation on mount\n        return getTargetStyle()\n      }, [initial, getTargetStyle])\n\n      // Initialize spring\n      useEffect(() => {\n        const initialStyle = getInitialStyle()\n        const numericInitial = extractNumericValues(initialStyle)\n\n        // Only create spring if there are numeric values to animate\n        if (Object.keys(numericInitial).length === 0) {\n          return\n        }\n\n        const spring = createSpringGroup(numericInitial, config)\n\n        spring.subscribe((values) => {\n          setAnimatedStyle(values as React.CSSProperties)\n        })\n\n        springRef.current = spring\n\n        return () => spring.destroy()\n      }, [config.stiffness, config.damping])\n\n      // Handle animation updates\n      useEffect(() => {\n        if (!springRef.current) return\n\n        const targetStyle = getTargetStyle()\n        const numericTarget = extractNumericValues(targetStyle)\n\n        // Skip animation on first render if initial !== false\n        if (isFirstRender.current) {\n          isFirstRender.current = false\n\n          // If initial is provided and different from animate, we need to animate\n          if (initial && initial !== false && animate) {\n            const numericInitial = extractNumericValues(initial)\n            const numericAnimate = extractNumericValues(animate)\n\n            // Check if initial and animate are different\n            const needsAnimation = Object.keys(numericAnimate).some(\n              (key) => numericInitial[key] !== numericAnimate[key]\n            )\n\n            if (needsAnimation) {\n              springRef.current.set(numericAnimate)\n            }\n          }\n          return\n        }\n\n        springRef.current.set(numericTarget)\n      }, [isPresent, animate, exit, getTargetStyle, initial, isHovered, isPressed, isFocused, isDragging, isInViewport])\n\n      // Handle exit animation completion\n      useEffect(() => {\n        if (!isPresent && exit && safeToRemove && !hasCalledSafeToRemove.current) {\n          const numericExit = extractNumericValues(exit)\n          const checkComplete = () => {\n            // Simple velocity check - in a real implementation,\n            // we'd check the spring's isAtRest state\n            const values = springRef.current\n            if (values) {\n              // For now, use a timeout as a fallback\n              // The spring group doesn't expose isAtRest easily\n              setTimeout(() => {\n                if (!hasCalledSafeToRemove.current) {\n                  hasCalledSafeToRemove.current = true\n                  safeToRemove()\n                  onAnimationComplete?.()\n                }\n              }, 500) // Reasonable default for spring animations\n            }\n          }\n\n          // Start checking for completion\n          const timeout = setTimeout(checkComplete, 50)\n          return () => clearTimeout(timeout)\n        }\n      }, [isPresent, exit, safeToRemove, onAnimationComplete])\n\n      // Reset flag when becoming present again\n      useEffect(() => {\n        if (isPresent) {\n          hasCalledSafeToRemove.current = false\n        }\n      }, [isPresent])\n\n      // Gesture event handlers\n      const handleMouseEnter = useCallback((e: React.MouseEvent) => {\n        if (whileHover) setIsHovered(true)\n        onHoverStart?.(e)\n        props.onMouseEnter?.(e as React.MouseEvent<HTMLElement>)\n      }, [whileHover, onHoverStart, props.onMouseEnter])\n\n      const handleMouseLeave = useCallback((e: React.MouseEvent) => {\n        if (whileHover) setIsHovered(false)\n        if (whileTap) setIsPressed(false)\n        onHoverEnd?.(e)\n        props.onMouseLeave?.(e as React.MouseEvent<HTMLElement>)\n      }, [whileHover, whileTap, onHoverEnd, props.onMouseLeave])\n\n      const handlePointerDown = useCallback((e: React.PointerEvent) => {\n        if (whileTap) setIsPressed(true)\n        onTapStart?.(e)\n        props.onPointerDown?.(e as React.PointerEvent<HTMLElement>)\n      }, [whileTap, onTapStart, props.onPointerDown])\n\n      const handlePointerUp = useCallback((e: React.PointerEvent) => {\n        if (whileTap && isPressed) {\n          setIsPressed(false)\n          onTap?.(e)\n        }\n        props.onPointerUp?.(e as React.PointerEvent<HTMLElement>)\n      }, [whileTap, isPressed, onTap, props.onPointerUp])\n\n      const handlePointerCancel = useCallback((e: React.PointerEvent) => {\n        if (whileTap && isPressed) {\n          setIsPressed(false)\n          onTapCancel?.(e)\n        }\n        props.onPointerCancel?.(e as React.PointerEvent<HTMLElement>)\n      }, [whileTap, isPressed, onTapCancel, props.onPointerCancel])\n\n      const handleFocus = useCallback((e: React.FocusEvent) => {\n        if (whileFocus) setIsFocused(true)\n        props.onFocus?.(e as React.FocusEvent<HTMLElement>)\n      }, [whileFocus, props.onFocus])\n\n      const handleBlur = useCallback((e: React.FocusEvent) => {\n        if (whileFocus) setIsFocused(false)\n        props.onBlur?.(e as React.FocusEvent<HTMLElement>)\n      }, [whileFocus, props.onBlur])\n\n      // Global pointer up listener for tap state\n      useEffect(() => {\n        if (!whileTap || !isPressed) return\n\n        const handleGlobalPointerUp = () => {\n          setIsPressed(false)\n        }\n\n        window.addEventListener('pointerup', handleGlobalPointerUp)\n        window.addEventListener('pointercancel', handleGlobalPointerUp)\n\n        return () => {\n          window.removeEventListener('pointerup', handleGlobalPointerUp)\n          window.removeEventListener('pointercancel', handleGlobalPointerUp)\n        }\n      }, [whileTap, isPressed])\n\n      // Combine static and animated styles\n      const staticStyle = Object.fromEntries(\n        Object.entries(style).filter(([_, v]) => typeof v !== 'number')\n      )\n\n      // Build event handlers\n      const eventHandlers: Record<string, React.EventHandler<React.SyntheticEvent>> = {}\n\n      if (whileHover || onHoverStart || onHoverEnd) {\n        eventHandlers.onMouseEnter = handleMouseEnter as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onMouseLeave = handleMouseLeave as React.EventHandler<React.SyntheticEvent>\n      }\n\n      if (whileTap || onTapStart || onTap || onTapCancel) {\n        eventHandlers.onPointerDown = handlePointerDown as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onPointerUp = handlePointerUp as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onPointerCancel = handlePointerCancel as React.EventHandler<React.SyntheticEvent>\n      }\n\n      if (whileFocus) {\n        eventHandlers.onFocus = handleFocus as React.EventHandler<React.SyntheticEvent>\n        eventHandlers.onBlur = handleBlur as React.EventHandler<React.SyntheticEvent>\n      }\n\n      return React.createElement(\n        tag,\n        {\n          ...props,\n          ...eventHandlers,\n          ref: setRef,\n          style: { ...staticStyle, ...animatedStyle },\n        },\n        children\n      )\n    }\n  )\n\n  AnimatedComponent.displayName = `Animated.${String(tag)}`\n  return memo(AnimatedComponent)\n}\n\n/**\n * Animated components with spring physics\n *\n * @example Basic animation\n * ```tsx\n * <Animated.div\n *   style={{\n *     opacity: isVisible ? 1 : 0,\n *     transform: `translateX(${isOpen ? 100 : 0}px)`,\n *   }}\n *   config={{ stiffness: 120, damping: 14 }}\n * >\n *   Content automatically animates\n * </Animated.div>\n * ```\n *\n * @example With AnimatePresence\n * ```tsx\n * <AnimatePresence>\n *   {isVisible && (\n *     <Animated.div\n *       key=\"modal\"\n *       initial={{ opacity: 0, scale: 0.9 }}\n *       animate={{ opacity: 1, scale: 1 }}\n *       exit={{ opacity: 0, scale: 0.9 }}\n *     >\n *       Modal content\n *     </Animated.div>\n *   )}\n * </AnimatePresence>\n * ```\n */\nexport const Animated = {\n  div: createAnimatedComponent('div'),\n  span: createAnimatedComponent('span'),\n  button: createAnimatedComponent('button'),\n  a: createAnimatedComponent('a'),\n  p: createAnimatedComponent('p'),\n  h1: createAnimatedComponent('h1'),\n  h2: createAnimatedComponent('h2'),\n  h3: createAnimatedComponent('h3'),\n  h4: createAnimatedComponent('h4'),\n  h5: createAnimatedComponent('h5'),\n  h6: createAnimatedComponent('h6'),\n  ul: createAnimatedComponent('ul'),\n  ol: createAnimatedComponent('ol'),\n  li: createAnimatedComponent('li'),\n  section: createAnimatedComponent('section'),\n  article: createAnimatedComponent('article'),\n  header: createAnimatedComponent('header'),\n  footer: createAnimatedComponent('footer'),\n  nav: createAnimatedComponent('nav'),\n  main: createAnimatedComponent('main'),\n  aside: createAnimatedComponent('aside'),\n  img: createAnimatedComponent('img'),\n  svg: createAnimatedComponent('svg'),\n  path: createAnimatedComponent('path'),\n  circle: createAnimatedComponent('circle'),\n  rect: createAnimatedComponent('rect'),\n  g: createAnimatedComponent('g'),\n}\n","import React, { useEffect, useRef, useState } from 'react'\nimport { createTrail } from '../../../index.js'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Trail component props\n */\nexport interface TrailProps<T, V extends Record<string, number>> {\n  /** Array of items */\n  items: T[]\n  /** Key extractor for items */\n  keys: (item: T, index: number) => string | number\n  /** Starting values */\n  from: V\n  /** Target values */\n  to: V\n  /** Spring configuration */\n  config?: SpringConfig\n  /** Whether to reverse the trail */\n  reverse?: boolean\n  /** Render function */\n  children: (values: V, item: T, index: number) => React.ReactNode\n}\n\n/**\n * Trail component for staggered animations\n *\n * @example\n * ```tsx\n * <Trail\n *   items={items}\n *   keys={(item) => item.id}\n *   from={{ opacity: 0, x: -20 }}\n *   to={{ opacity: 1, x: 0 }}\n *   config={{ stiffness: 120, damping: 14 }}\n * >\n *   {(style, item, index) => (\n *     <div\n *       key={item.id}\n *       style={{\n *         opacity: style.opacity,\n *         transform: `translateX(${style.x}px)`,\n *       }}\n *     >\n *       {item.name}\n *     </div>\n *   )}\n * </Trail>\n * ```\n */\nexport const Trail = <T, V extends Record<string, number>>({\n  items,\n  keys,\n  from,\n  to,\n  config = {},\n  reverse = false,\n  children,\n}: TrailProps<T, V>) => {\n  const trailRef = useRef<ReturnType<typeof createTrail> | null>(null)\n  const [values, setValues] = useState<V[]>(() =>\n    items.map(() => ({ ...from }))\n  )\n\n  // Initialize trail\n  useEffect(() => {\n    const trail = createTrail(items.length, config)\n\n    const unsubscribe = trail.subscribe((vals) => {\n      setValues(vals.map((v) => ({ ...to, x: v })))\n    })\n\n    trailRef.current = trail\n\n    // Start animation\n    const firstValue = Object.values(to)[0] as number\n    trail.set(firstValue)\n\n    return () => {\n      unsubscribe()\n      trail.destroy()\n    }\n  }, [items.length, config.stiffness, config.damping])\n\n  // Update when to values change\n  useEffect(() => {\n    const firstValue = Object.values(to)[0] as number\n    trailRef.current?.set(firstValue)\n  }, [to])\n\n  return (\n    <>\n      {items.map((item, index) => (\n        <React.Fragment key={keys(item, index)}>\n          {children(values[index]!, item, reverse ? items.length - 1 - index : index)}\n        </React.Fragment>\n      ))}\n    </>\n  )\n}\n","import React, { useMemo, useCallback, useRef, useEffect } from 'react'\nimport { PresenceContext, type PresenceContextValue } from '../context/PresenceContext.js'\n\nexport interface PresenceChildProps {\n  /** Unique identifier for this child */\n  id: string\n  /** The child element to render */\n  children: React.ReactElement\n  /** Whether this child is currently present in the tree */\n  isPresent: boolean\n  /** Callback when exit animation is complete and child can be removed */\n  onExitComplete: (id: string) => void\n  /** Custom data to pass to the child via context */\n  custom?: unknown\n}\n\n/**\n * Wrapper component that provides presence context to a child in AnimatePresence\n *\n * This component is internal and used by AnimatePresence to manage\n * the lifecycle of exiting children.\n */\nexport function PresenceChild({\n  id,\n  children,\n  isPresent,\n  onExitComplete,\n  custom,\n}: PresenceChildProps) {\n  const presenceIdRef = useRef(id)\n\n  // Update ref on id change (shouldn't happen but be safe)\n  presenceIdRef.current = id\n\n  // Memoized callback for safeToRemove\n  const safeToRemove = useCallback(() => {\n    onExitComplete(presenceIdRef.current)\n  }, [onExitComplete])\n\n  // Create stable context value\n  const contextValue = useMemo<PresenceContextValue>(\n    () => ({\n      id,\n      isPresent,\n      safeToRemove,\n      custom,\n    }),\n    [id, isPresent, safeToRemove, custom]\n  )\n\n  // Auto-call safeToRemove after a timeout if exit animation doesn't complete\n  // This prevents \"zombie\" children from staying in the tree forever\n  const hasExited = useRef(false)\n  useEffect(() => {\n    if (!isPresent && !hasExited.current) {\n      hasExited.current = true\n\n      // Set a generous timeout for exit animations\n      // If the animation hasn't called safeToRemove by then, force removal\n      const timeout = setTimeout(() => {\n        safeToRemove()\n      }, 10000) // 10 seconds max for exit animation\n\n      return () => clearTimeout(timeout)\n    }\n\n    // Reset when becoming present again\n    if (isPresent) {\n      hasExited.current = false\n    }\n  }, [isPresent, safeToRemove])\n\n  return (\n    <PresenceContext.Provider value={contextValue}>\n      {children}\n    </PresenceContext.Provider>\n  )\n}\n","import React, {\n  useRef,\n  useState,\n  useLayoutEffect,\n  useEffect,\n  Children,\n  isValidElement,\n  cloneElement,\n} from 'react'\nimport { PresenceChild } from './PresenceChild.js'\n\n// SSR-safe useLayoutEffect\nconst useIsomorphicLayoutEffect =\n  typeof window !== 'undefined' ? useLayoutEffect : useEffect\n\nexport type AnimatePresenceMode = 'sync' | 'wait' | 'popLayout'\n\nexport interface AnimatePresenceProps {\n  /**\n   * Children to animate. Each direct child must have a unique key.\n   */\n  children?: React.ReactNode\n\n  /**\n   * Custom data passed to exit animations via usePresenceCustom()\n   * Useful for dynamic exit directions (e.g., slide left vs right)\n   */\n  custom?: unknown\n\n  /**\n   * Whether to animate the initial mount of children.\n   * Set to false to skip initial animations.\n   * @default true\n   */\n  initial?: boolean\n\n  /**\n   * Controls how children animate relative to each other:\n   * - 'sync': Exiting and entering children animate simultaneously (default)\n   * - 'wait': Wait for exiting children to finish before entering new children\n   * - 'popLayout': Like 'sync' but uses FLIP for position animations\n   * @default 'sync'\n   */\n  mode?: AnimatePresenceMode\n\n  /**\n   * Callback fired when all exiting children have finished animating\n   */\n  onExitComplete?: () => void\n}\n\ninterface ChildMap {\n  [key: string]: React.ReactElement\n}\n\n/**\n * Get unique key from React element\n */\nfunction getChildKey(child: React.ReactElement): string {\n  return child.key !== null ? String(child.key) : ''\n}\n\n/**\n * Convert children array to keyed map\n */\nfunction getChildrenMap(children: React.ReactNode): ChildMap {\n  const map: ChildMap = {}\n\n  Children.forEach(children, (child) => {\n    if (isValidElement(child)) {\n      const key = getChildKey(child)\n      if (key) {\n        map[key] = child\n      }\n    }\n  })\n\n  return map\n}\n\n/**\n * AnimatePresence enables exit animations for children when they're removed.\n *\n * Wrap any components that may be conditionally rendered. Each direct child\n * must have a unique `key` prop for AnimatePresence to track them.\n *\n * @example Basic usage\n * ```tsx\n * import { AnimatePresence, Animated } from '@oxog/springkit/react'\n *\n * function App() {\n *   const [isVisible, setIsVisible] = useState(true)\n *\n *   return (\n *     <AnimatePresence>\n *       {isVisible && (\n *         <Animated.div\n *           key=\"box\"\n *           initial={{ opacity: 0 }}\n *           animate={{ opacity: 1 }}\n *           exit={{ opacity: 0 }}\n *         >\n *           I fade in and out\n *         </Animated.div>\n *       )}\n *     </AnimatePresence>\n *   )\n * }\n * ```\n *\n * @example Wait mode\n * ```tsx\n * <AnimatePresence mode=\"wait\">\n *   <Page key={currentPage} />\n * </AnimatePresence>\n * ```\n *\n * @example Custom exit data\n * ```tsx\n * <AnimatePresence custom={direction}>\n *   <Slide key={index} />\n * </AnimatePresence>\n *\n * // In Slide component:\n * const direction = usePresenceCustom<number>()\n * ```\n */\nexport function AnimatePresence({\n  children,\n  custom,\n  initial = true,\n  mode = 'sync',\n  onExitComplete,\n}: AnimatePresenceProps) {\n  // Track whether this is the first render (for initial prop)\n  const isInitialMount = useRef(true)\n\n  // Track which children are exiting (keyed by child key)\n  const [exitingChildren, setExitingChildren] = useState<ChildMap>({})\n\n  // Previous children for comparison\n  const prevChildrenRef = useRef<ChildMap>({})\n\n  // Force update trigger for 'wait' mode\n  const [, forceUpdate] = useState(0)\n\n  // Track pending exits for onExitComplete callback\n  const pendingExitCount = useRef(0)\n\n  // Convert current children to map\n  const currentChildren = getChildrenMap(children)\n\n  // Detect removed children on each render\n  useIsomorphicLayoutEffect(() => {\n    const prevChildren = prevChildrenRef.current\n    const newExiting: ChildMap = {}\n\n    // Find children that were removed\n    for (const key in prevChildren) {\n      if (!(key in currentChildren)) {\n        const prevChild = prevChildren[key]\n        // Child was removed, keep it for exit animation\n        if (prevChild) {\n          newExiting[key] = prevChild\n        }\n      }\n    }\n\n    // Update exiting children if there are any\n    if (Object.keys(newExiting).length > 0) {\n      setExitingChildren((prev) => ({ ...prev, ...newExiting }))\n      pendingExitCount.current += Object.keys(newExiting).length\n    }\n\n    // Store current as previous for next render\n    prevChildrenRef.current = currentChildren\n\n    // After initial mount, unset the flag\n    if (isInitialMount.current) {\n      isInitialMount.current = false\n    }\n  })\n\n  // Handle exit completion\n  const handleExitComplete = (key: string) => {\n    setExitingChildren((prev) => {\n      const next = { ...prev }\n      delete next[key]\n      return next\n    })\n\n    pendingExitCount.current--\n\n    // Fire callback when all exits are complete\n    if (pendingExitCount.current === 0 && onExitComplete) {\n      onExitComplete()\n    }\n\n    // Force re-render for 'wait' mode\n    if (mode === 'wait') {\n      forceUpdate((n) => n + 1)\n    }\n  }\n\n  // In 'wait' mode, don't render entering children until exits complete\n  const showEntering = mode !== 'wait' || Object.keys(exitingChildren).length === 0\n\n  // Combine current and exiting children for rendering\n  const allChildren: React.ReactElement[] = []\n\n  // First, add exiting children (they animate out)\n  for (const key in exitingChildren) {\n    const exitingChild = exitingChildren[key]\n    if (!exitingChild) continue\n\n    allChildren.push(\n      <PresenceChild\n        key={`presence-${key}`}\n        id={key}\n        isPresent={false}\n        onExitComplete={handleExitComplete}\n        custom={custom}\n      >\n        {cloneElement(exitingChild, {\n          key,\n        })}\n      </PresenceChild>\n    )\n  }\n\n  // Then, add current children (if allowed by mode)\n  if (showEntering) {\n    Children.forEach(children, (child) => {\n      if (isValidElement(child)) {\n        const key = getChildKey(child)\n        if (!key) {\n          console.warn(\n            'AnimatePresence: Every child must have a unique \"key\" prop.'\n          )\n          return\n        }\n\n        // Skip initial animation if initial={false} and this is first mount\n        const shouldAnimate = !(isInitialMount.current && initial === false)\n\n        allChildren.push(\n          <PresenceChild\n            key={`presence-${key}`}\n            id={key}\n            isPresent={true}\n            onExitComplete={handleExitComplete}\n            custom={custom}\n          >\n            {cloneElement(child, {\n              key,\n              // Pass down animation state - child components can use this\n              ...(shouldAnimate ? {} : { 'data-initial-skip': true }),\n            })}\n          </PresenceChild>\n        )\n      }\n    })\n  }\n\n  return <>{allChildren}</>\n}\n","import React, { createContext, useContext, useMemo } from 'react'\nimport type { SpringConfig } from '../../../types.js'\n\n/**\n * Reduced motion preference\n */\nexport type ReducedMotionMode = 'user' | 'always' | 'never'\n\n/**\n * Motion configuration options\n */\nexport interface MotionConfigProps {\n  /** Default spring configuration for all children */\n  config?: SpringConfig\n  /** How to handle reduced motion preference */\n  reducedMotion?: ReducedMotionMode\n  /** Whether to skip initial animations */\n  initial?: boolean\n  /** Children components */\n  children: React.ReactNode\n}\n\n/**\n * Motion context value\n */\nexport interface MotionContextValue {\n  config: SpringConfig\n  reducedMotion: ReducedMotionMode\n  initial: boolean\n  isReducedMotion: boolean\n}\n\nconst defaultContext: MotionContextValue = {\n  config: {},\n  reducedMotion: 'user',\n  initial: true,\n  isReducedMotion: false,\n}\n\n/**\n * Context for sharing motion configuration\n */\nexport const MotionContext = createContext<MotionContextValue>(defaultContext)\n\n/**\n * Hook to access motion configuration\n */\nexport function useMotionConfig(): MotionContextValue {\n  return useContext(MotionContext)\n}\n\n/**\n * Check if user prefers reduced motion\n */\nfunction checkReducedMotion(): boolean {\n  if (typeof window === 'undefined') return false\n  return window.matchMedia?.('(prefers-reduced-motion: reduce)').matches ?? false\n}\n\n/**\n * Provides motion configuration to all children.\n * Supports reduced motion preferences and default spring config.\n *\n * @example Default spring config\n * ```tsx\n * <MotionConfig config={{ stiffness: 200, damping: 20 }}>\n *   <Animated.div animate={{ opacity: 1 }}>\n *     Uses parent config\n *   </Animated.div>\n * </MotionConfig>\n * ```\n *\n * @example Reduced motion\n * ```tsx\n * // Respect user's system preference\n * <MotionConfig reducedMotion=\"user\">\n *   <App />\n * </MotionConfig>\n *\n * // Force reduced motion (accessibility)\n * <MotionConfig reducedMotion=\"always\">\n *   <App />\n * </MotionConfig>\n * ```\n *\n * @example Skip initial animations\n * ```tsx\n * <MotionConfig initial={false}>\n *   <Animated.div initial={{ opacity: 0 }} animate={{ opacity: 1 }}>\n *     No initial animation\n *   </Animated.div>\n * </MotionConfig>\n * ```\n */\nexport function MotionConfig({\n  config = {},\n  reducedMotion = 'user',\n  initial = true,\n  children,\n}: MotionConfigProps): React.ReactElement {\n  const parentContext = useContext(MotionContext)\n\n  const value = useMemo<MotionContextValue>(() => {\n    // Determine if reduced motion is active\n    let isReducedMotion = false\n    switch (reducedMotion) {\n      case 'always':\n        isReducedMotion = true\n        break\n      case 'never':\n        isReducedMotion = false\n        break\n      case 'user':\n      default:\n        isReducedMotion = checkReducedMotion()\n    }\n\n    // Merge with parent config\n    return {\n      config: { ...parentContext.config, ...config },\n      reducedMotion,\n      initial,\n      isReducedMotion,\n    }\n  }, [config, reducedMotion, initial, parentContext.config])\n\n  return (\n    <MotionContext.Provider value={value}>\n      {children}\n    </MotionContext.Provider>\n  )\n}\n"]}